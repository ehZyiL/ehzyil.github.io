{"meta":{"title":"ehzyil's blog","subtitle":"","description":"test description","author":"John Doe","url":"https://blog.ehzyil.xyz","root":"/"},"pages":[{"title":"","date":"2024-01-30T06:30:58.155Z","updated":"2024-01-30T06:30:58.155Z","comments":true,"path":"about/index.html","permalink":"https://blog.ehzyil.xyz/about/index.html","excerpt":"","text":"ä¸ªäººç®€ä»‹æ˜µç§°ï¼šehzyilæ€§åˆ«ï¼šç”·çˆ±å¥½ï¼šè·‘æ­¥"},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2024-01-30T06:30:58.155Z","updated":"2024-01-30T06:30:58.155Z","comments":true,"path":"categories/index.html","permalink":"https://blog.ehzyil.xyz/categories/index.html","excerpt":"","text":""},{"title":"","date":"2024-01-30T06:30:58.155Z","updated":"2024-01-30T06:30:58.155Z","comments":true,"path":"daily-attendance/index.html","permalink":"https://blog.ehzyil.xyz/daily-attendance/index.html","excerpt":"","text":"2023å¹´10æœˆ 2023å¹´10æœˆ 2023å¹´10æœˆ21æ—¥å°†åšå®¢éƒ¨ç½²åˆ°cloudflareä¸Šã€‚é…ç½®å°å·¥å…·çš„åŸŸåã€‚ä¼˜åŒ–å›¾åºŠç•Œé¢å’Œç½‘ç›˜è®¾ç½®ã€‚æ€»ç»“:æ”¶è´§å¾ˆå°‘ã€‚2023å¹´10æœˆ20æ—¥æ€»ç»“:æ— å¿ƒå­¦ä¹ ï¼Œæå„ç§å¯¹æˆ‘æ¥è¯´æ–°å¥‡çš„ä¸œè¥¿ï¼Œä¹°äº†åŸŸåï¼Œæ­å»ºäº†å›¾åºŠï¼Œé‡æ–°é…ç½®MS365E5å¹¶ä¸”æ­å»ºäº†onedriveçš„ä¸ªäººç½‘ç›˜ï¼Œä½†åŠŸèƒ½è¾ƒå°‘è¿˜éœ€è¦å®Œå–„ã€‚2023å¹´10æœˆ19æ—¥åšäº†ä¸€é“ç®—æ³•é¢˜ã€‚æ€»ç»“å‰å‡ å¤©çš„åˆ·é¢˜ç¬”è®°å†™äº†ä¸€é“æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²å’Œåˆ é™¤å€’æ•°èŠ‚ç‚¹ç®—æ³•é¢˜ã€‚å†™äº†ä¿èçš„æœ´æœ´çš„å’Œä¸€å®¶å¯¹æ—¥å¼€å‘å…¬å¸çš„é¢è¯•é¢˜ä¸çŸ¥é“èƒ½ä¸èƒ½è¿‡ã€‚æ‰“å¡ï¼š å¤šé‚»å›½15min é å¢™ç«™10min æ€»ç»“:è¿™ä¸¤å¤©å­¦åˆ°äº†æ–°çš„ç®—æ³•æ€æƒ³ï¼Œæ»‘åŠ¨çª—å£å’Œå¿«æ…¢æŒ‡é’ˆã€‚ç²¾ç¥çŠ¶æ€æ¯”å‰ä¸¤å¤©æœ‰è¿›æ­¥ï¼Œæƒ³çš„ä¹Ÿå°‘äº†ã€‚2023å¹´10æœˆ18æ—¥ä¸‹åˆé…ç½®ruoyi,é…ç½®è‹¥ä¾æ‰€éœ€çš„dockerç¯å¢ƒï¼Œè·‘èµ·æ¥äº†ã€‚çœ‹äº†çœ‹æ˜¨å¤©å†™çš„ä¸¤é“ç®—æ³•é¢˜ï¼Œæœ€é•¿å…¬å…±å­åºåˆ—å¤ªéš¾äº†ã€‚ã€‚ã€‚æ‰“å¡ï¼š å¤šé‚»å›½10min é å¢™ç«™10min çˆ¬4*26å±‚æ¥¼æ¢¯ æ€»ç»“ï¼šé¢è¯•çš„æ—¶å€™è„‘å­ä¸€å¨å±ã€‚2023å¹´10æœˆ17æ—¥ä¸Šåˆé¢äº†ä¸ªè¯•ï¼Œä¸€å¨ç‹—å±ã€‚æ•´ç†ä¹‹å‰çš„ç¬”è®°ã€‚æ‰“å¡ï¼š å¤šé‚»å›½15min é å¢™ç«™15min çˆ¬4*26å±‚æ¥¼æ¢¯ 2023å¹´10æœˆ16æ—¥å†™äº†å‡ é“ç®—æ³•é¢˜ï¼Œä½¿ç”¨é€’å½’å®ç°ç¿»è½¬é“¾è¡¨è¿˜æ˜¯å¤´ç—›ã€‚ã€‚ã€‚ä¼¼æ‡‚éæ‡‚Spring Bootæ•´åˆQuartzå®ç°åŠ¨æ€å®šæ—¶ä»»åŠ¡ã€‚æŠ•100ç®€å†ã€‚æ‰“å¡ï¼š å¤šé‚»å›½15min é å¢™ç«™15min æ€»ç»“ï¼šæ„Ÿè§‰è‡ªå·±è‚šé‡Œæ²¡æœ‰å¢¨æ°´ï¼Œéœ€è¦ç§¯ç´¯ï¼Œä»Šå¤©è¿‡å¾—ä¸€èˆ¬ï¼Œæ™šä¸Šå›å»åˆ«æ‹¿æ‰‹æœºä¸ŠåºŠäº†ã€‚2023å¹´10æœˆ15æ—¥æ‰¾æ¯•è®¾å¯¼å¸ˆå­¦ä¹ Quartzçš„ä½¿ç”¨ä¸åŸºç¡€çŸ¥è¯†ï¼Œæ˜ç™½äº†blogé¡¹ç›®ä¸­å®šæ—¶ä»»åŠ¡çš„å®ç°æ–¹å¼ã€‚æ‰¾åˆ°äº†ä¸‹ä¸€ä¸ªå­¦ä¹ çš„é¡¹ç›®ï¼Œå­¦ä¹ å®Œæˆåå¯ä»¥å°†å…¶èåˆè¿›blogé¡¹ç›®ã€‚æ‰“å¡ï¼š å¤šé‚»å›½15min é å¢™ç«™15min æ€»ç»“ï¼šæ˜¨å¤©é€šçŸ¥å¼€å§‹æ‰¾æ¯•è®¾å¯¼å¸ˆï¼Œè¯¢é—®äº†å‡ ä¸ªè€å¸ˆçš„æ„è§ï¼Œæƒ³ç€æ™šä¸Šæ‰“æ‰°è€å¸ˆå‘¨å…­çš„ç”Ÿæ´»ä¸å¥½ï¼Œå°±é€šè¿‡wxå»è”ç³»å¯¼å¸ˆï¼Œæ²¡æƒ³åˆ°ç­‰åˆ°æ·»åŠ ä¸Šå¥½å‹ä¹‹åï¼Œå¯¼å¸ˆçš„åé¢éƒ½æ»¡äº†...äºæ˜¯ä¸Šåˆé€šè¿‡æ‰“ç”µè¯è”ç³»å¯¼å¸ˆ...ä¸‹æ¬¡åšäº‹ä¸è¦ä¸ºåˆ«äººæƒ³å¤ªå¤šï¼Œå¤šå…³æ³¨è‡ªå·±çš„åˆ©ç›Š2023å¹´10æœˆ14æ—¥å…¨å¤©æ‘†çƒ‚ï¼ï¼ï¼åºŸç‰©ä¸€ä¸ª2023å¹´10æœˆ13æ—¥å­¦ä¹ å•è·¯é€’å½’å’Œå¤šè·¯é€’å½’ã€‚åˆ·é¢˜ï¼šäºŒåˆ†æŸ¥æ‰¾ã€å†’æ³¡æ’åºã€æ’å…¥æ’åºã€æ±‰è¯ºå¡”ã€æ¨è¾‰ä¸‰è§’ï¼Œæ˜å¤©æ•´ç†ç¬”è®°ã€‚æŠ•è‹¥å¹²ç®€å†ã€‚åšäº†ä¸ªæµ‹è¯„ä¸ªåœ¨çº¿ç¬”è¯•ï¼Œéš¾æ­»æˆ‘ï¼ï¼ï¼ã€‚æ‰“å¡ï¼š å¤šé‚»å›½15min é å¢™ç«™15min åšäº†åœ¨çº¿ç¬”è¯•ï¼Œåšå®Œç›´æ¥æ‘†çƒ‚ï¼Œæ˜å¤©å†å­¦ã€‚ 2023å¹´10æœˆ12æ—¥å­¦ä¹ å•é“¾è¡¨(å¸¦å“¨å…µ)ã€åŒå‘é“¾è¡¨(å¸¦å“¨å…µ)ã€ç¯å½¢é“¾è¡¨(å¸¦å“¨å…µ)å¹¶æ•´ç†ä»£ç ã€‚æŠ•è‹¥å¹²ç®€å†ã€‚æ•´ç†ideaåˆ›å»ºjspé¡¹ç›®çš„æ–¹æ³•ã€‚é“¾è¡¨ç¿»è½¬ï¼Œä¸‰ç§æ–¹æ³•åªä¼šæœ€ç®€å•çš„ã€‚æ‰“å¡ï¼š å¤šé‚»å›½10min é å¢™ç«™10min ç ´æˆ’äº†ï¼ï¼ï¼ æˆ‘è§‰å¾—æˆ‘åº”è¯¥åˆ—ä¸ªè±¡é™è¡¨æŠŠé‡è¦å’Œä¸é‡è¦çš„äº‹æƒ…åˆ—å‡ºæ¥ï¼Œå†åšï¼Œä¸ç„¶æƒ³åˆ°ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆã€‚2023å¹´10æœˆ11æ—¥å­¦ä¹ æ•°ç»„å’Œå•é“¾è¡¨ã€‚å­¦ä¹ äºŒåˆ†æŸ¥æ‰¾å¹¶è®°å½•ç¬”è®°ã€‚æŠ•é€’è‹¥å¹²ç®€å†è·‘æ­¥8kæ‰“å¡ï¼š å¤šé‚»å›½15min é å¢™ç«™10min äºŒåˆ†æŸ¥æ‰¾-åŠ›æ‰£ 704 é¢˜&#x2F;æœç´¢æ’å…¥ä½ç½®-åŠ›æ‰£ 35 é¢˜&#x2F;æœç´¢å¼€å§‹ç»“æŸä½ç½®-åŠ›æ‰£ 34 é¢˜ æ€»ç»“ï¼šæœ¬æ‰“ç®—ä¸Šåˆå­¦ä¹ ä½†æ€»è¢«å·¥ä½œä¸Šçš„äº‹æ‰“æ–­ï¼Œä¸­åˆå¼€å§‹çœ‹æ•°æ®ç»“æ„ï¼Œåªçœ‹æ–‡æ¡£æœ‰äº›åœ°æ–¹è¿˜æœ‰æœ‰äº›ä¸æ˜ç™½ï¼Œæ¯”å¦‚äºŒåˆ†æŸ¥æ‰¾çš„å¹³è¡¡æ¿ä¸ºä»€ä¹ˆä¸´ç•Œç‚¹ä¸å‡ä¸€ï¼Œæ™šä¸Šå›æ¥è·‘æ­¥ã€æ´—æ¾¡ã€å†™äº†ä¸‰é“äºŒåˆ†æ³•çš„é¢˜ï¼Œæ˜å¤©ç»§ç»­åšæŒï¼2023å¹´10æœˆ10æ—¥å®Œå–„åšå®¢ã€‚æŠ•é€’è‹¥å¹²ç®€å†åŠå°æ—¶å°±å†™äº†ä¸€é“äºŒåˆ†æ³•..æ‰“å¡ï¼š å¤šé‚»å›½10min é å¢™ç«™10min åšæŒæ‰“å¡åšå®¢ æ˜å¤©æ›´æ”¹å­¦ä¹ æ—¶é—´åˆ°æ—©ä¸Šï¼ï¼ï¼2023å¹´10æœˆ9æ—¥æ”¹å˜å¤šæ¬¡åå®šä¸‹äº†åšå®¢ä¸»é¢˜å¹¶éƒ¨ç½²ã€‚æŠ•Maxä»½ç®€å†ã€‚3.åˆæœ‰äº†å­¦ä¹ çš„æ¬²æœ›ã€‚4.ç«‹ä¸‹flagï¼š æ¯å¤©æ‰“å¡å¤šé‚»å›½è‡³å°‘10min æ¯å¤©é å¢™ç«™10min åšæŒæ‰“å¡åšå®¢"},{"title":"","date":"2021-09-19T04:33:48.000Z","updated":"2024-01-30T06:30:58.155Z","comments":true,"path":"friends/index.html","permalink":"https://blog.ehzyil.xyz/friends/index.html","excerpt":"å‹é“¾æ ¼å¼ã€‚title: xxxurl: xxxavatar: xxx","text":"å‹é“¾æ ¼å¼ã€‚title: xxxurl: xxxavatar: xxx æ”¶è—çš„é“¾æ¥ volantis_developervolantis_developerxaoxuuhttps://github.com/xaoxuuMHuiGhttps://github.com/MHuiGinksshttps://github.com/inkssColsrchhttps://github.com/ColsrchDrew233https://github.com/Drew233Linhk1606https://github.com/Linhk1606W4J1ehttps://github.com/W4J1ecommunity_builderxaoxuuhttps://github.com/xaoxuuMHuiGhttps://github.com/MHuiGColsrchhttps://github.com/Colsrchpennduhttps://github.com/pennduæœ‰ç”¨çš„ç½‘ç«™æˆ–åšå®¢æ”¶è—å¤¹å¤ªä¹±,å°±æ”¾è¿™é‡Œäº†Hexo+Qexo+Vercelå»ºç«™https://hoyue.fun/hexo_qexo.htmlç¦éŸ³æˆ°å£«æ¨™é¡Œç”Ÿæˆå™¨https://lab.magiconch.com/eva-title/MikuTools - å·¥å…·é›†åˆhttps://tools.miku.ac/ä¸€ä¸ªå°å‹å¸¸ç”¨shellå·¥å…·ç®±https://www.nodeseek.com/post-21153-1ä»é›¶å¼€å§‹æ­å»ºä¸ªäººä¹¦ç­¾å¯¼èˆªåº”ç”¨ï¼šFlarehttps://soulteary.com/2022/02/23/building-a-personal-bookmark-navigation-app-from-scratch-flare.htmMS365 E5 Renew Xhttps://ms-e5.hm0420.cc/User/Homeåœ¨Linuxä¸Šéƒ¨ç½²kukuçš„tgæœºå™¨äººhttps://www.kuku.me/archives/40/åœ¨çº¿å·¥å…·ç®±https://tools.laoda.de/ä¸€é”®DDç³»ç»Ÿè„šæœ¬ æ”¯æŒå›½å†…å°é¸¡ï¼Œé•¿æœŸæ›´æ–°https://blockxyz.notion.site/DD-fb837703b3ac4011bb2362e3a56ac148èŒå¯¼èˆªç½‘https://www.rrnav.com/xuexiMacè½¯ä»¶æ”¶å½•https://www.macat.vip/SHSSEDU-å¼€æºçŸ¥è¯†ç¤¾åŒºhttps://shssedu.github.io/æ˜“æ³¢å¶å¹³|https://zhaouncle.com/posts/xloghttps://xlog.app/ç½‘ç›˜ç›´é“¾è§£æAPIæ¼”ç¤ºhttps://lz.qaiu.top/ å‹é“¾ volantis_developervolantis_developerxaoxuuMHuiGxaoxuuMHuiGColsrch"},{"title":"æˆ‘çš„åŠ¨æ€","date":"2024-01-30T06:30:58.219Z","updated":"2024-01-30T06:30:58.219Z","comments":true,"path":"memos/index.html","permalink":"https://blog.ehzyil.xyz/memos/index.html","excerpt":"","text":"","author":"ehzyil"},{"title":"","date":"2024-01-30T06:30:58.219Z","updated":"2024-01-30T06:30:58.219Z","comments":true,"path":"shuoshuo/index.html","permalink":"https://blog.ehzyil.xyz/shuoshuo/index.html","excerpt":"","text":"å·²åºŸå¼ƒ"},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2024-01-30T06:30:58.219Z","updated":"2024-01-30T06:30:58.219Z","comments":true,"path":"tags/index.html","permalink":"https://blog.ehzyil.xyz/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"","slug":"2024/Gité—®é¢˜ï¼šè§£å†³â€œsshconnect to host github.com port 22 Connection timed outâ€","date":"2024-01-30T06:30:58.143Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2024/01/30/2024/Gité—®é¢˜ï¼šè§£å†³â€œsshconnect to host github.com port 22 Connection timed outâ€/","link":"","permalink":"https://blog.ehzyil.xyz/2024/01/30/2024/Git%E9%97%AE%E9%A2%98%EF%BC%9A%E8%A7%A3%E5%86%B3%E2%80%9Csshconnect%20to%20host%20github.com%20port%2022%20Connection%20timed%20out%E2%80%9D/","excerpt":"","text":"åœ¨å†™æ¯•è®¾çš„æ—¶å€™æäº¤ä»£ç å‘ç°æŠ¥é”™ï¼ŒæŸ¥äº†æŸ¥ä»¥ä¸ºå…¬å¸ç½‘ç¦ä¸èƒ½æäº¤ä»£ç ï¼Œåæ¥å‘ç°ç”¨è‡ªå·±çƒ­ç‚¹ä¹Ÿæäº¤ä¸äº†ï¼Œäºæ˜¯ç»§ç»­åœ¨ç½‘ä¸Šå¯»æ‰¾è§£å†³æ–¹æ¡ˆã€‚ Push failed ssh: connect to host github.com port 22: Connection timed out Could not read from remote repository. Please make sure you have the correct access rights and the repository exists. é—®é¢˜åŸå› å¯èƒ½æ˜¯ç”±äºç”µè„‘çš„é˜²ç«å¢™æˆ–è€…å…¶ä»–ç½‘ç»œåŸå› å¯¼è‡´sshè¿æ¥æ–¹å¼ç«¯å£22è¢«å°é”ã€‚ è§£å†³æ–¹æ¡ˆå› ä¸ºç«¯å£è¢«å°é”ï¼Œå°±æ¢æˆ443ç«¯å£ æ“ä½œæ–¹æ³•ï¼š 1.è¿›å…¥~&#x2F;.sshä¸‹ cd ~/.ssh 2.åˆ›å»ºä¸€ä¸ªconfigæ–‡ä»¶ 3.ç¼–è¾‘æ–‡ä»¶å†…å®¹ï¼š Host github.com User git Hostname ssh.github.com PreferredAuthentications publickey IdentityFile ~/.ssh/id_rsa Port 443 Host gitlab.com Hostname altssh.gitlab.com User git Port 443 PreferredAuthentications publickey IdentityFile ~/.ssh/id_rsa 4.ä¿å­˜é€€å‡º 5.æ£€æŸ¥æ˜¯å¦æˆåŠŸssh -T git@github.com ehZyiL@DESKTOP-1H567GC MINGW64 ~/.ssh $ ssh -T git@github.com Hi ehZyiL! You've successfully authenticated, but GitHub does not provide shell access.","categories":[],"tags":[]},{"title":"Frpå†…ç½‘ç©¿é€","slug":"2024/Frpå†…ç½‘ç©¿é€","date":"2024-01-28T20:22:46.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2024/01/28/2024/Frpå†…ç½‘ç©¿é€/","link":"","permalink":"https://blog.ehzyil.xyz/2024/01/28/2024/Frp%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/","excerpt":"","text":"Frpæœ¬åœ°å®‰è£…æŸ¥çœ‹æœåŠ¡å™¨æ¶æ„ä½¿ç”¨cat /proc/versionæŸ¥çœ‹æœåŠ¡å™¨æ¶æ„ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ—çš„å…¶ä»–ä¸¤ç§ root@iZj6caytd8hmoddao18kslZ:/data# cat /proc/version Linux version 5.10.0-15-amd64 (debian-kernel@lists.debian.org) (gcc-10 (Debian 10.2.1-6) 10.2.1 20210110, GNU ld (GNU Binutils for Debian) 2.35.2) #1 SMP Debian 5.10.120-1 (2022-06-09) root@iZj6caytd8hmoddao18kslZ:/data# uname -a Linux iZj6caytd8hmoddao18kslZ 5.10.0-15-amd64 #1 SMP Debian 5.10.120-1 (2022-06-09) x86_64 GNU/Linux root@iZj6caytd8hmoddao18kslZ:/data# uname -r 5.10.0-15-amd64 ä¸‹è½½releaseåŒ…ï¼šæ ¹æ®è®¾å¤‡å’Œfrpç‰ˆæœ¬ä¸‹è½½ï¼š wget https://github.com/fatedier/frp/releases/download/v0.53.2/frp_0.53.2_linux_amd64.tar.gz æŸ¥çœ‹å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ root@iZj6caytd8hmoddao18kslZ:&#x2F;data# ls frp_0.53.2_linux_amd64.tar.gz è§£å‹ï¼š tar -zxvf frp_0.53.2_linux_amd64.tar.gz ç›¸å…³æ–‡ä»¶ï¼š root@iZj6caytd8hmoddao18kslZ:&#x2F;data# cd frp_0.53.2_linux_amd64&#x2F; root@iZj6caytd8hmoddao18kslZ:&#x2F;data&#x2F;frp_0.53.2_linux_amd64# ls frpc frpc.toml frps frps.toml LICENSE frps*ï¼šæ˜¯frpæœåŠ¡å™¨ç›¸å…³æ–‡ä»¶ã€‚ frpc*ï¼šæ˜¯frpå®¢æˆ·ç«¯ç›¸å…³æ–‡ä»¶ã€‚ é…ç½®FRPæœåŠ¡ç«¯ä¿®æ”¹æœåŠ¡ç«¯é…ç½®ï¼š vim frps.ini æ–‡ä»¶å†…å®¹ï¼š # [common] is integral section [common] server_addr &#x3D; 8.210.2.174 # å¦‚æœæœ‰å¤šä¸ªIPï¼Œå¯ä»¥é€‰æ‹©ç»‘å®šåˆ°ä¸åŒçš„ipä¸Š bind_port &#x3D; 7000 # è™šæ‹Ÿä¸»æœºé…ç½®ï¼Œä¸èƒ½å’Œç³»ç»Ÿä¸­å·²ç›‘å¬çš„ç«¯å£å†²çªã€‚httpå’Œhttpså¯ä»¥è®¾ç½®æˆåŒä¸€ä¸ª vhost_http_port &#x3D; 7080 vhost_https_port &#x3D; 7081 # æœåŠ¡ç«¯webé¢æ¿ dashboard_addr &#x3D; 0.0.0.0 dashboard_port &#x3D; 7500 # è®¾ç½®ç”¨æˆ·åå¯†ç ï¼Œé»˜è®¤éƒ½æ˜¯adminï¼Œè¯·æ³¨æ„åšä¿®æ”¹ dashboard_user &#x3D; admin dashboard_pwd &#x3D; Li021712 # æ™®ç½—ç±³ä¿®æ–¯è¿ç»´æœåŠ¡ï¼Œgoè¯­è¨€ç›¸å…³ç›‘æ§ï¼Œå¯ä»¥å…³é—­ enable_prometheus &#x3D; false # è®¾ç½®æ—¥å¿—æ–‡ä»¶åœ°å€ log_file &#x3D; &#x2F;data&#x2F;frp&#x2F;frps.log # trace, debug, info, warn, error log_level &#x3D; info log_max_days &#x3D; 3 # disable log colors when log_file is console, default is false disable_log_color &#x3D; false # DetailedErrorsToClient defines whether to send the specific error (with debug info) to frpc. By default, this value is true. detailed_errors_to_client &#x3D; true # æœ€æ–°ç‰ˆæœ¬æ”¯æŒçš„éªŒè¯æ–¹å¼æ¯”è¾ƒå¤šï¼Œè¿™é‡Œè¿˜æ˜¯é€‰ç”¨tokenæ¨¡å¼ # AuthenticationMethod specifies what authentication method to use authenticate frpc with frps. # If &quot;token&quot; is specified - token will be read into login message. authentication_method &#x3D; token # AuthenticateHeartBeats specifies whether to include authentication token in heartbeats sent to frps. By default, this value is false. authenticate_heartbeats &#x3D; false # AuthenticateNewWorkConns specifies whether to include authentication token in new work connections sent to frps. By default, this value is false. authenticate_new_work_conns &#x3D; false # auth token ç›¸å½“äºå¯†ç ï¼Œè¯·æ³¨æ„ä¿æŠ¤ token &#x3D; 123456 # å…è®¸é…ç½®ç»‘å®šçš„ç«¯å£ # only allow frpc to bind ports you list, if you set nothing, there won&#39;t be any limit # allow_ports &#x3D; 2000-3000,3001,3003,4000-50000 # pool_count in each proxy will change to max_pool_count if they exceed the maximum value max_pool_count &#x3D; 5 # max ports can be used for each client, default value is 0 means no limit max_ports_per_client &#x3D; 0 # TlsOnly specifies whether to only accept TLS-encrypted connections. By default, the value is false. tls_only &#x3D; false Dockerå®‰è£…é…ç½®FRPæœåŠ¡ç«¯ä¿®æ”¹æœåŠ¡ç«¯é…ç½®ï¼š vim frps.ini æ–‡ä»¶å†…å®¹ï¼š # [common] is integral section [common] server_addr &#x3D; 8.210.2.174 # å¦‚æœæœ‰å¤šä¸ªIPï¼Œå¯ä»¥é€‰æ‹©ç»‘å®šåˆ°ä¸åŒçš„ipä¸Š bind_port &#x3D; 7000 # è™šæ‹Ÿä¸»æœºé…ç½®ï¼Œä¸èƒ½å’Œç³»ç»Ÿä¸­å·²ç›‘å¬çš„ç«¯å£å†²çªã€‚httpå’Œhttpså¯ä»¥è®¾ç½®æˆåŒä¸€ä¸ª vhost_http_port &#x3D; 7080 vhost_https_port &#x3D; 7081 # æœåŠ¡ç«¯webé¢æ¿ dashboard_addr &#x3D; 0.0.0.0 dashboard_port &#x3D; 7500 # è®¾ç½®ç”¨æˆ·åå¯†ç ï¼Œé»˜è®¤éƒ½æ˜¯adminï¼Œè¯·æ³¨æ„åšä¿®æ”¹ dashboard_user &#x3D; admin dashboard_pwd &#x3D; Li021712 # æ™®ç½—ç±³ä¿®æ–¯è¿ç»´æœåŠ¡ï¼Œgoè¯­è¨€ç›¸å…³ç›‘æ§ï¼Œå¯ä»¥å…³é—­ enable_prometheus &#x3D; false # è®¾ç½®æ—¥å¿—æ–‡ä»¶åœ°å€ log_file &#x3D; &#x2F;data&#x2F;frp&#x2F;frps.log # trace, debug, info, warn, error log_level &#x3D; info log_max_days &#x3D; 3 # disable log colors when log_file is console, default is false disable_log_color &#x3D; false # DetailedErrorsToClient defines whether to send the specific error (with debug info) to frpc. By default, this value is true. detailed_errors_to_client &#x3D; true # æœ€æ–°ç‰ˆæœ¬æ”¯æŒçš„éªŒè¯æ–¹å¼æ¯”è¾ƒå¤šï¼Œè¿™é‡Œè¿˜æ˜¯é€‰ç”¨tokenæ¨¡å¼ # AuthenticationMethod specifies what authentication method to use authenticate frpc with frps. # If &quot;token&quot; is specified - token will be read into login message. authentication_method &#x3D; token # AuthenticateHeartBeats specifies whether to include authentication token in heartbeats sent to frps. By default, this value is false. authenticate_heartbeats &#x3D; false # AuthenticateNewWorkConns specifies whether to include authentication token in new work connections sent to frps. By default, this value is false. authenticate_new_work_conns &#x3D; false # auth token ç›¸å½“äºå¯†ç ï¼Œè¯·æ³¨æ„ä¿æŠ¤ token &#x3D; 123456 # å…è®¸é…ç½®ç»‘å®šçš„ç«¯å£ # only allow frpc to bind ports you list, if you set nothing, there won&#39;t be any limit # allow_ports &#x3D; 2000-3000,3001,3003,4000-50000 # pool_count in each proxy will change to max_pool_count if they exceed the maximum value max_pool_count &#x3D; 5 # max ports can be used for each client, default value is 0 means no limit max_ports_per_client &#x3D; 0 # TlsOnly specifies whether to only accept TLS-encrypted connections. By default, the value is false. tls_only &#x3D; false æ‹‰å–dockeré•œåƒå¹¶è¿è¡Œdocker run --restart&#x3D;always --network host -d -v &#x2F;data&#x2F;frp&#x2F;frps.ini:&#x2F;etc&#x2F;frp&#x2F;frps.toml --name frps snowdreamtech&#x2F;frps é…ç½®FRPå®¢æˆ·ç«¯ä¸‹è½½å®¢æˆ·ç«¯ # FRPå®¢æˆ·ç«¯ [common] server_addr &#x3D; 8.210.2.174 # ä¸frps.iniçš„bind_portä¸€è‡´ server_port &#x3D; 7000 # ä¸frps.iniçš„tokenä¸€è‡´ token &#x3D; 123456 # [ä¸€ä¸ªä¾‹å­_è¿™é‡Œå°½é‡å…¨è‹±æ–‡] # type &#x3D; é“¾æ¥åè®®é»˜è®¤å°±æ˜¯tcpä¸éœ€è¦æ”¹ # local_ip &#x3D; å¦‚æœä½ è¦å†…ç½‘ç©¿é€çš„å°±æ˜¯æœ¬æœºåœ°å€å°±å†™127.0.0.1 # local_port &#x3D; å‡è®¾ä½ æ˜¯è¦è¿œç¨‹æ¡Œé¢(windows)é‚£å°±åœ¨è¿™é‡Œå†™3389 # remote_port &#x3D; å¦‚æœä½ æ˜¯æŒ‰ç…§æˆ‘åšå®¢çš„æ­¥éª¤å¡«å†™çš„æ˜¯30000-40000ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥éšä¾¿å†™ä¸€ä¸ª30000-40000ä¹‹é—´çš„æ•°å­— [forum] type &#x3D; tcp local_ip &#x3D; 127.0.0.1 local_port &#x3D; 8080 remote_port &#x3D; 80 [palword] type &#x3D; udp local_ip &#x3D; 127.0.0.1 local_port &#x3D; 8211 remote_port &#x3D; 36422 è¿è¡Œfrpc.exe -c frpc.ini","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"å†…ç½‘ç©¿é€","slug":"å†…ç½‘ç©¿é€","permalink":"https://blog.ehzyil.xyz/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"}],"author":"ehzyil"},{"title":"ä½¿ç”¨StringUtils.isNotEmptyé‡åˆ°çš„é—®é¢˜","slug":"2024/ä½¿ç”¨StringUtils.isNotEmptyé‡åˆ°çš„é—®é¢˜","date":"2024-01-12T00:00:00.000Z","updated":"2024-01-30T06:30:58.147Z","comments":true,"path":"2024/01/12/2024/ä½¿ç”¨StringUtils.isNotEmptyé‡åˆ°çš„é—®é¢˜/","link":"","permalink":"https://blog.ehzyil.xyz/2024/01/12/2024/%E4%BD%BF%E7%94%A8StringUtils.isNotEmpty%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/","excerpt":"","text":"åœ¨åˆ¤æ–­mapä¸­çš„keyçš„æ—¶å€™é‡åˆ°çš„é—®é¢˜ ä¸‹é¢çš„ä»£ç æƒ³è¦åˆ¤æ–­paramsä¸­çš„é”®dashesæ˜¯å¦å­˜åœ¨ï¼Œä¼ å…¥çš„ç©ºå­—ç¬¦ä¸²ï¼Œè°ƒç”¨StringUtils.isNotEmpty(dashes)æ–¹æ³•å´è¿”å›trueï¼Œå³ä¸ä¸ºç©ºå¯¼è‡´å®é™…ä¸šåŠ¡å‡ºç°äº†é—®é¢˜ã€‚ HashMap&lt;String, Object> params = new HashMap&lt;>(); params.put(\"é˜¿è¨\", \"\"); Object o = params.get(\"dashes\"); System.out.println(o); //ç©º String dashes = String.valueOf(o); System.out.println(dashes); // null System.out.println(StringUtils.isNotEmpty(dashes)); //true System.out.println(StringUtils.isNotBlank(dashes)); //true if (StringUtils.isNotEmpty(String.valueOf(params.get(\"dashes\")))) &#123; //å¯ä»¥è¿›æ¥ System.out.println(\"å¯ä»¥è¿›æ¥\"); &#125; é€šè¿‡æŸ¥çœ‹StringUtils.isNotEmpty()çš„æºç  public static boolean isNotEmpty(CharSequence cs) &#123; return !isEmpty(cs); &#125; public static boolean isEmpty(CharSequence cs) &#123; return cs &#x3D;&#x3D; null || cs.length() &#x3D;&#x3D; 0; &#125; å¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆé—®é¢˜ï¼Œä»¥ä¸ºè¿™ä¸ªæ–¹æ³•ä¸èƒ½æ£€æŸ¥å‡ºé—®é¢˜ï¼Œäºæ˜¯ç½‘ä¸Šæœç´¢äº†ç›¸å…³é—®é¢˜ï¼Œå‘ç°å¹¶ä¸æ˜¯StringUtils.isNotEmpty()çš„é—®é¢˜ã€‚é—®é¢˜è¦å½’ç»“äºString.valueOf(o)æ–¹æ³•ï¼Œä¸‹é¢çœ‹çœ‹å…¶æºç ï¼š //å½“å‚æ•°æ˜¯Integerã€Longç­‰èŒƒå‹æ—¶ public static String valueOf(Object obj) &#123; return (obj == null) ? \"null\" : obj.toString(); &#125; //å½“å‚æ•°ä¸ºåŸºæœ¬ç±»å‹æ—¶,å¦‚int public static String valueOf(int i) &#123; return Integer.toString(i); &#125; å› æ­¤å½“å‚æ•°æ˜¯Integerã€Longç­‰æ³›å‹æ—¶ï¼Œå¦‚æœå‚æ•°ä¸ºnullï¼Œæ­¤æ–¹æ³•ä¼šä¼šæŠŠå‚æ•°è½¬åŒ–æˆâ€nullâ€ æ‰€ä»¥å¦‚æœç”¨StringUtils.isNotEmptyå»åˆ¤æ–­ä½¿ç”¨String.ValueOfè½¬åŒ–æˆâ€nullâ€çš„å‚æ•°ï¼Œæ˜¯trueçš„ï¼Œå› ä¸ºæ­¤æ–¹æ³•å¹¶æ²¡æœ‰å»åˆ¤æ–­ä¼ å…¥å€¼ä¸ºâ€nullâ€çš„æƒ…å†µã€‚ å…¶å®åœ¨åˆ¤æ–­ä¸€ä¸ªmapä¸­çš„keyçš„æ—¶å€™åº”è¯¥å…ˆåˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ï¼Œå†å»åˆ¤æ–­å®ƒçš„å€¼ï¼Œä¸‹é¢è¦åˆ¤æ–­mapä¸­çš„ä¸€ä¸ªkeyå¯¹åº”çš„å€¼æ˜¯å¦æ˜¯â€trueâ€ï¼Œå¯ä»¥ä½¿ç”¨ï¼š HashMap&lt;String, Object> params = new HashMap&lt;>(); params.put(\"dashes\", \"true\"); if (params.containsKey(\"dashes\") &amp;&amp; StringUtils.isNotEmpty(params.get(\"dashes\").toString())) &#123; System.out.println(\"1\"); &#125; if (params.containsKey(\"dashes\") &amp;&amp; \"true\".equals(params.get(\"dashes\").toString())) &#123; System.out.println(\"2\"); &#125; Object o = Optional.ofNullable(params.get(\"dashes\")).orElse(\"\"); if (StringUtils.isNotEmpty(o.toString())) &#123; System.out.println(\"3\"); &#125; if (\"true\".equals(o.toString())) &#123; System.out.println(\"4\"); &#125; åªæœ‰å½“params.put(&quot;dashes&quot;, &quot;true&quot;);ä¼ å…¥çš„å€¼ä¸ºâ€trueâ€æ—¶æ‰ä¼šè¿›å…¥ifç»“æ„å†…ã€‚","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"},{"name":"è¸©å‘","slug":"è¸©å‘","permalink":"https://blog.ehzyil.xyz/tags/%E8%B8%A9%E5%9D%91/"}],"author":"ehzyil"},{"title":"SpringBootå®ç°å¾®ä¿¡å…¬ä¼—å·è‡ªåŠ¨ç™»å½•","slug":"2024/SpringBootå®ç°å¾®ä¿¡å…¬ä¼—å·è‡ªåŠ¨ç™»å½•","date":"2024-01-11T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2024/01/11/2024/SpringBootå®ç°å¾®ä¿¡å…¬ä¼—å·è‡ªåŠ¨ç™»å½•/","link":"","permalink":"https://blog.ehzyil.xyz/2024/01/11/2024/SpringBoot%E5%AE%9E%E7%8E%B0%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E8%87%AA%E5%8A%A8%E7%99%BB%E5%BD%95/","excerpt":"","text":"å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½®ä½¿ç”¨natappå¼€å¯å†…ç½‘ç©¿é€ä½¿ç”¨æ•™ç¨‹ æˆ‘çš„é…ç½®å¦‚ä¸‹ï¼š æ³¨å†Œå¾®ä¿¡å…¬ä¼—å·å¹¶å¼€å¯æœåŠ¡å™¨é…ç½®æ³¨å†Œå®Œå…¬ä¼—å·è¿›å…¥åŸºæœ¬é…ç½®&#x2F; å¡«å†™æœåŠ¡å™¨é…ç½® å¡«å†™å†…å®¹ç¤ºä¾‹ å…·ä½“è¦æ±‚å¯ä»¥å‚è€ƒ æ¥å…¥æŒ‡å— å¡«å†™å®Œç‚¹å‡»æäº¤çš„æ—¶å€™ä¼šå‘ç°æŠ¥é”™ï¼ŒåŸå› æ˜¯WXè¦è°ƒç”¨ä½ å¡«å†™çš„URLå¹¶ä¼ å…¥è¿™å‡ ä¸ªå‚æ•° å°†å…¶è¿›è¡ŒåŠ å¯†åå’Œechostræ¯”å¯¹åå¹¶è¿”å›echostræ‰èƒ½é€šè¿‡éªŒè¯ï¼Œå½“ç„¶ä½ ç›´æ¥è¿”å›echostrå­—æ®µä¹Ÿå¯å¯ä»¥ã€‚ è¿™ä¸ªæ–‡æ¡£é‡Œæœ‰å…·ä½“çš„å†…å®¹ä½†ä»–æ˜¯ç”¨pythonå†™çš„å…·ä½“çœ‹è¿™é‡Œã€‚ é™„ä¸ŠJavaä»£ç  @Slf4j @RestController @RequestMapping(path = \"wx\") public class WxCallbackRestController &#123; private static final String TOKEN = \"ehzyil\"; // è¯·æŒ‰ç…§å…¬ä¼—å¹³å°å®˜ç½‘\\åŸºæœ¬é…ç½®ä¸­ä¿¡æ¯å¡«å†™ /** * å¾®ä¿¡çš„å…¬ä¼—å·æ¥å…¥ token éªŒè¯ï¼Œå³è¿”å›echostrçš„å‚æ•°å€¼ * * @param request * @return */ @GetMapping public String check(HttpServletRequest request) &#123; try &#123; // è·å–è¯·æ±‚å‚æ•° String signature = request.getParameter(\"signature\"); String timestamp = request.getParameter(\"timestamp\"); String nonce = request.getParameter(\"nonce\"); String echostr = request.getParameter(\"echostr\"); // å°†tokenã€timestampã€nonceè¿›è¡Œå­—å…¸åºæ’åº String[] list = &#123;TOKEN, timestamp, nonce&#125;; Arrays.sort(list); // å°†ä¸‰ä¸ªå‚æ•°å­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸² String str = list[0] + list[1] + list[2]; // å°†å­—ç¬¦ä¸²è¿›è¡ŒSHA1åŠ å¯† MessageDigest sha1 = null; try &#123; sha1 = MessageDigest.getInstance(\"SHA-1\"); &#125; catch (Exception e) &#123; e.printStackTrace(); return null; &#125; // Update the message digest with each element in the list for (String element : list) &#123; sha1.update(element.getBytes()); &#125; // Generate the hash code byte[] hashcode = sha1.digest(); // Convert the hash code to a hexadecimal string StringBuilder hexString = new StringBuilder(); for (byte b : hashcode) &#123; hexString.append(String.format(\"%02X\", b)); &#125; // æ¯”è¾ƒåŠ å¯†åçš„å­—ç¬¦ä¸²å’Œsignatureæ˜¯å¦ä¸€è‡´ if (hexString.toString().equalsIgnoreCase(signature)) &#123; // å¦‚æœä¸€è‡´ï¼Œåˆ™è¿”å›echostr return echostr; &#125; else &#123; // å¦‚æœä¸ä¸€è‡´ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² return \"\"; &#125; &#125; catch (Exception e) &#123; // å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™è¿”å›å¼‚å¸¸ä¿¡æ¯ log.error(\"å¾®ä¿¡å…¬ä¼—å·ç™»å½•tokenéªŒè¯å¤±è´¥:\", e.getMessage()); return \"\"; &#125; &#125; &#125; æˆåŠŸå¹¶å¯ç”¨åæ˜¾ç¤ºå¦‚ä¸‹ï¼š ä¸‹é¢æ­£å¼å¼€å¯å®è·µã€‚ å®è·µç­–ç•¥ ä½¿ç”¨SSEå»ºç«‹å‰åç«¯çš„åŠé•¿è¿æ¥,åœ¨å‰ç«¯ç”ŸæˆéªŒè¯ç å¹¶å±•ç¤ºäºŒç»´ç ï¼Œç”¨æˆ·æ‰«æäºŒç»´ç å¹¶è¾“å…¥éªŒè¯ç ï¼ŒæœåŠ¡é€šè¿‡å›è°ƒæ¥å£æ¥æ”¶ç”¨æˆ·çš„éªŒè¯ç ï¼Œè®©ç”¨æˆ·è‡ªåŠ¨ç™»å½•ã€‚ å…·ä½“å®è·µSSEå»ºç«‹å‰åç«¯çš„åŠé•¿è¿æ¥-å‰ç«¯å‰ç«¯ä»£ç  &lt;div class=\"tabpane-container\"> &lt;h2 class=\"title\">å¾®ä¿¡æ‰«ç /é•¿æŒ‰è¯†åˆ«ç™»å½•&lt;/h2> &lt;div class=\"first\"> &lt;img class=\"signin-qrcode\" th:src=\"$&#123;global.siteInfo.contactMeWxQrCode&#125;\"/> &lt;/div> &lt;div class=\"explain\"> &lt;bold>è¾“å…¥éªŒè¯ç &lt;/bold> &lt;span id=\"code\">&lt;/span> &lt;div>&lt;span id=\"state\">æœ‰æ•ˆæœŸäº”åˆ†é’Ÿ ğŸ‘‰&lt;/span> &lt;a id=\"refreshCode\">æ‰‹åŠ¨åˆ·æ–°&lt;/a>&lt;/div> &lt;/div> &lt;/div> è¿™æ®µä»£ç ç”¨äºå»ºç«‹ä¸€ä¸ªé•¿è¿æ¥ã€‚ é¦–å…ˆï¼Œå®ƒæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ªåä¸ºsseSourceçš„å˜é‡ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™å°è¯•å…³é—­å®ƒã€‚ç„¶åï¼Œå®ƒæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ªåä¸ºdeviceIdçš„å˜é‡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä»cookieä¸­è·å–å®ƒã€‚ æ¥ä¸‹æ¥ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªæ–°çš„EventSourceå¯¹è±¡ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™sseSourceå˜é‡ã€‚è¿™ä¸ªå¯¹è±¡ç”¨äºå»ºç«‹ä¸æœåŠ¡å™¨çš„è¿æ¥ã€‚ ç„¶åï¼Œå®ƒä¸ºsseSourceå¯¹è±¡æ·»åŠ ä¸€ä¸ªonmessageäº‹ä»¶ç›‘å¬å™¨ï¼Œå½“æœåŠ¡å™¨å‘é€æ¶ˆæ¯æ—¶ï¼Œè¿™ä¸ªäº‹ä»¶ç›‘å¬å™¨å°±ä¼šè¢«è§¦å‘ã€‚åœ¨äº‹ä»¶ç›‘å¬å™¨ä¸­ï¼Œå®ƒå°†æ¶ˆæ¯çš„æ•°æ®éƒ¨åˆ†æ›¿æ¢æ‰€æœ‰åŒå¼•å·ï¼Œå¹¶å°†å…¶ä¿®å‰ªã€‚ç„¶åï¼Œå®ƒæ ¹æ®æ¶ˆæ¯çš„å†…å®¹æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚ å¦‚æœæ¶ˆæ¯ä»¥refresh#å¼€å¤´ï¼Œåˆ™è¡¨ç¤ºæœåŠ¡å™¨å‘é€äº†ä¸€ä¸ªæ–°çš„éªŒè¯ç ã€‚å®ƒå°†æ–°çš„éªŒè¯ç æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œå¹¶æ›´æ–°çŠ¶æ€æ ‡ç­¾ã€‚ å¦‚æœæ¶ˆæ¯æ˜¯scanï¼Œåˆ™è¡¨ç¤ºç”¨æˆ·å·²ç»æ‰«æäº†äºŒç»´ç ã€‚å®ƒæ›´æ–°çŠ¶æ€æ ‡ç­¾ã€‚ å¦‚æœæ¶ˆæ¯ä»¥login#å¼€å¤´ï¼Œåˆ™è¡¨ç¤ºç”¨æˆ·å·²ç»æˆåŠŸç™»å½•ã€‚å®ƒå°†æœåŠ¡å™¨å‘é€çš„cookieä¿å­˜åˆ°æœ¬åœ°ï¼Œå¹¶åˆ·æ–°é¡µé¢ã€‚ å¦‚æœæ¶ˆæ¯ä»¥init#å¼€å¤´ï¼Œåˆ™è¡¨ç¤ºæœåŠ¡å™¨å‘é€äº†ä¸€ä¸ªåˆå§‹éªŒè¯ç ã€‚å®ƒå°†åˆå§‹éªŒè¯ç æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œå¹¶æ›´æ–°çŠ¶æ€æ ‡ç­¾ã€‚ å¦‚æœæ¶ˆæ¯ä¸æ˜¯ä»¥ä¸Šä»»ä½•ä¸€ç§ï¼Œåˆ™å®ƒä¼šå°†æ–°çš„éªŒè¯ç æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œå¹¶æ›´æ–°çŠ¶æ€æ ‡ç­¾ã€‚ æœ€åï¼Œå®ƒä¸ºsseSourceå¯¹è±¡æ·»åŠ ä¸€ä¸ªonopenäº‹ä»¶ç›‘å¬å™¨ï¼Œå½“è¿æ¥å»ºç«‹æ—¶ï¼Œè¿™ä¸ªäº‹ä»¶ç›‘å¬å™¨å°±ä¼šè¢«è§¦å‘ã€‚åœ¨äº‹ä»¶ç›‘å¬å™¨ä¸­ï¼Œå®ƒå°†è®¾å¤‡IDæ‰“å°åˆ°æ§åˆ¶å°ã€‚ å®ƒè¿˜ä¸ºsseSourceå¯¹è±¡æ·»åŠ ä¸€ä¸ªonerroräº‹ä»¶ç›‘å¬å™¨ï¼Œå½“è¿æ¥å‡ºé”™æ—¶ï¼Œè¿™ä¸ªäº‹ä»¶ç›‘å¬å™¨å°±ä¼šè¢«è§¦å‘ã€‚åœ¨äº‹ä»¶ç›‘å¬å™¨ä¸­ï¼Œå®ƒå°†é”™è¯¯ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å°ï¼Œå¹¶æ›´æ–°çŠ¶æ€æ ‡ç­¾ã€‚ æœ€åï¼Œå®ƒåˆ›å»ºä¸€ä¸ªåä¸ºintHookçš„å˜é‡ï¼Œå¹¶å°†å…¶èµ‹å€¼ä¸ºä¸€ä¸ªæ¯ç§’é’Ÿæ‰§è¡Œä¸€æ¬¡çš„setIntervalå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ç”¨äºæ¯ç§’é’Ÿå‘æœåŠ¡å™¨è¯·æ±‚ä¸€æ¬¡éªŒè¯ç ã€‚ let fetchCodeCnt = 0; function fetchCode() &#123; if (deviceId) &#123; if (++fetchCodeCnt > 5) &#123; // ä¸ºäº†é¿å…ä¸åœçš„å‘åç«¯å‘èµ·è¯·æ±‚ï¼Œåšä¸€ä¸ªæœ€å¤§çš„é‡è¯•è®¡æ•°é™åˆ¶ try &#123; window.clearInterval(intHook); &#125; catch (e) &#123; &#125; return; &#125; $.ajax(&#123; url: \"/login/fetch?deviceId=\" + deviceId, type: \"get\", dataType: \"text\", success: function (data) &#123; console.log(\"data>>>>>>>>: \", data); if (data != 'fail') &#123; codeTag.text(data); try &#123; window.clearInterval(intHook); &#125; catch (e) &#123; &#125; &#125; &#125;, error: function (e) &#123; console.log(\"some error! \", e); &#125; &#125;); &#125; else &#123; console.log(\"deviceIdæœªè·å–ï¼Œç¨åå†è¯•!\"); &#125; &#125; è¿™æ®µä»£ç ç”¨äºæ¯ç§’é’Ÿå‘æœåŠ¡å™¨è¯·æ±‚ä¸€æ¬¡éªŒè¯ç ã€‚ é¦–å…ˆï¼Œå®ƒæ£€æŸ¥deviceIdå˜é‡æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ç»§ç»­æ‰§è¡Œã€‚ ç„¶åï¼Œå®ƒæ£€æŸ¥fetchCodeCntå˜é‡çš„å€¼ï¼Œå¦‚æœfetchCodeCntå¤§äº5ï¼Œåˆ™è¡¨ç¤ºå·²ç»é‡è¯•äº†5æ¬¡ï¼Œå®ƒå°†æ¸…é™¤intHookå®šæ—¶å™¨ï¼Œå¹¶è¿”å›ã€‚ å¦‚æœfetchCodeCntå°äºæˆ–ç­‰äº5ï¼Œåˆ™å®ƒå°†å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªAJAXè¯·æ±‚ï¼Œè¯·æ±‚éªŒè¯ç ã€‚ åœ¨AJAXè¯·æ±‚çš„successå›è°ƒå‡½æ•°ä¸­ï¼Œå®ƒå°†æœåŠ¡å™¨è¿”å›çš„éªŒè¯ç æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œå¹¶æ¸…é™¤intHookå®šæ—¶å™¨ã€‚ åœ¨AJAXè¯·æ±‚çš„errorå›è°ƒå‡½æ•°ä¸­ï¼Œå®ƒå°†é”™è¯¯ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å°ã€‚ æœ€åï¼Œå¦‚æœdeviceIdå˜é‡ä¸å­˜åœ¨ï¼Œåˆ™å®ƒå°†æ‰“å°ä¸€æ¡æ¶ˆæ¯åˆ°æ§åˆ¶å°ï¼Œè¡¨ç¤ºç¨åå†è¯•ã€‚ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯æ¯ç§’é’Ÿå‘æœåŠ¡å™¨è¯·æ±‚ä¸€æ¬¡éªŒè¯ç ï¼Œç›´åˆ°æœåŠ¡å™¨è¿”å›ä¸€ä¸ªæœ‰æ•ˆçš„éªŒè¯ç ï¼Œæˆ–è€…é‡è¯•æ¬¡æ•°è¾¾åˆ°5æ¬¡ã€‚ function refreshCode() &#123; $.ajax(&#123; url: &quot;&#x2F;login&#x2F;refresh?deviceId&#x3D;&quot; + deviceId, dataType: &quot;json&quot;, type: &quot;get&quot;, success: function (data) &#123; const code &#x3D; data[&#39;result&#39;][&#39;code&#39;]; const reconnect &#x3D; data[&#39;result&#39;][&#39;reconnect&#39;] console.log(&quot;éªŒè¯ç åˆ·æ–°å®Œæˆ: &quot;, data); if (reconnect) &#123; &#x2F;&#x2F; é‡æ–°å»ºç«‹è¿æ¥ buildConnect(); $(&#39;#state&#39;).text(&quot;å·²åˆ·æ–°!&quot;); &#125; else if (code) &#123; if (codeTag.text() !&#x3D;&#x3D; code) &#123; console.log(&quot;ä¸»åŠ¨åˆ·æ–°éªŒè¯ç !&quot;); codeTag.text(code); stateTag.text(&quot;å·²åˆ·æ–°!&quot;); &#125; else &#123; console.log(&quot;éªŒè¯ç å·²åˆ·æ–°äº†!&quot;); &#125; &#125; &#125; &#125;) &#125; refreshCode()å‡½æ•°ç”¨äºåˆ·æ–°éªŒè¯ç ã€‚ å®ƒé¦–å…ˆå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªAJAXè¯·æ±‚ï¼Œè¯·æ±‚æ–°çš„éªŒè¯ç ã€‚ åœ¨AJAXè¯·æ±‚çš„successå›è°ƒå‡½æ•°ä¸­ï¼Œå®ƒå°†æœåŠ¡å™¨è¿”å›çš„éªŒè¯ç æ•°æ®è§£æå‡ºæ¥ï¼Œå¹¶å­˜å‚¨åœ¨codeå’Œreconnectå˜é‡ä¸­ã€‚ ç„¶åï¼Œå®ƒå°†codeå’Œreconnectå˜é‡çš„å€¼æ‰“å°åˆ°æ§åˆ¶å°ã€‚ å¦‚æœreconnectä¸ºçœŸï¼Œåˆ™è¡¨ç¤ºéœ€è¦é‡æ–°å»ºç«‹é•¿è¿æ¥ï¼Œå®ƒå°†è°ƒç”¨buildConnect()å‡½æ•°é‡æ–°å»ºç«‹é•¿è¿æ¥ï¼Œå¹¶æ›´æ–°çŠ¶æ€æ ‡ç­¾çš„æ–‡æœ¬ä¸ºâ€œå·²åˆ·æ–°ï¼â€ã€‚ å¦‚æœreconnectä¸ºå‡ï¼Œåˆ™è¡¨ç¤ºä¸éœ€è¦é‡æ–°å»ºç«‹é•¿è¿æ¥ï¼Œå®ƒå°†æ£€æŸ¥codeå˜é‡çš„å€¼æ˜¯å¦ä¸å½“å‰éªŒè¯ç æ ‡ç­¾ä¸Šçš„æ–‡æœ¬ä¸åŒï¼Œå¦‚æœä¸åŒï¼Œåˆ™è¡¨ç¤ºéªŒè¯ç å·²åˆ·æ–°ï¼Œå®ƒå°†æ›´æ–°éªŒè¯ç æ ‡ç­¾ä¸Šçš„æ–‡æœ¬å’ŒçŠ¶æ€æ ‡ç­¾çš„æ–‡æœ¬ä¸ºâ€œå·²åˆ·æ–°ï¼â€ã€‚ å¦‚æœcodeå˜é‡çš„å€¼ä¸å½“å‰éªŒè¯ç æ ‡ç­¾ä¸Šçš„æ–‡æœ¬ç›¸åŒï¼Œåˆ™è¡¨ç¤ºéªŒè¯ç æ²¡æœ‰åˆ·æ–°ï¼Œå®ƒå°†æ‰“å°ä¸€æ¡æ¶ˆæ¯åˆ°æ§åˆ¶å°ï¼Œè¡¨ç¤ºéªŒè¯ç å·²åˆ·æ–°äº†ã€‚ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯åˆ·æ–°éªŒè¯ç ï¼Œå¹¶æ ¹æ®æœåŠ¡å™¨è¿”å›çš„æ•°æ®æ›´æ–°éªŒè¯ç æ ‡ç­¾å’ŒçŠ¶æ€æ ‡ç­¾çš„æ–‡æœ¬ã€‚ å®ƒå¯ä»¥ç”¨äºåœ¨ç”¨æˆ·ç‚¹å‡»åˆ·æ–°éªŒè¯ç æŒ‰é’®æ—¶åˆ·æ–°éªŒè¯ç ï¼Œä¹Ÿå¯ä»¥ç”¨äºåœ¨é•¿è¿æ¥æ–­å¼€æ—¶é‡æ–°å»ºç«‹é•¿è¿æ¥å¹¶åˆ·æ–°éªŒè¯ç ã€‚ SSEå»ºç«‹å‰åç«¯çš„åŠé•¿è¿æ¥-åç«¯åˆå§‹åŒ– /** * key = éªŒè¯ç , value = é•¿è¿æ¥ */ private LoadingCache&lt;String, SseEmitter> verifyCodeCache; /** * key = è®¾å¤‡ value = éªŒè¯ç  */ private LoadingCache&lt;String, String> deviceCodeCache; public WxLoginHelper(LoginService loginService) &#123; // æ³¨å…¥ç™»å½•æœåŠ¡ this.sessionService = loginService; // è®¾å®šä»¤ç‰ŒéªŒè¯ç ç¼“å­˜ï¼Œæœ€å¤§å®¹é‡ä¸º300ï¼Œè¿‡æœŸæ—¶é—´ä¸º5åˆ†é’Ÿ verifyCodeCache = CacheBuilder.newBuilder().maximumSize(300) .expireAfterWrite(5, TimeUnit.MINUTES).build(new CacheLoader&lt;String, SseEmitter>() &#123; @Override public SseEmitter load(String s) throws Exception &#123; // åœ¨Guavaåº“ä¸­æŠ›å‡ºå¼‚å¸¸\"No Vla In Guava Exception\"ï¼Œå¼‚å¸¸ä¿¡æ¯åŒ…å«å‚æ•°s throw new NoVlaInGuavaException(\"no val: \" + s); &#125; &#125;); // è®¾å®šéªŒè¯ç ç¼“å­˜ï¼Œæœ€å¤§å®¹é‡ä¸º300ï¼Œè¿‡æœŸæ—¶é—´ä¸º5åˆ†é’Ÿ deviceCodeCache = CacheBuilder.newBuilder().maximumSize(300) .expireAfterWrite(5, TimeUnit.MINUTES).build(new CacheLoader&lt;String, String>() &#123; @Override public String load(String s) &#123; // è®°å½•æ—¥å¿—ï¼šload deviceCodeCache: &#123;&#125; log.info(\"load deviceCodeCache: &#123;&#125;\", s); // å¾ªç¯ç”ŸæˆéªŒè¯ç  while (true) &#123; // è°ƒç”¨CodeGenerateUtilç±»çš„genCode()æ–¹æ³•ç”ŸæˆéªŒè¯ç  String code = CodeGenerateUtil.genCode(); // åˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦å·²ç»å­˜åœ¨è¯¥éªŒè¯ç  if (!verifyCodeCache.asMap().containsKey(code)) &#123; // è‹¥ç¼“å­˜ä¸­ä¸å­˜åœ¨è¯¥éªŒè¯ç ï¼Œåˆ™è¿”å›è¯¥éªŒè¯ç  return code; &#125; &#125; &#125; &#125;); &#125; åœ¨WxLoginHelperåˆå§‹åŒ–çš„åŒæ—¶ç»™verifyCodeCacheå’ŒdeviceCodeCacheåˆå§‹åŒ–ã€‚ LoadingCacheæ˜¯Guavaåº“ä¸­çš„ä¸€ç§ç¼“å­˜ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨åŠ è½½å’Œè¿‡æœŸç¼“å­˜é¡¹ã€‚ åœ¨ä½ çš„ä»£ç ä¸­ï¼ŒverifyCodeCacheç”¨äºå­˜å‚¨éªŒè¯éªŒè¯ç å’ŒSSE Emitterå¯¹è±¡çš„æ˜ å°„ï¼ŒdeviceCodeCacheç”¨äºå­˜å‚¨è®¾å¤‡IDå’ŒéªŒè¯ç çš„æ˜ å°„ã€‚ è¿™ä¸¤ä¸ªç¼“å­˜çš„æœ€å¤§å®¹é‡éƒ½æ˜¯300ï¼Œè¿‡æœŸæ—¶é—´éƒ½æ˜¯5åˆ†é’Ÿã€‚ verifyCodeCacheçš„åŠ è½½å™¨æ˜¯ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œå®ƒå®ç°äº†CacheLoaderæ¥å£ã€‚ CacheLoaderæ¥å£å®šä¹‰äº†ä¸€ä¸ªload()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äºåŠ è½½ç¼“å­˜é¡¹ã€‚ åœ¨verifyCodeCacheçš„åŠ è½½å™¨ä¸­ï¼Œload()æ–¹æ³•ä¼šæŠ›å‡ºä¸€ä¸ªNoVlaInGuavaExceptionå¼‚å¸¸ï¼Œè¯¥å¼‚å¸¸è¡¨ç¤ºç¼“å­˜ä¸­æ²¡æœ‰è¯¥éªŒè¯ç å¯¹åº”çš„å€¼ã€‚ deviceCodeCacheçš„åŠ è½½å™¨ä¹Ÿæ˜¯ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ï¼Œå®ƒä¹Ÿå®ç°äº†CacheLoaderæ¥å£ã€‚ åœ¨deviceCodeCacheçš„åŠ è½½å™¨ä¸­ï¼Œload()æ–¹æ³•ä¼šå¾ªç¯ç”ŸæˆéªŒè¯ç ï¼Œç›´åˆ°ç”Ÿæˆä¸€ä¸ªä¸å­˜åœ¨äºç¼“å­˜ä¸­çš„éªŒè¯ç ã€‚ è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯åˆå§‹åŒ–ä¸¤ä¸ªç¼“å­˜ï¼Œä»¥ä¾¿åœ¨åç»­çš„ä»£ç ä¸­ä½¿ç”¨å®ƒä»¬æ¥å­˜å‚¨éªŒè¯éªŒè¯ç å’Œè®¾å¤‡éªŒè¯ç ã€‚ è®¢é˜…æ–¹æ³•è·å–è®¢é˜…è®¾å¤‡çš„SseEmitter /** * è®¢é˜…è®¾å¤‡çš„SseEmitter * @param deviceId è®¾å¤‡ID * @return è®¢é˜…è®¾å¤‡çš„SseEmitterå¯¹è±¡ * @throws IOException è¾“å…¥è¾“å‡ºå¼‚å¸¸ */ public SseEmitter subscribe(String deviceId) throws IOException &#123; // ç”±äºä¼ æ¥çš„deviceIdå¹¶æ²¡æœ‰ç”¨ï¼Œå¯ä»¥ä»å‰ä¸€ä¸ªç±»ReqInfoContextä¸­è·å– deviceId = ReqInfoContext.getReqInfo().getDeviceId(); // getæ–¹æ³•ä¼šåœ¨ç¼“å­˜ä¸­æ£€æŸ¥è¯¥å€¼æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›nullã€‚ // getUncheckedæ–¹æ³•ä¸ä¼šæ£€æŸ¥è¯¥å€¼æ˜¯å¦å­˜åœ¨ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›è¯¥å€¼,å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ String realCode = deviceCodeCache.getUnchecked(deviceId); // åˆ›å»ºSseEmitterå¯¹è±¡ SseEmitter sseEmitter = new SseEmitter(SSE_EXPIRE_TIME); // æ£€æŸ¥å¹¶å…³é—­æ—§çš„SSE Emitter SseEmitter oldSss = verifyCodeCache.getIfPresent(deviceId); if (oldSss != null) &#123; oldSss.complete(); &#125; // å°†æ–°çš„SSE Emitteræ”¾å…¥ç¼“å­˜ verifyCodeCache.put(realCode, sseEmitter); // è®¾ç½®SSE Emitterçš„è¶…æ—¶å’Œé”™è¯¯å¤„ç†ç¨‹åº sseEmitter.onTimeout(() -> &#123; log.info(\"sse è¶…æ—¶ä¸­æ–­ --> &#123;&#125;\", realCode); verifyCodeCache.invalidate(realCode); sseEmitter.complete(); &#125;); sseEmitter.onError((e) -> &#123; log.warn(\"sse é”™è¯¯! --> &#123;&#125;\", realCode, e); verifyCodeCache.invalidate(realCode); sseEmitter.complete(); &#125;); // å‘å®¢æˆ·ç«¯å‘é€åˆå§‹åŒ–æ¶ˆæ¯ sseEmitter.send(\"initCode!\"); sseEmitter.send(\"init#\" + realCode); // è¿”å›SSE Emitterå¯¹è±¡ return sseEmitter; &#125; å½“å‰ç«¯è°ƒç”¨deviceCodeCache.getUnchecked(deviceId);æ–¹æ³•æ—¶ç”Ÿæˆå¹¶å°†éªŒè¯ç å­˜åœ¨deviceCodeCacheä¸­ã€‚verifyCodeCacheéªŒè¯ç å’Œæ–°åˆ›å»ºçš„sseEmitterï¼Œå®Œæˆä¹‹åå‘å®¢æˆ·ç«¯å‘é€åˆå§‹åŒ–æ¶ˆæ¯å¹¶è¿”å›SSE Emitterå¯¹è±¡ã€‚ è·å–éªŒè¯ç  public String resendCode() throws IOException &#123; &#x2F;&#x2F; è·å–æ—§çš„éªŒè¯ç ï¼Œæ³¨æ„ä¸ä½¿ç”¨ getUnchecked, é¿å…é‡æ–°ç”Ÿæˆä¸€ä¸ªéªŒè¯ç  String deviceId &#x3D; ReqInfoContext.getReqInfo().getDeviceId(); String oldCode &#x3D; deviceCodeCache.getIfPresent(deviceId); SseEmitter lastSse &#x3D; oldCode &#x3D;&#x3D; null ? null : verifyCodeCache.getIfPresent(oldCode); if (lastSse !&#x3D; null) &#123; lastSse.send(&quot;resend!&quot;); lastSse.send(&quot;init#&quot; + oldCode); return oldCode; &#125; return &quot;fail&quot;; &#125; æ ¹æ®deviceIdä»verifyCodeCacheä¸­è·å–SseEmitterï¼Œå¦‚æœä¸ºç©ºè¿”å›â€failâ€ã€‚å¦åˆ™é‡æ–°å‘é€éªŒè¯ç ã€‚ é‡æ–°è·å–éªŒè¯ç  public String refreshCode() throws IOException &#123; ReqInfoContext.ReqInfo reqInfo &#x3D; ReqInfoContext.getReqInfo(); &#x2F;&#x2F;è·å–è®¾å¤‡IDå’Œæ—§çš„éªŒè¯ç ã€‚ String deviceId &#x3D; ReqInfoContext.getReqInfo().getDeviceId(); &#x2F;&#x2F;æ£€æŸ¥æ—§çš„éªŒè¯ç æ˜¯å¦æœ‰æ•ˆã€‚ String oldCode &#x3D; deviceCodeCache.getIfPresent(deviceId); &#x2F;&#x2F;å¦‚æœæ—§çš„éªŒè¯ç æ— æ•ˆï¼Œåˆ™è¿”å›nullã€‚ SseEmitter lastSse &#x3D; (oldCode &#x3D;&#x3D; null ? null : verifyCodeCache.getIfPresent(oldCode)); if (lastSse &#x3D;&#x3D; null) &#123; log.info(&quot;last deviceId:&#123;&#125;, code:&#123;&#125;, sse closed!&quot;, deviceId, oldCode); deviceCodeCache.invalidate(deviceId); return null; &#125; &#x2F;&#x2F;ç”Ÿæˆä¸€ä¸ªæ–°çš„éªŒè¯ç ã€‚ deviceCodeCache.invalidate(deviceId); String newCode &#x3D; deviceCodeCache.getUnchecked(deviceId); log.info(&quot;generate new loginCode! deviceId:&#123;&#125;, oldCode:&#123;&#125;, code:&#123;&#125;&quot;, deviceId, oldCode, newCode); &#x2F;&#x2F;å‘å®¢æˆ·ç«¯å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œé€šçŸ¥å®¢æˆ·ç«¯æ›´æ–°éªŒè¯ç ã€‚ lastSse.send(&quot;updateCode!&quot;); lastSse.send(&quot;refresh#&quot; + newCode); &#x2F;&#x2F;å°†æ–°çš„éªŒè¯ç æ”¾å…¥ç¼“å­˜ã€‚ verifyCodeCache.invalidate(oldCode); verifyCodeCache.put(newCode, lastSse); &#x2F;&#x2F;è¿”å›æ–°çš„éªŒè¯ç ã€‚ return newCode; &#125; æ ¹æ®deviceIdå»deviceCodeCacheä¸­è·å–æ—§çš„éªŒè¯ç ï¼Œå¦‚æœæ—§çš„éªŒè¯ç æ— æ•ˆå°±è¿”å›nullï¼Œå¦åˆ™è¯´æ˜ä¹‹å‰è·å–è¿‡éªŒè¯ç ï¼Œå°±å°†éªŒè¯ç å’Œè®¾å¤‡ç åœ¨deviceIdä¸­ç§»é™¤å¹¶é‡æ–°ç”Ÿæˆï¼Œè¿”å›éªŒè¯ç ï¼Œå°†éªŒè¯ç å’Œssemitterçš„ç¼“å­˜è¿›verifyCodeCacheï¼Œæœ€åè¿”å›éªŒè¯ç ã€‚ å…³æ³¨å…¬ä¼—å·å¹¶å‘é€éªŒè¯ç é€šè¿‡å…¬ä¼—å·çš„WEBæ¥å£å’Œå…¬ä¼—å·å‘é€ä¿¡æ¯å‘ç°ä¸¤ä¸ªçš„è¯·æ±‚è·¯å¾„å¹¶ä¸ç›¸åŒï¼Œä¸ºäº†éƒ½èƒ½æ¥å—åˆ°ï¼Œåœ¨è¯·æ±‚ä¸Šåšäº†å…¼å®¹ã€‚ &#x2F;&#x2F;Request URL: http:&#x2F;&#x2F;gtmf86.natappfree.cc&#x2F;wx&#x2F;callback &#x2F;&#x2F;Request URL: http:&#x2F;&#x2F;gtmf86.natappfree.cc&#x2F;wx å›è°ƒæ¥å£ä»£ç å¦‚ä¸‹ï¼š @PostMapping(path &#x3D; &#123;&quot;&quot;, &quot;callback&quot;&#125;, consumes &#x3D; &#123;&quot;application&#x2F;xml&quot;, &quot;text&#x2F;xml&quot;&#125;, produces &#x3D; &quot;application&#x2F;xml;charset&#x3D;utf-8&quot;) public BaseWxMsgResVo callBack(@RequestBody WxTxtMsgReqVo msg) &#123; String content &#x3D; msg.getContent(); if (&quot;subscribe&quot;.equals(msg.getEvent()) || &quot;scan&quot;.equalsIgnoreCase(msg.getEvent())) &#123; String key &#x3D; msg.getEventKey(); if (StringUtils.isNotBlank(key) || key.startsWith(&quot;qrscene_&quot;)) &#123; &#x2F;&#x2F; å¸¦å‚æ•°çš„äºŒç»´ç ï¼Œæ‰«æã€å…³æ³¨äº‹ä»¶æ‹¿åˆ°ä¹‹åï¼Œç›´æ¥ç™»å½•ï¼Œçœå´è¾“å…¥éªŒè¯ç è¿™ä¸€æ­¥ &#125; &#125; BaseWxMsgResVo res &#x3D; wxHelper.buildResponseBody(msg.getEvent(), content, msg.getFromUserName()); fillResVo(res, msg); return res; &#125; buildResponseBody(): &#x2F;** * è¿”å›è‡ªåŠ¨å“åº”çš„æ–‡æœ¬ * * @return *&#x2F; public BaseWxMsgResVo buildResponseBody(String eventType, String content, String fromUser) &#123; &#x2F;&#x2F; è¿”å›çš„æ–‡æœ¬æ¶ˆæ¯ String textRes &#x3D; null; &#x2F;&#x2F; è¿”å›çš„æ˜¯å›¾æ–‡æ¶ˆæ¯ List&lt;WxImgTxtItemVo&gt; imgTxtList &#x3D; null; if (&quot;subscribe&quot;.equalsIgnoreCase(eventType)) &#123; &#x2F;&#x2F; è®¢é˜… textRes &#x3D; &quot;æ¬¢è¿è®¢é˜…ï¼&quot;; &#125; &#x2F;&#x2F; å¾®ä¿¡å…¬ä¼—å·ç™»å½• else if (CodeGenerateUtil.isVerifyCode(content)) &#123; sessionService.autoRegisterWxUserInfo(fromUser); if (qrLoginHelper.login(content)) &#123; textRes &#x3D; &quot;ç™»å½•æˆåŠŸï¼Œå¼€å§‹æ„‰å¿«çš„ç©è€æŠ€æœ¯æ´¾å§ï¼&quot;; log.info(&quot;ç”¨æˆ·:ç™»å½•æˆåŠŸ&quot;, fromUser); &#125; else &#123; textRes &#x3D; &quot;éªŒè¯ç è¿‡æœŸäº†ï¼Œåˆ·æ–°ç™»å½•é¡µé¢é‡è¯•ä¸€ä¸‹å§&quot;; log.info(&quot;ç”¨æˆ·:ç™»å½•å¤±è´¥ï¼ŒéªŒè¯ç è¿‡æœŸäº†ï¼&quot;, fromUser); &#125; &#125; else &#123; textRes &#x3D; content; &#125; if (textRes !&#x3D; null) &#123; WxTxtMsgResVo vo &#x3D; new WxTxtMsgResVo(); vo.setContent(textRes); return vo; &#125; else &#123; WxImgTxtMsgResVo vo &#x3D; new WxImgTxtMsgResVo(); vo.setArticles(imgTxtList); vo.setArticleCount(imgTxtList.size()); return vo; &#125; &#125; ç”¨æˆ·ç™»å½•é€»è¾‘ç”¨æˆ·æ³¨å†Œ&#x2F;ç™»å½• sessionService.autoRegisterWxUserInfo(fromUser); å®ç°æ–¹æ³•å¦‚ä¸‹ @Override public Long autoRegisterWxUserInfo(String uuid) &#123; UserSaveReq req &#x3D; new UserSaveReq().setLoginType(0).setThirdAccountId(uuid); Long userId &#x3D; registerOrGetUserInfo(req); ReqInfoContext.getReqInfo().setUserId(userId); return userId; &#125; &#x2F;** * æ²¡æœ‰æ³¨å†Œæ—¶ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼›è‹¥å·²ç»æœ‰ï¼Œåˆ™ç™»å½• * * @param req *&#x2F; private Long registerOrGetUserInfo(UserSaveReq req) &#123; &#x2F;&#x2F;æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å­˜åœ¨ UserDO user &#x3D; userDao.getByThirdAccountId(req.getThirdAccountId()); if (user &#x3D;&#x3D; null) &#123; &#x2F;&#x2F;ä¸å­˜åœ¨å°±æ³¨å†Œ return registerService.registerByWechat(req.getThirdAccountId()); &#125; return user.getId(); &#125; è¿™ä¸ªæ–¹æ³•è¿”å›ç”¨æˆ·çš„userId. ä¸‹é¢å°±æ˜¯é‡ç‚¹å†…å®¹ï¼Œå…ˆåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•æˆåŠŸ if (qrLoginHelper.login(content)) &#123; textRes &#x3D; &quot;ç™»å½•æˆåŠŸï¼Œå¼€å§‹æ„‰å¿«çš„ç©è€æŠ€æœ¯æ´¾å§ï¼&quot;; log.info(&quot;ç”¨æˆ·:ç™»å½•æˆåŠŸ&quot;, fromUser); &#125; else &#123; textRes &#x3D; &quot;éªŒè¯ç è¿‡æœŸäº†ï¼Œåˆ·æ–°ç™»å½•é¡µé¢é‡è¯•ä¸€ä¸‹å§&quot;; log.info(&quot;ç”¨æˆ·:ç™»å½•å¤±è´¥ï¼ŒéªŒè¯ç è¿‡æœŸäº†ï¼&quot;, fromUser); &#125; ç”¨æˆ·ç™»çš„é€»è¾‘å¦‚ä¸‹ public boolean login(String verifyCode) &#123; &#x2F;&#x2F;é€šè¿‡éªŒè¯ç æ‰¾åˆ°å¯¹åº”çš„SSE Emitterã€‚ SseEmitter sseEmitter &#x3D; verifyCodeCache.getIfPresent(verifyCode); if (sseEmitter &#x3D;&#x3D; null) &#123; return false; &#125; &#x2F;&#x2F;ç™»å½•å¾®ä¿¡ï¼Œå¹¶è·å–ç”¨æˆ·çš„sessionã€‚ String session &#x3D; sessionService.loginByWx(ReqInfoContext.getReqInfo().getUserId()); try &#123; &#x2F;&#x2F; ç™»å½•æˆåŠŸï¼Œå†™å…¥session sseEmitter.send(session); &#x2F;&#x2F; è®¾ç½®cookieçš„è·¯å¾„ sseEmitter.send(&quot;login#&quot; + LoginService.SESSION_KEY + &quot;&#x3D;&quot; + session + &quot;;path&#x3D;&#x2F;;&quot;); return true; &#125; catch (Exception e) &#123; log.error(&quot;ç™»å½•å¼‚å¸¸: &#123;&#125;&quot;, verifyCode, e); &#125; finally &#123; &#x2F;&#x2F;å…³é—­SSE Emitterï¼Œå¹¶ä»ç¼“å­˜ä¸­ç§»é™¤éªŒè¯ç ã€‚ sseEmitter.complete(); verifyCodeCache.invalidate(verifyCode); &#125; return false; &#125; ä¸Šè¿°ä»£ç çš„å…³é”®åœ°æ–¹åœ¨äº String session = sessionService.loginByWx(ReqInfoContext.getReqInfo().getUserId()); æ ¹æ®uderIdå»ç”Ÿæˆsessionï¼Œå¹¶å†™å›å‰ç«¯sseEmitter.send(&quot;login#&quot; + LoginService.SESSION_KEY + &quot;=&quot; + session + &quot;;path=/;&quot;); &#x2F;** * ç”Ÿæˆä¼šè¯å­—ç¬¦ä¸² * * @param userId ç”¨æˆ·ID * @return ç”Ÿæˆçš„ä¼šè¯å­—ç¬¦ä¸² *&#x2F; public String genSession(Long userId) &#123; &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªåŒ…å«SelfTraceIdGeneratorç”Ÿæˆçš„ä¼šè¯IDå’Œç”¨æˆ·IDçš„Mapå¯¹è±¡ String session &#x3D; JsonUtil.toStr(MapUtils.create(&quot;s&quot;, SelfTraceIdGenerator.generate(), &quot;u&quot;, userId)); &#x2F;&#x2F; ä½¿ç”¨JWTåˆ›å»ºä¸€ä¸ªä»¤ç‰Œ String token &#x3D; JWT.create() .withIssuer(jwtProperties.getIssuer()) &#x2F;&#x2F; è®¾ç½®ä»¤ç‰Œå‘å¸ƒè€… .withSubject(session) &#x2F;&#x2F; è®¾ç½®ä»¤ç‰Œä¸»é¢˜ä¸ºä¼šè¯å­—ç¬¦ä¸² .withClaim(&quot;userId&quot;, userId) &#x2F;&#x2F; æ·»åŠ ç”¨æˆ·IDä½œä¸ºå£°æ˜ .withExpiresAt(new Date(System.currentTimeMillis() + jwtProperties.getExpire())) &#x2F;&#x2F; è®¾ç½®ä»¤ç‰Œè¿‡æœŸæ—¶é—´ .sign(algorithm);&#x2F;&#x2F; ç­¾ç½²ä»¤ç‰Œ &#x2F;&#x2F;TODO å­˜redis return token; &#125; åœ¨å‰ç«¯æ”¶åˆ°sessionåå†™å…¥cookie else if (text.startsWith(&#39;login#&#39;)) &#123; &#x2F;&#x2F; ç™»å½•æ ¼å¼ä¸º login#cookie console.log(&quot;ç™»å½•æˆåŠŸ,ä¿å­˜cookie&quot;, text) document.cookie &#x3D; text.substring(6); source.close(); refreshPage(); &#125; å¦‚å›¾å†™å…¥çš„sessionæ ¼å¼å¦‚ä¸‹ è‡³æ­¤æ•´ä¸ªç™»å½•å®ç°å®Œæˆï¼Œè¿™ä¸ªé¡¹ç›®æ˜¯åç»­ç™»å½•é€»è¾‘æ˜¯ç™»å½•å®Œæˆåé‡å®šå‘åˆ°é¦–é¡µï¼Œåç«¯å®ç°filterè¿›è¡Œæ‹¦æˆªï¼Œæ‹¦æˆªæ—¶è·å–cookieå¹¶å¯¹å…¶è¿›è¡Œè§£æä»è€Œè·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå†™å…¥è¯·æ±‚ä¸Šä¸‹æ–‡ã€‚","categories":[{"name":"æ•™ç¨‹","slug":"æ•™ç¨‹","permalink":"https://blog.ehzyil.xyz/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"},{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"}],"author":"ehzyil"},{"title":"Dockerå®‰è£…Nginx","slug":"2024/Dockerå®‰è£…Nginx","date":"2024-01-09T20:22:46.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2024/01/09/2024/Dockerå®‰è£…Nginx/","link":"","permalink":"https://blog.ehzyil.xyz/2024/01/09/2024/Docker%E5%AE%89%E8%A3%85Nginx/","excerpt":"","text":"åˆ›å»ºæŒ‚è½½ç›®å½•mkdir -p &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;nginx&#x2F;conf mkdir -p &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;nginx&#x2F;log mkdir -p &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;nginx&#x2F;html æ‹‰å–dockeré•œåƒdocker pull nginx:latest åˆ›å»ºNginxå®¹å™¨å¹¶è¿è¡Œdocker run -d --name nginx -p 80:80 -v &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data:&#x2F;data nginx å®¹å™¨ä¸­çš„nginx.confæ–‡ä»¶ã€conf.dæ–‡ä»¶å’Œhtmlæ–‡ä»¶å¤¹å¤åˆ¶åˆ°å®¿ä¸»æœº docker cp nginx:&#x2F;etc&#x2F;nginx&#x2F;nginx.conf &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;nginx&#x2F; docker cp nginx:&#x2F;etc&#x2F;nginx&#x2F;conf.d &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;nginx&#x2F; docker cp nginx:&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;nginx&#x2F; å…³é—­å¹¶åˆ é™¤Nginxå®¹å™¨# å…³é—­è¯¥å®¹å™¨ docker stop nginx # åˆ é™¤è¯¥å®¹å™¨ docker rm nginx åˆ›å»ºNginxå®¹å™¨ï¼ŒæŒ‡å®šæŒ‚è½½ç‚¹å’Œç«¯å£å·å¹¶è¿è¡Œdocker run -p 81:80 --name nginx -v &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;nginx&#x2F;nginx.conf:&#x2F;etc&#x2F;nginx&#x2F;nginx.conf -v &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;nginx&#x2F;conf.d:&#x2F;etc&#x2F;nginx&#x2F;conf.d -v &#x2F;home&#x2F;nginx&#x2F;log:&#x2F;var&#x2F;log&#x2F;nginx -v &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;nginx&#x2F;html:&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html -d nginx:latest Nginxé»˜è®¤é…ç½®(å¤‡ä»½) user nginx; worker_processes auto; error_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log notice; pid &#x2F;var&#x2F;run&#x2F;nginx.pid; events &#123; worker_connections 1024; &#125; http &#123; include &#x2F;etc&#x2F;nginx&#x2F;mime.types; default_type application&#x2F;octet-stream; log_format main &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39; &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39; &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;; access_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log main; sendfile on; #tcp_nopush on; keepalive_timeout 65; #gzip on;a include &#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;*.conf; &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"docker","slug":"docker","permalink":"https://blog.ehzyil.xyz/tags/docker/"},{"name":"git","slug":"git","permalink":"https://blog.ehzyil.xyz/tags/git/"}],"author":"ehzyil"},{"title":"è®°å½•SQLæ‰§è¡Œæ—¥å¿—","slug":"2024/è®°å½•SQLæ‰§è¡Œæ—¥å¿—","date":"2024-01-06T20:22:46.000Z","updated":"2024-01-30T06:30:58.147Z","comments":true,"path":"2024/01/06/2024/è®°å½•SQLæ‰§è¡Œæ—¥å¿—/","link":"","permalink":"https://blog.ehzyil.xyz/2024/01/06/2024/%E8%AE%B0%E5%BD%95SQL%E6%89%A7%E8%A1%8C%E6%97%A5%E5%BF%97/","excerpt":"","text":"è®°å½•SQLæ‰§è¡Œæ—¥å¿—MybaitPlusæ‰§è¡Œæ—¥å¿—å› ä¸ºæŠ€æœ¯æ´¾ä½¿ç”¨MybatisPlusä½œä¸ºORMæ¡†æ¶è¿›è¡Œæ•°æ®æºçš„CURDï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨mybatisæä¾›çš„æ—¥å¿—è¾“å‡º å¦‚å¼€å¯æ§åˆ¶å°è¾“å‡º mybatis: configuration: log-impl: org.apache.ibatis.logging.stdout.StdOutImpl map-underscore-to-camel-case: true æ—¥å¿—ç»“æœï¼š JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@62f94ee2] will not be managed by Spring &#x3D;&#x3D;&gt; Preparing: select * from user where id &#x3D;? &#x3D;&#x3D;&gt; Parameters: 1(Integer) &lt;&#x3D;&#x3D; Columns: id, third_account_id, user_name, password, login_type, deleted, create_time, update_time &lt;&#x3D;&#x3D; Row: 1, master, admin, admin, 0, 0, 2023-12-28 15:53:47, 2023-12-29 11:23:18 &lt;&#x3D;&#x3D; Total: 1 ä½¿ç”¨Mybatisæ’ä»¶Mybatisæ’ä»¶æœºåˆ¶åœ¨Mybatisä¸­ï¼Œæ’ä»¶æœºåˆ¶æä¾›äº†éå¸¸å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›ï¼Œåœ¨sqlæœ€ç»ˆæ‰§è¡Œä¹‹å‰ï¼Œæä¾›äº†å››ä¸ªæ‹¦æˆªç‚¹ï¼Œæ”¯æŒä¸åŒåœºæ™¯çš„åŠŸèƒ½æ‰©å±• Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed) ParameterHandler (getParameterObject, setParameters) ResultSetHandler (handleResultSets, handleOutputParameters) StatementHandler (prepare, parameterize, batch, update, query) Mybatisæ’ä»¶å®ç°æµç¨‹1.å®ç°æ¥å£Interceptorpublic class SqlStateInterceptor implements Interceptor &#123;&#125; 2.æ·»åŠ æ³¨è§£@Intercepts(value &#x3D; &#123;@Signature(type &#x3D; Executor.class, method &#x3D; &quot;query&quot;, args &#x3D; &#123;MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class&#125;), @Signature(type &#x3D; Executor.class, method &#x3D; &quot;update&quot;, args &#x3D; &#123;MappedStatement.class, Object.class&#125;), &#125;) ç±»ä¸Šçš„@Interceptsæ³¨è§£ï¼Œå®ƒè¡¨æ˜è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªmybatisçš„æ’ä»¶ç±»ï¼Œé€šè¿‡@Signatureæ¥æŒ‡å®šåˆ‡ç‚¹ å…¶ä¸­çš„type, method, argsç”¨æ¥ç²¾ç¡®å‘½ä¸­åˆ‡ç‚¹çš„å…·ä½“æ–¹æ³• é¦–å…ˆä»åˆ‡ç‚¹ä¸ºExecutorï¼Œç„¶åä¸¤ä¸ªæ–¹æ³•çš„æ‰§è¡Œä¼šè¢«æ‹¦æˆªï¼›è¿™ä¸¤ä¸ªæ–¹æ³•çš„æ–¹æ³•ååˆ†åˆ«æ˜¯query, updateï¼Œå‚æ•°ç±»å‹ä¹Ÿä¸€å¹¶å®šä¹‰äº†ï¼Œé€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œå¯ä»¥ç²¾ç¡®åŒ¹é…Executoræ¥å£ä¸Šå®šä¹‰çš„ç±»ï¼Œå¦‚ä¸‹ &#x2F;&#x2F; org.apache.ibatis.executor.Executor &#x2F;&#x2F; å¯¹åº”ç¬¬ä¸€ä¸ª@Signature &lt;E&gt; List&lt;E&gt; query(MappedStatement var1, Object var2, RowBounds var3, ResultHandler var4) throws SQLException; &#x2F;&#x2F; å¯¹åº”ç¬¬äºŒä¸ª@Signature int update(MappedStatement var1, Object var2) throws SQLException; mybatisæä¾›äº†å››ä¸ªåˆ‡ç‚¹ï¼Œé‚£ä¹ˆä»–ä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä»€ä¹ˆæ ·çš„åœºæ™¯é€‰æ‹©ä»€ä¹ˆæ ·çš„åˆ‡ç‚¹å‘¢ï¼Ÿ ä¸€èˆ¬æ¥è®²ï¼Œæ‹¦æˆªParameterHandleræ˜¯æœ€å¸¸è§çš„ï¼Œè™½ç„¶ä¸Šé¢çš„å®ä¾‹æ˜¯æ‹¦æˆªExecutorï¼Œåˆ‡ç‚¹çš„é€‰æ‹©ï¼Œä¸»è¦ä¸å®ƒçš„åŠŸèƒ½å¼ºç›¸å…³ï¼Œæƒ³è¦æ›´å¥½çš„ç†è§£å®ƒï¼Œéœ€è¦ä»mybatisçš„å·¥ä½œåŸç†å‡ºå‘ï¼Œè¿™é‡Œå°†åªåšæœ€åŸºæœ¬çš„ä»‹ç»ï¼Œå¾…åç»­æºç è¿›è¡Œè¯¦ç»†åˆ†æ Executorï¼šä»£è¡¨æ‰§è¡Œå™¨ï¼Œç”±å®ƒè°ƒåº¦StatementHandlerã€ParameterHandlerã€ResultSetHandlerç­‰æ¥æ‰§è¡Œå¯¹åº”çš„SQLï¼Œå…¶ä¸­StatementHandleræ˜¯æœ€é‡è¦çš„ã€‚ StatementHandlerï¼šä½œç”¨æ˜¯ä½¿ç”¨æ•°æ®åº“çš„Statementï¼ˆPreparedStatementï¼‰æ‰§è¡Œæ“ä½œï¼Œå®ƒæ˜¯å››å¤§å¯¹è±¡çš„æ ¸å¿ƒï¼Œèµ·åˆ°æ‰¿ä¸Šå¯ä¸‹çš„ä½œç”¨ï¼Œè®¸å¤šé‡è¦çš„æ’ä»¶éƒ½æ˜¯é€šè¿‡æ‹¦æˆªå®ƒæ¥å®ç°çš„ã€‚ ParameterHandlerï¼šæ˜¯ç”¨æ¥å¤„ç†SQLå‚æ•°çš„ã€‚ ResultSetHandlerï¼šæ˜¯è¿›è¡Œæ•°æ®é›†ï¼ˆResultSetï¼‰çš„å°è£…è¿”å›å¤„ç†çš„ï¼Œå®ƒéå¸¸çš„å¤æ‚ï¼Œå¥½åœ¨ä¸å¸¸ç”¨ã€‚ å€Ÿç”¨ç½‘ä¸Šçš„ä¸€å¼ mybatisæ‰§è¡Œè¿‡ç¨‹æ¥è¾…åŠ©è¯´æ˜ 3.é‡è½½æ–¹æ³•public class SqlStateInterceptor implements Interceptor &#123; @Override public Object intercept(Invocation invocation) throws Throwable &#123; return null; &#125; @Override public Object plugin(Object target) &#123; return null; &#125; @Override public void setProperties(Properties properties) &#123; &#125; &#125; 4.æ‹¦æˆªå™¨æ³¨å†Œè‡ªå®šä¹‰çš„æ‹¦æˆªå™¨å®ç°ï¼Œè¿˜éœ€è¦æ³¨å†Œåˆ°åº”ç”¨ä¸­è®©å®ƒç”Ÿæ•ˆï¼Œä¸€èˆ¬æœ‰ä¸‹é¢å‡ ç§å§¿åŠ¿ 1.spring beanå¯¹è±¡ @Bean public SqlStateInterceptor sqlStateInterceptor() &#123; return new SqlStateInterceptor(); &#125; 2.SqlSessionFactory é™¤äº†ä¸Šé¢çš„å§¿åŠ¿ä¹‹å¤–è¿˜å¯ä»¥ç›´æ¥å†sqlä¼šè¯å·¥å‚ä¸­æŒ‡å®š @Bean(name &#x3D; &quot;sqlSessionFactory&quot;) public SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception &#123; SqlSessionFactoryBean bean &#x3D; new SqlSessionFactoryBean(); bean.setDataSource(dataSource); bean.setMapperLocations( &#x2F;&#x2F; è®¾ç½®mybatisçš„xmlæ‰€åœ¨ä½ç½®ï¼Œè¿™é‡Œä½¿ç”¨mybatisæ³¨è§£æ–¹å¼ï¼Œæ²¡æœ‰é…ç½®xmlæ–‡ä»¶ new PathMatchingResourcePatternResolver().getResources(&quot;classpath*:mapping&#x2F;*.xml&quot;)); &#x2F;&#x2F; æ³¨å†Œtypehandlerï¼Œä¾›å…¨å±€ä½¿ç”¨ bean.setTypeHandlers(new Timestamp2LongHandler()); bean.setPlugins(new SqlStatInterceptor()); return bean.getObject(); &#125; 3.xmlé…ç½® å¯¹äºä¹ æƒ¯ä½¿ç”¨myabtisçš„åŒå­¦è€Œè¨€ï¼Œè¿™ä¸€ç§æ–¹å¼ä¸å°‘è§ï¼Œç›´æ¥å†myabtis-config.xmlä¸­è¿›è¡Œå®šä¹‰ @Bean public SqlStateInterceptor sqlStateInterceptor() &#123; return new SqlStateInterceptor(); &#125; å®ç°package com.example.senstive.senstive; import com.alibaba.druid.pool.DruidPooledPreparedStatement; import com.baomidou.mybatisplus.core.MybatisParameterHandler; import com.example.senstive.util.DateUtil; import com.example.senstive.util.DruidCheckUtil; import com.mysql.cj.MysqlConnection; import com.zaxxer.hikari.pool.HikariProxyConnection; import com.zaxxer.hikari.pool.HikariProxyPreparedStatement; import lombok.extern.slf4j.Slf4j; import nonapi.io.github.classgraph.reflection.ReflectionUtils; import org.apache.ibatis.executor.statement.StatementHandler; import org.apache.ibatis.mapping.BoundSql; import org.apache.ibatis.mapping.MappedStatement; import org.apache.ibatis.mapping.ParameterMapping; import org.apache.ibatis.mapping.ParameterMode; import org.apache.ibatis.plugin.*; import org.apache.ibatis.reflection.MetaObject; import org.apache.ibatis.scripting.defaults.DefaultParameterHandler; import org.apache.ibatis.session.Configuration; import org.apache.ibatis.session.ResultHandler; import org.springframework.util.CollectionUtils; import java.sql.Connection; import java.sql.Statement; import java.util.Date; import java.util.List; import java.util.Properties; import java.util.regex.Matcher; // Define a custom MyBatis plugin to handle data masking. /** * SQLçŠ¶æ€æ‹¦æˆªå™¨ */ @Intercepts(&#123; @Signature(type = StatementHandler.class, method = \"query\", args = &#123;Statement.class, ResultHandler.class&#125;), @Signature(type = StatementHandler.class, method = \"update\", args = &#123;Statement.class&#125;) &#125;) @Slf4j public class SqlStateInterceptor implements Interceptor &#123; /** * æ‹¦æˆªæ–¹æ³• * * @param invocation è°ƒç”¨çš„Invocationå¯¹è±¡ * @return Object * @throws Throwable å¼‚å¸¸ */ @Override public Object intercept(Invocation invocation) throws Throwable &#123; long time = System.currentTimeMillis(); final List&lt;Object> results = (List&lt;Object>) invocation.proceed(); if (results.isEmpty()) &#123; return results; &#125; StatementHandler statementHandler = (StatementHandler) invocation.getTarget(); String sql = buildSql(statementHandler); //åˆ¤æ–­æ•°æ®åº“è¿æ¥æ± ç±»å‹ Object[] args = invocation.getArgs(); String uname = \"\"; if (args[0] instanceof HikariProxyPreparedStatement) &#123; HikariProxyConnection connection = (HikariProxyConnection) ((HikariProxyPreparedStatement) invocation.getArgs()[0]).getConnection(); uname = connection.getMetaData().getUserName(); &#125; else if (DruidCheckUtil.hasDuridPkg()) &#123; if (args[0] instanceof DruidPooledPreparedStatement) &#123; Connection connection = ((DruidPooledPreparedStatement) args[0]).getStatement().getConnection(); if (connection instanceof MysqlConnection) &#123; Properties properties = ((MysqlConnection) connection).getProperties(); uname = properties.getProperty(\"user\"); &#125; &#125; &#125; Object rs = null; try &#123; rs = invocation.proceed(); &#125; catch (Throwable e) &#123; log.error(\"error sql: \" + sql, e); throw e; &#125; finally &#123; long cost = System.currentTimeMillis() - time; sql = this.replaceContinueSpace(sql); // è¿™ä¸ªæ–¹æ³•çš„æ€»è€—æ—¶ log.info(\"\\n\\n ============= \\nsql ----> &#123;&#125;\\n&#123;&#125;\\nuser ----> &#123;&#125;\\ncost ----> &#123;&#125;\\n ============= \\n\", sql, getResult(rs.toString()), uname, cost); &#125; return rs; &#125; /** * è·å–ç»“æœ * * @param input è¾“å…¥ * @return ç»“æœ */ private String getResult(String input) &#123; return input.substring(input.indexOf(\"(\") + 1, input.lastIndexOf(\")\")); &#125; /** * æ›¿æ¢è¿ç»­çš„ç©ºç™½ * * @param str å­—ç¬¦ä¸² * @return æ›¿æ¢åçš„å­—ç¬¦ä¸² */ private String replaceContinueSpace(String str) &#123; StringBuilder builder = new StringBuilder(str.length()); boolean preSpace = false; for (int i = 0, len = str.length(); i &lt; len; i++) &#123; char ch = str.charAt(i); boolean isSpace = Character.isWhitespace(ch); if (preSpace &amp;&amp; isSpace) &#123; continue; &#125; if (preSpace) &#123; // å‰é¢çš„æ˜¯ç©ºç™½å­—ç¬¦ï¼Œå½“å‰çš„ä¸æ˜¯çš„ preSpace = false; builder.append(ch); &#125; else if (isSpace) &#123; // å½“å‰å­—ç¬¦ä¸ºç©ºç™½å­—ç¬¦ï¼Œå‰é¢çš„é‚£ä¸ªä¸æ˜¯çš„ preSpace = true; builder.append(\" \"); &#125; else &#123; // å‰ä¸€ä¸ªå’Œå½“å‰å­—ç¬¦éƒ½éç©ºç™½å­—ç¬¦ builder.append(ch); &#125; &#125; return builder.toString(); &#125; /** * æ„å»ºSQL * * @param statementHandler StatementHandlerå¯¹è±¡ * @return SQLè¯­å¥ */ private String buildSql(StatementHandler statementHandler) &#123; BoundSql boundSql = statementHandler.getBoundSql(); Configuration configuration = null; if (statementHandler.getParameterHandler() instanceof DefaultParameterHandler) &#123; DefaultParameterHandler handler = (DefaultParameterHandler) statementHandler.getParameterHandler(); configuration = (Configuration) new ReflectionUtils().getFieldVal(false, handler, \"configuration\"); &#125; else if (statementHandler.getParameterHandler() instanceof MybatisParameterHandler) &#123; MybatisParameterHandler paramHandler = (MybatisParameterHandler) statementHandler.getParameterHandler(); configuration = ((MappedStatement) new ReflectionUtils().getFieldVal(false, paramHandler, \"mappedStatement\")).getConfiguration(); &#125; if (configuration == null) &#123; return boundSql.getSql(); &#125; return buildSql(boundSql, configuration); &#125; /** * æ„å»ºSQL * * @param boundSql BoundSqlå¯¹è±¡ * @param configuration Configurationå¯¹è±¡ * @return SQLè¯­å¥ */ private String buildSql(BoundSql boundSql, Configuration configuration) &#123; String sql = boundSql.getSql(); //è·å–å‚æ•° Object parameterObject = boundSql.getParameterObject(); List&lt;ParameterMapping> parameterMappings = boundSql.getParameterMappings(); //æ²¡æœ‰å‚æ•°ç›´æ¥è¿”å› if (CollectionUtils.isEmpty(parameterMappings) || parameterObject == null) &#123; return sql; &#125; MetaObject mo = configuration.newMetaObject(boundSql.getParameterObject()); for (ParameterMapping parameterMapping : parameterMappings) &#123; //åªæ‹¦æˆª è¾“å‡ºå‚æ•° if (parameterMapping.getMode() == ParameterMode.OUT) &#123; continue; &#125; //å‚æ•°å€¼ Object value; //è·å–å‚æ•°åç§° String propertyName = parameterMapping.getProperty(); if (boundSql.hasAdditionalParameter(propertyName)) &#123; value = boundSql.getAdditionalParameter(propertyName); &#125; else if (configuration.getTypeHandlerRegistry().hasTypeHandler(parameterObject.getClass())) &#123; //å¦‚æœæ˜¯å•ä¸ªå€¼åˆ™ç›´æ¥èµ‹å€¼ value = parameterObject; &#125; else &#123; value = mo.getValue(propertyName); &#125; String param = Matcher.quoteReplacement(getParameter(value)); sql = sql.replaceFirst(\"\\\\?\", param); &#125; sql += \";\"; return sql; &#125; /** * è·å–å‚æ•°å€¼ * * @param parameter å‚æ•° * @return å‚æ•°å€¼ */ private String getParameter(Object parameter) &#123; if (parameter instanceof String) &#123; return \"'\" + parameter + \"'\"; &#125; else if (parameter instanceof Date) &#123; return \"'\" + DateUtil.format(DateUtil.DB_FORMAT, ((Date) parameter).getTime()) + \"'\"; &#125; else if (parameter instanceof java.util.Date) &#123; return \"'\" + DateUtil.format(DateUtil.DB_FORMAT, ((java.util.Date) parameter).getTime()) + \"'\"; &#125; return parameter.toString(); &#125; /** * æ’ä»¶æ–¹æ³• * * @param o å¯¹è±¡ * @return æ’ä»¶åçš„å¯¹è±¡ */ @Override public Object plugin(Object o) &#123; return Plugin.wrap(o, this); &#125; /** * è®¾ç½®å±æ€§ * * @param properties å±æ€§ */ @Override public void setProperties(Properties properties) &#123; &#125; &#125; å½“æ’ä»¶çš„intercept()æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œæ‹¦æˆªçš„SQLè¯­å¥ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œä¼šé¦–å…ˆè·å–æ‹¦æˆªçš„SQLè¯­å¥å¹¶æ ¹æ®æ•°æ®åº“è¿æ¥æ± çš„ç±»å‹è·å–ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·åã€‚ç„¶åï¼Œä¼šæ‰§è¡ŒåŸå§‹çš„SQLè¯­å¥ï¼Œå¹¶åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ•è·ä»»ä½•å¼‚å¸¸å¹¶è®°å½•æ—¥å¿—ã€‚æœ€åï¼Œä¼šè¿”å›åŸå§‹SQLè¯­å¥çš„ç»“æœã€‚æ’ä»¶çš„plugin()æ–¹æ³•ç”¨äºå°†æ’ä»¶åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡ä¸Šã€‚å®ƒä½¿ç”¨MyBatisæä¾›çš„Pluginç±»å¯¹ç›®æ ‡å¯¹è±¡è¿›è¡ŒåŒ…è£…ï¼Œä»è€Œå®ç°æ’ä»¶çš„åŠŸèƒ½ã€‚setProperties()æ–¹æ³•ç”¨äºè®¾ç½®æ’ä»¶çš„å±æ€§ã€‚ ä¸ºä»€ä¹ˆ buildSql()è¦è·å–Configurationè·å– Configuration å¯¹è±¡æ˜¯ä¸ºäº†èƒ½å¤Ÿè®¿é—® MyBatis çš„é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š ç±»å‹å¤„ç†å™¨æ³¨å†Œè¡¨ (TypeHandlerRegistry) å¯¹è±¡å·¥å‚ (ObjectFactory) å¯¹è±¡åŒ…è£…å·¥å‚ (ObjectWrapperFactory) æ’ä»¶åˆ—è¡¨ (InterceptorChain) æ˜ å°„è¯­å¥æ³¨å†Œè¡¨ (MappedStatementRegistry) ç¯å¢ƒ (Environment) åœ¨ buildSql() æ–¹æ³•ä¸­ï¼Œéœ€è¦ä½¿ç”¨ Configuration å¯¹è±¡æ¥è·å–ç±»å‹å¤„ç†å™¨æ³¨å†Œè¡¨ï¼Œä»¥ä¾¿èƒ½å¤Ÿå°†å‚æ•°å€¼è½¬æ¢ä¸ºæ•°æ®åº“å¯è¯†åˆ«çš„æ ¼å¼ã€‚ ä¾‹å¦‚ï¼Œåœ¨ä»¥ä¸‹ä»£ç ä¸­ï¼Œä½¿ç”¨ Configuration å¯¹è±¡æ¥è·å–ç±»å‹å¤„ç†å™¨æ³¨å†Œè¡¨ï¼Œå¹¶ä½¿ç”¨ç±»å‹å¤„ç†å™¨æ³¨å†Œè¡¨æ¥è·å–å­—ç¬¦ä¸²ç±»å‹å‚æ•°çš„ç±»å‹å¤„ç†å™¨ï¼š Configuration configuration = ...; TypeHandlerRegistry typeHandlerRegistry = configuration.getTypeHandlerRegistry(); TypeHandler&lt;String> stringTypeHandler = typeHandlerRegistry.getTypeHandler(String.class); ç„¶åï¼Œå¯ä»¥ä½¿ç”¨ stringTypeHandler æ¥å°†å­—ç¬¦ä¸²ç±»å‹å‚æ•°å€¼è½¬æ¢ä¸ºæ•°æ®åº“å¯è¯†åˆ«çš„æ ¼å¼ã€‚ String parameterValue = ...; String databaseValue = stringTypeHandler.setParameter(parameterValue, null); è·å– Configuration å¯¹è±¡è¿˜å¯ä»¥ç”¨äºè®¿é—®å…¶ä»– MyBatis é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š å…è®¸è‡ªåŠ¨æ˜ å°„çš„åˆ«ååˆ—è¡¨ (typeAliases) å…è®¸è‡ªåŠ¨æ˜ å°„çš„ç»“æœæ˜ å°„åˆ—è¡¨ (resultMaps) å…è®¸è‡ªåŠ¨æ˜ å°„çš„ç¼“å­˜åˆ—è¡¨ (caches) è¿™äº›ä¿¡æ¯å¯ä»¥ç”¨äºæ„å»ºæ›´å¤æ‚çš„ SQL è¯­å¥æˆ–æ‰§è¡Œå…¶ä»–æ“ä½œã€‚ ä¸‹åˆ—ä»£ç çš„ä½œç”¨MetaObject mo &#x3D; configuration.newMetaObject(boundSql.getParameterObject()); for (ParameterMapping parameterMapping : parameterMappings) &#123; &#x2F;&#x2F;åªæ‹¦æˆª è¾“å‡ºå‚æ•° if (parameterMapping.getMode() &#x3D;&#x3D; ParameterMode.OUT) &#123; continue; &#125; &#x2F;&#x2F;å‚æ•°å€¼ Object value; &#x2F;&#x2F;è·å–å‚æ•°åç§° String propertyName &#x3D; parameterMapping.getProperty(); if (boundSql.hasAdditionalParameter(propertyName)) &#123; value &#x3D; boundSql.getAdditionalParameter(propertyName); &#125; else if (configuration.getTypeHandlerRegistry().hasTypeHandler(parameterObject.getClass())) &#123; &#x2F;&#x2F;å¦‚æœæ˜¯å•ä¸ªå€¼åˆ™ç›´æ¥èµ‹å€¼ value &#x3D; parameterObject; &#125; else &#123; value &#x3D; mo.getValue(propertyName); &#125; String param &#x3D; Matcher.quoteReplacement(getParameter(value)); sql &#x3D; sql.replaceFirst(&quot;\\\\?&quot;, param); &#125; è¿™æ®µä»£ç ç”¨äºå°† MyBatis æŸ¥è¯¢è¯­å¥ä¸­çš„å‚æ•°å€¼æ›¿æ¢ä¸ºå®é™…å€¼ã€‚ é¦–å…ˆï¼Œä½¿ç”¨ configuration.newMetaObject(boundSql.getParameterObject()) åˆ›å»ºä¸€ä¸ª MetaObject å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°è£…äº†æŸ¥è¯¢è¯­å¥çš„å‚æ•°å¯¹è±¡ã€‚ ç„¶åï¼Œéå†æŸ¥è¯¢è¯­å¥ä¸­çš„å‚æ•°æ˜ å°„åˆ—è¡¨ (parameterMappings)ã€‚å¯¹äºæ¯ä¸ªå‚æ•°æ˜ å°„ï¼Œå¦‚æœå‚æ•°æ¨¡å¼ä¸º ParameterMode.OUTï¼Œåˆ™è·³è¿‡è¯¥å‚æ•°ï¼Œå› ä¸ºè¾“å‡ºå‚æ•°ä¸éœ€è¦æ›¿æ¢ã€‚ å¯¹äºå…¶ä»–å‚æ•°ï¼Œæ ¹æ®å‚æ•°æ˜ å°„çš„å±æ€§åç§° (propertyName) è·å–å‚æ•°å€¼ã€‚å‚æ•°å€¼å¯èƒ½æ¥è‡ªä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š å¦‚æœæŸ¥è¯¢è¯­å¥ä¸­åŒ…å«é™„åŠ å‚æ•°ï¼Œåˆ™ä»é™„åŠ å‚æ•°ä¸­è·å–ã€‚ å¦‚æœ MyBatis é…ç½®ä¸­æ³¨å†Œäº†å‚æ•°å¯¹è±¡çš„ç±»å‹å¤„ç†å™¨ï¼Œåˆ™ç›´æ¥ä½¿ç”¨å‚æ•°å¯¹è±¡ä½œä¸ºå‚æ•°å€¼ã€‚ å¦åˆ™ï¼Œä»å‚æ•°å¯¹è±¡ä¸­è·å–å‚æ•°å€¼ã€‚ æœ€åï¼Œä½¿ç”¨ Matcher.quoteReplacement(getParameter(value)) å°†å‚æ•°å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶ç”¨è¯¥å­—ç¬¦ä¸²æ›¿æ¢æŸ¥è¯¢è¯­å¥ä¸­çš„ç¬¬ä¸€ä¸ªé—®å· (?)ã€‚ å·¥å…·ç±»package com.example.senstive.util; import java.sql.Timestamp; import java.time.Instant; import java.time.LocalDateTime; import java.time.ZoneId; import java.time.format.DateTimeFormatter; public class DateUtil &#123; public static final DateTimeFormatter UTC_FORMAT &#x3D; DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ss.SSS&#39;Z&#39;&quot;); public static final DateTimeFormatter DB_FORMAT &#x3D; DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;); public static final DateTimeFormatter BLOG_TIME_FORMAT &#x3D; DateTimeFormatter.ofPattern(&quot;yyyyå¹´MMæœˆddæ—¥ HH:mm&quot;); public static final DateTimeFormatter BLOG_DATE_FORMAT &#x3D; DateTimeFormatter.ofPattern(&quot;yyyyå¹´MMæœˆddæ—¥&quot;); &#x2F;** * ä¸€å¤©å¯¹åº”çš„æ¯«ç§’æ•° *&#x2F; public static final Long ONE_DAY_MILL &#x3D; 86400_000L; public static final Long ONE_DAY_SECONDS &#x3D; 86400L; public static final Long ONE_MONTH_SECONDS &#x3D; 31 * 86400L; public static final Long THREE_DAY_MILL &#x3D; 3 * ONE_DAY_MILL; &#x2F;** * æ¯«ç§’è½¬æ—¥æœŸ * * @param timestamp * @return *&#x2F; public static String time2day(long timestamp) &#123; return format(BLOG_TIME_FORMAT, timestamp); &#125; public static String time2day(Timestamp timestamp) &#123; return time2day(timestamp.getTime()); &#125; public static LocalDateTime time2LocalTime(long timestamp) &#123; return LocalDateTime.ofInstant(Instant.ofEpochMilli(timestamp), ZoneId.systemDefault()); &#125; public static String time2utc(long timestamp) &#123; return format(UTC_FORMAT, timestamp); &#125; public static String time2date(long timestamp) &#123; return format(BLOG_DATE_FORMAT, timestamp); &#125; public static String time2date(Timestamp timestamp) &#123; return time2date(timestamp.getTime()); &#125; public static String format(DateTimeFormatter format, long timestamp) &#123; LocalDateTime time &#x3D; time2LocalTime(timestamp); return format.format(time); &#125; &#125; import org.springframework.util.ClassUtils public class DruidCheckUtil &#123; &#x2F;** * åˆ¤æ–­æ˜¯å¦åŒ…å«duridç›¸å…³çš„æ•°æ®åŒ… * * @return *&#x2F; public static boolean hasDuridPkg() &#123; return ClassUtils.isPresent(&quot;com.alibaba.druid.pool.DruidDataSource&quot;, DataSourceConfig.class.getClassLoader()); &#125; &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"},{"name":"Mybatis","slug":"Mybatis","permalink":"https://blog.ehzyil.xyz/tags/Mybatis/"}],"author":"ehzyil"},{"title":"é€šç”¨æ•æ„Ÿè¯æ›¿æ¢","slug":"2024/é€šç”¨æ•æ„Ÿè¯æ›¿æ¢","date":"2024-01-06T20:22:46.000Z","updated":"2024-01-30T06:30:58.147Z","comments":true,"path":"2024/01/06/2024/é€šç”¨æ•æ„Ÿè¯æ›¿æ¢/","link":"","permalink":"https://blog.ehzyil.xyz/2024/01/06/2024/%E9%80%9A%E7%94%A8%E6%95%8F%E6%84%9F%E8%AF%8D%E6%9B%BF%E6%8D%A2/","excerpt":"","text":"æœ¬æ–‡åŸºäºå¼€æºé¡¹ç›®sensitive-wordï¼ŒåŸºç¡€ä½¿ç”¨æ–¹æ³•è¯·çœ‹æ–‡æ¡£ã€‚ æ•æ„Ÿè¯æœåŠ¡ç±»æ–°å¢ä¸€ä¸ªæ•æ„Ÿè¯é…ç½®ç±»ï¼Œå¤„ç†è‡ªå®šä¹‰çš„æ•æ„Ÿè¯ã€ä¸ç™½åå• @Data @Component @ConfigurationProperties(prefix &#x3D; &quot;forum.sensitive&quot;) public class SensitiveProperty &#123; &#x2F;** * true è¡¨ç¤ºå¼€å¯æ•æ„Ÿè¯æ ¡éªŒ *&#x2F; private Boolean enable; &#x2F;** * è‡ªå®šä¹‰çš„æ•æ„Ÿè¯ *&#x2F; private List&lt;String&gt; deny; &#x2F;** * è‡ªå®šä¹‰çš„éæ•æ„Ÿè¯ *&#x2F; private List&lt;String&gt; allow; &#125; å°è£…æ•æ„Ÿè¯çš„æœåŠ¡ç±»ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æ—¶è¿›è¡Œåˆå§‹åŒ– @Slf4j @Service public class SensitiveService &#123; /** * æ•æ„Ÿè¯å‘½ä¸­è®¡æ•°ç»Ÿè®¡ */ private static final String SENSITIVE_WORD_CNT_PREFIX = \"sensitive_word\"; private volatile SensitiveWordBs sensitiveWordBs; @Autowired private SensitiveProperty sensitiveConfig; @PostConstruct public void refresh() &#123; IWordDeny deny = () -> &#123; List&lt;String> sub = WordDenySystem.getInstance().deny(); sub.addAll(sensitiveConfig.getDeny()); return sub; &#125;; IWordAllow allow = () -> &#123; List&lt;String> sub = WordAllowSystem.getInstance().allow(); sub.addAll(sensitiveConfig.getAllow()); return sub; &#125;; sensitiveWordBs = SensitiveWordBs.newInstance() .wordDeny(deny) .wordAllow(allow) .init(); log.info(\"æ•æ„Ÿè¯åˆå§‹åŒ–å®Œæˆ!\"); &#125; /** * åˆ¤æ–­æ˜¯å¦åŒ…å«æ•æ„Ÿè¯ * * @param txt éœ€è¦æ ¡éªŒçš„æ–‡æœ¬ * @return è¿”å›å‘½ä¸­çš„æ•æ„Ÿè¯ */ public List&lt;String> contains(String txt) &#123; if (!BooleanUtils.isTrue(sensitiveConfig.getEnable())) &#123; return Collections.emptyList(); &#125; List&lt;String> ans = sensitiveWordBs.findAll(txt); if (CollectionUtils.isEmpty(ans)) &#123; return ans; &#125; return ans; &#125; /** * æ•æ„Ÿè¯æ›¿æ¢ * * @param txt * @return */ public String replace(String txt) &#123; if (BooleanUtils.isTrue(sensitiveConfig.getEnable())) &#123; return sensitiveWordBs.replace(txt); &#125; return txt; &#125; /** * æŸ¥è¯¢æ–‡æœ¬ä¸­æ‰€æœ‰å‘½ä¸­çš„æ•æ„Ÿè¯ * * @param txt æ ¡éªŒæ–‡æœ¬ * @return å‘½ä¸­çš„æ•æ„Ÿè¯ */ public List&lt;String> findAll(String txt) &#123; return sensitiveWordBs.findAll(txt); &#125; &#125; è°ƒç”¨æµ‹è¯•åœ¨application.ymlä¸­é…ç½®æ•æ„Ÿè¯ è°ƒç”¨ä¸‹åˆ—æ¥å£æµ‹è¯• @GetMapping(path &#x3D; &quot;sensitive&#x2F;check&quot;) public List&lt;String&gt; check(String txt) &#123; return sensitiveService.findAll(txt); &#125; @GetMapping(path &#x3D; &quot;sensitive&#x2F;contains&quot;) public List&lt;String&gt; contains(String txt) &#123; return sensitiveService.contains(txt); &#125; @GetMapping(path &#x3D; &quot;sensitive&#x2F;replace&quot;) public String replace(String txt) &#123; return sensitiveService.replace(txt); &#125; è‡ªå®šä¹‰çš„æ•°æ®åº“æ•æ„Ÿè¯æ›¿æ¢æ–¹æ¡ˆ æ•°æ®è„±æ•æ˜¯æŒ‡ä½¿ç”¨å„ç§æŠ€æœ¯æ‰‹æ®µå¯¹æ•æ„Ÿæ•°æ®è¿›è¡Œå¤„ç†ï¼Œä½¿å…¶æ— æ³•è¢«æœªç»æˆæƒçš„äººå‘˜è®¿é—®æˆ–ä½¿ç”¨ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œéœ€è¦æ•°æ®è„±æ•çš„åŸå› æœ‰å¾ˆå¤šï¼Œåœ¨æ­¤æˆ‘ä»¬åœ¨å®ç°Springbooté¡¹ç›®ä¸­å®ç°æ•æ„Ÿè¯æ›¿æ¢ã€‚ å®é™…ç”Ÿäº§é¡¹ç›®ä¸­ä½¿ç”¨çš„æ•°æ®è„±æ•æœºåˆ¶ï¼Œä¸ºäº†å®‰å…¨ä»¥åŠæŸäº›å¤§å®¶éƒ½çŸ¥é“çš„åŸå› ï¼Œdbä¸­æœ‰å¾ˆå¤šä¿¡æ¯æ˜¯ä¸èƒ½å­˜å‚¨æ˜æ–‡çš„ï¼Œæ¯”å¦‚èº«ä»½è¯ã€é“¶è¡Œå¡ç­‰éœ€è¦åŠ å¯†ä¹‹åå­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œç„¶åå†è¯»å–æ—¶ï¼Œè§£å¯†è¿”å›å¯¹åº”çš„æ˜æ–‡é‚£ä¹ˆå¦‚ä½•å®ç°å‘¢ï¼Ÿ ç›´æ¥ç¼–ç å®ç°ï¼Œæ¯æ¬¡å†™çš„æ—¶å€™ã€è¯»å–çš„æ—¶å€™æ‰‹åŠ¨è¿›è¡ŒåŠ è§£å¯† ï¼Ÿ å®ç°ä¸€ä¸ªé€šç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚åœ¨éœ€è¦è„±æ•çš„å­—æ®µä¸ŠåŠ ä¸€ä¸ªæ ‡è¯†ï¼Œç„¶åå†å®é™…å†™db&#x2F;ä»dbè¯»å–æ—¶ï¼Œè‡ªåŠ¨å®ç°åŠ è§£å¯† æˆ‘ä»¬è¿™é‡Œä»‹ç»çš„æ˜¯ç¬¬äºŒä¸ªè§£å†³æ–¹æ¡ˆ åŸºäºmybatisæ‹¦æˆªå™¨çš„æ•æ„Ÿè¯æ›¿æ¢å®ç°æ–¹æ¡ˆæ•´ä½“çš„æ–¹æ¡ˆæ€è·¯æ¯”è¾ƒæ¸…æ™°ï¼š å®ç°ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ï¼Œæ”¾åœ¨éœ€è¦è„±æ•çš„æ•°æ®åº“å®ä½“å¯¹è±¡çš„æˆå‘˜ä¸Š å®ç°æŸ¥è¯¢æ‹¦æˆªå™¨ï¼Œå†è¿”å›æ•°æ®åº“å†…å®¹åˆ°æ•°æ®åº“å®ä½“å¯¹è±¡ä¸Šæ—¶ï¼Œè‹¥åˆ¤æ–­æˆå‘˜ä¸Šæœ‰å¯¹åº”æ³¨è§£ï¼Œåˆ™èµ‹å€¼æ•æ„Ÿè¯æ›¿æ¢ä¹‹åçš„å†…å®¹ å†å…·ä½“çš„å®ç°å±‚ï¼Œæˆ‘ä»¬ä¼šå¢åŠ ä¸€ä¸‹ç¼“å­˜ï¼Œå‡å°‘æ¯æ¬¡éƒ½å¯¹å®ä½“å¯¹è±¡çš„æˆå‘˜éƒ½è¿›è¡Œåˆ¤å®šï¼Œæ˜¯å¦éœ€è¦è„±æ• å…·ä½“å®ç°å®ç°ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£é€šè¿‡è‡ªå®šä¹‰æ³¨è§£ï¼Œçµæ´»åœ°å¯¹éœ€è¦è„±æ•çš„æ•°æ®åº“å®ä½“å¯¹è±¡æˆå‘˜è¿›è¡Œæ ‡è®°ã€‚ @Retention(RetentionPolicy.RUNTIME) @Target(ElementType.FIELD) public @interface SensitiveField &#123; String bind() default &quot;&quot;; &#125; å®ç°æ•æ„Ÿæ•°æ®ç¼“å­˜ä¸ºäº†æé«˜è„±æ•æ•ˆç‡ï¼Œä½¿ç”¨ç¼“å­˜ç³»ç»Ÿå­˜å‚¨è„±æ•åçš„æ•°æ®ï¼Œå‡å°‘é‡å¤è„±æ•çš„è®¡ç®—ã€‚ æ•æ„Ÿè¯ç¼“å­˜ç±»ï¼š public class SensitiveMetaCache &#123; &#x2F;&#x2F; æ•æ„Ÿå…ƒæ•°æ®ç¼“å­˜ private static ConcurrentHashMap&lt;String, SensitiveObjectMeta&gt; CACHE &#x3D; new ConcurrentHashMap&lt;&gt;(); &#x2F;** * è·å–æŒ‡å®škeyå¯¹åº”çš„æ•æ„Ÿå…ƒæ•°æ® * * @param key é”® * @return æŒ‡å®škeyå¯¹åº”çš„æ•æ„Ÿå…ƒæ•°æ® *&#x2F; public static SensitiveObjectMeta get(String key) &#123; return CACHE.get(key); &#125; &#x2F;** * å°†æ•æ„Ÿå…ƒæ•°æ®æ”¾å…¥ç¼“å­˜ * * @param key é”® * @param meta æ•æ„Ÿå…ƒæ•°æ® *&#x2F; public static void put(String key, SensitiveObjectMeta meta) &#123; CACHE.put(key, meta); &#125; &#x2F;** * ä»ç¼“å­˜ä¸­ç§»é™¤æŒ‡å®škeyå¯¹åº”çš„æ•æ„Ÿå…ƒæ•°æ® * * @param key é”® *&#x2F; public static void remove(String key) &#123; CACHE.remove(key); &#125; &#x2F;** * æ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®škeyå¯¹åº”çš„æ•æ„Ÿå…ƒæ•°æ® * * @param key é”® * @return ç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®škeyå¯¹åº”çš„æ•æ„Ÿå…ƒæ•°æ® *&#x2F; public static boolean contains(String key) &#123; return CACHE.containsKey(key); &#125; &#x2F;** * å°†æ•æ„Ÿå…ƒæ•°æ®æ”¾å…¥ç¼“å­˜ï¼Œå¦‚æœé”®å·²å­˜åœ¨ï¼Œåˆ™æ›´æ–°å¯¹åº”çš„æ•æ„Ÿå…ƒæ•°æ® * * @param key é”® * @param meta æ•æ„Ÿå…ƒæ•°æ® * @return æ–°çš„æ•æ„Ÿå…ƒæ•°æ® *&#x2F; public static SensitiveObjectMeta putIfAbsent(String key, SensitiveObjectMeta meta) &#123; return CACHE.putIfAbsent(key, meta); &#125; &#x2F;** * ä»ç¼“å­˜ä¸­è®¡ç®—å¹¶è·å–æŒ‡å®škeyå¯¹åº”çš„æ•æ„Ÿå…ƒæ•°æ® * * @param key é”® * @param function è®¡ç®—å‡½æ•° * @return æŒ‡å®škeyå¯¹åº”çš„æ•æ„Ÿå…ƒæ•°æ® *&#x2F; public static SensitiveObjectMeta computeIfAbsent(String key, Function&lt;String, SensitiveObjectMeta&gt; function) &#123; return CACHE.computeIfAbsent(key, function); &#125; &#125; computeIfAbsent æ–¹æ³•çš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªé”®å€¼å¯¹æ·»åŠ åˆ°ç¼“å­˜ä¸­ï¼Œå¦‚æœé”®å·²ç»å­˜åœ¨ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ ä»£ç åˆ†è§£ public static SensitiveObjectMeta computeIfAbsent(String key, Function&lt;String, SensitiveObjectMeta&gt; function)ï¼šè¿™æ˜¯ä¸€ä¸ªå…¬å…±é™æ€æ–¹æ³•ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼škey æ˜¯è¦æ·»åŠ åˆ°ç¼“å­˜ä¸­çš„é”®ï¼Œfunction æ˜¯ä¸€ä¸ª lambda è¡¨è¾¾å¼ï¼Œç”¨äºè®¡ç®—é”®å¯¹åº”çš„å€¼ã€‚ return CACHE.computeIfAbsent(key, function);: ä½¿ç”¨ ConcurrentHashMap çš„ computeIfAbsent æ–¹æ³•æ¥å°†é”®å€¼å¯¹æ·»åŠ åˆ°ç¼“å­˜ä¸­ã€‚å¦‚æœé”®å·²ç»å­˜åœ¨ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚å¦åˆ™ï¼Œä½¿ç”¨ lambda è¡¨è¾¾å¼ function æ¥è®¡ç®—é”®å¯¹åº”çš„å€¼ï¼Œå¹¶å°†é”®å€¼å¯¹æ·»åŠ åˆ°ç¼“å­˜ä¸­ã€‚ @Data public class SensitiveObjectMeta &#123; private static final String JAVA_LANG_OBJECT &#x3D; &quot;java.lang.object&quot;; &#x2F;** * æ˜¯å¦å¯ç”¨è„±æ• *&#x2F; private Boolean enabledSensitiveReplace; &#x2F;** * ç±»å *&#x2F; private String className; &#x2F;** * æ ‡æ³¨ SensitiveField çš„æˆå‘˜ *&#x2F; private List&lt;SensitiveFieldMeta&gt; sensitiveFieldMetaList; &#x2F;** * æ„å»º SensitiveObjectMeta å¯¹è±¡ * * @param param å¯¹è±¡å®ä¾‹ * @return Optional&lt;SensitiveObjectMeta&gt; å¯é€‰çš„ SensitiveObjectMeta å¯¹è±¡ *&#x2F; public static Optional&lt;SensitiveObjectMeta&gt; buildSensitiveObjectMeta(Object param) &#123; if (isNull(param)) &#123; return Optional.empty(); &#125; Class&lt;?&gt; clazz &#x3D; param.getClass(); SensitiveObjectMeta sensitiveObjectMeta &#x3D; new SensitiveObjectMeta(); sensitiveObjectMeta.setClassName(clazz.getName()); List&lt;SensitiveFieldMeta&gt; sensitiveFieldMetaList &#x3D; newArrayList(); sensitiveObjectMeta.setSensitiveFieldMetaList(sensitiveFieldMetaList); boolean sensitiveField &#x3D; parseAllSensitiveField(clazz, sensitiveFieldMetaList); sensitiveObjectMeta.setEnabledSensitiveReplace(sensitiveField); return Optional.of(sensitiveObjectMeta); &#125; &#x2F;** * è§£æç±»ä¸­çš„æ‰€æœ‰ SensitiveField å­—æ®µ * * @param clazz ç±»å®ä¾‹ * @param sensitiveFieldMetaList SensitiveFieldMeta å¯¹è±¡åˆ—è¡¨ * @return boolean æ˜¯å¦åŒ…å« SensitiveField *&#x2F; private static boolean parseAllSensitiveField(Class&lt;?&gt; clazz, List&lt;SensitiveFieldMeta&gt; sensitiveFieldMetaList) &#123; Class&lt;?&gt; tempClazz &#x3D; clazz; boolean hasSensitiveField &#x3D; false; while ((nonNull(tempClazz)) &amp;&amp; !JAVA_LANG_OBJECT.equalsIgnoreCase(tempClazz.getName())) &#123; for (java.lang.reflect.Field field : tempClazz.getDeclaredFields()) &#123; SensitiveField sensitiveField &#x3D; field.getAnnotation(SensitiveField.class); if (nonNull(sensitiveField)) &#123; SensitiveFieldMeta sensitiveFieldMeta &#x3D; new SensitiveFieldMeta(); sensitiveFieldMeta.setName(field.getName()); sensitiveFieldMeta.setBindField(sensitiveField.bind()); sensitiveFieldMetaList.add(sensitiveFieldMeta); hasSensitiveField &#x3D; true; &#125; &#125; tempClazz &#x3D; tempClazz.getSuperclass(); &#125; return hasSensitiveField; &#125; @Data public static class SensitiveFieldMeta &#123; &#x2F;** * é»˜è®¤æ ¹æ®å­—æ®µåï¼Œæ‰¾dbä¸­åŒåçš„å­—æ®µ *&#x2F; private String name; &#x2F;** * ç»‘å®šçš„æ•°æ®åº“å­—æ®µåˆ«å *&#x2F; private String bindField; &#125; &#125; å®ç°æŸ¥è¯¢æ‹¦æˆªå™¨åœ¨æŸ¥è¯¢æ‹¦æˆªå™¨ä¸­ï¼Œå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ‹¦æˆªï¼Œå¹¶æ ¹æ®è‡ªå®šä¹‰æ³¨è§£å¯¹æ•æ„Ÿæ•°æ®è¿›è¡Œè„±æ•å¤„ç†ã€‚ æ‹¦æˆªå™¨çš„å·¥ä½œåŸç† è¿™ä¸ªæ‹¦æˆªå™¨çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š å½“ MyBatis æ‰§è¡Œ SQL è¯­å¥æ—¶ï¼Œæ‹¦æˆªå™¨ä¼šé¦–å…ˆè¢«è°ƒç”¨ã€‚ æ‹¦æˆªå™¨ä¼šæ£€æŸ¥ SQL è¯­å¥æ˜¯å¦éœ€è¦è¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢ã€‚ å¦‚æœéœ€è¦è¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢ï¼Œæ‹¦æˆªå™¨ä¼šå¯¹æŸ¥è¯¢ç»“æœä¸­çš„æ•æ„Ÿè¯è¿›è¡Œæ›¿æ¢ã€‚ æ‹¦æˆªå™¨ä¼šå°†æ›¿æ¢åçš„æŸ¥è¯¢ç»“æœè¿”å›ç»™ MyBatisã€‚ ä»£ç å®ç°ç»†èŠ‚ @Intercepts(&#123; @Signature(type = ResultSetHandler.class, method = \"handleResultSets\", args = &#123;java.sql.Statement.class&#125;) &#125;) @Component @Slf4j public class SensitiveReadInterceptor implements Interceptor &#123; private static final String MAPPED_STATEMENT = \"mappedStatement\"; @Autowired private SensitiveService sensitiveService; @Override public Object intercept(Invocation invocation) throws Throwable &#123; final List&lt;Object> results = (List&lt;Object>) invocation.proceed(); if (results.isEmpty()) &#123; return results; &#125; final ResultSetHandler statementHandler = realTarget(invocation.getTarget()); // è·å– statementHandler å¯¹è±¡çš„å…ƒå¯¹è±¡ã€‚ final MetaObject metaObject = SystemMetaObject.forObject(statementHandler); //è·å– statementHandler å¯¹è±¡çš„ MAPPED_STATEMENT å±æ€§ final MappedStatement mappedStatement = (MappedStatement) metaObject.getValue(MAPPED_STATEMENT); // ä» results åˆ—è¡¨ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªéç©ºå…ƒç´ ï¼Œå¹¶å°†å…¶åŒ…è£…åœ¨ä¸€ä¸ª Optional å¯¹è±¡ä¸­ã€‚ Optional firstOpt = results.stream().filter(Objects::nonNull).findFirst(); //æ£€æŸ¥ Optional å¯¹è±¡æ˜¯å¦åŒ…å«å€¼ if (!firstOpt.isPresent()) &#123; return results; &#125; Object firstObject = firstOpt.get(); // æ‰¾åˆ°éœ€è¦è¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢çš„æ•°æ®åº“å®ä½“ç±»çš„æˆå‘˜ä¿¡æ¯ SensitiveObjectMeta sensitiveObjectMeta = findSensitiveObjectMeta(firstObject); // æ‰§è¡Œæ›¿æ¢çš„æ•æ„Ÿè¯æ›¿æ¢ replaceSensitiveResults(results, mappedStatement, sensitiveObjectMeta); // æ‰¾åˆ°éœ€è¦è¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢çš„æ•°æ®åº“å®ä½“ç±»çš„æˆå‘˜ä¿¡æ¯ return results; &#125; @Override public Object plugin(Object o) &#123; return Plugin.wrap(o, this); &#125; @Override public void setProperties(Properties properties) &#123; &#125; &#125; æ‹¦æˆªå™¨æ³¨è§£ï¼š @Intercepts æ³¨è§£ç”¨äºæŒ‡å®šæ‹¦æˆªå™¨è¦æ‹¦æˆªçš„æ–¹æ³•ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæ‹¦æˆªå™¨è¦æ‹¦æˆª ResultSetHandler.handleResultSets æ–¹æ³•ã€‚ ç»„ä»¶æ‰«æï¼š @Component æ³¨è§£ç”¨äºå°†æ‹¦æˆªå™¨æ³¨å†Œä¸º Spring Beanã€‚ æ—¥å¿—è®°å½•ï¼š @Slf4j æ³¨è§£ç”¨äºå¯ç”¨æ—¥å¿—è®°å½•ã€‚ æ‹¦æˆªæ–¹æ³•ï¼š intercept æ–¹æ³•æ˜¯æ‹¦æˆªå™¨çš„ä¸»æ–¹æ³•ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæ‹¦æˆªå™¨ä¼šå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ‹¦æˆªã€æ£€æŸ¥æ˜¯å¦éœ€è¦è¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢ã€å¯¹æŸ¥è¯¢ç»“æœä¸­çš„æ•æ„Ÿè¯è¿›è¡Œæ›¿æ¢ï¼Œå¹¶å°†æ›¿æ¢åçš„æŸ¥è¯¢ç»“æœè¿”å›ç»™ MyBatisã€‚ æ’ä»¶æ–¹æ³•ï¼š plugin æ–¹æ³•ç”¨äºå°†æ‹¦æˆªå™¨åŒ…è£…æˆä¸€ä¸ªæ’ä»¶ã€‚ å±æ€§è®¾ç½®æ–¹æ³•ï¼š setProperties æ–¹æ³•ç”¨äºè®¾ç½®æ‹¦æˆªå™¨çš„å±æ€§ã€‚ final MetaObject metaObject &#x3D; SystemMetaObject.forObject(statementHandler); è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯è·å– statementHandler å¯¹è±¡çš„å…ƒå¯¹è±¡ã€‚ åœ¨ Java ä¸­ï¼Œå…ƒå¯¹è±¡æ˜¯ä¸€ç§åŒ…å«äº†å¯¹è±¡å…ƒæ•°æ®ä¿¡æ¯çš„å¯¹è±¡ã€‚å…ƒæ•°æ®ä¿¡æ¯åŒ…æ‹¬å¯¹è±¡çš„ç±»å‹ã€å±æ€§ã€æ–¹æ³•ç­‰ã€‚ SystemMetaObject.forObject æ–¹æ³•å¯ä»¥è·å–ä¸€ä¸ªå¯¹è±¡çš„å…ƒå¯¹è±¡ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ MetaObject ç±»çš„é™æ€æ–¹æ³•ã€‚ statementHandler å¯¹è±¡æ˜¯ä¸€ä¸ª org.apache.ibatis.executor.statement.StatementHandler å¯¹è±¡ã€‚StatementHandler å¯¹è±¡è´Ÿè´£å°† SQL è¯­å¥å‘é€åˆ°æ•°æ®åº“å¹¶å¤„ç†ç»“æœã€‚ è·å– statementHandler å¯¹è±¡çš„å…ƒå¯¹è±¡åï¼Œå°±å¯ä»¥é€šè¿‡å…ƒå¯¹è±¡æ¥è·å– statementHandler å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚ æŸ¥è¯¢å¯¹è±¡ä¸­ï¼Œæºå¸¦æœ‰ @SensitiveField çš„æˆå‘˜ï¼Œè¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢ï¼š findSensitiveObjectMeta æ–¹æ³•ç”¨äºæŸ¥è¯¢å¯¹è±¡ä¸­ï¼Œæºå¸¦æœ‰ @SensitiveField çš„æˆå‘˜ï¼Œå¹¶è¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢ã€‚ /** * æŸ¥è¯¢å¯¹è±¡ä¸­ï¼Œæºå¸¦æœ‰ @SensitiveField çš„æˆå‘˜ï¼Œè¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢ * * @param firstObject å¾…æŸ¥è¯¢çš„å¯¹è±¡ * @return è¿”å›å¯¹è±¡çš„æ•æ„Ÿè¯å…ƒæ•°æ® */ private SensitiveObjectMeta findSensitiveObjectMeta(Object firstObject) &#123; // ç¼“å­˜ä¸­ä¸å­˜åœ¨ï¼Œåˆ™è®¡ç®—é”®å¯¹åº”çš„å€¼ï¼Œå¹¶ç¼“å­˜ SensitiveMetaCache.computeIfAbsent(firstObject.getClass().getName(), s -> &#123; Optional&lt;SensitiveObjectMeta> sensitiveObjectMeta = SensitiveObjectMeta.buildSensitiveObjectMeta(firstObject); return sensitiveObjectMeta.orElse(null); &#125;); // ä»ç¼“å­˜ä¸­è·å– SensitiveObjectMeta å¯¹è±¡ã€‚ return SensitiveMetaCache.get(firstObject.getClass().getName()); &#125; æ‰§è¡Œå…·ä½“çš„æ•æ„Ÿè¯æ›¿æ¢ï¼š replaceSensitiveResults æ–¹æ³•ç”¨äºæ‰§è¡Œå…·ä½“çš„æ•æ„Ÿè¯æ›¿æ¢ã€‚ &#x2F;** * æ‰§è¡Œå…·ä½“çš„æ•æ„Ÿè¯æ›¿æ¢ * * @param results ç»“æœåˆ—è¡¨ * @param mappedStatement MappedStatement å¯¹è±¡ * @param sensitiveObjectMeta SensitiveObjectMeta å¯¹è±¡ *&#x2F; private void replaceSensitiveResults(Collection&lt;Object&gt; results, MappedStatement mappedStatement, SensitiveObjectMeta sensitiveObjectMeta) &#123; for (Object obj : results) &#123; if (sensitiveObjectMeta.getSensitiveFieldMetaList() &#x3D;&#x3D; null) continue; MetaObject objMetaObject &#x3D; mappedStatement.getConfiguration().newMetaObject(obj); sensitiveObjectMeta.getSensitiveFieldMetaList().forEach(i -&gt; &#123; Object value &#x3D; objMetaObject.getValue(StringUtils.isBlank(i.getBindField()) ? i.getName() : i.getBindField()); if (value &#x3D;&#x3D; null) &#123; return; &#125; else if (value instanceof String) &#123; String strValue &#x3D; (String) value; &#x2F;&#x2F; æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„æ•æ„Ÿè¯ String processVal &#x3D; sensitiveService.replace(strValue); objMetaObject.setValue(i.getName(), processVal); &#125; else if (value instanceof Collection) &#123; Collection listValue &#x3D; (Collection) value; if (CollectionUtils.isNotEmpty(listValue)) &#123; Optional firstValOpt &#x3D; listValue.stream().filter(Objects::nonNull).findFirst(); if (firstValOpt.isPresent()) &#123; &#x2F;&#x2F; æ‰¾åˆ°ç¬¬ä¸€ä¸ªéç©ºå…ƒç´ çš„æ•æ„Ÿå¯¹è±¡æˆå‘˜ä¿¡æ¯; SensitiveObjectMeta valSensitiveObjectMeta &#x3D; findSensitiveObjectMeta(firstValOpt.get()); if (Boolean.TRUE.equals(valSensitiveObjectMeta.getEnabledSensitiveReplace()) &amp;&amp; CollectionUtils.isNotEmpty(valSensitiveObjectMeta.getSensitiveFieldMetaList())) &#123; &#x2F;&#x2F; é€’å½’è¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢ replaceSensitiveResults(listValue, mappedStatement, valSensitiveObjectMeta); &#125; &#125; &#125; &#125; else if (ClassUtils.isPrimitiveOrWrapper(value.getClass())) &#123; &#x2F;&#x2F; å¯¹äºéåŸºæœ¬ç±»å‹çš„ï¼Œéœ€è¦å¯¹å…¶å†…éƒ¨è¿›è¡Œæ•æ„Ÿè¯æ›¿æ¢ SensitiveObjectMeta valSensitiveObjectMeta &#x3D; findSensitiveObjectMeta(value); if (Boolean.TRUE.equals(valSensitiveObjectMeta.getEnabledSensitiveReplace()) &amp;&amp; CollectionUtils.isNotEmpty(valSensitiveObjectMeta.getSensitiveFieldMetaList())) &#123; replaceSensitiveResults(newArrayList(value), mappedStatement, valSensitiveObjectMeta); &#125; &#125; &#125;); &#125; &#125; è·å–ä»£ç†å¯¹è±¡çš„çœŸå®ç›®æ ‡å¯¹è±¡ï¼š realTarget æ–¹æ³•ç”¨äºè·å–ä»£ç†å¯¹è±¡çš„çœŸå®ç›®æ ‡å¯¹è±¡ã€‚ &#x2F;** * è·å–ä»£ç†å¯¹è±¡çš„çœŸå®ç›®æ ‡å¯¹è±¡ã€‚ * * @param target * @param &lt;T&gt; * @return *&#x2F; public static &lt;T&gt; T realTarget(Object target) &#123; if (Proxy.isProxyClass(target.getClass())) &#123; &#x2F;&#x2F;è·å–ä¸€ä¸ªå¯¹è±¡çš„å…ƒå¯¹è±¡ MetaObject metaObject &#x3D; SystemMetaObject.forObject(target); &#x2F;&#x2F;å¦‚æœ target æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œé‚£ä¹ˆ realTarget æ–¹æ³•ä¼šé€’å½’åœ°è·å–ä»£ç†å¯¹è±¡çš„çœŸå®ç›®æ ‡å¯¹è±¡ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªä¸æ˜¯ä»£ç†å¯¹è±¡çš„å¯¹è±¡ã€‚ return realTarget(metaObject.getValue(&quot;h.target&quot;)); &#125; return (T) target; &#125; åœ¨ Java ä¸­ï¼Œä»£ç†å¯¹è±¡æ˜¯ä¸€ç§å¯ä»¥ä»£æ›¿çœŸå®å¯¹è±¡æ‰§è¡Œæ“ä½œçš„å¯¹è±¡ã€‚ä»£ç†å¯¹è±¡å¯ä»¥ç”¨æ¥å¢å¼ºçœŸå®å¯¹è±¡çš„æŸäº›åŠŸèƒ½ï¼Œä¾‹å¦‚æ·»åŠ æ—¥å¿—è®°å½•ã€å®‰å…¨æ£€æŸ¥ç­‰ã€‚ Proxy.isProxyClass æ–¹æ³•å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚å¦‚æœ target æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œé‚£ä¹ˆ realTarget æ–¹æ³•ä¼šé€’å½’åœ°è·å–ä»£ç†å¯¹è±¡çš„çœŸå®ç›®æ ‡å¯¹è±¡ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªä¸æ˜¯ä»£ç†å¯¹è±¡çš„å¯¹è±¡ã€‚ SystemMetaObject.forObject æ–¹æ³•å¯ä»¥è·å–ä¸€ä¸ªå¯¹è±¡çš„å…ƒå¯¹è±¡ã€‚å…ƒå¯¹è±¡åŒ…å«äº†è¯¥å¯¹è±¡çš„ä¸€äº›å…ƒæ•°æ®ä¿¡æ¯ï¼Œä¾‹å¦‚å¯¹è±¡çš„ç±»å‹ã€å±æ€§ã€æ–¹æ³•ç­‰ã€‚ getValue æ–¹æ³•å¯ä»¥ä»å…ƒå¯¹è±¡ä¸­è·å–ä¸€ä¸ªå±æ€§çš„å€¼ã€‚åœ¨ realTarget æ–¹æ³•ä¸­ï¼ŒgetValue æ–¹æ³•è¢«ç”¨æ¥è·å–ä»£ç†å¯¹è±¡çš„ h.target å±æ€§çš„å€¼ã€‚h.target å±æ€§çš„å€¼å°±æ˜¯ä»£ç†å¯¹è±¡çš„çœŸå®ç›®æ ‡å¯¹è±¡ã€‚ æœ€åï¼ŒrealTarget æ–¹æ³•å°†ä»£ç†å¯¹è±¡çš„çœŸå®ç›®æ ‡å¯¹è±¡è¿”å›ã€‚ è¿™ä¸ªæ–¹æ³•å¯ä»¥ç”¨äºå„ç§åœºæ™¯ï¼Œä¾‹å¦‚ï¼š è·å–ä»£ç†å¯¹è±¡çš„çœŸå®ç›®æ ‡å¯¹è±¡ï¼Œä»¥ä¾¿ç›´æ¥è°ƒç”¨çœŸå®ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ã€‚ åœ¨ä»£ç†å¯¹è±¡ä¸Šæ·»åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æ—¥å¿—è®°å½•ã€å®‰å…¨æ£€æŸ¥ç­‰ã€‚ åœ¨ä»£ç†å¯¹è±¡ä¸Šè¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œä¾‹å¦‚ç¼“å­˜ä»£ç†å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ç»“æœã€‚ æµ‹è¯•åœ¨å®ä½“ç±»ä¸Šæ·»åŠ æ³¨è§£ @Data @EqualsAndHashCode(callSuper &#x3D; false) @Accessors(chain &#x3D; true) @TableName(&quot;user&quot;) public class User implements Serializable &#123; private static final long serialVersionUID &#x3D; 1L; List&lt;User&gt; users; &#x2F;** * ä¸»é”®ID *&#x2F; @TableId(value &#x3D; &quot;id&quot;, type &#x3D; IdType.AUTO) private Integer id; &#x2F;** * ç¬¬ä¸‰æ–¹ç”¨æˆ·ID *&#x2F; @SensitiveField(bind &#x3D; &quot;thirdAccountId&quot;) private String thirdAccountId; &#x2F;** * ç”¨æˆ·å *&#x2F; @SensitiveField(bind &#x3D; &quot;userName&quot;) private String userName; &#x2F;** * å¯†ç  *&#x2F; @SensitiveField() private String password; &#x2F;** * ç™»å½•æ–¹å¼: 0-å¾®ä¿¡ç™»å½•ï¼Œ1-è´¦å·å¯†ç ç™»å½• *&#x2F; @SensitiveField() private Integer loginType; &#x2F;** * æ˜¯å¦åˆ é™¤ *&#x2F; private Integer deleted; &#x2F;** * åˆ›å»ºæ—¶é—´ *&#x2F; private LocalDateTime createTime; &#x2F;** * æœ€åæ›´æ–°æ—¶é—´ *&#x2F; private LocalDateTime updateTime; &#125; @SensitiveField()çš„å­—æ®µå¯ä»¥æŒ‡å®šä¹Ÿå¯ä»¥ä¸æŒ‡å®šï¼Œå› ä¸ºä¸Šè¿°ä»£ç ä¸­å·²ç»åšäº†åˆ¤æ–­ Object value &#x3D; objMetaObject.getValue(StringUtils.isBlank(i.getBindField()) ? i.getName() : i.getBindField()); è°ƒç”¨ä¸‹è¿°æ¥å£ @GetMapping() public Object getAllUsers() &#123; return userService.getAllUsers(); &#125; SQLæ—¥å¿—å¦‚ä¸‹ &#x3D;&#x3D;&gt; Preparing: select * from user &#x3D;&#x3D;&gt; Parameters: &lt;&#x3D;&#x3D; Columns: id, third_account_id, user_name, password, login_type, deleted, create_time, update_time &lt;&#x3D;&#x3D; Row: 1, fuckman, admin, admin, 0, 0, 2023-12-28 15:53:47, 2024-01-04 12:19:49 &lt;&#x3D;&#x3D; Row: 2, a7cb7200-0f85-4dd5-845c-700f3740e91, admin1, admin1, 10, 0, 2023-12-28 15:53:47, 2024-01-04 12:53:47 &lt;&#x3D;&#x3D; Row: 3, third_account_id, user_name, password, 20, 0, 2024-01-02 15:41:22, 2024-01-04 12:53:50 &lt;&#x3D;&#x3D; Row: 4, third_account_id, user_name, password, 0, 0, 2024-01-02 15:41:24, 2024-01-02 15:41:24 &lt;&#x3D;&#x3D; Row: 5, hello, user_name, password, 0, 0, 2024-01-02 15:41:25, 2024-01-04 12:19:52 &lt;&#x3D;&#x3D; Row: 6, master, admin, admin, 0, 0, 2023-12-28 15:53:47, 2023-12-29 11:23:18 &lt;&#x3D;&#x3D; Row: 7, big, admin, admin, 0, 0, 2023-12-28 15:53:47, 2024-01-04 12:19:56 &lt;&#x3D;&#x3D; Total: 7 Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@370642cb] æ˜¾ç¤ºç»“æœå¦‚ä¸‹:","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"},{"name":"Mybatis","slug":"Mybatis","permalink":"https://blog.ehzyil.xyz/tags/Mybatis/"}],"author":"ehzyil"},{"title":"åŸºäºAbstractRoutingDataSourceä¸AOPå®ç°å¤šæ•°æ®æºåˆ‡æ¢","slug":"2023/åŸºäºAbstractRoutingDataSourceä¸AOPå®ç°å¤šæ•°æ®æºåˆ‡æ¢","date":"2023-12-29T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/29/2023/åŸºäºAbstractRoutingDataSourceä¸AOPå®ç°å¤šæ•°æ®æºåˆ‡æ¢/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/29/2023/%E5%9F%BA%E4%BA%8EAbstractRoutingDataSource%E4%B8%8EAOP%E5%AE%9E%E7%8E%B0%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E5%88%87%E6%8D%A2/","excerpt":"","text":"ç¯å¢ƒå‡†å¤‡ç¯å¢ƒé…ç½®ä»£ç åœ°å€ &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt; &lt;artifactId&gt;spring-boot-starter-aop&lt;&#x2F;artifactId&gt; &lt;&#x2F;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.google.guava&lt;&#x2F;groupId&gt; &lt;artifactId&gt;guava&lt;&#x2F;artifactId&gt; &lt;version&gt;30.1-jre&lt;&#x2F;version&gt; &lt;&#x2F;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;&#x2F;groupId&gt; &lt;artifactId&gt;mybatis-plus-generator&lt;&#x2F;artifactId&gt; &lt;version&gt;3.4.1&lt;&#x2F;version&gt; &lt;&#x2F;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;&#x2F;groupId&gt; &lt;artifactId&gt;commons-lang3&lt;&#x2F;artifactId&gt; &lt;&#x2F;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;&#x2F;groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;&#x2F;artifactId&gt; &lt;version&gt;1.3.2&lt;&#x2F;version&gt; &lt;&#x2F;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;&#x2F;groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;&#x2F;artifactId&gt; &lt;version&gt;1.2.16&lt;&#x2F;version&gt; &lt;scope&gt;provided&lt;&#x2F;scope&gt; &lt;&#x2F;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;&#x2F;groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;&#x2F;artifactId&gt; &lt;&#x2F;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;&#x2F;artifactId&gt; &lt;&#x2F;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;&#x2F;groupId&gt; &lt;artifactId&gt;lombok&lt;&#x2F;artifactId&gt; &lt;&#x2F;dependency&gt; application.yml # é»˜è®¤çš„æ•°æ®åº“å database: name: story spring: dynamic: primary: master11 # è¿™ä¸ªè¡¨ç¤ºé»˜è®¤çš„æ•°æ®æº datasource: master: # æ•°æ®åº“åï¼Œä»é…ç½® database.name ä¸­è·å– url: jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;story?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai username: root password: 666666 # æ³¨æ„ä¸‹é¢è¿™ä¸ªtype,é€‰æ‹©DruidDataSourceæ—¶ï¼Œè¯·ç¡®ä¿é¡¹ç›®ä¸­æ·»åŠ äº†druidç›¸å…³ä¾èµ– type: com.alibaba.druid.pool.DruidDataSource #DruidDataSourceè‡ªæœ‰å±æ€§ filters: stat initialSize: 0 minIdle: 1 maxActive: 200 maxWait: 10000 time-between-eviction-runs-millis: 60000 min-evictable-idle-time-millis: 200000 testWhileIdle: true testOnBorrow: true validationQuery: select 1 shop: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;shop?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai username: root password: 666666 blog: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;sg_blog?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai username: root password: 666666 logging: level: default: debug mybatis: configuration: log-impl: org.apache.ibatis.logging.stdout.StdOutImpl map-underscore-to-camel-case: true åŸºç¡€çŸ¥è¯†ç‚¹ä¸»è¦å€ŸåŠ©AbstractRoutingDataSourceæ¥å®ç°åŠ¨æ€æ•°æ®æºï¼Œç®€å•ä»‹ç»ä¸‹å®ƒï¼š AbstractRoutingDataSource æ˜¯ Spring æä¾›çš„ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬åŠ¨æ€åˆ‡æ¢æ•°æ®æºã€‚åœ¨ä½¿ç”¨ AbstractRoutingDataSource æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å®ç°å®ƒçš„ determineCurrentLookupKey() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›å½“å‰çº¿ç¨‹ä½¿ç”¨çš„æ•°æ®æºçš„åç§°æˆ–æ ‡è¯†ç¬¦ã€‚ AbstractRoutingDataSource ä¸¤ä¸ªé‡è¦çš„æˆå‘˜å˜é‡ï¼š defaultTargetDataSourceï¼šé»˜è®¤æ•°æ®æºï¼Œå³å½“æ— æ³•ç¡®å®šä½¿ç”¨å“ªä¸ªæ•°æ®æºæ—¶ï¼Œå°†ä½¿ç”¨è¯¥é»˜è®¤æ•°æ®æºã€‚åœ¨AbstractRoutingDataSourceä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨setDefaultTargetDataSource()æ–¹æ³•æ¥è®¾ç½®é»˜è®¤æ•°æ®æºã€‚ targetDataSourcesï¼šä¸€ä¸ªMapç±»å‹çš„æˆå‘˜å˜é‡ï¼Œå…¶ä¸­ä¿å­˜äº†å¤šä¸ªæ•°æ®æºå®ä¾‹ã€‚åœ¨AbstractRoutingDataSourceä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨setTargetDataSources()æ–¹æ³•æ¥è®¾ç½®å¤šä¸ªæ•°æ®æºå®ä¾‹ï¼Œå…¶ä¸­Mapçš„keyä¸ºæ•°æ®æºæ ‡è¯†ç¬¦æˆ–åç§°ï¼Œvalueä¸ºå¯¹åº”çš„æ•°æ®æºå®ä¾‹ã€‚ ä½¿ç”¨AbstractRoutingDataSourceå®ç°æ•°æ®æºåˆ‡æ¢çš„åŸç†å¦‚ä¸‹ï¼š åœ¨åº”ç”¨å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®å¤šä¸ªæ•°æ®æºï¼Œå¹¶å°†å®ƒä»¬æ³¨å†Œåˆ°AbstractRoutingDataSourceä¸­ã€‚ å½“åº”ç”¨å‘èµ·æ•°æ®åº“æ“ä½œæ—¶ï¼ŒAbstractRoutingDataSourceä¼šæ ¹æ®determineCurrentLookupKey()æ–¹æ³•è¿”å›çš„å€¼ï¼ŒæŸ¥æ‰¾å¯¹åº”çš„æ•°æ®æºã€‚ åœ¨determineCurrentLookupKey()æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„ç­–ç•¥æ¥å†³å®šä½¿ç”¨å“ªä¸ªæ•°æ®æºã€‚ä¾‹å¦‚ï¼Œå¯ä»¥æ ¹æ®å½“å‰è¯·æ±‚çš„ç”¨æˆ·ä¿¡æ¯ã€è¯·æ±‚çš„URLã€å½“å‰æ—¶é—´ç­‰æ¥é€‰æ‹©ä¸åŒçš„æ•°æ®æºã€‚ å…¶æ ¸å¿ƒä»£ç å¦‚ï¼š // è¿”å›é€‰ä¸­çš„æ•°æ®æº protected DataSource determineTargetDataSource() &#123; Assert.notNull(this.resolvedDataSources, \"DataSource router not initialized\"); Object lookupKey = this.determineCurrentLookupKey(); DataSource dataSource = (DataSource)this.resolvedDataSources.get(lookupKey); if (dataSource == null &amp;&amp; (this.lenientFallback || lookupKey == null)) &#123; dataSource = this.resolvedDefaultDataSource; &#125; if (dataSource == null) &#123; throw new IllegalStateException(\"Cannot determine target DataSource for lookup key [\" + lookupKey + \"]\"); &#125; else &#123; return dataSource; &#125; &#125; @Nullable protected abstract Object determineCurrentLookupKey(); è®¾è®¡æ–¹æ¡ˆåŸºäºä¸Šé¢çš„åŠ¨æ€æ•°æ®æºçš„å‡ ä¸ªæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬éœ€è¦å®ç°åŠ¨æ€æ•°æ®æºåˆ‡æ¢æ—¶ï¼Œè‡ªç„¶è€Œç„¶å¯ä»¥æƒ³åˆ°çš„ä¸€ä¸ªæ–¹æ¡ˆå°±æ˜¯åœ¨æ¯æ¬¡dbæ‰§è¡Œä¹‹å‰ï¼Œå¡å…¥è¿™ä¸ªå¸Œæœ›ä½¿ç”¨çš„æ•°æ®æºkey ![d82673ae-8d87-48ba-8fbc-288ebdcb237b (1)](..&#x2F;..&#x2F;..&#x2F;images&#x2F;2023&#x2F;assets&#x2F;d82673ae-8d87-48ba-8fbc-288ebdcb237b (1).png) å¦‚ä¸Šçš„è®¾è®¡æ€è·¯ï¼Œä¸»è¦å€ŸåŠ©aopçš„æ€æƒ³æ¥å®ç°ï¼Œé€šè¿‡ä¸Šä¸‹æ–‡æ¥å­˜å‚¨å½“å‰æ–¹æ³•çš„æ‰§è¡Œï¼Œå…·ä½“å¸Œæœ›ä½¿ç”¨çš„æ•°æ®æºï¼Œç„¶åå†æ‰§è¡Œçš„sqlçš„æ—¶å€™ï¼ŒAbstractRoutingDataSourceç›´æ¥ä»ä¸Šä¸‹æ–‡ä¸­è·å–keyï¼Œä»¥æ­¤æ¥æŠ‰æ‹©å…·ä½“çš„æ•°æ®æº åŸºäºä¸Šé¢çš„æ–¹æ¡ˆï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¡¥å……ä¸€ä¸‹ç»†èŠ‚ 1.æ•°æ®æºé€‰æ‹©æ–¹å¼é€šè¿‡AOPçš„æ–¹å¼è¿›è¡Œæ‹¦æˆªï¼Œå†™å…¥æ•°æ®æºé€‰æ‹©ï¼Œè¿™ç§æ–¹å¼é€‚ç”¨äºæ–¹æ³•çº§åˆ«çš„ç²’åº¦ï¼ŒåŸºäºæ­¤å¸¸è§çš„å®ç°æ–¹å¼å°±æ˜¯é€šè¿‡è‡ªå®šä¹‰æ³¨è§£ï¼Œæ¥æ ‡æ³¨éœ€è¦ä½¿ç”¨çš„æ•°æ®æº å¦‚è‡ªå®šä¹‰æ³¨è§£ï¼Œé€šè¿‡è®¾ç½®dså€¼æ¥æŒ‡å®šè¿™ä¸ªæ–¹æ³•æ‰§è¡Œæ—¶é€‰æ‹©çš„æ•°æ®æº @Retention(RetentionPolicy.RUNTIME) @Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;) public @interface DsAno &#123; &#x2F;** * å¯ç”¨çš„æ•°æ®æºï¼Œé»˜è®¤ä¸»åº“ * * @return *&#x2F; MasterSlaveDsEnum value() default MasterSlaveDsEnum.MASTER; &#x2F;** * å¯ç”¨çš„æ•°æ®æºï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨å®ƒæ¥æ›¿æ¢é»˜è®¤çš„value * * @return *&#x2F; String ds() default &quot;&quot;; &#125; 2.ä¸Šä¸‹æ–‡é€šè¿‡ä¸Šä¸‹æ–‡æ¥ä¿å­˜å½“å‰é€‰ä¸­çš„æ•°æ®æºï¼Œå› æ­¤å¯ä»¥å€ŸåŠ© ThreadLocal æ¥å®ç°ä¸€ä¸ªç®€å•çš„æ•°æ®æºé€‰æ‹©ä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨ç»§æ‰¿çš„çº¿ç¨‹ä¸Šä¸‹æ–‡ï¼Œæ”¯æŒå¼‚æ­¥æ—¶é€‰æ‹©ä¼ é€’ã€‚ private static final ThreadLocal&lt;String&gt; CONTEXT_HOLDER &#x3D; new InheritableThreadLocal&lt;&gt;(); 3.åŠ¨æ€æ•°æ®æºé€‰æ‹©public class MyRoutingDataSource extends AbstractRoutingDataSource &#123; @Nullable @Override protected Object determineCurrentLookupKey() &#123; return DsContextHolder.get(); &#125; &#125; 4.aopæ‹¦æˆªå€ŸåŠ©AOPï¼Œæ‹¦æˆªæ–¹æ³•ã€ç±»ä¸Šæ‹¥æœ‰DSæ³¨è§£çš„æ–¹æ³•æ‰§è¡Œï¼Œç„¶åä»è¿™ä¸ªæ³¨è§£ä¸­è¯»å–é€‰ä¸­çš„æ•°æ®æºï¼Œç„¶åå†™å…¥ä¸Šä¸‹æ–‡ï¼›å†æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæ¸…ç©ºä¸Šä¸‹æ–‡ @Aspect public class DsAspect &#123; &#x2F;** * åˆ‡å…¥ç‚¹, æ‹¦æˆªç±»ä¸Šã€æ–¹æ³•ä¸Šæœ‰æ³¨è§£çš„æ–¹æ³•ï¼Œç”¨äºåˆ‡æ¢æ•°æ®æº *&#x2F; @Pointcut(&quot;@annotation(com.example.multidatasource.dal.DsAno)||@within(com.example.multidatasource.dal.DsAno)&quot;) public void pointcut() &#123; &#125; @Around(&quot;pointcut()&quot;) public Object around(ProceedingJoinPoint proceedingJoinPoint) throws Throwable &#123; DsAno ds &#x3D; getDsAno(proceedingJoinPoint); try &#123; if (ds !&#x3D; null &amp;&amp; (StringUtils.isNotBlank(ds.ds()) || ds.value() !&#x3D; null)) &#123; &#x2F;&#x2F; å½“ä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰æ—¶ï¼Œåˆ™å†™å…¥çº¿ç¨‹ä¸Šä¸‹æ–‡ï¼Œåº”è¯¥ç”¨å“ªä¸ªDB DsContextHolder.set(StringUtils.isNoneBlank(ds.ds()) ? ds.ds() : ds.value().name()); &#125; return proceedingJoinPoint.proceed(); &#125; finally &#123; &#x2F;&#x2F; æ¸…ç©ºä¸Šä¸‹æ–‡ä¿¡æ¯ if (ds !&#x3D; null) &#123; DsContextHolder.reset(); &#125; &#125; &#125; private DsAno getDsAno(ProceedingJoinPoint proceedingJoinPoint) &#123; MethodSignature signature &#x3D; (MethodSignature) proceedingJoinPoint.getSignature(); Method method &#x3D; signature.getMethod(); DsAno ds &#x3D; method.getAnnotation(DsAno.class); if (ds &#x3D;&#x3D; null) &#123; &#x2F;&#x2F; è·å–ç±»ä¸Šçš„æ³¨è§£ ds &#x3D; (DsAno) proceedingJoinPoint.getSignature().getDeclaringType().getAnnotation(DsAno.class); &#125; return ds; &#125; &#125; å¤šæ•°æ®æºå®ç°1.å¤šæ•°æ®æºå®šä¹‰å¯¹äºå¤šæ•°æ®æºï¼Œå› æ­¤æ— æ³•ç›´æ¥ä½¿ç”¨é»˜è®¤çš„æ•°æ®æºé…ç½®ï¼Œæˆ‘ä»¬å€ŸåŠ©é»˜è®¤çš„é…ç½®è§„åˆ™ï¼ŒåŠ ä¸€ä¸ªå¤šæ•°æ®æºç‰ˆæœ¬çš„è®¾è®¡å¯¹åº”çš„å¤šæ•°æ®æºçš„é…ç½®è§„åˆ™å¦‚ä¸‹ spring: dynamic: primary: master # è¿™ä¸ªè¡¨ç¤ºé»˜è®¤çš„æ•°æ®æº datasource: story: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/$&#123;database.name&#125;?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai username: root password: 666666 shop: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/shop?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai username: root password: 666666 æ³¨æ„ä¸Šé¢çš„å®šä¹‰ï¼š spring.dynamic.primary: æŒ‡å®šé»˜è®¤å¯ç”¨çš„æ•°æ®æº spring.dynamic.datasource.æ•°æ®æºå.é…ç½®: è¿™é‡Œçš„æ•°æ®æºåä¸èƒ½é‡å¤ï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰ï¼Œæ•°æ®æºä¸‹çš„é…ç½®ä¸é»˜è®¤çš„é…ç½®å‚æ•°è¦æ±‚ä¸€è‡´ å¯¹åº”çš„æ•°æ®æºé…ç½®åŠ è½½æ–¹å¼ç›´æ¥å€ŸåŠ©äº†Springçš„ConfigurationPropertiesæ¥å®ç° 2.å¤šæ•°æ®æºæ³¨å†Œä¸Šé¢æ˜¯æ•°æ®æºçš„é…ç½®å®šä¹‰ä¸åŠ è½½ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦åŸºäºä¸Šé¢çš„æ•°æ®æºé…ç½®æ¥å®ä¾‹åŒ–å¯¹åº”çš„datasourceã€‚ @Slf4j @Configuration @ConditionalOnProperty(prefix &#x3D; &quot;spring.dynamic&quot;, name &#x3D; &quot;primary&quot;) @EnableConfigurationProperties(DsProperties.class) public class DataSourceConfig &#123; public DataSourceConfig() &#123; log.info(&quot;åŠ¨æ€æ•°æ®æºåˆå§‹åŒ–!&quot;); &#125; @Bean public DsAspect dsAspect() &#123; return new DsAspect(); &#125; &#x2F;** * æ•´åˆä¸»ä»æ•°æ®æº * * @param dsProperties * @return 1 *&#x2F; @Bean @Primary public DataSource dataSource(DsProperties dsProperties) &#123; Map&lt;Object, Object&gt; targetDataSources &#x3D; Maps.newHashMapWithExpectedSize(dsProperties.getDatasource().size()); dsProperties.getDatasource().forEach((k, v) -&gt; targetDataSources.put(k.toUpperCase(), v.initializeDataSourceBuilder().build())); if (CollectionUtils.isEmpty(targetDataSources)) &#123; throw new IllegalStateException(&quot;å¤šæ•°æ®æºé…ç½®ï¼Œè¯·ä»¥ spring.dynamic å¼€å¤´&quot;); &#125; MyRoutingDataSource myRoutingDataSource &#x3D; new MyRoutingDataSource(); Object key &#x3D; dsProperties.getPrimary().toUpperCase(); if (!targetDataSources.containsKey(key)) &#123; if (targetDataSources.containsKey(MasterSlaveDsEnum.MASTER.name())) &#123; &#x2F;&#x2F; å½“ä»¬æ²¡æœ‰é…ç½®primaryå¯¹åº”çš„æ•°æ®æºæ—¶ï¼Œå­˜åœ¨MASTERæ•°æ®æºï¼Œåˆ™å°†ä¸»åº“ä½œä¸ºé»˜è®¤çš„æ•°æ®æº key &#x3D; MasterSlaveDsEnum.MASTER.name(); &#125; else &#123; key &#x3D; targetDataSources.keySet().iterator().next(); &#125; &#125; log.info(&quot;åŠ¨æ€æ•°æ®æºï¼Œé»˜è®¤å¯ç”¨ä¸ºï¼š &quot; + key); myRoutingDataSource.setDefaultTargetDataSource(targetDataSources.get(key)); myRoutingDataSource.setTargetDataSources(targetDataSources); return myRoutingDataSource; &#125; &#125; @ConditionalOnProperty: è¿™æ˜¯Spring Bootæ¡†æ¶æä¾›çš„æ¡ä»¶æ³¨è§£ï¼Œå®ƒè¡¨ç¤ºåªæœ‰å½“æŒ‡å®šçš„å±æ€§æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶ï¼Œæ‰ä¼šåˆ›å»ºè¿™ä¸ªé…ç½®ç±»æ‰€å®šä¹‰çš„beanã€‚ @EnableConfigurationProperties(DsProperties.class): è¿™ä¸ªæ³¨è§£å‘Šè¯‰Spring Bootå»å¯ç”¨ç‰¹å®šçš„é…ç½®å±æ€§ç±»ï¼ˆDsPropertiesï¼‰ï¼Œä½¿å…¶å¯ä»¥è¢«æ³¨å…¥åˆ°å…¶ä»–beanä¸­ã€‚ @Primary: è¿™ä¸ªæ³¨è§£ç”¨äºæ ‡è¯†åœ¨å¤šä¸ªbeanå€™é€‰è€…ä¸­ï¼Œä¼˜å…ˆé€‰æ‹©è¢«æ³¨è§£çš„beanä½œä¸ºè‡ªåŠ¨è£…é…çš„é¦–é€‰é¡¹ã€‚ datasourceå®ä¾‹åŒ–æ–¹å¼ DataSourceProperties.initializeDataSourceBuilder().build() é€šè¿‡ä¸Šé¢çš„æ–¹å¼åˆ›å»ºçš„DataSourceä¸ºé»˜è®¤çš„HikariDataSource 3.ä¸Šä¸‹æ–‡å®šä¹‰public class DsContextHolder &#123; &#x2F;** * ä½¿ç”¨ç»§æ‰¿çš„çº¿ç¨‹ä¸Šä¸‹æ–‡ï¼Œæ”¯æŒå¼‚æ­¥æ—¶é€‰æ‹©ä¼ é€’ * ä½¿ç”¨DsNodeï¼Œæ”¯æŒé“¾å¼çš„æ•°æ®æºåˆ‡æ¢ï¼Œå¦‚æœ€å¤–å±‚ä½¿ç”¨masteræ•°æ®æºï¼Œå†…éƒ¨æŸä¸ªæ–¹æ³•ä½¿ç”¨slaveæ•°æ®æºï¼›ä½†æ˜¯è¯·æ³¨æ„ï¼Œå¯¹äºäº‹åŠ¡çš„åœºæ™¯ï¼Œä¸è¦äº¤å‰ *&#x2F; private static final ThreadLocal&lt;String&gt; CONTEXT_HOLDER &#x3D; new InheritableThreadLocal&lt;&gt;(); private DsContextHolder() &#123; &#125; public static void set(String dbType) &#123; CONTEXT_HOLDER.set(dbType); &#125; public static String get() &#123; return CONTEXT_HOLDER.get(); &#125; public static void set(DS ds) &#123; set(ds.name().toUpperCase()); &#125; &#x2F;** * ç§»é™¤ä¸Šä¸‹æ–‡ *&#x2F; public static void reset() &#123; CONTEXT_HOLDER.remove(); &#125; &#125; 4.AOPå®ç°å€ŸåŠ©AOPæ¥ç®€åŒ–æ•°æ®æºçš„é€‰æ‹©ï¼Œå› æ­¤æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªæ³¨è§£DsAnoï¼Œå¯ä»¥æ”¾åœ¨ç±»ä¸Šï¼Œè¡¨ç¤ºè¿™ä¸ªç±»ä¸‹æ‰€æœ‰çš„å…±æœ‰æ–¹æ³•ï¼Œéƒ½èµ°æŸä¸ªæ•°æ®æºï¼›ä¹Ÿå¯ä»¥æ”¾åœ¨æ–¹æ³•ä¸Šï¼Œä¸”æ–¹æ³•ä¸Šçš„ä¼˜å…ˆçº§å¤§äºç±»ä¸Šçš„æ³¨è§£ public interface DS &#123; &#x2F;** * ä½¿ç”¨çš„æ•°æ®æºå * * @return *&#x2F; String name(); &#125; @Retention(RetentionPolicy.RUNTIME) @Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;) public @interface DsAno &#123; &#x2F;** * å¯ç”¨çš„æ•°æ®æºï¼Œé»˜è®¤ä¸»åº“ * * @return *&#x2F; MasterSlaveDsEnum value() default MasterSlaveDsEnum.MASTER; &#x2F;** * å¯ç”¨çš„æ•°æ®æºï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨å®ƒæ¥æ›¿æ¢é»˜è®¤çš„value * * @return *&#x2F; String ds() default &quot;&quot;; &#125; @Aspect public class DsAspect &#123; &#x2F;** * åˆ‡å…¥ç‚¹, æ‹¦æˆªç±»ä¸Šã€æ–¹æ³•ä¸Šæœ‰æ³¨è§£çš„æ–¹æ³•ï¼Œç”¨äºåˆ‡æ¢æ•°æ®æº *&#x2F; @Pointcut(&quot;@annotation(com.example.multidatasource.dal.DsAno)||@within(com.example.multidatasource.dal.DsAno)&quot;) public void pointcut() &#123; &#125; @Around(&quot;pointcut()&quot;) public Object around(ProceedingJoinPoint proceedingJoinPoint) throws Throwable &#123; DsAno ds &#x3D; getDsAno(proceedingJoinPoint); try &#123; if (ds !&#x3D; null &amp;&amp; (StringUtils.isNotBlank(ds.ds()) || ds.value() !&#x3D; null)) &#123; &#x2F;&#x2F; å½“ä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰æ—¶ï¼Œåˆ™å†™å…¥çº¿ç¨‹ä¸Šä¸‹æ–‡ï¼Œåº”è¯¥ç”¨å“ªä¸ªDB DsContextHolder.set(StringUtils.isNoneBlank(ds.ds()) ? ds.ds() : ds.value().name()); &#125; return proceedingJoinPoint.proceed(); &#125; finally &#123; &#x2F;&#x2F; æ¸…ç©ºä¸Šä¸‹æ–‡ä¿¡æ¯ if (ds !&#x3D; null) &#123; DsContextHolder.reset(); &#125; &#125; &#125; private DsAno getDsAno(ProceedingJoinPoint proceedingJoinPoint) &#123; MethodSignature signature &#x3D; (MethodSignature) proceedingJoinPoint.getSignature(); Method method &#x3D; signature.getMethod(); DsAno ds &#x3D; method.getAnnotation(DsAno.class); if (ds &#x3D;&#x3D; null) &#123; &#x2F;&#x2F; è·å–ç±»ä¸Šçš„æ³¨è§£ ds &#x3D; (DsAno) proceedingJoinPoint.getSignature().getDeclaringType().getAnnotation(DsAno.class); &#125; return ds; &#125; &#125; ä¸Šé¢çš„è®¾è®¡ä¸­ï¼Œé’ˆå¯¹å¸¸è§çš„ä¸»ä»åˆ‡æ¢åšäº†ä¸€ä¸ªç®€å•çš„å…¼å®¹ï¼Œå®šä¹‰äº†ä¸€ä¸ªä¸»ä»æ•°æ®æºçš„æšä¸¾ï¼ŒåŒæ ·ä¹Ÿæ˜¯åŸºäºç®€åŒ–ä½¿ç”¨ä½“éªŒçš„å‡ºå‘ï¼Œæšä¸¾ç±»è®¾è®¡å¦‚ä¸‹ï¼š public enum MasterSlaveDsEnum implements DS &#123; MASTER, SHOP, STORY; &#125; 5.ç¼–ç¨‹å¼æ•°æ®æºé€‰æ‹©ä¸å°ç»“import java.util.function.Supplier; &#x2F;** * æ‰‹åŠ¨æŒ‡å®šæ•°æ®æºçš„ç”¨æ³• *&#x2F; public class DsSelectExecutor &#123; &#x2F;** * æœ‰è¿”å›ç»“æœ * * @param ds æ•°æ®æº * @param supplier ä¾›åº”å•† * @param &lt;T&gt; æ³›å‹ç±»å‹ * @return è¿”å›ç»“æœ *&#x2F; public static &lt;T&gt; T submit(DS ds, Supplier&lt;T&gt; supplier) &#123; DsContextHolder.set(ds); try &#123; return supplier.get(); &#125; finally &#123; DsContextHolder.reset(); &#125; &#125; &#x2F;** * æ— è¿”å›ç»“æœ * * @param ds æ•°æ®æº * @param call å¯è°ƒç”¨å¯¹è±¡ *&#x2F; public static void execute(DS ds, Runnable call) &#123; DsContextHolder.set(ds); try &#123; call.run(); &#125; finally &#123; DsContextHolder.reset(); &#125; &#125; &#125; submitæ–¹æ³•ï¼šæ¥æ”¶ä¸€ä¸ªæ•°æ®åº“è¿æ¥å’Œä¸€ä¸ªSupplieræ¥å£å®ä¾‹ä½œä¸ºå‚æ•°ï¼Œè¿”å›Supplieræ¥å£çš„è¿”å›å€¼ã€‚è¯¥æ–¹æ³•çš„ç›®çš„æ˜¯ä½¿ç”¨ç»™å®šçš„æ•°æ®åº“è¿æ¥æ‰§è¡Œä¼ å…¥çš„Supplieræ¥å£å®ä¾‹ï¼Œç„¶åè¿”å›è¯¥æ¥å£çš„è¿”å›å€¼ã€‚åœ¨æ–¹æ³•ä¸­ï¼Œé¦–å…ˆé€šè¿‡DsContextHolderç±»å°†æ•°æ®åº“è¿æ¥è®¾ç½®åˆ°è¿æ¥æ± ä¸­ï¼Œç„¶åä½¿ç”¨supplier.get()æ–¹æ³•è·å–Supplieræ¥å£çš„è¿”å›å€¼ã€‚æœ€åï¼Œåœ¨finallyå—ä¸­é‡ç½®æ•°æ®åº“è¿æ¥æ± çš„çŠ¶æ€ï¼Œä»¥ç¡®ä¿æ•°æ®åº“è¿æ¥è¢«æ­£ç¡®é‡Šæ”¾ã€‚ executeæ–¹æ³•ï¼šæ¥æ”¶ä¸€ä¸ªæ•°æ®åº“è¿æ¥å’Œä¸€ä¸ªRunnableæ¥å£å®ä¾‹ä½œä¸ºå‚æ•°ï¼Œæ— è¿”å›å€¼ã€‚è¯¥æ–¹æ³•çš„ç›®çš„æ˜¯ä½¿ç”¨ç»™å®šçš„æ•°æ®åº“è¿æ¥æ‰§è¡Œä¼ å…¥çš„Runnableæ¥å£å®ä¾‹ä¸­çš„ä»£ç ã€‚åœ¨æ–¹æ³•ä¸­ï¼Œé¦–å…ˆé€šè¿‡DsContextHolderç±»å°†æ•°æ®åº“è¿æ¥è®¾ç½®åˆ°è¿æ¥æ± ä¸­ï¼Œç„¶åä½¿ç”¨call.run()æ–¹æ³•æ‰§è¡ŒRunnableæ¥å£çš„ä»£ç ã€‚æœ€åï¼Œåœ¨finallyå—ä¸­é‡ç½®æ•°æ®åº“è¿æ¥æ± çš„çŠ¶æ€ï¼Œä»¥ç¡®ä¿æ•°æ®åº“è¿æ¥è¢«æ­£ç¡®é‡Šæ”¾ã€‚ å°ç»“å°ç»“ä¸€ä¸‹æ•´ä¸ªçš„è®¾è®¡å®ç°ï¼Œä¸»è¦åŸºäºAOP + ä¸Šä¸‹æ–‡çš„æ–¹å¼ï¼Œé…åˆAbstractRoutingDataSourceæ¥å®ç°å¤šæ•°æ®æºçš„è‡ªç”±é€‰æ‹© ä½†æ˜¯è¯·æ³¨æ„ï¼Œä¸Šé¢çš„å®ç°ï¼Œè¿˜æœ‰å‡ ä¸ªç¼ºé™·ï¼š å¦‚æœä¸€ä¸ªæ–¹æ³•ä¸Šæœ‰æ•°æ®æºé€‰æ‹©æ³¨è§£ï¼Œä½†æ˜¯å†…éƒ¨å¼€äº†å­çº¿ç¨‹åšå¼‚æ­¥å¤„ç†ï¼Œé‚£ä¹ˆä¸Šä¸‹æ–‡å­˜å‚¨çš„æ•°æ®æºä¼šå¤±æ•ˆ ä¸€ä¸ªæ–¹æ³•ä¸ŠæŒ‡å®šäº†æ•°æ®æºï¼Œå®ƒåˆè°ƒç”¨å…¶ä»–æœ‰ä¹ŸæŒ‡å®šäº†æ•°æ®æºçš„æ–¹æ³•ï¼Œå½“å‰çš„æ–¹æ¡ˆä¼šå­˜åœ¨æ•°æ®æºçš„é€‰æ‹©å†²çª druidæ•°æ®æºæ€ä¹ˆå…¼å®¹ï¼Ÿ ä¼˜åŒ–æ”¯æŒåµŒå¥—çš„æ•°æ®æºé€‰æ‹©æ–¹æ¡ˆå‰é¢æå‡ºçš„ä¸€ä¸ªéå¸¸å¤§çš„é—®é¢˜å°±æ˜¯å†æ•´ä¸ªé“¾è·¯ä¸­ï¼Œåªæ”¯æŒé€‰æ‹©ä¸€æ¬¡çš„æ•°æ®æºï¼Œæ˜¾ç„¶è¿™ç§æ–¹å¼ç¼ºé™·æ¯”è¾ƒå¤§ï¼Œä¹Ÿå¾ˆå®¹æ˜“å‡ºç°é—®é¢˜ï¼› è‹¥æˆ‘ä»¬å¸Œæœ›å®ç°åœ¨é€‰æ‹©äº†ä¸€ä¸ªæ•°æ®æºä¹‹åï¼Œåœ¨æ‰§è¡ŒæŸä¸ªä»£ç ç‰‡æ®µæ—¶ï¼Œè¿˜å¯ä»¥ç»§ç»­å†é€‰æ‹©å…¶ä»–çš„æ•°æ®æºï¼Œé‚£ä¹ˆåº”è¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿ é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¹‹å‰çš„å®ç°æ–¹æ¡ˆ ![d82673ae-8d87-48ba-8fbc-288ebdcb237b (1)](..&#x2F;..&#x2F;..&#x2F;images&#x2F;2023&#x2F;assets&#x2F;d82673ae-8d87-48ba-8fbc-288ebdcb237b (1).png) åœ¨æ‰§è¡Œsqlæ—¶ï¼Œä»ä¸Šä¸‹æ–‡ä¸­è·å–å½“å‰é€‰ä¸­çš„æ•°æ®æº,å‰é¢è®¾è®¡çš„ä¸Šä¸‹æ–‡ç›´æ¥ä½¿ç”¨çº¿ç¨‹ä¸Šçº¿æ–‡ä¿å­˜ private static final ThreadLocal&lt;String&gt; CONTEXT_HOLDER &#x3D; new InheritableThreadLocal&lt;&gt;(); ä»ä¸Šé¢çš„è¿™ä¸ªå®ç°æ¥çœ‹ï¼Œä¸Šä¸‹æ–‡èµ‹å€¼åªèƒ½æœ‰ä¸€æ¬¡ï¼Œå½“æˆ‘ä»¬å¸Œæœ›å¯ä»¥å®ç°æ ‡é¢˜çš„æ•ˆæœï¼Œè‡ªç„¶æˆ‘ä»¬åº”è¯¥æƒ³åˆ°çš„æ•°æ®ç»“æ„å°±æ˜¯æ ˆ â€“ åè¿›å…ˆå‡º æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªDsNodeèŠ‚ç‚¹æ¥å­˜å‚¨é€‰ä¸­çš„æ•°æ®æºï¼ŒåŒºåˆ«äºä¹‹å‰çš„Stringï¼Œå®ƒé™¤äº†è®°å½•é€‰ä¸­çš„æ•°æ®æºä¹‹å¤–ï¼Œè¿˜è®°å½•å‰ä¸€æ¬¡é€‰ä¸­çš„æ•°æ®æº public static class DsNode &#123; DsNode pre; String ds; public DsNode(DsNode parent, String ds) &#123; pre &#x3D; parent; this.ds &#x3D; ds; &#125; &#125; ç§»é™¤ä¸Šä¸‹æ–‡åˆ™ä¸èƒ½åƒä¹‹å‰é‚£ä¹ˆç²—æš´ï¼Œè€Œæ˜¯è¦å®ç°æ ˆçš„å¼¹å‡ºæ•ˆæœ å¦‚æœæ— é€‰ä¸­çš„æ•°æ®æºï¼Œç›´æ¥è¿”å› è‹¥ä¹‹å‰é€‰ä¸­çš„DsNodeï¼Œå­˜åœ¨ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™å°†ä¸Šä¸€ä¸ªèŠ‚ç‚¹é‡æ–°å†™å…¥ä¸Šä¸‹æ–‡ è‹¥ä¹‹å‰é€‰ä¸­çš„DsNodeï¼Œä¸å­˜åœ¨ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™æ¸…ç©ºä¸Šä¸‹æ–‡ public static String get() &#123; DsNode dsNode &#x3D; CONTEXT_HOLDER.get(); log.info(&quot;get dbType:&#123;&#125;&quot;, CONTEXT_HOLDER.get()); return dsNode&#x3D;&#x3D;null? null:dsNode.ds; &#125; public static void set(String dbType) &#123; DsNode current &#x3D; CONTEXT_HOLDER.get(); CONTEXT_HOLDER.set(new DsNode(current,dbType)); &#125; public static void set(DS ds) &#123; set(ds.name().toUpperCase()); &#125; &#x2F;** * ç§»é™¤ä¸Šä¸‹æ–‡ *&#x2F; public static void reset() &#123; DsNode ds &#x3D; CONTEXT_HOLDER.get(); if (ds &#x3D;&#x3D; null) &#123; return; &#125; if (ds.pre !&#x3D; null) &#123; &#x2F;&#x2F; é€€å‡ºå½“å‰çš„æ•°æ®æºé€‰æ‹©ï¼Œåˆ‡å›å»èµ°ä¸Šä¸€æ¬¡çš„æ•°æ®æºé…ç½® CONTEXT_HOLDER.set(ds.pre); &#125; else &#123; CONTEXT_HOLDER.remove(); &#125; &#125; Druidæ•°æ®æºæ”¯æŒdsProperties.getDatasource().forEach((k, v) -&gt; targetDataSources.put(k.toUpperCase(), initDataSource(k, v))); ä¸Šé¢ä»£ç ä¸­ä½¿ç”¨v.initializeDataSourceBuilder().build()åˆå§‹åŒ–çš„æ•°æ®æºé»˜è®¤æ˜¯HikarDataSource,å½“æˆ‘ä»¬ä½¿ç”¨Druidæ•°æ®æºæ—¶å°±æ— æ³•é€‚é…ï¼Œå› æ­¤éœ€è¦åšä»¥ä¸‹ä¿®æ”¹ã€‚ 1.æ£€æŸ¥æ˜¯å¦å¼•å…¥Druidç›¸å…³èµ„æº public class DruidCheckUtil &#123; &#x2F;** * åˆ¤æ–­æ˜¯å¦åŒ…å«duridç›¸å…³çš„æ•°æ®åŒ… * * @return *&#x2F; public static boolean hasDuridPkg() &#123; return ClassUtils.isPresent(&quot;com.alibaba.druid.pool.DruidDataSource&quot;, DataSourceConfig.class.getClassLoader()); &#125; &#125; 2.åˆ›å»ºInitDatasourseæ–¹æ³•ç”¨æ¥åˆ¤æ–­æ˜¯å¦åˆå§‹åŒ–Druidæ•°æ®æº &#x2F;** * åˆå§‹åŒ–æ•°æ®æº * @param prefix æ•°æ®æºå‰ç¼€ * @param properties æ•°æ®æºå±æ€§ * @return æ•°æ®æº *&#x2F; public DataSource initDataSource(String prefix, DataSourceProperties properties) &#123; &#x2F;&#x2F; æ£€æŸ¥æ˜¯å¦åŒ…å«DruidåŒ… if (!DruidCheckUtil.hasDuridPkg()) &#123; log.info(&quot;å®ä¾‹åŒ–HikarDataSource: &#123;&#125;&quot;, prefix); &#x2F;&#x2F; ä½¿ç”¨æ•°æ®æºå±æ€§åˆå§‹åŒ–æ•°æ®æºæ„å»ºå™¨å¹¶æ„å»ºæ•°æ®æº return properties.initializeDataSourceBuilder().build(); &#125; &#x2F;&#x2F; å¦‚æœæ•°æ®æºç±»å‹ä¸ºç©ºæˆ–è€…æ•°æ®æºç±»å‹ä¸æ˜¯DruidDataSourceç±» if (properties.getType() &#x3D;&#x3D; null || !properties.getType().isAssignableFrom(DruidDataSource.class)) &#123; log.info(&quot;å®ä¾‹åŒ–HikarDataSource: &#123;&#125;&quot;, prefix); &#x2F;&#x2F; ä½¿ç”¨æ•°æ®æºå±æ€§åˆå§‹åŒ–æ•°æ®æºæ„å»ºå™¨å¹¶æ„å»ºæ•°æ®æº return properties.initializeDataSourceBuilder().build(); &#125; log.info(&quot;å®ä¾‹åŒ–DruidDataSource: &#123;&#125;&quot;, prefix); &#x2F;&#x2F; ä½¿ç”¨Spring Binder ç»‘å®šæˆ–åˆ›å»ºä¸€ä¸ª &quot;spring.dynamic.datasource.&quot; + prefix çš„DruidDataSourceå¯¹è±¡ return Binder.get(environment).bindOrCreate(&quot;spring.dynamic.datasource.&quot; + prefix, DruidDataSource.class); &#125; ä¸Šé¢æ–¹æ³•ä¼šè¯»å–spring.dynamic.datasource.xxxçš„é…ç½®ä¿¡æ¯ï¼Œæˆ‘ä»¬åªéœ€æ·»åŠ typeå±æ€§å’ŒDruidçš„é…ç½®ä¿¡æ¯å³å¯åˆå§‹åŒ–DruidDataSourceã€‚ é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š # é»˜è®¤çš„æ•°æ®åº“å database: name: story spring: dynamic: primary: master # è¿™ä¸ªè¡¨ç¤ºé»˜è®¤çš„æ•°æ®æº datasource: master: # æ•°æ®åº“åï¼Œä»é…ç½® database.name ä¸­è·å– url: jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;$&#123;database.name&#125;?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai username: root password: 666666 # æ³¨æ„ä¸‹é¢è¿™ä¸ªtype,é€‰æ‹©DruidDataSourceæ—¶ï¼Œè¯·ç¡®ä¿é¡¹ç›®ä¸­æ·»åŠ äº†druidç›¸å…³ä¾èµ– type: com.alibaba.druid.pool.DruidDataSource #DruidDataSourceè‡ªæœ‰å±æ€§ filters: stat initialSize: 0 minIdle: 1 maxActive: 200 maxWait: 10000 time-between-eviction-runs-millis: 60000 min-evictable-idle-time-millis: 200000 testWhileIdle: true testOnBorrow: true validationQuery: select 1 story: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;$&#123;database.name&#125;?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai username: root password: 666666 shop: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;shop?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai username: root password: 666666 blog: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;sg_blog?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai username: root password: 666666","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"},{"name":"MySQL","slug":"MySQL","permalink":"https://blog.ehzyil.xyz/tags/MySQL/"}],"author":"ehzyil"},{"title":"æ•°æ®åº“è¡¨è‡ªåŠ¨åˆå§‹åŒ–","slug":"2023/æ•°æ®åº“è¡¨è‡ªåŠ¨åˆå§‹åŒ–","date":"2023-12-28T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/28/2023/æ•°æ®åº“è¡¨è‡ªåŠ¨åˆå§‹åŒ–/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/28/2023/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E8%87%AA%E5%8A%A8%E5%88%9D%E5%A7%8B%E5%8C%96/","excerpt":"","text":"æ•°æ®åº“è¡¨è‡ªåŠ¨åˆå§‹åŒ–Liquibaseæ•°æ®åº“è¡¨ç‰ˆæœ¬ç®¡ç†ä¾èµ–é…ç½®åœ¨Mavençš„pomæ–‡ä»¶ä¸­æ·»åŠ Liquibaseä¾èµ– &lt;dependency> &lt;groupId>org.liquibase&lt;/groupId> &lt;artifactId>liquibase-core&lt;/artifactId> &lt;/dependency> é…ç½®æ•°æ®æºå’ŒLiquibase åœ¨application.ymlæ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼Œliquibase: change-log: classpath:liquibase/master.xmlç”¨äºæŒ‡å®šchange-logçš„ç›®å½•ã€‚ # é»˜è®¤çš„æ•°æ®åº“å database: name: story spring: liquibase: change-log: classpath:liquibase/master.xml enabled: true # å½“å®é™…ä½¿ç”¨çš„æ•°æ®åº“ä¸æ”¯æŒliquibaseï¼Œå¦‚ mariadb æ—¶ï¼Œå°†è¿™ä¸ªå‚æ•°è®¾ç½®ä¸ºfalse datasource: url: jdbc:mysql://127.0.0.1:3306/$&#123;database.name&#125;?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai username: root password: 666666 è¯´æ˜ï¼šâ—å¯¹äºä¸æ”¯æŒliquibaseçš„æ•°æ®åº“ï¼Œå¦‚mariadbï¼Œè¯·å°†ä¸Šé¢çš„ spring.liquibase.enabled è®¾ç½®ä¸º falseâ—change-log: å¯¹åº”çš„æ˜¯æ ¸å¿ƒçš„æ•°æ®åº“ç‰ˆæœ¬å˜æ›´é…ç½® åœ¨rescourcesä¸‹åˆ›å»ºä»¥ä¸‹çš„é…ç½®æ–‡ä»¶ã€‚ master.xml æ–‡ä»¶ä¸­çš„å†…å®¹å¦‚ä¸‹ &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &lt;databaseChangeLog xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.liquibase.org&#x2F;xml&#x2F;ns&#x2F;dbchangelog&quot; xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot; xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;www.liquibase.org&#x2F;xml&#x2F;ns&#x2F;dbchangelog http:&#x2F;&#x2F;www.liquibase.org&#x2F;xml&#x2F;ns&#x2F;dbchangelog&#x2F;dbchangelog-3.5.xsd&quot;&gt; &lt;include file&#x3D;&quot;liquibase&#x2F;changelog&#x2F;000_initial_schema.xml&quot; relativeToChangelogFile&#x3D;&quot;false&quot;&#x2F;&gt; &lt;&#x2F;databaseChangeLog&gt; è¯´æ˜ï¼šâ—å¯¹äºä¸æ”¯æŒliquibaseçš„æ•°æ®åº“ï¼Œå¦‚mariadbï¼Œè¯·å°†ä¸Šé¢çš„ spring.liquibase.enabled è®¾ç½®ä¸º falseâ—change-log: å¯¹åº”çš„æ˜¯æ ¸å¿ƒçš„æ•°æ®åº“ç‰ˆæœ¬å˜æ›´é…ç½® æ³¨æ„ä¸Šé¢è¿™ä¸ª includeï¼Œ è¿™é‡Œå°±æ˜¯å‘Šè¯‰liquibaseï¼Œæ‰€æœ‰çš„å˜æ›´è®°å½•ï¼Œéƒ½æ”¾åœ¨äº† liquibase&#x2F;changelog&#x2F;000_initial_schema.xml è¿™ä¸ªæ–‡ä»¶ä¸­ changelogæ–‡ä»¶ changelogæ–‡ä»¶ï¼Œç”¨äºå®šä¹‰æ•°æ®åº“çš„ç»“æ„å’Œåˆå§‹æ•°æ®ã€‚å¯ä»¥ä½¿ç”¨XMLã€YAMLæˆ–è€…JSONæ ¼å¼æ¥ç¼–å†™changelogæ–‡ä»¶ï¼Œä¾‹å¦‚000_initial_schema.xmlã€‚ &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt; &lt;databaseChangeLog xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.liquibase.org&#x2F;xml&#x2F;ns&#x2F;dbchangelog&quot; xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot; xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;www.liquibase.org&#x2F;xml&#x2F;ns&#x2F;dbchangelog http:&#x2F;&#x2F;www.liquibase.org&#x2F;xml&#x2F;ns&#x2F;dbchangelog&#x2F;dbchangelog-3.5.xsd&quot;&gt; &lt;property name&#x3D;&quot;now&quot; value&#x3D;&quot;now()&quot; dbms&#x3D;&quot;mysql&quot;&#x2F;&gt; &lt;property name&#x3D;&quot;autoIncrement&quot; value&#x3D;&quot;true&quot;&#x2F;&gt; &lt;changeSet id&#x3D;&quot;00000000000001&quot; author&#x3D;&quot;ehzyil&quot;&gt; &lt;sqlFile dbms&#x3D;&quot;mysql&quot; endDelimiter&#x3D;&quot;;&quot; encoding&#x3D;&quot;UTF-8&quot; path&#x3D;&quot;liquibase&#x2F;data&#x2F;init-schema.sql&quot;&#x2F;&gt; &lt;&#x2F;changeSet&gt; &lt;changeSet id&#x3D;&quot;00000000000002&quot; author&#x3D;&quot;ehzyil&quot;&gt; &lt;sqlFile dbms&#x3D;&quot;mysql&quot; endDelimiter&#x3D;&quot;;&quot; encoding&#x3D;&quot;UTF-8&quot; path&#x3D;&quot;liquibase&#x2F;data&#x2F;init-schema-1.sql&quot;&#x2F;&gt; &lt;&#x2F;changeSet&gt; &lt;changeSet id&#x3D;&quot;00000000000003&quot; author&#x3D;&quot;ehzyil&quot;&gt; &lt;sqlFile dbms&#x3D;&quot;mysql&quot; endDelimiter&#x3D;&quot;;&quot; encoding&#x3D;&quot;UTF-8&quot; path&#x3D;&quot;liquibase&#x2F;data&#x2F;init-data.sql&quot;&#x2F;&gt; &lt;&#x2F;changeSet&gt; &lt;!-- å¯ä»¥æ·»åŠ æ›´å¤šçš„changeSetæ¥å®šä¹‰å…¶ä»–è¡¨ç»“æ„å’Œåˆå§‹æ•°æ® --&gt; &lt;&#x2F;databaseChangeLog&gt; è¯´æ˜ï¼šâ—changeSet æ ‡ç­¾ï¼Œidå¿…é¡»å”¯ä¸€ï¼Œä¸èƒ½å‡ºç°å†²çªâ—sqlFile é‡Œé¢çš„pathï¼Œå¯¹åº”çš„å¯ä»¥æ˜¯æ ‡å‡†çš„sqlæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯xmlæ ¼å¼çš„æ•°æ®åº“è¡¨å®šä¹‰ã€æ•°æ®åº“æ“ä½œæ–‡ä»¶â—ä¸€æ—¦å†™ä¸Šå»ï¼ŒchangeSetçš„é¡ºåºä¸è¦è°ƒæ•´ init-schema.sql CREATE TABLE &#96;user&#96; ( &#96;id&#96; int unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;ä¸»é”®ID&#39;, &#96;third_account_id&#96; varchar(128) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;ç¬¬ä¸‰æ–¹ç”¨æˆ·ID&#39;, &#96;user_name&#96; varchar(64) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;ç”¨æˆ·å&#39;, &#96;password&#96; varchar(128) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;å¯†ç &#39;, &#96;login_type&#96; tinyint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;ç™»å½•æ–¹å¼: 0-å¾®ä¿¡ç™»å½•ï¼Œ1-è´¦å·å¯†ç ç™»å½•&#39;, &#96;deleted&#96; tinyint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;æ˜¯å¦åˆ é™¤&#39;, &#96;create_time&#96; timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, &#96;update_time&#96; timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#39;æœ€åæ›´æ–°æ—¶é—´&#39;, PRIMARY KEY (&#96;id&#96;), KEY &#96;key_third_account_id&#96; (&#96;third_account_id&#96;), KEY &#96;user_name&#96; (&#96;user_name&#96;) ) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8mb4 COMMENT&#x3D;&#39;ç”¨æˆ·ç™»å½•è¡¨&#39;; é¡¹ç›®æ¼”ç¤ºé¡¹ç›®å¯åŠ¨ä¹‹åï¼Œä¸€åˆ‡æ­£å¸¸çš„è¯ï¼Œç›´æ¥è¿ä¸Šæ•°æ®åº“å¯ä»¥çœ‹åˆ°åº“è¡¨åˆ›å»ºæˆåŠŸï¼Œæ•°æ®ä¹Ÿåˆå§‹åŒ–å®Œæˆï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è§‚å¯Ÿæ§åˆ¶å°çš„è¾“å‡º æ³¨æ„äº‹é¡¹éå¸¸é‡è¦çš„ä¸€ä¸ªç‚¹æ˜¯ï¼Œä¸Šé¢çš„æ¯ä¸ªChangeSetåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå› æ­¤å½“æ‰§è¡Œå®Œæ¯•ä¹‹åå‘ç°ä¸å¯¹ï¼Œè¦å›æ»šæ€ä¹ˆåŠï¼Ÿæˆ–è€…åˆéœ€è¦ä¿®æ”¹æ€ä¹ˆåŠï¼Ÿ liquibase æä¾›äº†å›æ»šçš„æœºåˆ¶ï¼Œå½“ChangeSetæ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå¯¹åº”çš„sqlæ–‡ä»¶&#x2F;xmlæ–‡ä»¶ï¼ˆå³pathå®šä¹‰çš„æ–‡ä»¶ï¼‰ä¸å…è®¸å†ä¿®æ”¹ï¼Œå› ä¸ºdbä¸­ä¼šè®°å½•è¿™ä¸ªæ–‡ä»¶çš„md5ï¼Œå½“ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ä¹‹åï¼Œè¿™ä¸ªmd5ä¹Ÿä¼šéšä¹‹å‘ç”Ÿæ”¹å˜ å› æ­¤ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆï¼šæ–°å¢ä¸€ä¸ªchangeSet åˆ é™¤ DATABASECHANGELOG è¡¨ä¸­ changeSet idå¯¹åº”çš„è®°å½•ï¼Œç„¶åé‡æ–°èµ°ä¸€é DataSourcelnitializeré¦–æ¬¡åˆå§‹åŒ–æ–¹æ¡ˆ å¦‚ä½•ä½¿ç”¨DataSourceInitializeræ¥å®ç°è‡ªä¸»å¯æ§çš„æ•°æ®åˆå§‹åŒ– é¡¹ç›®æ­å»ºä¾èµ–é¦–å…ˆæ­å»ºä¸€ä¸ªæ ‡å‡†çš„SpringBooté¡¹ç›®å·¥ç¨‹ï¼Œç›¸å…³ç‰ˆæœ¬ä»¥åŠä¾èµ–å¦‚ä¸‹ &lt;dependency&gt; &lt;groupId&gt;mysql&lt;&#x2F;groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;&#x2F;artifactId&gt; &lt;version&gt;8.0.31&lt;&#x2F;version&gt; &lt;&#x2F;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;&#x2F;artifactId&gt; &lt;&#x2F;dependency&gt; é…ç½®æ³¨æ„å®ç°åˆå§‹åŒ–æ•°æ®åº“è¡¨æ“ä½œçš„æ ¸å¿ƒé…ç½®å°±åœ¨ä¸‹é¢ï¼Œé‡ç‚¹å…³æ³¨ é…ç½®æ–‡ä»¶ï¼š resources/application.yml # é»˜è®¤çš„æ•°æ®åº“å database: name: story spring: datasource: url: jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;$&#123;database.name&#125;?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai username: root password: 666666 logging: level: root: info org: springframework: jdbc: core: debug resources/init_data/init-schema.sql å¯¹åº”çš„åˆå§‹åŒ–ddl CREATE TABLE &#96;user&#96; ( &#96;id&#96; int unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;ä¸»é”®ID&#39;, &#96;third_account_id&#96; varchar(128) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;ç¬¬ä¸‰æ–¹ç”¨æˆ·ID&#39;, &#96;user_name&#96; varchar(64) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;ç”¨æˆ·å&#39;, &#96;password&#96; varchar(128) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;å¯†ç &#39;, &#96;login_type&#96; tinyint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;ç™»å½•æ–¹å¼: 0-å¾®ä¿¡ç™»å½•ï¼Œ1-è´¦å·å¯†ç ç™»å½•&#39;, &#96;deleted&#96; tinyint NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;æ˜¯å¦åˆ é™¤&#39;, &#96;create_time&#96; timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, &#96;update_time&#96; timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT &#39;æœ€åæ›´æ–°æ—¶é—´&#39;, PRIMARY KEY (&#96;id&#96;), KEY &#96;key_third_account_id&#96; (&#96;third_account_id&#96;), KEY &#96;user_name&#96; (&#96;user_name&#96;) ) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8mb4 COMMENT&#x3D;&#39;ç”¨æˆ·ç™»å½•è¡¨&#39;; resources/init_data/init-data.sql å¯¹ç”¨çš„åˆå§‹åŒ–dml INSERT INTO &#96;user&#96; (id, third_account_id, &#96;user_name&#96;, &#96;password&#96;, login_type, deleted) VALUES (1, &#39;a7cb7228-0f85-4dd5-845c-7c5df3746e92&#39;, &#39;admin&#39;, &#39;admin&#39;, 0, 0); åˆå§‹åŒ–åˆå§‹åŒ–é…ç½® @Slf4j @Configuration public class DataSourceInit &#123; //éœ€è¦åˆå§‹åŒ–çš„è¡¨ç»“æ„ @Value(\"classpath:init_data/init-schema.sql\") private Resource initDataSource; //åˆå§‹åŒ–æ•°æ® @Value(\"classpath:init_data/init-data.sql\") private Resource initData; //æ•°æ®åº“å @Value(\"$&#123;database.name&#125;\") private String dataBaseName; @Bean public DataSourceInitializer dataSourceInitializer(final DataSource dataSource) &#123; final DataSourceInitializer initializer = new DataSourceInitializer(); // è®¾ç½®æ•°æ®æº initializer.setDataSource(dataSource); // è®¾ç½®æ•°æ®åº“Populator initializer.setDatabasePopulator(databasePopulator()); // trueè¡¨ç¤ºéœ€è¦æ‰§è¡Œï¼Œfalseè¡¨ç¤ºä¸éœ€è¦åˆå§‹åŒ– initializer.setEnabled(needInit(dataSource)); return initializer; &#125; /** * è®¾ç½®æ•°æ®æº * &lt;span>åˆ›å»ºäº†ä¸€ä¸ªResourceDatabasePopulatorå¯¹è±¡ï¼Œå¹¶æ·»åŠ äº†ä¸¤ä¸ªSQLè„šæœ¬æ–‡ä»¶åˆ°å…¶ä¸­ï¼Œç”¨åˆ†å·ä½œä¸ºåˆ†éš”ç¬¦ã€‚æœ€åå°†è¿™ä¸ªpopulatorå¯¹è±¡è¿”å›ã€‚&lt;/span> * * @return */ private DatabasePopulator databasePopulator() &#123; final ResourceDatabasePopulator populator = new ResourceDatabasePopulator(); populator.addScripts(initDataSource); populator.addScripts(initData); populator.setSeparator(\";\"); return populator; &#125; &#125; æˆ‘ä»¬è¿™é‡Œä¸»è¦æ˜¯å€ŸåŠ© DataSourceInitializer æ¥å®ç°åˆå§‹åŒ–ï¼Œå…¶æ ¸å¿ƒæœ‰ä¸¤ä¸ªé…ç½® DatabasePopulator: é€šè¿‡addScriptsæ¥æŒ‡å®šå¯¹åº”çš„sqlæ–‡ä»¶ DataSourceInitializer#setEnabled: åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰§è¡Œåˆå§‹åŒ– æ¥ä¸‹æ¥é‡ç‚¹éœ€è¦çœ‹çš„å°±æ˜¯needInitæ–¹æ³•ï¼Œæˆ‘ä»¬å†è¿™ä¸ªæ–¹æ³•é‡Œé¢ï¼Œéœ€è¦åˆ¤æ–­æ•°æ®åº“æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨æ—¶ï¼Œåˆ™åˆ›å»ºæ•°æ®åº“ï¼›ç„¶åå†åˆ¤æ–­è¡¨æ˜¯å¦å­˜åœ¨ï¼Œä»¥æ­¤æ¥å†³å®šæ˜¯å¦éœ€è¦æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³• /** * åˆ¤æ–­æ˜¯å¦éœ€è¦åˆå§‹åŒ– * * @param dataSource * @return */ private boolean needInit(DataSource dataSource) &#123; if (autoInitDatabase()) &#123; return true; &#125; // æ ¹æ®æ˜¯å¦å­˜åœ¨è¡¨æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰§è¡Œsqlæ“ä½œ JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource); List&lt;Map&lt;String, Object>> list = jdbcTemplate.queryForList(\"SELECT table_name FROM information_schema.TABLES where table_name = 'user' and table_schema = '\" + dataBaseName + \"'\"); boolean init = CollectionUtils.isEmpty(list); if (init) &#123; log.info(\"åº“è¡¨ä¸å­˜åœ¨ï¼Œæ‰§è¡Œå»ºè¡¨åŠæ•°æ®åˆå§‹åŒ–\"); &#125; else &#123; log.info(\"è¡¨ç»“æ„å·²å­˜åœ¨ï¼Œæ— éœ€åˆå§‹åŒ–\"); &#125; return init; &#125; /** * æ•°æ®åº“ä¸å­˜åœ¨æ—¶ï¼Œå°è¯•åˆ›å»ºæ•°æ®åº“ * * @return */ private boolean autoInitDatabase() &#123; // æŸ¥è¯¢å¤±è´¥ï¼Œå¯èƒ½æ˜¯æ•°æ®åº“ä¸å­˜åœ¨ï¼Œå°è¯•åˆ›å»ºæ•°æ®åº“ä¹‹åå†æ¬¡æµ‹è¯• //jdbc:mysql://127.0.0.1:3306/story?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai //mysql://127.0.0.1:3306/story?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai URI url = URI.create(SpringUtil.getConfig(\"spring.datasource.url\").substring(5)); String uname = SpringUtil.getConfig(\"spring.datasource.username\"); String pwd = SpringUtil.getConfig(\"spring.datasource.password\"); try (Connection connection = DriverManager.getConnection(\"jdbc:mysql://\" + url.getHost() + \":\" + url.getPort() + \"?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false\", uname, pwd); Statement statement = connection.createStatement()) &#123; ResultSet set = statement.executeQuery(\"select schema_name from information_schema.schemata where schema_name='\" + dataBaseName + \"'\"); if (!set.next()) &#123; String createDb = \"create database if not exists \" + dataBaseName; connection.setAutoCommit(false); statement.execute(createDb); connection.commit(); log.info(\"åˆ›å»ºæ•°æ®åº“ï¼ˆ&#123;&#125;ï¼‰æˆåŠŸ\", createDb); if (set.isClosed()) &#123; set.close(); &#125; return true; &#125; set.close(); log.info(\"æ•°æ®åº“å·²å­˜åœ¨ï¼Œæ— éœ€åˆå§‹åŒ–\"); return false; &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; &#125; ä¸Šé¢çš„æ•°æ®åº“åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä»¥åŠåˆå§‹åŒ–çš„è¿‡ç¨‹ç›¸å¯¹åŸºç¡€ï¼Œç›´æ¥ä½¿ç”¨äº†åŸºç¡€çš„Connectionè¿›è¡Œæ“ä½œï¼›è¿™é‡Œå€ŸåŠ©äº†SpringUtilæ¥è·å–é…ç½®ä¿¡æ¯ï¼Œå¯¹åº”çš„ç±»æºç å¦‚ä¸‹ @Component public class SpringUtil implements ApplicationContextAware, EnvironmentAware &#123; private static ApplicationContext context; private static Environment environment; /** * è·å–bean * * @param bean * @param &lt;T> * @return */ public static &lt;T> T getBean(Class&lt;T> bean) &#123; return context.getBean(bean); &#125; public static Object getBean(String beanName) &#123; return context.getBean(beanName); &#125; /** * è·å–é…ç½® * * @param key * @return */ public static String getConfig(String key) &#123; return environment.getProperty(key); &#125; /** * å‘å¸ƒäº‹ä»¶æ¶ˆæ¯ * * @param event */ public static void publishEvent(ApplicationEvent event) &#123; context.publishEvent(event); &#125; @Override public void setApplicationContext(ApplicationContext applicationContext) throws BeansException &#123; SpringUtil.context = applicationContext; &#125; @Override public void setEnvironment(Environment environment) &#123; SpringUtil.environment = environment; &#125; &#125; Springbootå¯åŠ¨ç±»é…ç½®å¦‚ä¸‹ï¼š @Slf4j @SpringBootApplication public class LiquibaseApplication implements ApplicationRunner &#123; @Autowired private JdbcTemplate jdbcTemplate; public static void main(String[] args) &#123; SpringApplication.run(LiquibaseApplication.class); &#125; @Override public void run(ApplicationArguments args) throws Exception &#123; List list &#x3D; jdbcTemplate.queryForList(&quot;select * from user limit 2&quot;); log.info(&quot;å¯åŠ¨æˆåŠŸï¼Œåˆå§‹åŒ–æ•°æ®: &#123;&#125;\\n&#123;&#125;&quot;, list.size(), list); &#125; &#125; é¡¹ç›®æ¼”ç¤ºåˆ é™¤åŸæœ‰çš„storyæ•°æ®åº“ï¼Œå¯åŠ¨é¡¹ç›®ï¼ŒæˆåŠŸæ‰§è¡Œç»“æœå¦‚ä¸‹ ä¸¤ç§åˆå§‹åŒ–æ–¹å¼ç»“åˆçš„å®è·µæ–¹æ¡ˆ ç¬¬ä¸€æ¬¡å¯åŠ¨é¡¹ç›®æ—¶é€‰æ‹©æœªå¼€å¯liquibaseï¼Œç¬¬äºŒæ¬¡å¼€å¯liquibaseæ—¶ä¼šæŠ¥é”™ï¼Œå› ä¸º databasechangelogè¡¨æœªåˆ›å»ºï¼Œå› æ­¤è¯·é€‰å‡†ä¸€ç§å¯åŠ¨æ–¹å¼ã€‚ åº“åˆå§‹åŒ–/** * æ•°æ®åº“ä¸å­˜åœ¨æ—¶ï¼Œå°è¯•åˆ›å»ºæ•°æ®åº“&lt;br> * &lt;span> * autoInitDatabaseæ–¹æ³•ç”¨äºè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œé¦–å…ˆä»é…ç½®æ–‡ä»¶ä¸­è·å–æ•°æ®åº“è¿æ¥URLã€ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶é€šè¿‡DriverManageråˆ›å»ºæ•°æ®åº“è¿æ¥å’ŒStatementå¯¹è±¡ã€‚ * ç„¶åé€šè¿‡æ‰§è¡ŒæŸ¥è¯¢è¯­å¥åˆ¤æ–­æ•°æ®åº“æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æ‰§è¡Œåˆ›å»ºæ•°æ®åº“çš„sqlè¯­å¥ï¼Œå¹¶æ‰“å°ç›¸åº”æ—¥å¿—ã€‚ * &lt;/span> * * @return æ˜¯å¦æˆåŠŸåˆ›å»ºæ•°æ®åº“ */ private boolean autoInitDatabase() &#123; // æŸ¥è¯¢å¤±è´¥ï¼Œå¯èƒ½æ˜¯æ•°æ®åº“ä¸å­˜åœ¨ï¼Œå°è¯•åˆ›å»ºæ•°æ®åº“ä¹‹åå†æ¬¡æµ‹è¯• //jdbc:mysql://127.0.0.1:3306/story?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai //mysql://127.0.0.1:3306/story?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai URI url = URI.create(SpringUtil.getConfig(\"spring.datasource.url\").substring(5)); String uname = SpringUtil.getConfig(\"spring.datasource.username\"); String pwd = SpringUtil.getConfig(\"spring.datasource.password\"); try (Connection connection = DriverManager.getConnection(\"jdbc:mysql://\" + url.getHost() + \":\" + url.getPort() + \"?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false\", uname, pwd); Statement statement = connection.createStatement()) &#123; ResultSet set = statement.executeQuery(\"select schema_name from information_schema.schemata where schema_name='\" + database + \"'\"); if (!set.next()) &#123; String createDb = \"create database if not exists \" + database; connection.setAutoCommit(false); statement.execute(createDb); connection.commit(); log.info(\"åˆ›å»ºæ•°æ®åº“ï¼ˆ&#123;&#125;ï¼‰æˆåŠŸ\", createDb); if (set.isClosed()) &#123; set.close(); &#125; return true; &#125; set.close(); log.info(\"æ•°æ®åº“å·²å­˜åœ¨ï¼Œæ— éœ€åˆå§‹åŒ–\"); return false; &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; &#125; ä¸Šé¢çš„å®ç°æ¯”è¾ƒæ¸…æ™°äº†ï¼Œé¦–å…ˆæ˜¯åˆ¤æ–­åº“æ˜¯å¦å­˜åœ¨ï¼ŒautoInitDatabaseæ–¹æ³•ç”¨äºè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œé¦–å…ˆä»é…ç½®æ–‡ä»¶ä¸­è·å–æ•°æ®åº“è¿æ¥URLã€ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶é€šè¿‡DriverManageråˆ›å»ºæ•°æ®åº“è¿æ¥å’ŒStatementå¯¹è±¡ã€‚ç„¶åé€šè¿‡æ‰§è¡ŒæŸ¥è¯¢è¯­å¥åˆ¤æ–­æ•°æ®åº“æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æ‰§è¡Œåˆ›å»ºæ•°æ®åº“çš„sqlè¯­å¥ï¼Œå¹¶æ‰“å°ç›¸åº”æ—¥å¿—ã€‚ ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ spring.datasource.url æ¥åˆ›å»ºè¿æ¥ï¼Ÿå› ä¸ºåº“ä¸å­˜åœ¨æ—¶ï¼Œç›´æ¥ä½¿ç”¨ä¸‹é¢è¿™ä¸ªurlè¿›è¡Œè¿æ¥ä¼šæŠ›è¿æ¥å¼‚å¸¸ è¡¨åˆå§‹åŒ–è¡¨çš„åˆå§‹åŒ–ï¼Œå…¶å®å¯ä»¥ç†è§£ä¸ºé¡¹ç›®å¯åŠ¨ä¹‹åæ‰§è¡Œä¸€äº›sqlï¼Œè¿™æ—¶ä¸»è¦å€ŸåŠ©çš„å°±æ˜¯ initializer.setDatabasePopulatoræ ¸å¿ƒçŸ¥è¯†ç‚¹æˆ‘ä»¬ä½¿ç”¨DbChangeSetLoader ç±»æ¥å®ç°åˆå§‹åŒ–sqlçš„åŠ è½½ï¼Œä½†å®é™…ä¸Šï¼Œè‹¥ä½ å®Œå…¨æŠ›å¼€Liquibaseï¼Œå•çº¯çš„å¸Œæœ›é¡¹ç›®å¯åŠ¨åæ‰§è¡ŒæŸäº›sqlï¼Œå¯ä»¥éå¸¸ç®€å•çš„å®ç°ï¼Œç›´æ¥ç”¨DataSourcelnitializeré¦–æ¬¡åˆå§‹åŒ–æ–¹æ¡ˆä¸­å†™çš„é€šè¿‡ @Value æ¥åŠ è½½éœ€è¦åˆå§‹åŒ–çš„sqlæ–‡ä»¶ï¼Œç›´æ¥é€šè¿‡ ResourceDatabasePoplulator æ·»åŠ sqlèµ„æºå°±å¯ä»¥äº† /** * æ£€æµ‹ä¸€ä¸‹æ•°æ®åº“ä¸­è¡¨æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™ä¸åˆå§‹åŒ–ï¼› * * @param dataSource * @return true è¡¨ç¤ºéœ€è¦åˆå§‹åŒ–ï¼› false è¡¨ç¤ºæ— éœ€åˆå§‹åŒ– */ private boolean needInit(DataSource dataSource) &#123; if (autoInitDatabase()) &#123; return true; //ä¸å­˜åœ¨ä¸”å·²åˆ›å»º &#125; //å·²å­˜åœ¨çš„æ‰§è¡Œé€»è¾‘ // æ ¹æ®æ˜¯å¦å­˜åœ¨è¡¨æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰§è¡Œsqlæ“ä½œ JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource); if (!liquibaseEnable) &#123; // éliquibaseåšæ•°æ®åº“ç‰ˆæœ¬ç®¡ç†çš„ï¼Œæ ¹æ®ç”¨æˆ·æ¥åˆ¤æ–­æ˜¯å¦æœ‰åˆå§‹åŒ– List list = jdbcTemplate.queryForList(\"SELECT table_name FROM information_schema.TABLES where table_name = 'user_info' and table_schema = '\" + database + \"';\"); return CollectionUtils.isEmpty(list); &#125; // å¯¹äºliquibaseåšæ•°æ®ç‰ˆæœ¬ç®¡æ§çš„åœºæ™¯ï¼Œè‹¥ä½¿ç”¨çš„ä¸æ˜¯é»˜è®¤çš„pai_codingï¼Œåˆ™éœ€è¦è¿›è¡Œä¿®è®¢ List&lt;Map&lt;String, Object>> record = jdbcTemplate.queryForList(\"select * from DATABASECHANGELOG where ID='00000000000020' limit 1;\"); if (CollectionUtils.isEmpty(record)) &#123; // é¦–æ¬¡å¯åŠ¨ï¼Œéœ€è¦åˆå§‹åŒ–åº“è¡¨ï¼Œç›´æ¥è¿”å› return true; &#125; // éé¦–æ¬¡å¯åŠ¨æ—¶ï¼Œåˆ¤æ–­è®°å½•å¯¹åº”çš„md5æ˜¯å¦å‡†ç¡® if (Objects.equals(record.get(0).get(\"MD5SUM\"), \"8:a1a2d9943b746acf58476ae612c292fc\")) &#123; jdbcTemplate.update(\"update DATABASECHANGELOG set MD5SUM='8:bb81b67a5219be64eff22e2929fed540' where ID='00000000000020'\"); &#125; return false; &#125; needInitæ–¹æ³•ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦åˆå§‹åŒ–æ•°æ®åº“ã€‚è¯¥æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªDataSourceå¯¹è±¡ï¼Œè¡¨ç¤ºæ•°æ®æºã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ï¼Œå¦‚æœéœ€è¦åˆ™è¿”å›trueã€‚ç„¶åé€šè¿‡JdbcTemplateæŸ¥è¯¢æ˜¯å¦å­˜åœ¨è¡¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™éœ€è¦åˆå§‹åŒ–æ•°æ®åº“ï¼Œå¹¶æ‰“å°ç›¸åº”æ—¥å¿—ï¼Œå¦åˆ™ä¸éœ€è¦åˆå§‹åŒ–å¹¶æ‰“å°ç›¸åº”æ—¥å¿—ã€‚ æ ¸å¿ƒçŸ¥è¯†ç‚¹Liquibaseå…¼å®¹æ–¹æ¡ˆdataSourceInitializer(final DataSource dataSource)ç”¨äºåˆå§‹åŒ–æ•°æ®æºï¼Œè¿”å›ä¸€ä¸ªDataSourceInitializerçš„Beanã€‚è¯¥æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªDataSourceå¯¹è±¡ï¼Œè¡¨ç¤ºæ•°æ®æºã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œåˆ›å»ºäº†ä¸€ä¸ªDataSourceInitializerå¯¹è±¡ï¼Œè®¾ç½®æ•°æ®æºä¸ºä¼ å…¥çš„å‚æ•°ï¼Œå¹¶æ ¹æ®æ˜¯å¦éœ€è¦åˆå§‹åŒ–æ•°æ®åº“è®¾ç½®å¯ç”¨çŠ¶æ€å’Œæ•°æ®åº“ç»“æ„åˆå§‹åŒ–çš„Populatorã€‚ databasePopulatoræ–¹æ³•ç”¨äºåˆ›å»ºDatabasePopulatorå¯¹è±¡ï¼Œç”¨äºæ•°æ®åº“ç»“æ„åˆå§‹åŒ–ã€‚è¯¥æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªæ˜¯å¦éœ€è¦åˆå§‹åŒ–çš„æ ‡å¿—ï¼Œæ ¹æ®è¯¥æ ‡å¿—è¿›è¡Œä¸åŒçš„æ“ä½œã€‚å¦‚æœä¸éœ€è¦åˆå§‹åŒ–ä¸”ä¸ä½¿ç”¨Liquibaseç®¡ç†æ•°æ®åº“ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªResourceDatabasePopulatorå¯¹è±¡ï¼Œå¹¶é€šè¿‡addScriptsæ–¹æ³•æ·»åŠ éœ€è¦æ‰§è¡Œçš„sqlè„šæœ¬ï¼Œé€šè¿‡setSeparatoræ–¹æ³•è®¾ç½®sqlè¯­å¥çš„åˆ†éš”ç¬¦ã€‚ @Value(\"$&#123;database.name&#125;\") private String database; // ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–æ•°æ®åº“åç§° @Value(\"$&#123;spring.liquibase.enabled:true&#125;\") private Boolean liquibaseEnable; // ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–æ˜¯å¦ä½¿ç”¨Liquibaseç®¡ç†æ•°æ®åº“çš„é…ç½® @Value(\"$&#123;spring.liquibase.change-log&#125;\") private String liquibaseChangeLog; // ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–Liquibaseçš„change-logé…ç½® /** * åˆå§‹åŒ–æ•°æ®æºï¼Œè¿”å›DataSourceInitializer Bean&lt;br> * * * @param dataSource æ•°æ®æº * @return DataSourceInitializer */ @Bean public org.springframework.jdbc.datasource.init.DataSourceInitializer dataSourceInitializer(final DataSource dataSource) &#123; final org.springframework.jdbc.datasource.init.DataSourceInitializer initializer = new org.springframework.jdbc.datasource.init.DataSourceInitializer(); // è®¾ç½®æ•°æ®æº initializer.setDataSource(dataSource); boolean enable = needInit(dataSource); initializer.setEnabled(enable); initializer.setDatabasePopulator(databasePopulator(enable)); return initializer; &#125; /** * åˆ›å»ºDatabasePopulatorå¯¹è±¡ï¼Œç”¨äºæ•°æ®åº“ç»“æ„åˆå§‹åŒ–&lt;br> * @param initEnable æ˜¯å¦éœ€è¦åˆå§‹åŒ– * @return DatabasePopulator */ private DatabasePopulator databasePopulator(boolean initEnable) &#123; final ResourceDatabasePopulator populator = new ResourceDatabasePopulator(); if (!liquibaseEnable &amp;&amp; initEnable) &#123; // fixme: é¦–æ¬¡å¯åŠ¨æ—¶, å¯¹äºä¸æ”¯æŒliquibaseçš„æ•°æ®åº“ï¼Œå¦‚mariadbï¼Œé‡‡ç”¨ä¸»åŠ¨åˆå§‹åŒ– // fixme è¿™ç§æ–¹å¼ä¸æ”¯æŒåç»­åŠ¨æ€çš„æ•°æ®è¡¨ç»“æ„æ›´æ–°ã€æ•°æ®å˜æ›´ populator.addScripts(XmlParserUtils.loadDbChangeSetResources(liquibaseChangeLog).toArray(new ClassPathResource[]&#123;&#125;)); populator.setSeparator(\";\"); log.info(\"éLiquibaseç®¡ç†æ•°æ®åº“ï¼Œè¯·æ‰‹åŠ¨æ‰§è¡Œæ•°æ®åº“è¡¨åˆå§‹åŒ–!\"); &#125; return populator; &#125; XmlParserUtils.loadDbChangeSetResources(liquibaseChangeLog).toArray(new ClassPathResource[]&#123;&#125;)ç”¨äºè¯»å–é…ç½®æ–‡ä»¶ä¸­çš„change-log: classpath:liquibase/master.xmlæ¥è·å–liquibaseçš„ChangeLogä»è€Œè·å–åˆ°æ‰€æœ‰çš„sqlè„šæœ¬ã€‚ æ³¨æ„ä¸Šé¢çš„å®ç°ï¼šæˆ‘ä»¬ä¾ç„¶å€ŸåŠ©äº†Liquibase çš„xmlæ–‡ä»¶æ¥è§£ææ¥åŠ è½½å¯¹åº”çš„æ•°æ®åº“è¡¨å˜æ›´å†å²sqlã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé‡‡ç”¨DataSourceInitializeråˆå§‹åŒ–æ–¹æ¡ˆï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼›å½“ä½ ä»githubä¸Šæ‹‰äº†ä»£ç æœ¬åœ°æ‰§è¡Œä¹‹åï¼Œåç»­å†æ‹‰æ–°çš„ä»£ç ï¼Œæœ‰æ–°çš„å˜æ›´æ—¶ï¼Œè¿™äº›æ–°çš„å˜æ›´éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼Œéœ€è¦æˆ‘ä»¬åˆ é™¤æ•°æ®åº“æˆ–åˆ é™¤ DATABASECHANGELOG è¡¨ä¸­ changeSet idå¯¹åº”çš„è®°å½•ï¼Œç„¶åé‡æ–°èµ°ä¸€éã€‚ æ‰§è¡Œç»“æœ æœªåˆ›å»ºæ•°æ®åº“çš„æƒ…å†µ å·²åˆ›å»ºæ•°æ®åº“çš„æƒ…å†µ ä¸å¯ç”¨liquibase æœªå»ºåº“ spring: liquibase: change-log: classpath:liquibase&#x2F;master.xml enabled: false # å½“å®é™…ä½¿ç”¨çš„æ•°æ®åº“ä¸æ”¯æŒliquibaseï¼Œå¦‚ mariadb æ—¶ï¼Œå°†è¿™ä¸ªå‚æ•°è®¾ç½®ä¸ºfalse é™„ä¸Šä¸»è¦ç±»çš„ä»£ç  @Slf4j @Configuration public class ForumDataSourceInitializer &#123; @Value(&quot;$&#123;database.name&#125;&quot;) private String database; &#x2F;&#x2F; ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–æ•°æ®åº“åç§° @Value(&quot;$&#123;spring.liquibase.enabled:true&#125;&quot;) private Boolean liquibaseEnable; &#x2F;&#x2F; ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–æ˜¯å¦ä½¿ç”¨Liquibaseç®¡ç†æ•°æ®åº“çš„é…ç½® @Value(&quot;$&#123;spring.liquibase.change-log&#125;&quot;) private String liquibaseChangeLog; &#x2F;&#x2F; ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–Liquibaseçš„change-logé…ç½® &#x2F;** * åˆå§‹åŒ–æ•°æ®æºï¼Œè¿”å›DataSourceInitializer Bean&lt;br&gt; * &lt;span&gt;ç”¨äºåˆå§‹åŒ–æ•°æ®æºï¼Œè¿”å›ä¸€ä¸ªDataSourceInitializerçš„Beanã€‚ * è¯¥æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªDataSourceå¯¹è±¡ï¼Œè¡¨ç¤ºæ•°æ®æºã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œåˆ›å»ºäº†ä¸€ä¸ªDataSourceInitializerå¯¹è±¡ï¼Œ * è®¾ç½®æ•°æ®æºä¸ºä¼ å…¥çš„å‚æ•°ï¼Œå¹¶æ ¹æ®æ˜¯å¦éœ€è¦åˆå§‹åŒ–æ•°æ®åº“è®¾ç½®å¯ç”¨çŠ¶æ€å’Œæ•°æ®åº“ç»“æ„åˆå§‹åŒ–çš„Populatorã€‚ &lt;&#x2F;span&gt; * * @param dataSource æ•°æ®æº * @return DataSourceInitializer *&#x2F; @Bean public org.springframework.jdbc.datasource.init.DataSourceInitializer dataSourceInitializer(final DataSource dataSource) &#123; final org.springframework.jdbc.datasource.init.DataSourceInitializer initializer &#x3D; new org.springframework.jdbc.datasource.init.DataSourceInitializer(); &#x2F;&#x2F; è®¾ç½®æ•°æ®æº initializer.setDataSource(dataSource); boolean enable &#x3D; needInit(dataSource); initializer.setEnabled(enable); initializer.setDatabasePopulator(databasePopulator(enable)); return initializer; &#125; &#x2F;** * åˆ›å»ºDatabasePopulatorå¯¹è±¡ï¼Œç”¨äºæ•°æ®åº“ç»“æ„åˆå§‹åŒ–&lt;br&gt; * &lt;span&gt;databasePopulatoræ–¹æ³•ç”¨äºåˆ›å»ºDatabasePopulatorå¯¹è±¡ï¼Œç”¨äºæ•°æ®åº“ç»“æ„åˆå§‹åŒ–ã€‚è¯¥æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªæ˜¯å¦éœ€è¦åˆå§‹åŒ–çš„æ ‡å¿—ï¼Œæ ¹æ®è¯¥æ ‡å¿—è¿›è¡Œä¸åŒçš„æ“ä½œã€‚ * å¦‚æœä¸éœ€è¦åˆå§‹åŒ–ä¸”ä¸ä½¿ç”¨Liquibaseç®¡ç†æ•°æ®åº“ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªResourceDatabasePopulatorå¯¹è±¡ï¼Œå¹¶é€šè¿‡addScriptsæ–¹æ³•æ·»åŠ éœ€è¦æ‰§è¡Œçš„sqlè„šæœ¬ï¼Œ * é€šè¿‡setSeparatoræ–¹æ³•è®¾ç½®sqlè¯­å¥çš„åˆ†éš”ç¬¦ã€‚&lt;&#x2F;span&gt; * * @param initEnable æ˜¯å¦éœ€è¦åˆå§‹åŒ– * @return DatabasePopulator *&#x2F; private DatabasePopulator databasePopulator(boolean initEnable) &#123; final ResourceDatabasePopulator populator &#x3D; new ResourceDatabasePopulator(); if (!liquibaseEnable &amp;&amp; initEnable) &#123; &#x2F;&#x2F; fixme: é¦–æ¬¡å¯åŠ¨æ—¶, å¯¹äºä¸æ”¯æŒliquibaseçš„æ•°æ®åº“ï¼Œå¦‚mariadbï¼Œé‡‡ç”¨ä¸»åŠ¨åˆå§‹åŒ– &#x2F;&#x2F; fixme è¿™ç§æ–¹å¼ä¸æ”¯æŒåç»­åŠ¨æ€çš„æ•°æ®è¡¨ç»“æ„æ›´æ–°ã€æ•°æ®å˜æ›´ populator.addScripts(XmlParserUtils.loadDbChangeSetResources(liquibaseChangeLog).toArray(new ClassPathResource[]&#123;&#125;)); populator.setSeparator(&quot;;&quot;); log.info(&quot;éLiquibaseç®¡ç†æ•°æ®åº“ï¼Œè¯·æ‰‹åŠ¨æ‰§è¡Œæ•°æ®åº“è¡¨åˆå§‹åŒ–!&quot;); &#125; return populator; &#125; &#x2F;** * åˆ¤æ–­æ˜¯å¦éœ€è¦åˆå§‹åŒ–æ•°æ®åº“&lt;br&gt; * * &lt;span&gt; * needInitæ–¹æ³•ç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦åˆå§‹åŒ–æ•°æ®åº“ã€‚è¯¥æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªDataSourceå¯¹è±¡ï¼Œè¡¨ç¤ºæ•°æ®æºã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ï¼Œå¦‚æœéœ€è¦åˆ™è¿”å›trueã€‚ * ç„¶åé€šè¿‡JdbcTemplateæŸ¥è¯¢æ˜¯å¦å­˜åœ¨è¡¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™éœ€è¦åˆå§‹åŒ–æ•°æ®åº“ï¼Œå¹¶æ‰“å°ç›¸åº”æ—¥å¿—ï¼Œå¦åˆ™ä¸éœ€è¦åˆå§‹åŒ–å¹¶æ‰“å°ç›¸åº”æ—¥å¿—ã€‚ * &lt;&#x2F;span&gt; * * @param dataSource æ•°æ®æº * @return æ˜¯å¦éœ€è¦åˆå§‹åŒ– *&#x2F; private boolean needInit(DataSource dataSource) &#123; &#x2F;&#x2F; åˆ›å»ºæ•°æ®åº“ if (autoInitDatabase()) &#123; return true; &#125; &#x2F;&#x2F; æ ¹æ®æ˜¯å¦å­˜åœ¨è¡¨æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰§è¡Œsqlæ“ä½œ JdbcTemplate jdbcTemplate &#x3D; new JdbcTemplate(dataSource); List&lt;Map&lt;String, Object&gt;&gt; list &#x3D; jdbcTemplate.queryForList(&quot;SELECT table_name FROM information_schema.TABLES where table_name &#x3D; &#39;user&#39; and table_schema &#x3D; &#39;&quot; + database + &quot;&#39;&quot;); boolean init &#x3D; CollectionUtils.isEmpty(list); if (init) &#123; log.info(&quot;åº“è¡¨ä¸å­˜åœ¨ï¼Œå³å°†æ‰§è¡Œå»ºè¡¨åŠæ•°æ®åˆå§‹åŒ–&quot;); &#125; else &#123; log.info(&quot;è¡¨ç»“æ„å·²å­˜åœ¨ï¼Œæ— éœ€åˆå§‹åŒ–&quot;); &#125; return init; &#125; &#x2F;** * æ•°æ®åº“ä¸å­˜åœ¨æ—¶ï¼Œå°è¯•åˆ›å»ºæ•°æ®åº“&lt;br&gt; * &lt;span&gt; * autoInitDatabaseæ–¹æ³•ç”¨äºè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œé¦–å…ˆä»é…ç½®æ–‡ä»¶ä¸­è·å–æ•°æ®åº“è¿æ¥URLã€ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶é€šè¿‡DriverManageråˆ›å»ºæ•°æ®åº“è¿æ¥å’ŒStatementå¯¹è±¡ã€‚ * ç„¶åé€šè¿‡æ‰§è¡ŒæŸ¥è¯¢è¯­å¥åˆ¤æ–­æ•°æ®åº“æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æ‰§è¡Œåˆ›å»ºæ•°æ®åº“çš„sqlè¯­å¥ï¼Œå¹¶æ‰“å°ç›¸åº”æ—¥å¿—ã€‚ * &lt;&#x2F;span&gt; * * @return æ˜¯å¦æˆåŠŸåˆ›å»ºæ•°æ®åº“ *&#x2F; private boolean autoInitDatabase() &#123; &#x2F;&#x2F; æŸ¥è¯¢å¤±è´¥ï¼Œå¯èƒ½æ˜¯æ•°æ®åº“ä¸å­˜åœ¨ï¼Œå°è¯•åˆ›å»ºæ•°æ®åº“ä¹‹åå†æ¬¡æµ‹è¯• &#x2F;&#x2F;jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;story?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai &#x2F;&#x2F;mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;story?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&amp;serverTimezone&#x3D;Asia&#x2F;Shanghai URI url &#x3D; URI.create(SpringUtil.getConfig(&quot;spring.datasource.url&quot;).substring(5)); String uname &#x3D; SpringUtil.getConfig(&quot;spring.datasource.username&quot;); String pwd &#x3D; SpringUtil.getConfig(&quot;spring.datasource.password&quot;); try (Connection connection &#x3D; DriverManager.getConnection(&quot;jdbc:mysql:&#x2F;&#x2F;&quot; + url.getHost() + &quot;:&quot; + url.getPort() + &quot;?useUnicode&#x3D;true&amp;characterEncoding&#x3D;UTF-8&amp;useSSL&#x3D;false&quot;, uname, pwd); Statement statement &#x3D; connection.createStatement()) &#123; ResultSet set &#x3D; statement.executeQuery(&quot;select schema_name from information_schema.schemata where schema_name&#x3D;&#39;&quot; + database + &quot;&#39;&quot;); if (!set.next()) &#123; String createDb &#x3D; &quot;create database if not exists &quot; + database; connection.setAutoCommit(false); statement.execute(createDb); connection.commit(); log.info(&quot;åˆ›å»ºæ•°æ®åº“ï¼ˆ&#123;&#125;ï¼‰æˆåŠŸ&quot;, createDb); if (set.isClosed()) &#123; set.close(); &#125; return true; &#125; set.close(); log.info(&quot;æ•°æ®åº“å·²å­˜åœ¨ï¼Œæ— éœ€åˆå§‹åŒ–&quot;); return false; &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; &#125; &#125; public class XmlParserUtils &#123; private static final Log logger &#x3D; LogFactory.getLog(XmlParserUtils.class); &#x2F;&#x2F; ç§æœ‰åŒ–getInstanceæ–¹æ³•ï¼Œç”¨äºè·å–XMLReaderå®ä¾‹ private static XMLReader xmlReader; private XmlParserUtils() &#123; &#x2F;&#x2F; é˜²æ­¢å®ä¾‹åŒ– &#125; public static List&lt;ClassPathResource&gt; loadDbChangeSetResources(String source) &#123; try &#123; XMLReader reader &#x3D; getXMLReader(); ChangeHandler logHandler &#x3D; new ChangeHandler(&quot;include&quot;, &quot;file&quot;); reader.setContentHandler(logHandler); Path path &#x3D; new ClassPathResource(source.replace(&quot;classpath:&quot;, &quot;&quot;)).getFile().toPath(); reader.parse(path.toString()); List&lt;String&gt; changeSetFiles &#x3D; logHandler.getSets(); List&lt;ClassPathResource&gt; result &#x3D; new ArrayList&lt;&gt;(); ChangeHandler setHandler &#x3D; new ChangeHandler(&quot;sqlFile&quot;, &quot;path&quot;); for (String set : changeSetFiles) &#123; reader.setContentHandler(setHandler); Path setPath &#x3D; new ClassPathResource(set).getFile().toPath(); reader.parse(setPath.toString()); result.addAll(setHandler.getSets().stream().map(ClassPathResource::new).collect(Collectors.toList())); setHandler.reset(); &#125; return result; &#125; catch (Exception e) &#123; throw new IllegalStateException(&quot;åŠ è½½åˆå§‹åŒ–è„šæœ¬å¼‚å¸¸!&quot;, e); &#125; &#125; private static XMLReader getXMLReader() throws ParserConfigurationException, SAXException &#123; if (xmlReader &#x3D;&#x3D; null) &#123; SAXParserFactory factory &#x3D; SAXParserFactory.newInstance(); xmlReader &#x3D; factory.newSAXParser().getXMLReader(); &#125; return xmlReader; &#125; public static class ChangeHandler extends DefaultHandler &#123; private final String tag; private final String attr; private List&lt;String&gt; sets &#x3D; new ArrayList&lt;&gt;(); &#x2F;** * æ„é€ å‡½æ•° * * @param tag æ ‡ç­¾ * @param attr å±æ€§ *&#x2F; public ChangeHandler(String tag, String attr) &#123; this.tag &#x3D; tag; this.attr &#x3D; attr; &#125; @Override public void startElement(String uri, String localName, String qName, Attributes attributes) throws SAXException &#123; if (tag.equals(qName)) &#123; sets.add(attributes.getValue(attr)); &#125; &#125; &#x2F;** * è·å–å˜æ›´è„šæœ¬åˆ—è¡¨ * * @return å˜æ›´è„šæœ¬åˆ—è¡¨ *&#x2F; public List&lt;String&gt; getSets() &#123; return sets; &#125; &#x2F;** * é‡ç½®å˜æ›´è„šæœ¬åˆ—è¡¨ *&#x2F; public void reset() &#123; sets.clear(); &#125; &#125; &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"},{"name":"MySQL","slug":"MySQL","permalink":"https://blog.ehzyil.xyz/tags/MySQL/"}],"author":"ehzyil"},{"title":"DockeræŒ‡ä»¤æŠ¥é”™çš„è§£å†³æ–¹æ³•'permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock:'","slug":"2023/DockeræŒ‡ä»¤æŠ¥é”™çš„è§£å†³æ–¹æ³•ï¼š'permission denied while trying to connect to the Docker...'","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/12/26/2023/DockeræŒ‡ä»¤æŠ¥é”™çš„è§£å†³æ–¹æ³•ï¼š'permission denied while trying to connect to the Docker...'/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/Docker%E6%8C%87%E4%BB%A4%E6%8A%A5%E9%94%99%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%EF%BC%9A'permission%20denied%20while%20trying%20to%20connect%20to%20the%20Docker...'/","excerpt":"","text":"ä½¿ç”¨azureçš„æœåŠ¡å™¨æŸ¥çœ‹dockerå®¹å™¨å†…çš„è¿›ç¨‹çš„æ—¶å€™å‡ºç°ä¸€ä¸‹é”™è¯¯ï¼Œ æ„æ€æ˜¯è¯•å›¾è¿æ¥unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock:ï¼Œä½†æƒé™ä¸å¤Ÿã€‚ åŸå› åˆ†æï¼šè¿™æ˜¯å› ä¸ºä½ å½“å‰çš„ç”¨æˆ·æ²¡æœ‰è¿™ä¸ªæƒé™ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œdocker å‘½ä»¤ä¼šä½¿ç”¨ Unix socket ä¸ Docker å¼•æ“é€šè®¯ã€‚è€Œåªæœ‰ root ç”¨æˆ·å’Œ docker ç»„çš„ç”¨æˆ·æ‰å¯ä»¥è®¿é—® Docker å¼•æ“çš„ Unix socketã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä¸€èˆ¬ Linux ç³»ç»Ÿä¸Šä¸ä¼šç›´æ¥ä½¿ç”¨ root ç”¨æˆ·ã€‚å³æˆ‘ä»¬å½“å‰çš„ç”¨æˆ·ä¸æ˜¯rootç”¨æˆ·ã€‚ è§£å†³åŠæ³•ï¼šæŠŠæˆ‘ä»¬å½“å‰çš„ç”¨æˆ·æ·»åŠ åˆ°dockerç»„ä¸­å°±å¯ä»¥äº† ç¬¬ä¸€æ­¥ï¼š sudo gpasswd -a username docker #å°†æ™®é€šç”¨æˆ·usernameåŠ å…¥åˆ°dockerç»„ä¸­ï¼Œusernameè¿™ä¸ªå­—æ®µä¹Ÿå¯ä»¥ç›´æ¥æ¢æˆ$USERã€‚ ç¬¬äºŒæ­¥ï¼šæ›´æ–°dockerç»„ newgrp docker #æ›´æ–°dockerç»„ ç¬¬ä¸‰æ­¥ï¼šå†æ‰§è¡Œä½ æŠ¥é”™çš„å‘½ä»¤ï¼Œæ­¤æ—¶å°±ä¸ä¼šæŠ¥é”™äº†ã€‚ ehzyil@AzureVM:~$ docker ps permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get \"http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/json\": dial unix /var/run/docker.sock: connect: permission denied ehzyil@AzureVM:~$ sudo gpasswd -a ehzyil docker Adding user ehzyil to group docker ehzyil@AzureVM:~$ newgrp docker ehzyil@AzureVM:~$ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://blog.ehzyil.xyz/tags/Docker/"},{"name":"linux","slug":"linux","permalink":"https://blog.ehzyil.xyz/tags/linux/"}],"author":"ehzyil"},{"title":"JSå¸¸ç”¨æ—¥æœŸå‡½æ•°","slug":"2023/JSå¸¸ç”¨æ—¥æœŸå‡½æ•°","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/12/26/2023/JSå¸¸ç”¨æ—¥æœŸå‡½æ•°/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/JS%E5%B8%B8%E7%94%A8%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0/","excerpt":"","text":"JSå¸¸ç”¨æ—¥æœŸå‡½æ•° &#x2F;&#x2F;è·å–å®Œæ•´çš„æ—¥æœŸ var date&#x3D;new Date; var year&#x3D;date.getFullYear(); var month&#x3D;date.getMonth()+1; month &#x3D;(month&lt;10 ? &quot;0&quot;+month:month); var mydate &#x3D; (year.toString()+month.toString()); æ³¨æ„ï¼Œyear.toString()+month.toString()ä¸èƒ½å†™æˆyear+monthã€‚ä¸ç„¶å¦‚æœæœˆä»½å¤§äºç­‰äº10ï¼Œåˆ™æœˆä»½ä¸ºæ•°å­—ï¼Œä¼šå’Œå¹´ä»½ç›¸åŠ ï¼Œå¦‚201210ï¼Œåˆ™ä¼šå˜ä¸º2022ï¼Œéœ€è¦åŠ .toString() ä»¥ä¸‹æ˜¯æœåˆ°çš„æœ‰ç”¨å†…å®¹ï¼š var myDate &#x3D; new Date(); myDate.getYear(); &#x2F;&#x2F;è·å–å½“å‰å¹´ä»½(2ä½) myDate.getFullYear(); &#x2F;&#x2F;è·å–å®Œæ•´çš„å¹´ä»½(4ä½,1970-????) myDate.getMonth(); &#x2F;&#x2F;è·å–å½“å‰æœˆä»½(0-11,0ä»£è¡¨1æœˆ) myDate.getDate(); &#x2F;&#x2F;è·å–å½“å‰æ—¥(1-31) myDate.getDay(); &#x2F;&#x2F;è·å–å½“å‰æ˜ŸæœŸX(0-6,0ä»£è¡¨æ˜ŸæœŸå¤©) myDate.getTime(); &#x2F;&#x2F;è·å–å½“å‰æ—¶é—´(ä»1970.1.1å¼€å§‹çš„æ¯«ç§’æ•°) myDate.getHours(); &#x2F;&#x2F;è·å–å½“å‰å°æ—¶æ•°(0-23) myDate.getMinutes(); &#x2F;&#x2F;è·å–å½“å‰åˆ†é’Ÿæ•°(0-59) myDate.getSeconds(); &#x2F;&#x2F;è·å–å½“å‰ç§’æ•°(0-59) myDate.getMilliseconds(); &#x2F;&#x2F;è·å–å½“å‰æ¯«ç§’æ•°(0-999) myDate.toLocaleDateString(); &#x2F;&#x2F;è·å–å½“å‰æ—¥æœŸ var mytime&#x3D;myDate.toLocaleTimeString(); &#x2F;&#x2F;è·å–å½“å‰æ—¶é—´ myDate.toLocaleString( ); &#x2F;&#x2F;è·å–æ—¥æœŸä¸æ—¶é—´ &lt;script language&#x3D;&quot;JavaScript&quot;&gt;function monthnow()&#123; var now &#x3D; new Date(); var monthn &#x3D; now.getMonth(); var yearn &#x3D; now.getYear(); window.location.href&#x3D;&quot;winnNamelist.jsp?getMonth&#x3D;&quot;+monthn+&quot;&amp;getYear&#x3D;&quot;+yearn; &#125;&lt;&#x2F;script&gt;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java Script","slug":"Java-Script","permalink":"https://blog.ehzyil.xyz/tags/Java-Script/"}],"author":"ehzyil"},{"title":"Java String hashCodeç”Ÿæˆè´Ÿå€¼","slug":"2023/Java String hashCodeç”Ÿæˆè´Ÿå€¼","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/12/26/2023/Java String hashCodeç”Ÿæˆè´Ÿå€¼/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/Java%20String%20hashCode%E7%94%9F%E6%88%90%E8%B4%9F%E5%80%BC/","excerpt":"","text":"è½¬è½½ java String hashCodeé‡åˆ°çš„å‘ åœ¨è¿›è¡Œæ•°æ®äº¤æ¢æ—¶ï¼Œå¦‚æœä¸»é”®ä¸æ˜¯æ•´å‹ï¼Œéœ€è¦å¯¹å­—ç¬¦ä¸²ï¼Œæˆ–è”åˆä¸»é”®æ‹¼æ¥ä¸ºå­—ç¬¦ä¸²ï¼Œè¿›è¡Œhashï¼Œå†è¿›è¡Œå–æ¨¡åˆ†ç‰‡ï¼Œä½¿ç”¨çš„æ˜¯Stringè‡ªå¸¦çš„hashCode()æ–¹æ³•ï¼Œæœ¬æ¥æ˜¯ä»¶å¾ˆæ–¹ä¾¿çš„äº‹ï¼Œä½†æ˜¯æœ‰äº›å­—ç¬¦ä¸²å–hashCodeç«Ÿç„¶æ˜¯è´Ÿæ•°ï¼Œä½¿å¾—åˆ†ç‰‡ä¸ºè´Ÿæ•°ï¼Œæ‰¾ä¸åˆ°å¯¹åº”çš„åˆ†ç‰‡ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹String ç”ŸæˆhashCodeçš„ä»£ç ï¼š /** * Returns a hash code for this string. The hash code for a * &#123;@code String&#125; object is computed as * &lt;blockquote>&lt;pre> * s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1] * &lt;/pre>&lt;/blockquote> * using &#123;@code int&#125; arithmetic, where &#123;@code s[i]&#125; is the * &lt;i>i&lt;/i>th character of the string, &#123;@code n&#125; is the length of * the string, and &#123;@code ^&#125; indicates exponentiation. * (The hash value of the empty string is zero.) * * @return a hash code value for this object. */ public int hashCode() &#123; int h = hash; if (h == 0 &amp;&amp; value.length > 0) &#123; char val[] = value; for (int i = 0; i &lt; value.length; i++) &#123; h = 31 * h + val[i]; &#125; hash = h; &#125; return h; &#125; ä¸»è¦æ˜¯æ ¹æ®å­—ç¬¦ä¸²ä¸­å­—ç¬¦çš„asciiç å€¼æ¥è®¡ç®—çš„ï¼Œå³ 31 * hash + å­—ç¬¦çš„ASCIIç å€¼ï¼Œintå‹çš„å€¼å–å€¼èŒƒå›´ä¸ºInteger.MIN_VALUE(-2147483648)ï½Integer.MAX_VALUE(2147483647)ï¼Œæ‰€ä»¥å¦‚æœå­—ç¬¦ä¸²æ¯”è¾ƒé•¿ï¼Œè®¡ç®—çš„æ•°å€¼å°±å¯èƒ½è¶…å‡ºInteger.MAX_VALUEï¼Œé€ æˆæ•°å€¼æº¢å‡ºï¼Œå€¼å˜æˆè´Ÿæ•° å‡ ç§æ¯”è¾ƒæç«¯çš„å­—ç¬¦ä¸²hashCodeå€¼ï¼š String hashStr0 = \"35953305172933/\"; System.out.println(hashStr0.hashCode()); // 2147483647 Integer.MAX_VALUE System.out.println(Math.abs(hashStr0.hashCode())); // 2147483647 Integer.MAX_VALUE System.out.println(\"-------------------\"); String hashStr = \"359533051729330\"; System.out.println(hashStr.hashCode()); // -2147483648 Integer.MIN_VALUE System.out.println(Math.abs(hashStr.hashCode())); // -2147483648 Integer.MIN_VALUE System.out.println(\"-------------------\"); String hashStr2 = \"56800004874\"; System.out.println(hashStr2.hashCode()); // -2082984168 System.out.println(Math.abs(hashStr2.hashCode())); // 2082984168 System.out.println(\"-------------------\"); String hashStr3 = \"\"; System.out.println(hashStr3.hashCode()); // 0 System.out.println(Math.abs(hashStr3.hashCode())); // 0 System.out.println(\"-------------------\"); å½“ key.hashCode() å€¼ä¸º Interger.MIN_VALUEæ—¶å€™Maths.abs(key.hashCode()) å– hashå€¼ä¸ºè´Ÿã€‚ å¯¹äºå­—ç¬¦ä¸²â€œ359533051729330â€çš„hashCodeä¸ºInteger.MIN_VALUEï¼Œæˆ‘ä»¬ä½¿ç”¨å–ç»å¯¹å€¼è¿˜æ˜¯è¶…å‡ºInteger.MAX_VALUEï¼Œè¿˜æ˜¯Integer.MIN_VALUEï¼Œæ‰€ä»¥é’ˆå¯¹è¿™ç§æç«¯æƒ…å†µæ˜¯ä¸å¯ç”¨çš„ è¦æƒ³åˆ©ç”¨hashCodeä¸ºéè´Ÿæ•°ï¼Œå¯ä»¥Integer.MAX_VALUEå’Œä¸æ“ä½œï¼Œè¿™æ ·æœ€å¤§æ­£æ•´æ•°çš„ç¬¦å·ä½ä¸º0ï¼Œä¸ä»»ä½•æ•°ä¸æ“ä½œéƒ½æ˜¯0ï¼Œå³æ˜¯æ­£æ•° int hash &#x3D; str.hashCode() &amp; Integer.MAX_VALUE;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"}],"author":"ehzyil"},{"title":"Java å®ç° AES åŠ å¯†å’Œè§£å¯†å®Œæ•´ç¤ºä¾‹","slug":"2023/Java å®ç° AES åŠ å¯†å’Œè§£å¯†å®Œæ•´ç¤ºä¾‹","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/12/26/2023/Java å®ç° AES åŠ å¯†å’Œè§£å¯†å®Œæ•´ç¤ºä¾‹/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/Java%20%E5%AE%9E%E7%8E%B0%20AES%20%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B/","excerpt":"","text":"Java å®ç° AES åŠ å¯†å’Œè§£å¯†å®Œæ•´ç¤ºä¾‹ é‡åˆ°éœ€æ±‚éœ€è¦ç»™å·²AESåŠ å¯†çš„ç”¨æˆ·å§“åè§£å¯†ï¼Œå¹¶ç»™å‡ºäº†pythonä»£ç ï¼Œç½‘ä¸Šæ‰¾äº†ä¸ªå¾ˆå…¨çš„Java å®ç° AES åŠ å¯†å’Œè§£å¯†å®Œæ•´ç¤ºä¾‹ï¼Œè®°å½•ä»¥ä¸‹æ–¹ä¾¿ä»¥åæŸ¥é˜…ã€‚ è½¬è½½Java å®ç° AES åŠ å¯†å’Œè§£å¯†å®Œæ•´ç¤ºä¾‹ å…¶ä»–è¯¦ç»†èµ„æ–™ 1ã€ç®€ä»‹AESï¼Œå…¨ç§°ä¸º Advanced Encryption Standardï¼Œæ˜¯ä¸€ç§åˆ†ç»„å¯†ç ç®—æ³•ï¼Œç”¨äºä¿æŠ¤æ•æ„Ÿæ•°æ®çš„ä¼ è¾“å’Œå­˜å‚¨ã€‚AES åˆ†ä¸º 128 ä½å’Œ 256 ä½ä¸¤ç§å¯†é’¥é•¿åº¦ï¼Œå¯ä»¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œä¿è¯æ•°æ®çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ã€‚AES ä¸»è¦åº”ç”¨äºç”µå­å•†åŠ¡ã€ç§»åŠ¨æ”¯ä»˜ã€ç½‘ç»œå®‰å…¨ç­‰é¢†åŸŸï¼Œè¢«å¹¿æ³›è¿ç”¨äºç°ä»£ç¤¾ä¼šçš„å„ä¸ªæ–¹é¢ã€‚AES ç®—æ³•è¢«è®¾è®¡ä¸ºé«˜åº¦å®‰å…¨ï¼Œå¯ä»¥åœ¨ç†è®ºä¸Šä¿è¯å…¶åˆ†ç»„å¯†ç çš„å®‰å…¨æ€§ã€‚ç„¶è€Œï¼Œç”±äºå…¶å¤æ‚æ€§å’Œå¯†é’¥é•¿åº¦ï¼ŒAES ç®—æ³•çš„å®ç°å’Œåº”ç”¨ä¹Ÿå…·æœ‰ä¸€å®šçš„æŠ€æœ¯éš¾åº¦ã€‚å› æ­¤ï¼Œåœ¨åº”ç”¨ AESç®—æ³•æ—¶ï¼Œéœ€è¦æ³¨æ„åŠ å¼ºå¯†é’¥ç®¡ç†å’Œå®‰å…¨æ€§ä¿éšœã€‚ è¿™ä¸ªæ ‡å‡†ç”¨æ¥æ›¿ä»£åŸå…ˆçš„ DESï¼ˆData Encryption Standardï¼‰ï¼Œå·²ç»è¢«å¤šæ–¹åˆ†æä¸”å¹¿ä¸ºå…¨ä¸–ç•Œæ‰€ä½¿ç”¨ã€‚ AES ç®—æ³•å…·æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œä¾‹å¦‚å¿«é€Ÿã€å®‰å…¨ã€å¯é ç­‰ã€‚å®ƒå¯ä»¥åŠ å¯†å¤§é‡æ•°æ®ï¼Œè€Œä¸ä¼šå› ä¸ºåŠ å¯†è¿‡ç¨‹ä¸­çš„æ•°æ®é‡è¿‡å¤§è€Œå˜å¾—ç¼“æ…¢ã€‚æ­¤å¤–ï¼ŒAES ç®—æ³•è¿˜æ”¯æŒå—å¤§å°çš„è‡ªåŠ¨è°ƒæ•´ï¼Œå¯ä»¥å¤„ç†ä¸åŒå¤§å°çš„æ•°æ®å—ã€‚ 2ã€AES åŠ å¯†æ¨¡å¼2.1ã€åŠ å¯†æ–¹å¼ECBï¼ˆElectronic Codebookï¼‰æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼æ˜¯å°†æ•´ä¸ªæ˜æ–‡åˆ†æˆè‹¥å¹²æ®µç›¸åŒçš„å°æ®µï¼Œç„¶åå¯¹æ¯ä¸€å°æ®µè¿›è¡ŒåŠ å¯†ã€‚åŠ å¯†æ—¶ï¼Œä½¿ç”¨ä¸€ä¸ªå¯†é’¥ï¼Œå°†æ˜æ–‡ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸å¯†é’¥ä¸­å¯¹åº”ä½ç½®çš„å­—ç¬¦è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—åˆ°å¯†æ–‡ã€‚ CBCï¼ˆCipher Block Chainingï¼‰æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼æ˜¯å…ˆå°†æ˜æ–‡åˆ‡åˆ†æˆè‹¥å¹²å°æ®µï¼Œç„¶åæ¯ä¸€å°æ®µä¸åˆå§‹å—æˆ–è€…ä¸Šä¸€æ®µçš„å¯†æ–‡æ®µè¿›è¡Œå¼‚æˆ–è¿ç®—åï¼Œå†ä¸å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚åŠ å¯†æ—¶ï¼Œä½¿ç”¨ä¸€ä¸ªå¯†é’¥å’Œä¸€ä¸ªåˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ï¼Œåˆå§‹åŒ–å‘é‡æ˜¯ä¸€ä¸ª16å­—èŠ‚çš„å‘é‡ï¼ŒåŒ…å«äº†åŠ å¯†ç®—æ³•æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚ CFBï¼ˆCipher Feedbackï¼‰æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼æ˜¯ä¸€ç§è¾ƒä¸ºå¤æ‚çš„åŠ å¯†æ¨¡å¼ï¼Œå®ƒç»“åˆäº†CBCå’ŒCTRä¸¤ç§æ¨¡å¼çš„ä¼˜ç‚¹ã€‚åœ¨CFBæ¨¡å¼ä¸­ï¼ŒåŠ å¯†è¿‡ç¨‹ä¸­ä½¿ç”¨ä¸€ä¸ªå¯†é’¥å’Œä¸€ä¸ªéšæœºç”Ÿæˆçš„åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ï¼Œç„¶åå¯¹æ˜æ–‡è¿›è¡ŒåŠ å¯†ã€‚åœ¨åŠ å¯†å®Œæˆåï¼Œé€šè¿‡å¯¹æ˜æ–‡è¿›è¡Œéå¯¹ç§°åŠ å¯†æ¥ç”Ÿæˆå¯†æ–‡çš„å‘é‡ã€‚éšåï¼Œé€šè¿‡å¯¹å¯†æ–‡è¿›è¡Œåå‘æ“ä½œï¼Œå°†å¯†æ–‡çš„å‘é‡ä¸æ˜æ–‡çš„å‘é‡è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—åˆ°è§£å¯†æ‰€éœ€çš„å¯†é’¥ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒECBã€CBCã€CFBç­‰æ¨¡å¼éƒ½æ˜¯å¯¹ç§°åŠ å¯†ç®—æ³•ï¼ŒåŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ã€‚åœ¨ä½¿ç”¨è¿™äº›ç®—æ³•æ—¶ï¼Œéœ€è¦æ³¨æ„ä¿æŠ¤å¯†é’¥çš„å®‰å…¨ï¼Œé¿å…è¢«æ¶æ„è·å–ã€‚ 2.2ã€å®‰å…¨æ€§ECB ä¸å¤Ÿå®‰å…¨ï¼Œåªé€‚åˆäºçŸ­æ•°æ®çš„åŠ å¯†ï¼Œè€Œ CBC å’Œ CFB ç›¸è¾ƒäº ECB æ›´åŠ å®‰å…¨ï¼Œå› ä¸ºå‰ä¸€ä¸ªå¯†æ–‡å—ä¼šå½±å“å½“å‰æ˜æ–‡å—ï¼Œä½¿æ”»å‡»è€…éš¾ä»¥é¢„æµ‹å¯†æ–‡çš„ç»“æ„ã€‚ 2.3ã€é€Ÿåº¦ECB æ˜¯æœ€ç®€å•çš„åŠ å¯†æ–¹å¼ï¼Œé€Ÿåº¦æœ€å¿«ï¼Œä½†ç”±äºå®‰å…¨æ€§å·®ä¸å»ºè®®ä½¿ç”¨ï¼ŒCBC å› ä¸ºæ¯ä¸ªæ˜æ–‡å—éƒ½è¦ä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œæ¯” ECB è¦æ…¢ä¸€äº›ï¼ŒCFB å› ä¸ºéœ€è¦åå¤åŠ å¯†å’Œè§£å¯†ï¼Œé€Ÿåº¦å¯èƒ½ä¼šæ›´æ…¢ã€‚ æ€»çš„æ¥è¯´ï¼Œé€‰æ‹© AES çš„ç®—æ³•æ¨¡å¼éœ€è¦æ ¹æ®åŠ å¯†éœ€è¦çš„å®‰å…¨æ€§å’Œé€Ÿåº¦æ¥è¿›è¡Œé€‰æ‹©ï¼Œé€šå¸¸æ¨èä½¿ç”¨CBC æˆ– CFB æ¨¡å¼ï¼Œè€Œä¸æ˜¯ ECB æ¨¡å¼ã€‚ 3ã€Java å®ç°å®Œæ•´ç¤ºä¾‹åœ¨ Java ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ javax.crypto åŒ…ä¸­çš„ Cipher ç±»æ¥å®ç° AES åŠ å¯†å’Œè§£å¯†ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š import javax.crypto.Cipher; import javax.crypto.spec.IvParameterSpec; import javax.crypto.spec.SecretKeySpec; import java.nio.charset.StandardCharsets; import java.util.Base64; import java.util.Random; /** * &lt;h1>AES åŠ å¯†å’Œè§£å¯†ç¤ºä¾‹ä»£ç &lt;/h1> * Created by woniu * */ public class AESExample &#123; /** åŠ å¯†æ¨¡å¼ä¹‹ ECBï¼Œç®—æ³•/æ¨¡å¼/è¡¥ç æ–¹å¼ */ private static final String AES_ECB = \"AES/ECB/PKCS5Padding\"; /** åŠ å¯†æ¨¡å¼ä¹‹ CBCï¼Œç®—æ³•/æ¨¡å¼/è¡¥ç æ–¹å¼ */ private static final String AES_CBC = \"AES/CBC/PKCS5Padding\"; /** åŠ å¯†æ¨¡å¼ä¹‹ CFBï¼Œç®—æ³•/æ¨¡å¼/è¡¥ç æ–¹å¼ */ private static final String AES_CFB = \"AES/CFB/PKCS5Padding\"; /** AES ä¸­çš„ IV å¿…é¡»æ˜¯ 16 å­—èŠ‚ï¼ˆ128ä½ï¼‰é•¿ */ private static final Integer IV_LENGTH = 16; /*** * &lt;h2>ç©ºæ ¡éªŒ&lt;/h2> * @param str éœ€è¦åˆ¤æ–­çš„å€¼ */ public static boolean isEmpty(Object str) &#123; return null == str || \"\".equals(str); &#125; /*** * &lt;h2>String è½¬ byte&lt;/h2> * @param str éœ€è¦è½¬æ¢çš„å­—ç¬¦ä¸² */ public static byte[] getBytes(String str)&#123; if (isEmpty(str)) &#123; return null; &#125; try &#123; return str.getBytes(StandardCharsets.UTF_8); &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; &#125; /*** * &lt;h2>åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªéšæœºç”Ÿæˆçš„å­—èŠ‚æ•°ç»„ï¼Œç”¨äºå¢åŠ åŠ å¯†å’Œè§£å¯†çš„å®‰å…¨æ€§&lt;/h2> */ public static String getIV()&#123; // String str = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"; // Random random = new Random(); // StringBuffer sb = new StringBuffer(); // for(int i = 0 ; i &lt; IV_LENGTH ; i++)&#123; // int number = random.nextInt(str.length()); // sb.append(str.charAt(number)); // &#125; // return sb.toString(); return \"1234567876543210\"; &#125; /*** * &lt;h2>è·å–ä¸€ä¸ª AES å¯†é’¥è§„èŒƒ&lt;/h2> */ public static SecretKeySpec getSecretKeySpec(String key)&#123; SecretKeySpec secretKeySpec = new SecretKeySpec(getBytes(key), \"AES\"); return secretKeySpec; &#125; /** * &lt;h2>åŠ å¯† - æ¨¡å¼ ECB&lt;/h2> * @param text éœ€è¦åŠ å¯†çš„æ–‡æœ¬å†…å®¹ * @param key åŠ å¯†çš„å¯†é’¥ key * */ public static String encrypt(String text, String key)&#123; if (isEmpty(text) || isEmpty(key)) &#123; return null; &#125; try &#123; // åˆ›å»ºAESåŠ å¯†å™¨ Cipher cipher = Cipher.getInstance(AES_ECB); SecretKeySpec secretKeySpec = getSecretKeySpec(key); cipher.init(Cipher.ENCRYPT_MODE, secretKeySpec); // åŠ å¯†å­—èŠ‚æ•°ç»„ byte[] encryptedBytes = cipher.doFinal(getBytes(text)); // å°†å¯†æ–‡è½¬æ¢ä¸º Base64 ç¼–ç å­—ç¬¦ä¸² return Base64.getEncoder().encodeToString(encryptedBytes); &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; &#125; /** * &lt;h2>è§£å¯† - æ¨¡å¼ ECB&lt;/h2> * @param text éœ€è¦è§£å¯†çš„æ–‡æœ¬å†…å®¹ * @param key è§£å¯†çš„å¯†é’¥ key * */ public static String decrypt(String text, String key)&#123; if (isEmpty(text) || isEmpty(key)) &#123; return null; &#125; // å°†å¯†æ–‡è½¬æ¢ä¸º16å­—èŠ‚çš„å­—èŠ‚æ•°ç»„ byte[] textBytes = Base64.getDecoder().decode(text); try &#123; // åˆ›å»ºAESåŠ å¯†å™¨ Cipher cipher = Cipher.getInstance(AES_ECB); SecretKeySpec secretKeySpec = getSecretKeySpec(key); cipher.init(Cipher.DECRYPT_MODE, secretKeySpec); // è§£å¯†å­—èŠ‚æ•°ç»„ byte[] decryptedBytes = cipher.doFinal(textBytes); // å°†æ˜æ–‡è½¬æ¢ä¸ºå­—ç¬¦ä¸² return new String(decryptedBytes, StandardCharsets.UTF_8); &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; &#125; /** * &lt;h2>åŠ å¯† - è‡ªå®šä¹‰åŠ å¯†æ¨¡å¼&lt;/h2> * @param text éœ€è¦åŠ å¯†çš„æ–‡æœ¬å†…å®¹ * @param key åŠ å¯†çš„å¯†é’¥ key * @param iv åˆå§‹åŒ–å‘é‡ * @param mode åŠ å¯†æ¨¡å¼ * */ public static String encrypt(String text, String key, String iv, String mode)&#123; if (isEmpty(text) || isEmpty(key) || isEmpty(iv)) &#123; return null; &#125; try &#123; // åˆ›å»ºAESåŠ å¯†å™¨ Cipher cipher = Cipher.getInstance(mode); SecretKeySpec secretKeySpec = getSecretKeySpec(key); cipher.init(Cipher.ENCRYPT_MODE, secretKeySpec, new IvParameterSpec(getBytes(iv))); // åŠ å¯†å­—èŠ‚æ•°ç»„ byte[] encryptedBytes = cipher.doFinal(getBytes(text)); // å°†å¯†æ–‡è½¬æ¢ä¸º Base64 ç¼–ç å­—ç¬¦ä¸² return Base64.getEncoder().encodeToString(encryptedBytes); &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; &#125; /** * &lt;h2>è§£å¯† - è‡ªå®šä¹‰åŠ å¯†æ¨¡å¼&lt;/h2> * @param text éœ€è¦è§£å¯†çš„æ–‡æœ¬å†…å®¹ * @param key è§£å¯†çš„å¯†é’¥ key * @param iv åˆå§‹åŒ–å‘é‡ * @param mode åŠ å¯†æ¨¡å¼ * */ public static String decrypt(String text, String key, String iv, String mode)&#123; if (isEmpty(text) || isEmpty(key) || isEmpty(iv)) &#123; return null; &#125; // å°†å¯†æ–‡è½¬æ¢ä¸º16å­—èŠ‚çš„å­—èŠ‚æ•°ç»„ byte[] textBytes = Base64.getDecoder().decode(text); try &#123; // åˆ›å»ºAESåŠ å¯†å™¨ Cipher cipher = Cipher.getInstance(mode); SecretKeySpec secretKeySpec = getSecretKeySpec(key); cipher.init(Cipher.DECRYPT_MODE, secretKeySpec, new IvParameterSpec(getBytes(iv))); // è§£å¯†å­—èŠ‚æ•°ç»„ byte[] decryptedBytes = cipher.doFinal(textBytes); // å°†æ˜æ–‡è½¬æ¢ä¸ºå­—ç¬¦ä¸² return new String(decryptedBytes, StandardCharsets.UTF_8); &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; &#125; public static void main(String[] args) &#123; String text = \"411025200102175014\"; String key = \"rHx3pZwRTAb33psX\"; // 16å­—èŠ‚çš„å¯†é’¥ String iv = getIV(); String encryptTextEBC = encrypt(text, key); System.out.println(\"EBC åŠ å¯†åå†…å®¹ï¼š\" + encryptTextEBC); System.out.println(\"EBC è§£å¯†åå†…å®¹ï¼š\" + decrypt(encryptTextEBC, key)); System.out.println(); String encryptTextCBC = encrypt(text, key, iv, AES_CBC); System.out.println(\"CBC åŠ å¯†IVï¼š\" + iv); System.out.println(\"CBC åŠ å¯†åå†…å®¹ï¼š\" + encryptTextCBC); System.out.println(\"CBC è§£å¯†åå†…å®¹ï¼š\" + decrypt(encryptTextCBC, key, iv, AES_CBC)); System.out.println(); String encryptTextCFB = encrypt(text, key, iv, AES_CFB); System.out.println(\"CFB åŠ å¯†IVï¼š\" + iv); System.out.println(\"CFB åŠ å¯†åå†…å®¹ï¼š\" + encryptTextCFB); System.out.println(\"CFB è§£å¯†åå†…å®¹ï¼š\" + decrypt(encryptTextCFB, key, iv, AES_CFB)); &#125; &#125; public static String decryptAES(String text) &#123; if (StringUtils.isEmpty(text)) return \"\"; text = text.substring(4); System.out.println(text); String mode = \"AES/CBC/PKCS5Padding\"; String iv = \"1234567876543210\"; String key = \"rHx3pZwRTAb33psX\"; // 16å­—èŠ‚çš„å¯†é’¥ // å°†å¯†æ–‡è½¬æ¢ä¸º16å­—èŠ‚çš„å­—èŠ‚æ•°ç»„ byte[] textBytes = Base64.getDecoder().decode(text); try &#123; // åˆ›å»ºAESåŠ å¯†å™¨ Cipher cipher = Cipher.getInstance(mode); SecretKeySpec secretKeySpec = getSecretKeySpec(key); cipher.init(Cipher.DECRYPT_MODE, secretKeySpec, new IvParameterSpec(getBytes(iv))); // è§£å¯†å­—èŠ‚æ•°ç»„ byte[] decryptedBytes = cipher.doFinal(textBytes); // å°†æ˜æ–‡è½¬æ¢ä¸ºå­—ç¬¦ä¸² return new String(decryptedBytes, StandardCharsets.UTF_8); &#125; catch (Exception e) &#123; throw new RuntimeException(e); &#125; &#125; éœ€æ±‚ä¸­ç»™å‡ºçš„pythonä»£ç  AesEncryption.py import base64 # å¯¼å…¥base64æ¨¡å— from Crypto.Cipher import AES # ä»Cryptoæ¨¡å—ä¸­å¯¼å…¥AESåŠ å¯†ç®—æ³• import StringUtil # å¯¼å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„StringUtilæ¨¡å— class AesEncryption: __AES_IV = '1234567876543210' # åˆå§‹åŒ–ä¸€ä¸ªAES IVå‘é‡ def __init__(self, password: str = 'rHx3pZwRTAb33psX', prefix: str = 'AES:', encoding_protocol: str = 'ASCII'): self.__password = password # åˆå§‹åŒ–å¯†ç  self.__encoding_protocol = encoding_protocol # åˆå§‹åŒ–ç¼–ç åè®® self.__prefix = prefix # åˆå§‹åŒ–å‰ç¼€ # AESåŠ å¯†æ–¹æ³• def aes_encrypt(self, text: str): block_size = 16 # å®šä¹‰å—å¤§å°ä¸º16 # æ•°æ®è¿›è¡Œ PKCS5Padding çš„å¡«å…… pad = lambda s: (s + (block_size - len(s) % block_size) * chr(block_size - len(s) % block_size)) # å®šä¹‰å¡«å……å‡½æ•° data = pad(text) # å¯¹æ–‡æœ¬è¿›è¡Œå¡«å…… # åˆ›å»ºåŠ å¯†å¯¹è±¡ cipher = AES.new(self.__password.encode(), AES.MODE_CBC, self.__AES_IV.encode()) # åˆ›å»ºAESåŠ å¯†å¯¹è±¡ # å¾—åˆ°åŠ å¯†åçš„å­—èŠ‚ç  encrypted_text = cipher.encrypt(bytes(data, self.__encoding_protocol)) # è¿›è¡ŒåŠ å¯† # base64 ç¼–ç  encode_text = base64.b64encode(encrypted_text).decode(self.__encoding_protocol) # è¿›è¡Œbase64ç¼–ç  if StringUtil.is_str_not_null(self.__prefix): # åˆ¤æ–­å‰ç¼€æ˜¯å¦ä¸ä¸ºç©º encode_text = self.__prefix + encode_text # å¦‚æœå‰ç¼€ä¸ä¸ºç©ºï¼Œåˆ™æ·»åŠ å‰ç¼€ return encode_text # è¿”å›åŠ å¯†åçš„æ–‡æœ¬ # AESè§£å¯†æ–¹æ³• def aes_decrypt(self, text: str): # å»æ‰ PKCS5Padding çš„å¡«å…… un_pad = lambda s: s[:-ord(s[len(s) - 1:])] # å®šä¹‰å»é™¤å¡«å……çš„å‡½æ•° # åˆ›å»ºåŠ å¯†å¯¹è±¡ cipher = AES.new(self.__password.encode(), AES.MODE_CBC, self.__AES_IV.encode()) # åˆ›å»ºAESè§£å¯†å¯¹è±¡ # base64 è§£ç  text = StringUtil.split_by_first_str(text, self.__prefix) # é€šè¿‡å‰ç¼€åˆ†å‰²æ–‡æœ¬ decode_text = base64.b64decode(str(text).encode()) # è¿›è¡Œbase64è§£ç  decrypt_text = un_pad(cipher.decrypt(decode_text)).decode(self.__encoding_protocol) # è¿›è¡Œè§£å¯† return decrypt_text # è¿”å›è§£å¯†åçš„æ–‡æœ¬ # ç±»æ–¹æ³•ï¼šAESåŠ å¯† @classmethod def aes_encrypt_cls(cls, text: str, password: str = 'rHx3pZwRTAb33psX', prefix: str = 'AES:', encoding_protocol: str = 'ASCII'): aes_en = AesEncryption(password=password, prefix=prefix, encoding_protocol=encoding_protocol) # åˆ›å»ºAesEncryptionå®ä¾‹ return aes_en.aes_encrypt(text) # è°ƒç”¨å®ä¾‹æ–¹æ³•è¿›è¡ŒåŠ å¯† # ç±»æ–¹æ³•ï¼šAESè§£å¯† @classmethod def aes_decrypt_cls(cls, text: str, password: str = 'rHx3pZwRTAb33psX', prefix: str = 'AES:', encoding_protocol: str = 'ASCII'): aes_de = AesEncryption(password=password, prefix=prefix, encoding_protocol=encoding_protocol) # åˆ›å»ºAesEncryptionå®ä¾‹ return aes_de.aes_decrypt(text) # è°ƒç”¨å®ä¾‹æ–¹æ³•è¿›è¡Œè§£å¯† # è¦åŠ å¯†çš„æ–‡æœ¬ text_to_encrypt = \"411025200102175014\" # ä½¿ç”¨ç±»æ–¹æ³•è¿›è¡ŒåŠ å¯† encrypted_text = AesEncryption.aes_encrypt_cls(text_to_encrypt) # è¾“å‡ºåŠ å¯†åçš„æ–‡æœ¬ print(\"Encrypted Text:\", encrypted_text) # ä½¿ç”¨ç±»æ–¹æ³•è¿›è¡Œè§£å¯† decrypted_text = AesEncryption.aes_decrypt_cls(encrypted_text) # è¾“å‡ºè§£å¯†åçš„æ–‡æœ¬ print(\"Decrypted Text:\", decrypted_text) #StringUtil.py def is_str_not_null(text): if text is None: return False else: if type(text) == str: if text.strip() == '': return False else: return True else: raise Exception('textéœ€ä¸ºå­—ç¬¦ä¸²') def split_by_first_str(text, prefix): if is_str_not_null(text) and is_str_not_null(prefix): sub_arr = text.split(prefix, 1) if len(sub_arr) > 1: return sub_arr[1] else: return text else: return text","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"},{"name":"AES","slug":"AES","permalink":"https://blog.ehzyil.xyz/tags/AES/"}],"author":"ehzyil"},{"title":"Javaå°†listè½¬å­—ç¬¦ä¸²çš„æ–¹æ³•","slug":"2023/Javaå°†listè½¬å­—ç¬¦ä¸²çš„æ–¹æ³•","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/12/26/2023/Javaå°†listè½¬å­—ç¬¦ä¸²çš„æ–¹æ³•/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/Java%E5%B0%86list%E8%BD%AC%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%96%B9%E6%B3%95/","excerpt":"","text":"ç¬¬ä¸€ç§ï¼šjoin()String.join(&quot;,&quot;, strList) ç¬¬äºŒç§ï¼šå¾ªç¯æ’å…¥é€—å·public static &lt;T&gt; String parseListToStr(List&lt;T&gt; list)&#123; StringBuffer sb &#x3D; new StringBuffer(); if(listIsNotNull(list)) &#123; for(int i&#x3D;0;i&lt;&#x3D;list.size()-1;i++)&#123; if(i&lt;list.size()-1)&#123; sb.append(list.get(i) + &quot;,&quot;); &#125;else &#123; sb.append(list.get(i)); &#125; &#125; &#125; return sb.toString(); &#125; ç¬¬ä¸‰ç§ï¼šstreamæµpublic static &lt;T&gt; String parseListToStr3(List&lt;T&gt; list)&#123; String result &#x3D; list.stream().map(String::valueOf).collect(Collectors.joining(&quot;,&quot;)); ç¬¬å››ç§ï¼šä½¿ç”¨è°·æ­ŒJoineræ–¹æ³•import com.google.common.base.Joiner; public static &lt;T&gt; String parseListToStr(List&lt;T&gt; list)&#123; String result &#x3D; Joiner.on(&quot;,&quot;).join(list); return result; &#125; å¯¼å…¥com.google.common.base.Joiner; public static String strategyï¼ˆString strategyï¼‰&#123; String result &#x3D; Joiner.onï¼ˆâ€œï¼Œâ€ï¼‰.joinï¼ˆlistï¼‰; è¿”å›ç»“æœ; &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"}],"author":"ehzyil"},{"title":"Javaå¾ªç¯åˆ é™¤Listä¸­å…ƒç´ çš„æ­£ç¡®æ–¹å¼","slug":"2023/Javaå¾ªç¯åˆ é™¤Listä¸­å…ƒç´ ","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/12/26/2023/Javaå¾ªç¯åˆ é™¤Listä¸­å…ƒç´ /","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/Java%E5%BE%AA%E7%8E%AF%E5%88%A0%E9%99%A4List%E4%B8%AD%E5%85%83%E7%B4%A0/","excerpt":"","text":"Javaå¾ªç¯åˆ é™¤Listä¸­å…ƒç´ çš„æ­£ç¡®æ–¹å¼There are a few different ways to correctly delete elements from a List in Java. Here are some common methods: Using an Iterator: You can use an Iterator to loop through the List and remove elements based on a condition. This is the safest way to modify a List while iterating over it. List&lt;String&gt; list &#x3D; new ArrayList&lt;&gt;(); list.add(&quot;A&quot;); list.add(&quot;B&quot;); list.add(&quot;C&quot;); Iterator&lt;String&gt; iterator &#x3D; list.iterator(); while (iterator.hasNext()) &#123; String element &#x3D; iterator.next();&#x2F;&#x2F;åˆ é™¤ä¹‹å‰å¿…é¡»æ˜¾ç¤ºè°ƒç”¨ if (element.equals(&quot;B&quot;)) &#123; iterator.remove(); &#125; &#125; System.out.println(list); &#x2F;&#x2F; Output: [A, C] Using the removeIf() method: Java 8 introduced the removeIf() method in the List interface, which allows you to remove elements based on a specified condition using a Predicate. List&lt;String&gt; list &#x3D; new ArrayList&lt;&gt;(); list.add(&quot;A&quot;); list.add(&quot;B&quot;); list.add(&quot;C&quot;); list.removeIf(element -&gt; element.equals(&quot;B&quot;)); System.out.println(list); &#x2F;&#x2F; Output: [A, C] Using the removeAll() method: You can also use the removeAll() method to remove all occurrences of a specific element from the List. List&lt;String&gt; list &#x3D; new ArrayList&lt;&gt;(); list.add(&quot;A&quot;); list.add(&quot;B&quot;); list.add(&quot;C&quot;); list.removeAll(Collections.singleton(&quot;B&quot;)); System.out.println(list); &#x2F;&#x2F; Output: [A, C] Using a for loop in reverse order:You can iterate through the List in reverse order and remove elements that meet a certain condition. This approach is useful when you want to avoid using an Iterator. List&lt;String> list = new ArrayList&lt;>(); list.add(\"A\"); list.add(\"B\"); list.add(\"C\"); for (int i = list.size() - 1; i >= 0; i--) &#123; if (list.get(i).equals(\"B\")) &#123; list.remove(i); &#125; &#125; System.out.println(list); // Output: [A, C] Using the subList() method:You can utilize the subList() method to create a sub-list and then remove elements from it. This approach is helpful when you want to remove a range of elements from the List. List&lt;String> list = new ArrayList&lt;>(); list.add(\"A\"); list.add(\"B\"); list.add(\"C\"); list.subList(1, 2).clear(); System.out.println(list); // Output: [A, C] Using the Apache Commons Collections library:If you are open to using external libraries, the Apache Commons Collections library provides a CollectionUtils class with various methods for manipulating collections, including removing elements based on conditions. List&lt;String> list = new ArrayList&lt;>(); list.add(\"A\"); list.add(\"B\"); list.add(\"C\"); CollectionUtils.filter(list, object -> !object.equals(\"B\")); System.out.println(list); // Output: [A, C] é¢˜å¤–è¯å…¶ä»–æ–¹æ³• é€šè¿‡forå¾ªç¯åˆ é™¤ï¼ˆé”™è¯¯ï¼‰ ä½¿ç”¨foreachå¾ªç¯åˆ é™¤ï¼ˆé”™è¯¯ï¼‰ åŸå› è§: Javaå¾ªç¯åˆ é™¤Listä¸­å…ƒç´ çš„æ­£ç¡®æ–¹å¼","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"}],"author":"ehzyil"},{"title":"Javaæ•°ç»„è½¬Listçš„ä¸‰ç§æ–¹å¼","slug":"2023/Javaæ•°ç»„è½¬Listçš„ä¸‰ç§æ–¹å¼","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/12/26/2023/Javaæ•°ç»„è½¬Listçš„ä¸‰ç§æ–¹å¼/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/Java%E6%95%B0%E7%BB%84%E8%BD%ACList%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/","excerpt":"","text":"Javaæ•°ç»„è½¬Listçš„ä¸‰ç§æ–¹å¼ éœ€æ±‚ä¸­å¸¸ç”¨åˆ°æ•°ç»„è½¬é›†åˆçš„æ“ä½œ,ä¸ºäº†é¿å…ä¸å‡ºé”™å¹¶ä½¿ç”¨é«˜æ•ˆæ–¹æ³•å»ç½‘ä¸Šæ‰¾äº†ç¯‡éå¸¸ä¸é”™çš„æ–‡ç« ã€‚ è½¬è½½ Javaæ•°ç»„è½¬Listçš„ä¸‰ç§æ–¹å¼åŠå¯¹æ¯” ä¸€.æœ€å¸¸è§æ–¹å¼ï¼ˆæœªå¿…æœ€ä½³ï¼‰é€šè¿‡ Arrays.asList(strArray) æ–¹å¼,å°†æ•°ç»„è½¬æ¢Liståï¼Œä¸èƒ½å¯¹Listå¢åˆ ï¼Œåªèƒ½æŸ¥æ”¹ï¼Œå¦åˆ™æŠ›å¼‚å¸¸ã€‚ å…³é”®ä»£ç ï¼š List list &#x3D; Arrays.asList(strArray); private void testArrayCastToListError() &#123; String[] strArray &#x3D; new String[2]; List list &#x3D; Arrays.asList(strArray); &#x2F;&#x2F;å¯¹è½¬æ¢åçš„listæ’å…¥ä¸€æ¡æ•°æ® list.add(&quot;1&quot;); System.out.println(list); &#125; æ‰§è¡Œç»“æœï¼š Exception in thread &quot;main&quot; java.lang.UnsupportedOperationException at java.util.AbstractList.add(AbstractList.java:148) at java.util.AbstractList.add(AbstractList.java:108) at com.darwin.junit.Calculator.testArrayCastToList(Calculator.java:19) at com.darwin.junit.Calculator.main(Calculator.java:44) ç¨‹åºåœ¨list.add(â€œ1â€)å¤„ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼šUnsupportedOperationExceptionã€‚ åŸå› è§£æï¼šArrays.asList(strArray)è¿”å›å€¼æ˜¯java.util.Arraysç±»ä¸­ä¸€ä¸ªç§æœ‰é™æ€å†…éƒ¨ç±»java.util.Arrays.ArrayListï¼Œå®ƒå¹¶éjava.util.ArrayListç±»ã€‚java.util.Arrays.ArrayListç±»å…·æœ‰ set()ï¼Œget()ï¼Œcontains()ç­‰æ–¹æ³•ï¼Œä½†æ˜¯ä¸å…·æœ‰æ·»åŠ add()æˆ–åˆ é™¤remove()æ–¹æ³•,æ‰€ä»¥è°ƒç”¨add()æ–¹æ³•ä¼šæŠ¥é”™ã€‚ ä½¿ç”¨åœºæ™¯ï¼šArrays.asList(strArray)æ–¹å¼ä»…èƒ½ç”¨åœ¨å°†æ•°ç»„è½¬æ¢ä¸ºListåï¼Œä¸éœ€è¦å¢åˆ å…¶ä¸­çš„å€¼ï¼Œä»…ä½œä¸ºæ•°æ®æºè¯»å–ä½¿ç”¨ã€‚ äºŒ.æ•°ç»„è½¬ä¸ºListåï¼Œæ”¯æŒå¢åˆ æ”¹æŸ¥çš„æ–¹å¼é€šè¿‡ArrayListçš„æ„é€ å™¨ï¼Œå°†Arrays.asList(strArray)çš„è¿”å›å€¼ç”±java.util.Arrays.ArrayListè½¬ä¸ºjava.util.ArrayListã€‚ å…³é”®ä»£ç ï¼šArrayList list &#x3D; new ArrayList(Arrays.asList(strArray)) ; private void testArrayCastToListRight() &#123; String[] strArray &#x3D; new String[2]; ArrayList&lt;String&gt; list &#x3D; new ArrayList&lt;String&gt;(Arrays.asList(strArray)) ; list.add(&quot;1&quot;); System.out.println(list); &#125; æ‰§è¡Œç»“æœï¼šæˆåŠŸè¿½åŠ ä¸€ä¸ªå…ƒç´ â€œ1â€ã€‚ ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦åœ¨å°†æ•°ç»„è½¬æ¢ä¸ºListåï¼Œå¯¹Listè¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œï¼Œåœ¨Listçš„æ•°æ®é‡ä¸å¤§çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ã€‚ ä¸‰.é€šè¿‡é›†åˆå·¥å…·ç±»Collections.addAll()æ–¹æ³•(æœ€é«˜æ•ˆ)é€šè¿‡Collections.addAll(arrayList, strArray)æ–¹å¼è½¬æ¢ï¼Œæ ¹æ®æ•°ç»„çš„é•¿åº¦åˆ›å»ºä¸€ä¸ªé•¿åº¦ç›¸åŒçš„Listï¼Œç„¶åé€šè¿‡Collections.addAll()æ–¹æ³•ï¼Œå°†æ•°ç»„ä¸­çš„å…ƒç´ è½¬ä¸ºäºŒè¿›åˆ¶ï¼Œç„¶åæ·»åŠ åˆ°Listä¸­ï¼Œè¿™æ˜¯æœ€é«˜æ•ˆçš„æ–¹æ³•ã€‚ å…³é”®ä»£ç ï¼š ArrayList&lt; String&gt; arrayList &#x3D; new ArrayList&lt;String&gt;(strArray.length); Collections.addAll(arrayList, strArray); æµ‹è¯•ï¼š private void testArrayCastToListEfficient()&#123; String[] strArray &#x3D; new String[2]; ArrayList&lt; String&gt; arrayList &#x3D; new ArrayList&lt;String&gt;(strArray.length); Collections.addAll(arrayList, strArray); arrayList.add(&quot;1&quot;); System.out.println(arrayList); &#125; æ‰§è¡Œç»“æœï¼šåŒæ ·æˆåŠŸè¿½åŠ ä¸€ä¸ªå…ƒç´ â€œ1â€ã€‚ [null, null, 1] ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦åœ¨å°†æ•°ç»„è½¬æ¢ä¸ºListåï¼Œå¯¹Listè¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œï¼Œåœ¨Listçš„æ•°æ®é‡å·¨å¤§çš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆä½¿ç”¨ï¼Œå¯ä»¥æé«˜æ“ä½œé€Ÿåº¦ã€‚ å››.Java8å¯é€šè¿‡streamæµå°†3ç§åŸºæœ¬ç±»å‹æ•°ç»„è½¬ä¸ºListå¦‚æœJDKç‰ˆæœ¬åœ¨1.8ä»¥ä¸Šï¼Œå¯ä»¥ä½¿ç”¨æµstreamæ¥å°†ä¸‹åˆ—3ç§æ•°ç»„å¿«é€Ÿè½¬ä¸ºListï¼Œåˆ†åˆ«æ˜¯int[]ã€long[]ã€double[]ï¼Œå…¶ä»–æ•°æ®ç±»å‹æ¯”å¦‚short[]ã€byte[]ã€char[]ï¼Œåœ¨JDK1.8ä¸­æš‚ä¸æ”¯æŒã€‚ç”±äºè¿™åªæ˜¯ä¸€ç§å¸¸ç”¨æ–¹æ³•çš„å°è£…ï¼Œä¸å†çº³å…¥ä¸€ç§å´­æ–°çš„æ•°ç»„è½¬Listæ–¹å¼ï¼Œæš‚æ—¶ç®—æ˜¯javaæµé€ç»™æˆ‘ä»¬çš„å¸¸ç”¨å·¥å…·æ–¹æ³•å§ã€‚ è½¬æ¢ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š List&lt;Integer&gt; intList&#x3D; Arrays.stream(new int[] &#123; 1, 2, 3, &#125;).boxed().collect(Collectors.toList()); List&lt;Long&gt; longList&#x3D; Arrays.stream(new long[] &#123; 1, 2, 3 &#125;).boxed().collect(Collectors.toList()); List&lt;Double&gt; doubleList&#x3D; Arrays.stream(new double[] &#123; 1, 2, 3 &#125;).boxed().collect(Collectors.toList()); å¦‚æœæ˜¯Stringæ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨Streamæµè¿™æ ·è½¬æ¢ï¼š String[] arrays &#x3D; &#123;&quot;tom&quot;, &quot;jack&quot;, &quot;kate&quot;&#125;; List&lt;String&gt; stringList&#x3D; Stream.of(arrays).collect(Collectors.toList()); é¢˜å¤–è¯ä¸‹åˆ—ä»£ç ä¸ºä»€ä¹ˆä¼šæŠ¥é”™ï¼Ÿ String[] strArray &#x3D; new String[2]; Arrays.stream(strArray).boxed().collect(Collectors.toList()); è¿™æ®µä»£ç ä¼šæŠ¥é”™æ˜¯å› ä¸ºåœ¨å°†Stringæ•°ç»„è½¬æ¢ä¸ºStreamåï¼Œä½¿ç”¨boxed()æ–¹æ³•å°†åŸºæœ¬æ•°æ®ç±»å‹çš„Streamè½¬æ¢ä¸ºåŒ…è£…ç±»å‹çš„Streamã€‚ç„¶è€Œï¼ŒStringæœ¬èº«å¹¶ä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå› æ­¤ä¸éœ€è¦ä½¿ç”¨boxed()æ–¹æ³•ã€‚åº”è¯¥ç›´æ¥ä½¿ç”¨Arrays.stream(strArray).collect(Collectors.toList())å³å¯å°†Stringæ•°ç»„è½¬æ¢ä¸ºListã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"}],"author":"ehzyil"},{"title":"Springè¯»å–Resourceä¸‹æ–‡ä»¶çš„å‡ ç§æ–¹å¼","slug":"2023/Springè¯»å–Resourceä¸‹æ–‡ä»¶çš„å‡ ç§æ–¹å¼","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/12/26/2023/Springè¯»å–Resourceä¸‹æ–‡ä»¶çš„å‡ ç§æ–¹å¼/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/Spring%E8%AF%BB%E5%8F%96Resource%E4%B8%8B%E6%96%87%E4%BB%B6%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/","excerpt":"","text":"Springè¯»å–Resourceä¸‹æ–‡ä»¶çš„å‡ ç§æ–¹å¼ç¬¬ä¸€ç§ï¼šé€šè¿‡å½“å‰çº¿ç¨‹çš„ç±»åŠ è½½å™¨è·å–èµ„æºæ–‡ä»¶ï¼› InputStream inputStream &#x3D; Thread.currentThread().getContextClassLoader().getResourceAsStream(&quot;excleTemplate&#x2F;test.xlsx&quot;); ç¬¬äºŒç§ï¼šé€šè¿‡å½“å‰ç±»çš„ç±»åŠ è½½å™¨è·å–èµ„æºæ–‡ä»¶ InputStream inputStream &#x3D; this.getClass().getResourceAsStream(&quot;&#x2F;excleTemplate&#x2F;test.xlsx&quot;); å‰ä¸¤ç§æ–¹å¼éƒ½æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œéœ€è¦æ³¨æ„èµ„æºæ–‡ä»¶çš„ä½ç½®å’Œè°ƒç”¨ä»£ç çš„ä½ç½®ã€‚ ç¬¬ä¸‰ç§ï¼šClassPathResourceè¿™æ˜¯ä½¿ç”¨Springæ¡†æ¶æä¾›çš„æ–¹å¼ï¼Œé€šè¿‡ClassPathResourceæ¥è¯»å–èµ„æºæ–‡ä»¶ã€‚å®ƒæä¾›äº†æ›´å¤šçš„çµæ´»æ€§å’ŒåŠŸèƒ½ï¼Œæ¯”å¦‚å¯ä»¥ç›´æ¥è·å–è¾“å…¥æµã€‚ ClassPathResource classPathResource &#x3D; new ClassPathResource(&quot;excleTemplate&#x2F;test.xlsx&quot;); InputStream inputStream &#x3D;classPathResource.getInputStream(); ç¬¬å››ç§ï¼šResourceUtilsè¿™ç§æ–¹å¼ä½¿ç”¨äº†ResourceUtilsçš„getFileæ–¹æ³•ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ResourceUtilsçš„getFileæ–¹æ³•åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚å› ä¸ºå®ƒä½¿ç”¨äº†classpath:å‰ç¼€ï¼Œè€Œè¿™ç§æ–¹å¼åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¹¶ä¸é€‚ç”¨ã€‚ File file &#x3D; ResourceUtils.getFile(&quot;classpath:excleTemplate&#x2F;test.xlsx&quot;); InputStream inputStream &#x3D; new FileInputStream(file); åº”ç”¨å®ä¾‹ï¼šspringè¯»å–jsonæ–‡ä»¶public static com.alibaba.fastjson.JSONObject getProblemType() throws IOException &#123; &#x2F;&#x2F; ä½¿ç”¨ ResourceUtils å·¥å…·ç±»è·å–ç±»è·¯å¾„ä¸‹çš„ problemType.json æ–‡ä»¶ File file &#x3D; ResourceUtils.getFile(&quot;classpath:data&#x2F;problemType.json&quot;); &#x2F;&#x2F; ä½¿ç”¨ FileUtils å·¥å…·ç±»å°†æ–‡ä»¶å†…å®¹è¯»å–ä¸ºå­—ç¬¦ä¸² String json &#x3D; FileUtils.readFileToString(file, &quot;UTF-8&quot;); &#x2F;&#x2F; ä½¿ç”¨ fastjson åº“å°†å­—ç¬¦ä¸²è§£æä¸º JSONObject å¯¹è±¡ com.alibaba.fastjson.JSONObject jsonObject &#x3D; JSON.parseObject(json); &#x2F;&#x2F; è¿”å›è§£æåçš„ JSONObject å¯¹è±¡ return jsonObject; &#125; è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ä»ç±»è·¯å¾„ä¸­è¯»å–ä¸€ä¸ªåä¸º problemType.json çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶å†…å®¹è§£æä¸º JSONObject å¯¹è±¡ï¼Œç„¶åè¿”å›è¯¥å¯¹è±¡ã€‚ä»¥ä¸‹æ˜¯æ³¨é‡Šçš„è¯¦ç»†è§£é‡Šï¼š public static com.alibaba.fastjson.JSONObject getProblemType() throws IOException &#123;: è¿™æ˜¯ä¸€ä¸ªå…¬å…±çš„é™æ€æ–¹æ³•ï¼Œè¿”å›ç±»å‹ä¸º com.alibaba.fastjson.JSONObjectï¼Œå¹¶ä¸”å¯èƒ½ä¼šæŠ›å‡º IOException å¼‚å¸¸ã€‚ File file = ResourceUtils.getFile(&quot;classpath:data/problemType.json&quot;);: ä½¿ç”¨ Spring æ¡†æ¶çš„ ResourceUtils å·¥å…·ç±»è·å–ç±»è·¯å¾„ä¸‹çš„ problemType.json æ–‡ä»¶ã€‚classpath: å‰ç¼€è¡¨ç¤ºæ–‡ä»¶ä½äºç±»è·¯å¾„ä¸‹çš„ data ç›®å½•ä¸­ã€‚ String json = FileUtils.readFileToString(file, &quot;UTF-8&quot;);: ä½¿ç”¨ Apache Commons IO å·¥å…·ç±» FileUtils å°†æ–‡ä»¶å†…å®¹è¯»å–ä¸ºå­—ç¬¦ä¸²ã€‚è¿™é‡ŒæŒ‡å®šäº†æ–‡ä»¶ç¼–ç ä¸º UTF-8ã€‚ com.alibaba.fastjson.JSONObject jsonObject = JSON.parseObject(json);: ä½¿ç”¨é˜¿é‡Œå·´å·´çš„ fastjson åº“å°†å­—ç¬¦ä¸²è§£æä¸º JSONObject å¯¹è±¡ã€‚ return jsonObject;: è¿”å›è§£æåçš„ JSONObject å¯¹è±¡ã€‚ æ›¿æ¢æˆæ›´ä¿é™©çš„æ–¹æ³• public static com.alibaba.fastjson.JSONObject getProblemType() throws IOException &#123; &#x2F;&#x2F; ä½¿ç”¨ ClassPathResource å·¥å…·ç±»è·å–ç±»è·¯å¾„ä¸‹çš„ problemType.json æ–‡ä»¶ ClassPathResource resource &#x3D; new ClassPathResource(&quot;data&#x2F;problemType.json&quot;); &#x2F;&#x2F; ä½¿ç”¨ IOUtils å·¥å…·ç±»å°†æ–‡ä»¶å†…å®¹è¯»å–ä¸ºå­—ç¬¦ä¸² String json &#x3D; IOUtils.toString(resource.getInputStream(), &quot;UTF-8&quot;); &#x2F;&#x2F; ä½¿ç”¨ fastjson åº“å°†å­—ç¬¦ä¸²è§£æä¸º JSONObject å¯¹è±¡ com.alibaba.fastjson.JSONObject jsonObject &#x3D; JSON.parseObject(json); &#x2F;&#x2F; è¿”å›è§£æåçš„ JSONObject å¯¹è±¡ return jsonObject; &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"},{"name":"Spring","slug":"Spring","permalink":"https://blog.ehzyil.xyz/tags/Spring/"}],"author":"ehzyil"},{"title":"ä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ to connect to the Docker daemon socket at unix:///var/run/docker.sock:'","slug":"2023/ä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/26/2023/ä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/%E4%B8%80%E6%9D%A1SQL%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84%EF%BC%9F/","excerpt":"","text":"ä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ è½¬è½½MySQLå®æˆ˜45è®²| 02 | æ—¥å¿—ç³»ç»Ÿï¼šä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ ä»ä¸€ä¸ªè¡¨çš„ä¸€æ¡æ›´æ–°è¯­å¥è¯´èµ·ï¼Œä¸‹é¢æ˜¯è¿™ä¸ªè¡¨çš„åˆ›å»ºè¯­å¥ï¼Œè¿™ä¸ªè¡¨æœ‰ä¸€ä¸ªä¸»é”® ID å’Œä¸€ä¸ªæ•´å‹å­—æ®µ cï¼š mysql&gt; create table T(ID int primary key, c int); å¦‚æœè¦å°† ID&#x3D;2 è¿™ä¸€è¡Œçš„å€¼åŠ  1ï¼ŒSQL è¯­å¥å°±ä¼šè¿™ä¹ˆå†™ï¼š mysql&gt; update T set c&#x3D;c+1 where ID&#x3D;2; ä»å‰é¢çš„ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿå¯ä»¥çŸ¥é“æ›´æ–°è¯­å¥ä¹Ÿä¼šèµ°ä¸€éç›¸åŒçš„æµç¨‹ã€‚ æ‰§è¡Œè¯­å¥å‰è¦å…ˆè¿æ¥æ•°æ®åº“ï¼Œè¿™æ˜¯è¿æ¥å™¨çš„å·¥ä½œã€‚ å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œåœ¨ä¸€ä¸ªè¡¨ä¸Šæœ‰æ›´æ–°çš„æ—¶å€™ï¼Œè·Ÿè¿™ä¸ªè¡¨æœ‰å…³çš„æŸ¥è¯¢ç¼“å­˜ä¼šå¤±æ•ˆï¼Œæ‰€ä»¥è¿™æ¡è¯­å¥å°±ä¼šæŠŠè¡¨ T ä¸Šæ‰€æœ‰ç¼“å­˜ç»“æœéƒ½æ¸…ç©ºã€‚è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„åŸå› ã€‚ æ¥ä¸‹æ¥ï¼Œåˆ†æå™¨ä¼šé€šè¿‡è¯æ³•å’Œè¯­æ³•è§£æçŸ¥é“è¿™æ˜¯ä¸€æ¡æ›´æ–°è¯­å¥ã€‚ä¼˜åŒ–å™¨å†³å®šè¦ä½¿ç”¨ ID è¿™ä¸ªç´¢å¼•ã€‚ç„¶åï¼Œæ‰§è¡Œå™¨è´Ÿè´£å…·ä½“æ‰§è¡Œï¼Œæ‰¾åˆ°è¿™ä¸€è¡Œï¼Œç„¶åæ›´æ–°ã€‚ ä¸æŸ¥è¯¢æµç¨‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œæ›´æ–°æµç¨‹è¿˜æ¶‰åŠä¸¤ä¸ªé‡è¦çš„æ—¥å¿—æ¨¡å—ï¼Œå®ƒä»¬æ­£æ˜¯æˆ‘ä»¬ä»Šå¤©è¦è®¨è®ºçš„ä¸»è§’ï¼šredo logï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œ binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰ã€‚å¦‚æœæ¥è§¦ MySQLï¼Œé‚£è¿™ä¸¤ä¸ªè¯è‚¯å®šæ˜¯ç»•ä¸è¿‡çš„ï¼Œæˆ‘åé¢çš„å†…å®¹é‡Œä¹Ÿä¼šä¸æ–­åœ°å’Œä½ å¼ºè°ƒã€‚ä¸è¿‡è¯è¯´å›æ¥ï¼Œredo log å’Œ binlog åœ¨è®¾è®¡ä¸Šæœ‰å¾ˆå¤šæœ‰æ„æ€çš„åœ°æ–¹ï¼Œè¿™äº›è®¾è®¡æ€è·¯ä¹Ÿå¯ä»¥ç”¨åˆ°ä½ è‡ªå·±çš„ç¨‹åºé‡Œã€‚ é‡è¦çš„æ—¥å¿—æ¨¡å—ï¼šredo logä¸çŸ¥é“ä½ è¿˜è®°ä¸è®°å¾—ã€Šå­”ä¹™å·±ã€‹è¿™ç¯‡æ–‡ç« ï¼Œé…’åº—æŒæŸœæœ‰ä¸€ä¸ªç²‰æ¿ï¼Œä¸“é—¨ç”¨æ¥è®°å½•å®¢äººçš„èµŠè´¦è®°å½•ã€‚å¦‚æœèµŠè´¦çš„äººä¸å¤šï¼Œé‚£ä¹ˆä»–å¯ä»¥æŠŠé¡¾å®¢åå’Œè´¦ç›®å†™åœ¨æ¿ä¸Šã€‚ä½†å¦‚æœèµŠè´¦çš„äººå¤šäº†ï¼Œç²‰æ¿æ€»ä¼šæœ‰è®°ä¸ä¸‹çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™æŒæŸœä¸€å®šè¿˜æœ‰ä¸€ä¸ªä¸“é—¨è®°å½•èµŠè´¦çš„è´¦æœ¬ã€‚ å¦‚æœæœ‰äººè¦èµŠè´¦æˆ–è€…è¿˜è´¦çš„è¯ï¼ŒæŒæŸœä¸€èˆ¬æœ‰ä¸¤ç§åšæ³•ï¼š ä¸€ç§åšæ³•æ˜¯ç›´æ¥æŠŠè´¦æœ¬ç¿»å‡ºæ¥ï¼ŒæŠŠè¿™æ¬¡èµŠçš„è´¦åŠ ä¸Šå»æˆ–è€…æ‰£é™¤æ‰ï¼› å¦ä¸€ç§åšæ³•æ˜¯å…ˆåœ¨ç²‰æ¿ä¸Šè®°ä¸‹è¿™æ¬¡çš„è´¦ï¼Œç­‰æ‰“çƒŠä»¥åå†æŠŠè´¦æœ¬ç¿»å‡ºæ¥æ ¸ç®—ã€‚ åœ¨ç”Ÿæ„çº¢ç«æŸœå°å¾ˆå¿™æ—¶ï¼ŒæŒæŸœä¸€å®šä¼šé€‰æ‹©åè€…ï¼Œå› ä¸ºå‰è€…æ“ä½œå®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ã€‚é¦–å…ˆï¼Œä½ å¾—æ‰¾åˆ°è¿™ä¸ªäººçš„èµŠè´¦æ€»é¢é‚£æ¡è®°å½•ã€‚ä½ æƒ³æƒ³ï¼Œå¯†å¯†éº»éº»å‡ åé¡µï¼ŒæŒæŸœè¦æ‰¾åˆ°é‚£ä¸ªåå­—ï¼Œå¯èƒ½è¿˜å¾—å¸¦ä¸Šè€èŠ±é•œæ…¢æ…¢æ‰¾ï¼Œæ‰¾åˆ°ä¹‹åå†æ‹¿å‡ºç®—ç›˜è®¡ç®—ï¼Œæœ€åå†å°†ç»“æœå†™å›åˆ°è´¦æœ¬ä¸Šã€‚ è¿™æ•´ä¸ªè¿‡ç¨‹æƒ³æƒ³éƒ½éº»çƒ¦ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œè¿˜æ˜¯å…ˆåœ¨ç²‰æ¿ä¸Šè®°ä¸€ä¸‹æ–¹ä¾¿ã€‚ä½ æƒ³æƒ³ï¼Œå¦‚æœæŒæŸœæ²¡æœ‰ç²‰æ¿çš„å¸®åŠ©ï¼Œæ¯æ¬¡è®°è´¦éƒ½å¾—ç¿»è´¦æœ¬ï¼Œæ•ˆç‡æ˜¯ä¸æ˜¯ä½å¾—è®©äººéš¾ä»¥å¿å—ï¼Ÿ åŒæ ·ï¼Œåœ¨ MySQL é‡Œä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¦‚æœæ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦å†™è¿›ç£ç›˜ï¼Œç„¶åç£ç›˜ä¹Ÿè¦æ‰¾åˆ°å¯¹åº”çš„é‚£æ¡è®°å½•ï¼Œç„¶åå†æ›´æ–°ï¼Œæ•´ä¸ªè¿‡ç¨‹ IO æˆæœ¬ã€æŸ¥æ‰¾æˆæœ¬éƒ½å¾ˆé«˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒMySQL çš„è®¾è®¡è€…å°±ç”¨äº†ç±»ä¼¼é…’åº—æŒæŸœç²‰æ¿çš„æ€è·¯æ¥æå‡æ›´æ–°æ•ˆç‡ã€‚ è€Œç²‰æ¿å’Œè´¦æœ¬é…åˆçš„æ•´ä¸ªè¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯ MySQL é‡Œç»å¸¸è¯´åˆ°çš„ WAL æŠ€æœ¯ï¼ŒWAL çš„å…¨ç§°æ˜¯ Write-Ahead Loggingï¼Œå®ƒçš„å…³é”®ç‚¹å°±æ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯å…ˆå†™ç²‰æ¿ï¼Œç­‰ä¸å¿™çš„æ—¶å€™å†å†™è´¦æœ¬ã€‚ å…·ä½“æ¥è¯´ï¼Œå½“æœ‰ä¸€æ¡è®°å½•éœ€è¦æ›´æ–°çš„æ—¶å€™ï¼ŒInnoDB å¼•æ“å°±ä¼šå…ˆæŠŠè®°å½•å†™åˆ° redo logï¼ˆç²‰æ¿ï¼‰é‡Œé¢ï¼Œå¹¶æ›´æ–°å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚åŒæ—¶ï¼ŒInnoDB å¼•æ“ä¼šåœ¨é€‚å½“çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªæ“ä½œè®°å½•æ›´æ–°åˆ°ç£ç›˜é‡Œé¢ï¼Œè€Œè¿™ä¸ªæ›´æ–°å¾€å¾€æ˜¯åœ¨ç³»ç»Ÿæ¯”è¾ƒç©ºé—²çš„æ—¶å€™åšï¼Œè¿™å°±åƒæ‰“çƒŠä»¥åæŒæŸœåšçš„äº‹ã€‚ å¦‚æœä»Šå¤©èµŠè´¦çš„ä¸å¤šï¼ŒæŒæŸœå¯ä»¥ç­‰æ‰“çƒŠåå†æ•´ç†ã€‚ä½†å¦‚æœæŸå¤©èµŠè´¦çš„ç‰¹åˆ«å¤šï¼Œç²‰æ¿å†™æ»¡äº†ï¼Œåˆæ€ä¹ˆåŠå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™æŒæŸœåªå¥½æ”¾ä¸‹æ‰‹ä¸­çš„æ´»å„¿ï¼ŒæŠŠç²‰æ¿ä¸­çš„ä¸€éƒ¨åˆ†èµŠè´¦è®°å½•æ›´æ–°åˆ°è´¦æœ¬ä¸­ï¼Œç„¶åæŠŠè¿™äº›è®°å½•ä»ç²‰æ¿ä¸Šæ“¦æ‰ï¼Œä¸ºè®°æ–°è´¦è…¾å‡ºç©ºé—´ã€‚ ä¸æ­¤ç±»ä¼¼ï¼ŒInnoDB çš„ redo log æ˜¯å›ºå®šå¤§å°çš„ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸ºä¸€ç»„ 4 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯ 1GBï¼Œé‚£ä¹ˆè¿™å—â€œç²‰æ¿â€æ€»å…±å°±å¯ä»¥è®°å½• 4GB çš„æ“ä½œã€‚ä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾å°±åˆå›åˆ°å¼€å¤´å¾ªç¯å†™ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªå›¾æ‰€ç¤ºã€‚ write pos æ˜¯å½“å‰è®°å½•çš„ä½ç½®ï¼Œä¸€è¾¹å†™ä¸€è¾¹åç§»ï¼Œå†™åˆ°ç¬¬ 3 å·æ–‡ä»¶æœ«å°¾åå°±å›åˆ° 0 å·æ–‡ä»¶å¼€å¤´ã€‚checkpoint æ˜¯å½“å‰è¦æ“¦é™¤çš„ä½ç½®ï¼Œä¹Ÿæ˜¯å¾€åæ¨ç§»å¹¶ä¸”å¾ªç¯çš„ï¼Œæ“¦é™¤è®°å½•å‰è¦æŠŠè®°å½•æ›´æ–°åˆ°æ•°æ®æ–‡ä»¶ã€‚ write pos å’Œ checkpoint ä¹‹é—´çš„æ˜¯â€œç²‰æ¿â€ä¸Šè¿˜ç©ºç€çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨æ¥è®°å½•æ–°çš„æ“ä½œã€‚å¦‚æœ write pos è¿½ä¸Š checkpointï¼Œè¡¨ç¤ºâ€œç²‰æ¿â€æ»¡äº†ï¼Œè¿™æ—¶å€™ä¸èƒ½å†æ‰§è¡Œæ–°çš„æ›´æ–°ï¼Œå¾—åœä¸‹æ¥å…ˆæ“¦æ‰ä¸€äº›è®°å½•ï¼ŒæŠŠ checkpoint æ¨è¿›ä¸€ä¸‹ã€‚ æœ‰äº† redo logï¼ŒInnoDB å°±å¯ä»¥ä¿è¯å³ä½¿æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¹‹å‰æäº¤çš„è®°å½•éƒ½ä¸ä¼šä¸¢å¤±ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸ºcrash-safeã€‚ è¦ç†è§£ crash-safe è¿™ä¸ªæ¦‚å¿µï¼Œå¯ä»¥æƒ³æƒ³æˆ‘ä»¬å‰é¢èµŠè´¦è®°å½•çš„ä¾‹å­ã€‚åªè¦èµŠè´¦è®°å½•è®°åœ¨äº†ç²‰æ¿ä¸Šæˆ–å†™åœ¨äº†è´¦æœ¬ä¸Šï¼Œä¹‹åå³ä½¿æŒæŸœå¿˜è®°äº†ï¼Œæ¯”å¦‚çªç„¶åœä¸šå‡ å¤©ï¼Œæ¢å¤ç”Ÿæ„åä¾ç„¶å¯ä»¥é€šè¿‡è´¦æœ¬å’Œç²‰æ¿ä¸Šçš„æ•°æ®æ˜ç¡®èµŠè´¦è´¦ç›®ã€‚ é‡è¦çš„æ—¥å¿—æ¨¡å—ï¼šbinlogå‰é¢æˆ‘ä»¬è®²è¿‡ï¼ŒMySQL æ•´ä½“æ¥çœ‹ï¼Œå…¶å®å°±æœ‰ä¸¤å—ï¼šä¸€å—æ˜¯ Server å±‚ï¼Œå®ƒä¸»è¦åšçš„æ˜¯ MySQL åŠŸèƒ½å±‚é¢çš„äº‹æƒ…ï¼›è¿˜æœ‰ä¸€å—æ˜¯å¼•æ“å±‚ï¼Œè´Ÿè´£å­˜å‚¨ç›¸å…³çš„å…·ä½“äº‹å®œã€‚ä¸Šé¢æˆ‘ä»¬èŠåˆ°çš„ç²‰æ¿ redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„æ—¥å¿—ï¼Œè€Œ Server å±‚ä¹Ÿæœ‰è‡ªå·±çš„æ—¥å¿—ï¼Œç§°ä¸º binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰ã€‚ æˆ‘æƒ³ä½ è‚¯å®šä¼šé—®ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä»½æ—¥å¿—å‘¢ï¼Ÿ å› ä¸ºæœ€å¼€å§‹ MySQL é‡Œå¹¶æ²¡æœ‰ InnoDB å¼•æ“ã€‚MySQL è‡ªå¸¦çš„å¼•æ“æ˜¯ MyISAMï¼Œä½†æ˜¯ MyISAM æ²¡æœ‰ crash-safe çš„èƒ½åŠ›ï¼Œbinlog æ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚è€Œ InnoDB æ˜¯å¦ä¸€ä¸ªå…¬å¸ä»¥æ’ä»¶å½¢å¼å¼•å…¥ MySQL çš„ï¼Œæ—¢ç„¶åªä¾é  binlog æ˜¯æ²¡æœ‰ crash-safe èƒ½åŠ›çš„ï¼Œæ‰€ä»¥ InnoDB ä½¿ç”¨å¦å¤–ä¸€å¥—æ—¥å¿—ç³»ç»Ÿâ€”â€”ä¹Ÿå°±æ˜¯ redo log æ¥å®ç° crash-safe èƒ½åŠ›ã€‚ è¿™ä¸¤ç§æ—¥å¿—æœ‰ä»¥ä¸‹ä¸‰ç‚¹ä¸åŒã€‚ redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„ï¼›binlog æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚ redo log æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€ï¼›binlog æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ ID&#x3D;2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1 â€ã€‚ redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚ æœ‰äº†å¯¹è¿™ä¸¤ä¸ªæ—¥å¿—çš„æ¦‚å¿µæ€§ç†è§£ï¼Œæˆ‘ä»¬å†æ¥çœ‹æ‰§è¡Œå™¨å’Œ InnoDB å¼•æ“åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„ update è¯­å¥æ—¶çš„å†…éƒ¨æµç¨‹ã€‚ update T set c=c+1 where ID=2; æ‰§è¡Œå™¨å…ˆæ‰¾å¼•æ“å– ID&#x3D;2 è¿™ä¸€è¡Œã€‚ID æ˜¯ä¸»é”®ï¼Œå¼•æ“ç›´æ¥ç”¨æ ‘æœç´¢æ‰¾åˆ°è¿™ä¸€è¡Œã€‚å¦‚æœ ID&#x3D;2 è¿™ä¸€è¡Œæ‰€åœ¨çš„æ•°æ®é¡µæœ¬æ¥å°±åœ¨å†…å­˜ä¸­ï¼Œå°±ç›´æ¥è¿”å›ç»™æ‰§è¡Œå™¨ï¼›å¦åˆ™ï¼Œéœ€è¦å…ˆä»ç£ç›˜è¯»å…¥å†…å­˜ï¼Œç„¶åå†è¿”å›ã€‚ æ‰§è¡Œå™¨æ‹¿åˆ°å¼•æ“ç»™çš„è¡Œæ•°æ®ï¼ŒæŠŠè¿™ä¸ªå€¼åŠ ä¸Š 1ï¼Œæ¯”å¦‚åŸæ¥æ˜¯ Nï¼Œç°åœ¨å°±æ˜¯ N+1ï¼Œå¾—åˆ°æ–°çš„ä¸€è¡Œæ•°æ®ï¼Œå†è°ƒç”¨å¼•æ“æ¥å£å†™å…¥è¿™è¡Œæ–°æ•°æ®ã€‚ å¼•æ“å°†è¿™è¡Œæ–°æ•°æ®æ›´æ–°åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶å°†è¿™ä¸ªæ›´æ–°æ“ä½œè®°å½•åˆ° redo log é‡Œé¢ï¼Œæ­¤æ—¶ redo log å¤„äº prepare çŠ¶æ€ã€‚ç„¶åå‘ŠçŸ¥æ‰§è¡Œå™¨æ‰§è¡Œå®Œæˆäº†ï¼Œéšæ—¶å¯ä»¥æäº¤äº‹åŠ¡ã€‚ æ‰§è¡Œå™¨ç”Ÿæˆè¿™ä¸ªæ“ä½œçš„ binlogï¼Œå¹¶æŠŠ binlog å†™å…¥ç£ç›˜ã€‚ æ‰§è¡Œå™¨è°ƒç”¨å¼•æ“çš„æäº¤äº‹åŠ¡æ¥å£ï¼Œå¼•æ“æŠŠåˆšåˆšå†™å…¥çš„ redo log æ”¹æˆæäº¤ï¼ˆcommitï¼‰çŠ¶æ€ï¼Œæ›´æ–°å®Œæˆã€‚ è¿™é‡Œæˆ‘ç»™å‡ºè¿™ä¸ª update è¯­å¥çš„æ‰§è¡Œæµç¨‹å›¾ï¼Œå›¾ä¸­æµ…è‰²æ¡†è¡¨ç¤ºæ˜¯åœ¨ InnoDB å†…éƒ¨æ‰§è¡Œçš„ï¼Œæ·±è‰²æ¡†è¡¨ç¤ºæ˜¯åœ¨æ‰§è¡Œå™¨ä¸­æ‰§è¡Œçš„ã€‚ ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œæœ€åä¸‰æ­¥çœ‹ä¸Šå»æœ‰ç‚¹â€œç»•â€ï¼Œå°† redo log çš„å†™å…¥æ‹†æˆäº†ä¸¤ä¸ªæ­¥éª¤ï¼šprepare å’Œ commitï¼Œè¿™å°±æ˜¯â€ä¸¤é˜¶æ®µæäº¤â€ã€‚ ä¸¤é˜¶æ®µæäº¤ä¸ºä»€ä¹ˆå¿…é¡»æœ‰â€œä¸¤é˜¶æ®µæäº¤â€å‘¢ï¼Ÿè¿™æ˜¯ä¸ºäº†è®©ä¸¤ä»½æ—¥å¿—ä¹‹é—´çš„é€»è¾‘ä¸€è‡´ã€‚è¦è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¾—ä»æ€æ ·è®©æ•°æ®åº“æ¢å¤åˆ°åŠä¸ªæœˆå†…ä»»æ„ä¸€ç§’çš„çŠ¶æ€ï¼Ÿè¯´èµ·ã€‚ å‰é¢æˆ‘ä»¬è¯´è¿‡äº†ï¼Œbinlog ä¼šè®°å½•æ‰€æœ‰çš„é€»è¾‘æ“ä½œï¼Œå¹¶ä¸”æ˜¯é‡‡ç”¨â€œè¿½åŠ å†™â€çš„å½¢å¼ã€‚å¦‚æœä½ çš„ DBA æ‰¿è¯ºè¯´åŠä¸ªæœˆå†…å¯ä»¥æ¢å¤ï¼Œé‚£ä¹ˆå¤‡ä»½ç³»ç»Ÿä¸­ä¸€å®šä¼šä¿å­˜æœ€è¿‘åŠä¸ªæœˆçš„æ‰€æœ‰ binlogï¼ŒåŒæ—¶ç³»ç»Ÿä¼šå®šæœŸåšæ•´åº“å¤‡ä»½ã€‚è¿™é‡Œçš„â€œå®šæœŸâ€å–å†³äºç³»ç»Ÿçš„é‡è¦æ€§ï¼Œå¯ä»¥æ˜¯ä¸€å¤©ä¸€å¤‡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€å‘¨ä¸€å¤‡ã€‚ å½“éœ€è¦æ¢å¤åˆ°æŒ‡å®šçš„æŸä¸€ç§’æ—¶ï¼Œæ¯”å¦‚æŸå¤©ä¸‹åˆä¸¤ç‚¹å‘ç°ä¸­åˆåäºŒç‚¹æœ‰ä¸€æ¬¡è¯¯åˆ è¡¨ï¼Œéœ€è¦æ‰¾å›æ•°æ®ï¼Œé‚£ä½ å¯ä»¥è¿™ä¹ˆåšï¼š é¦–å…ˆï¼Œæ‰¾åˆ°æœ€è¿‘çš„ä¸€æ¬¡å…¨é‡å¤‡ä»½ï¼Œå¦‚æœä½ è¿æ°”å¥½ï¼Œå¯èƒ½å°±æ˜¯æ˜¨å¤©æ™šä¸Šçš„ä¸€ä¸ªå¤‡ä»½ï¼Œä»è¿™ä¸ªå¤‡ä»½æ¢å¤åˆ°ä¸´æ—¶åº“ï¼› ç„¶åï¼Œä»å¤‡ä»½çš„æ—¶é—´ç‚¹å¼€å§‹ï¼Œå°†å¤‡ä»½çš„ binlog ä¾æ¬¡å–å‡ºæ¥ï¼Œé‡æ”¾åˆ°ä¸­åˆè¯¯åˆ è¡¨ä¹‹å‰çš„é‚£ä¸ªæ—¶åˆ»ã€‚ è¿™æ ·ä½ çš„ä¸´æ—¶åº“å°±è·Ÿè¯¯åˆ ä¹‹å‰çš„çº¿ä¸Šåº“ä¸€æ ·äº†ï¼Œç„¶åä½ å¯ä»¥æŠŠè¡¨æ•°æ®ä»ä¸´æ—¶åº“å–å‡ºæ¥ï¼ŒæŒ‰éœ€è¦æ¢å¤åˆ°çº¿ä¸Šåº“å»ã€‚ å¥½äº†ï¼Œè¯´å®Œäº†æ•°æ®æ¢å¤è¿‡ç¨‹ï¼Œæˆ‘ä»¬å›æ¥è¯´è¯´ï¼Œä¸ºä»€ä¹ˆæ—¥å¿—éœ€è¦â€œä¸¤é˜¶æ®µæäº¤â€ã€‚è¿™é‡Œä¸å¦¨ç”¨åè¯æ³•æ¥è¿›è¡Œè§£é‡Šã€‚ ç”±äº redo log å’Œ binlog æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„é€»è¾‘ï¼Œå¦‚æœä¸ç”¨ä¸¤é˜¶æ®µæäº¤ï¼Œè¦ä¹ˆå°±æ˜¯å…ˆå†™å®Œ redo log å†å†™ binlogï¼Œæˆ–è€…é‡‡ç”¨åè¿‡æ¥çš„é¡ºåºã€‚æˆ‘ä»¬çœ‹çœ‹è¿™ä¸¤ç§æ–¹å¼ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚ ä»ç„¶ç”¨å‰é¢çš„ update è¯­å¥æ¥åšä¾‹å­ã€‚å‡è®¾å½“å‰ ID&#x3D;2 çš„è¡Œï¼Œå­—æ®µ c çš„å€¼æ˜¯ 0ï¼Œå†å‡è®¾æ‰§è¡Œ update è¯­å¥è¿‡ç¨‹ä¸­åœ¨å†™å®Œç¬¬ä¸€ä¸ªæ—¥å¿—åï¼Œç¬¬äºŒä¸ªæ—¥å¿—è¿˜æ²¡æœ‰å†™å®ŒæœŸé—´å‘ç”Ÿäº† crashï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ å…ˆå†™ redo log åå†™ binlogã€‚å‡è®¾åœ¨ redo log å†™å®Œï¼Œbinlog è¿˜æ²¡æœ‰å†™å®Œçš„æ—¶å€™ï¼ŒMySQL è¿›ç¨‹å¼‚å¸¸é‡å¯ã€‚ç”±äºæˆ‘ä»¬å‰é¢è¯´è¿‡çš„ï¼Œredo log å†™å®Œä¹‹åï¼Œç³»ç»Ÿå³ä½¿å´©æºƒï¼Œä»ç„¶èƒ½å¤ŸæŠŠæ•°æ®æ¢å¤å›æ¥ï¼Œæ‰€ä»¥æ¢å¤åè¿™ä¸€è¡Œ c çš„å€¼æ˜¯ 1ã€‚ä½†æ˜¯ç”±äº binlog æ²¡å†™å®Œå°± crash äº†ï¼Œè¿™æ—¶å€™ binlog é‡Œé¢å°±æ²¡æœ‰è®°å½•è¿™ä¸ªè¯­å¥ã€‚å› æ­¤ï¼Œä¹‹åå¤‡ä»½æ—¥å¿—çš„æ—¶å€™ï¼Œå­˜èµ·æ¥çš„ binlog é‡Œé¢å°±æ²¡æœ‰è¿™æ¡è¯­å¥ã€‚ç„¶åä½ ä¼šå‘ç°ï¼Œå¦‚æœéœ€è¦ç”¨è¿™ä¸ª binlog æ¥æ¢å¤ä¸´æ—¶åº“çš„è¯ï¼Œç”±äºè¿™ä¸ªè¯­å¥çš„ binlog ä¸¢å¤±ï¼Œè¿™ä¸ªä¸´æ—¶åº“å°±ä¼šå°‘äº†è¿™ä¸€æ¬¡æ›´æ–°ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ c çš„å€¼å°±æ˜¯ 0ï¼Œä¸åŸåº“çš„å€¼ä¸åŒã€‚ å…ˆå†™ binlog åå†™ redo logã€‚å¦‚æœåœ¨ binlog å†™å®Œä¹‹å crashï¼Œç”±äº redo log è¿˜æ²¡å†™ï¼Œå´©æºƒæ¢å¤ä»¥åè¿™ä¸ªäº‹åŠ¡æ— æ•ˆï¼Œæ‰€ä»¥è¿™ä¸€è¡Œ c çš„å€¼æ˜¯ 0ã€‚ä½†æ˜¯ binlog é‡Œé¢å·²ç»è®°å½•äº†â€œæŠŠ c ä» 0 æ”¹æˆ 1â€è¿™ä¸ªæ—¥å¿—ã€‚æ‰€ä»¥ï¼Œåœ¨ä¹‹åç”¨ binlog æ¥æ¢å¤çš„æ—¶å€™å°±å¤šäº†ä¸€ä¸ªäº‹åŠ¡å‡ºæ¥ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ c çš„å€¼å°±æ˜¯ 1ï¼Œä¸åŸåº“çš„å€¼ä¸åŒã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¸ä½¿ç”¨â€œä¸¤é˜¶æ®µæäº¤â€ï¼Œé‚£ä¹ˆæ•°æ®åº“çš„çŠ¶æ€å°±æœ‰å¯èƒ½å’Œç”¨å®ƒçš„æ—¥å¿—æ¢å¤å‡ºæ¥çš„åº“çš„çŠ¶æ€ä¸ä¸€è‡´ã€‚ ä½ å¯èƒ½ä¼šè¯´ï¼Œè¿™ä¸ªæ¦‚ç‡æ˜¯ä¸æ˜¯å¾ˆä½ï¼Œå¹³æ—¶ä¹Ÿæ²¡æœ‰ä»€ä¹ˆåŠ¨ä¸åŠ¨å°±éœ€è¦æ¢å¤ä¸´æ—¶åº“çš„åœºæ™¯å‘€ï¼Ÿ å…¶å®ä¸æ˜¯çš„ï¼Œä¸åªæ˜¯è¯¯æ“ä½œåéœ€è¦ç”¨è¿™ä¸ªè¿‡ç¨‹æ¥æ¢å¤æ•°æ®ã€‚å½“ä½ éœ€è¦æ‰©å®¹çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯éœ€è¦å†å¤šæ­å»ºä¸€äº›å¤‡åº“æ¥å¢åŠ ç³»ç»Ÿçš„è¯»èƒ½åŠ›çš„æ—¶å€™ï¼Œç°åœ¨å¸¸è§çš„åšæ³•ä¹Ÿæ˜¯ç”¨å…¨é‡å¤‡ä»½åŠ ä¸Šåº”ç”¨ binlog æ¥å®ç°çš„ï¼Œè¿™ä¸ªâ€œä¸ä¸€è‡´â€å°±ä¼šå¯¼è‡´ä½ çš„çº¿ä¸Šå‡ºç°ä¸»ä»æ•°æ®åº“ä¸ä¸€è‡´çš„æƒ…å†µã€‚ ç®€å•è¯´ï¼Œredo log å’Œ binlog éƒ½å¯ä»¥ç”¨äºè¡¨ç¤ºäº‹åŠ¡çš„æäº¤çŠ¶æ€ï¼Œè€Œä¸¤é˜¶æ®µæäº¤å°±æ˜¯è®©è¿™ä¸¤ä¸ªçŠ¶æ€ä¿æŒé€»è¾‘ä¸Šçš„ä¸€è‡´ã€‚ å°ç»“redo log ç”¨äºä¿è¯ crash-safe èƒ½åŠ›ã€‚innodb_flush_log_at_trx_commit è¿™ä¸ªå‚æ•°è®¾ç½®æˆ 1 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡çš„ redo log éƒ½ç›´æ¥æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚è¿™ä¸ªå‚æ•°æˆ‘å»ºè®®ä½ è®¾ç½®æˆ 1ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ MySQL å¼‚å¸¸é‡å¯ä¹‹åæ•°æ®ä¸ä¸¢å¤±ã€‚ sync_binlog è¿™ä¸ªå‚æ•°è®¾ç½®æˆ 1 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡çš„ binlog éƒ½æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚è¿™ä¸ªå‚æ•°æˆ‘ä¹Ÿå»ºè®®ä½ è®¾ç½®æˆ 1ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ MySQL å¼‚å¸¸é‡å¯ä¹‹å binlog ä¸ä¸¢å¤±ã€‚ æˆ‘è¿˜è·Ÿä½ ä»‹ç»äº†ä¸ MySQL æ—¥å¿—ç³»ç»Ÿå¯†åˆ‡ç›¸å…³çš„â€œä¸¤é˜¶æ®µæäº¤â€ã€‚ä¸¤é˜¶æ®µæäº¤æ˜¯è·¨ç³»ç»Ÿç»´æŒæ•°æ®é€»è¾‘ä¸€è‡´æ€§æ—¶å¸¸ç”¨çš„ä¸€ä¸ªæ–¹æ¡ˆï¼Œå³ä½¿ä½ ä¸åšæ•°æ®åº“å†…æ ¸å¼€å‘ï¼Œæ—¥å¸¸å¼€å‘ä¸­ä¹Ÿæœ‰å¯èƒ½ä¼šç”¨åˆ°ã€‚ æ€è€ƒé¢˜å‰é¢è¯´åˆ°å®šæœŸå…¨é‡å¤‡ä»½çš„å‘¨æœŸâ€œå–å†³äºç³»ç»Ÿé‡è¦æ€§ï¼Œæœ‰çš„æ˜¯ä¸€å¤©ä¸€å¤‡ï¼Œæœ‰çš„æ˜¯ä¸€å‘¨ä¸€å¤‡â€ã€‚é‚£ä¹ˆåœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ï¼Œä¸€å¤©ä¸€å¤‡ä¼šæ¯”ä¸€å‘¨ä¸€å¤‡æ›´æœ‰ä¼˜åŠ¿å‘¢ï¼Ÿæˆ–è€…è¯´ï¼Œå®ƒå½±å“äº†è¿™ä¸ªæ•°æ®åº“ç³»ç»Ÿçš„å“ªä¸ªæŒ‡æ ‡ï¼Ÿ å¥½å¤„æ˜¯â€œæœ€é•¿æ¢å¤æ—¶é—´â€æ›´çŸ­ã€‚ åœ¨ä¸€å¤©ä¸€å¤‡çš„æ¨¡å¼é‡Œï¼Œæœ€åæƒ…å†µä¸‹éœ€è¦åº”ç”¨ä¸€å¤©çš„ binlogã€‚æ¯”å¦‚ï¼Œä½ æ¯å¤© 0 ç‚¹åšä¸€æ¬¡å…¨é‡å¤‡ä»½ï¼Œè€Œè¦æ¢å¤å‡ºä¸€ä¸ªåˆ°æ˜¨å¤©æ™šä¸Š 23 ç‚¹çš„å¤‡ä»½ã€‚ ä¸€å‘¨ä¸€å¤‡æœ€åæƒ…å†µå°±è¦åº”ç”¨ä¸€å‘¨çš„ binlog äº†ã€‚ ç³»ç»Ÿçš„å¯¹åº”æŒ‡æ ‡å°±æ˜¯RTOï¼ˆæ¢å¤ç›®æ ‡æ—¶é—´ï¼‰ã€‚ å½“ç„¶è¿™ä¸ªæ˜¯æœ‰æˆæœ¬çš„ï¼Œå› ä¸ºæ›´é¢‘ç¹å…¨é‡å¤‡ä»½éœ€è¦æ¶ˆè€—æ›´å¤šå­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥è¿™ä¸ª RTO æ˜¯æˆæœ¬æ¢æ¥çš„ï¼Œå°±éœ€è¦ä½ æ ¹æ®ä¸šåŠ¡é‡è¦æ€§æ¥è¯„ä¼°äº†ã€‚","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://blog.ehzyil.xyz/tags/MySQL/"}],"author":"ehzyil"},{"title":"ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ","slug":"2023/ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/26/2023/ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/%E4%B8%80%E6%9D%A1SQL%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84%EF%BC%9F/","excerpt":"","text":"ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ è½¬è½½MySQLå®æˆ˜45è®²| 01 | åŸºç¡€æ¶æ„ï¼šä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ å¹³æ—¶æˆ‘ä»¬ä½¿ç”¨æ•°æ®åº“ï¼Œçœ‹åˆ°çš„é€šå¸¸éƒ½æ˜¯ä¸€ä¸ªæ•´ä½“ã€‚æ¯”å¦‚ï¼Œä½ æœ‰ä¸ªæœ€ç®€å•çš„è¡¨ï¼Œè¡¨é‡Œåªæœ‰ä¸€ä¸ª ID å­—æ®µï¼Œåœ¨æ‰§è¡Œä¸‹é¢è¿™ä¸ªæŸ¥è¯¢è¯­å¥æ—¶ï¼š mysql> update T set c=c+1 where ID=2; æˆ‘ä»¬çœ‹åˆ°çš„åªæ˜¯è¾“å…¥ä¸€æ¡è¯­å¥ï¼Œè¿”å›ä¸€ä¸ªç»“æœï¼Œå´ä¸çŸ¥é“è¿™æ¡è¯­å¥åœ¨ MySQL å†…éƒ¨çš„æ‰§è¡Œè¿‡ç¨‹ã€‚ ä»Šå¤©æ¥æŠŠ MySQL æ‹†è§£ä¸€ä¸‹ï¼Œçœ‹çœ‹é‡Œé¢éƒ½æœ‰å“ªäº›â€œé›¶ä»¶â€ï¼Œå¸Œæœ›å€Ÿç”±è¿™ä¸ªæ‹†è§£è¿‡ç¨‹ï¼Œè®©æˆ‘ä»¬å¯¹MySQL æœ‰æ›´æ·±å…¥çš„ç†è§£ã€‚è¿™æ ·å½“æˆ‘ä»¬ç¢°åˆ° MySQL çš„ä¸€äº›å¼‚å¸¸æˆ–è€…é—®é¢˜æ—¶ï¼Œå°±èƒ½å¤Ÿç›´æˆ³æœ¬è´¨ï¼Œæ›´ä¸ºå¿«é€Ÿåœ°å®šä½å¹¶è§£å†³é—®é¢˜ã€‚ ä¸‹é¢æ˜¯ MySQL çš„åŸºæœ¬æ¶æ„ç¤ºæ„å›¾ï¼Œä»ä¸­å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ° SQL è¯­å¥åœ¨ MySQL çš„å„ä¸ªåŠŸèƒ½æ¨¡å—ä¸­çš„æ‰§è¡Œè¿‡ç¨‹ã€‚ å¤§ä½“æ¥è¯´ï¼ŒMySQL å¯ä»¥åˆ†ä¸º Server å±‚å’Œå­˜å‚¨å¼•æ“å±‚ä¸¤éƒ¨åˆ†ã€‚ Server å±‚åŒ…æ‹¬è¿æ¥å™¨ã€æŸ¥è¯¢ç¼“å­˜ã€åˆ†æå™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨ç­‰ï¼Œæ¶µç›– MySQL çš„å¤§å¤šæ•°æ ¸å¿ƒæœåŠ¡åŠŸèƒ½ï¼Œä»¥åŠæ‰€æœ‰çš„å†…ç½®å‡½æ•°ï¼ˆå¦‚æ—¥æœŸã€æ—¶é—´ã€æ•°å­¦å’ŒåŠ å¯†å‡½æ•°ç­‰ï¼‰ï¼Œæ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½éƒ½åœ¨è¿™ä¸€å±‚å®ç°ï¼Œæ¯”å¦‚å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ã€è§†å›¾ç­‰ã€‚ è€Œå­˜å‚¨å¼•æ“å±‚è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œæå–ã€‚å…¶æ¶æ„æ¨¡å¼æ˜¯æ’ä»¶å¼çš„ï¼Œæ”¯æŒ InnoDBã€MyISAMã€Memory ç­‰å¤šä¸ªå­˜å‚¨å¼•æ“ã€‚ç°åœ¨æœ€å¸¸ç”¨çš„å­˜å‚¨å¼•æ“æ˜¯ InnoDBï¼Œå®ƒä» MySQL 5.5.5 ç‰ˆæœ¬å¼€å§‹æˆä¸ºäº†é»˜è®¤å­˜å‚¨å¼•æ“ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æ‰§è¡Œ create table å»ºè¡¨çš„æ—¶å€™ï¼Œå¦‚æœä¸æŒ‡å®šå¼•æ“ç±»å‹ï¼Œé»˜è®¤ä½¿ç”¨çš„å°±æ˜¯ InnoDBã€‚ä¸è¿‡ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šå­˜å‚¨å¼•æ“çš„ç±»å‹æ¥é€‰æ‹©åˆ«çš„å¼•æ“ï¼Œæ¯”å¦‚åœ¨ create table è¯­å¥ä¸­ä½¿ç”¨ engine&#x3D;memory, æ¥æŒ‡å®šä½¿ç”¨å†…å­˜å¼•æ“åˆ›å»ºè¡¨ã€‚ä¸åŒå­˜å‚¨å¼•æ“çš„è¡¨æ•°æ®å­˜å–æ–¹å¼ä¸åŒï¼Œæ”¯æŒçš„åŠŸèƒ½ä¹Ÿä¸åŒï¼Œåœ¨åé¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šè®¨è®ºåˆ°å¼•æ“çš„é€‰æ‹©ã€‚ ä»å›¾ä¸­ä¸éš¾çœ‹å‡ºï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“å…±ç”¨ä¸€ä¸ªServer å±‚ï¼Œä¹Ÿå°±æ˜¯ä»è¿æ¥å™¨åˆ°æ‰§è¡Œå™¨çš„éƒ¨åˆ†ã€‚ä½ å¯ä»¥å…ˆå¯¹æ¯ä¸ªç»„ä»¶çš„åå­—æœ‰ä¸ªå°è±¡ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šç»“åˆå¼€å¤´æåˆ°çš„é‚£æ¡ SQL è¯­å¥ï¼Œå¸¦ä½ èµ°ä¸€éæ•´ä¸ªæ‰§è¡Œæµç¨‹ï¼Œä¾æ¬¡çœ‹ä¸‹æ¯ä¸ªç»„ä»¶çš„ä½œç”¨ã€‚ è¿æ¥å™¨ç¬¬ä¸€æ­¥ï¼Œä½ ä¼šå…ˆè¿æ¥åˆ°è¿™ä¸ªæ•°æ®åº“ä¸Šï¼Œè¿™æ—¶å€™æ¥å¾…ä½ çš„å°±æ˜¯è¿æ¥å™¨ã€‚è¿æ¥å™¨è´Ÿè´£è·Ÿå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ã€è·å–æƒé™ã€ç»´æŒå’Œç®¡ç†è¿æ¥ã€‚è¿æ¥å‘½ä»¤ä¸€èˆ¬æ˜¯è¿™ä¹ˆå†™çš„ï¼š mysql -h$ip -P$port -u$user -p è¾“å®Œå‘½ä»¤ä¹‹åï¼Œä½ å°±éœ€è¦åœ¨äº¤äº’å¯¹è¯é‡Œé¢è¾“å…¥å¯†ç ã€‚è™½ç„¶å¯†ç ä¹Ÿå¯ä»¥ç›´æ¥è·Ÿåœ¨ -p åé¢å†™åœ¨å‘½ä»¤è¡Œä¸­ï¼Œä½†è¿™æ ·å¯èƒ½ä¼šå¯¼è‡´ä½ çš„å¯†ç æ³„éœ²ã€‚å¦‚æœä½ è¿çš„æ˜¯ç”Ÿäº§æœåŠ¡å™¨ï¼Œå¼ºçƒˆå»ºè®®ä½ ä¸è¦è¿™ä¹ˆåšã€‚ è¿æ¥å‘½ä»¤ä¸­çš„ mysql æ˜¯å®¢æˆ·ç«¯å·¥å…·ï¼Œç”¨æ¥è·ŸæœåŠ¡ç«¯å»ºç«‹è¿æ¥ã€‚åœ¨å®Œæˆç»å…¸çš„ TCP æ¡æ‰‹åï¼Œè¿æ¥å™¨å°±è¦å¼€å§‹è®¤è¯ä½ çš„èº«ä»½ï¼Œè¿™ä¸ªæ—¶å€™ç”¨çš„å°±æ˜¯ä½ è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ å¦‚æœç”¨æˆ·åæˆ–å¯†ç ä¸å¯¹ï¼Œä½ å°±ä¼šæ”¶åˆ°ä¸€ä¸ªâ€Access denied for userâ€çš„é”™è¯¯ï¼Œç„¶åå®¢æˆ·ç«¯ç¨‹åºç»“æŸæ‰§è¡Œã€‚ å¦‚æœç”¨æˆ·åå¯†ç è®¤è¯é€šè¿‡ï¼Œè¿æ¥å™¨ä¼šåˆ°æƒé™è¡¨é‡Œé¢æŸ¥å‡ºä½ æ‹¥æœ‰çš„æƒé™ã€‚ä¹‹åï¼Œè¿™ä¸ªè¿æ¥é‡Œé¢çš„æƒé™åˆ¤æ–­é€»è¾‘ï¼Œéƒ½å°†ä¾èµ–äºæ­¤æ—¶è¯»åˆ°çš„æƒé™ã€‚ è¿™å°±æ„å‘³ç€ï¼Œä¸€ä¸ªç”¨æˆ·æˆåŠŸå»ºç«‹è¿æ¥åï¼Œå³ä½¿ä½ ç”¨ç®¡ç†å‘˜è´¦å·å¯¹è¿™ä¸ªç”¨æˆ·çš„æƒé™åšäº†ä¿®æ”¹ï¼Œä¹Ÿä¸ä¼šå½±å“å·²ç»å­˜åœ¨è¿æ¥çš„æƒé™ã€‚ä¿®æ”¹å®Œæˆåï¼Œåªæœ‰å†æ–°å»ºçš„è¿æ¥æ‰ä¼šä½¿ç”¨æ–°çš„æƒé™è®¾ç½®ã€‚ å¸¸è§çš„æœ‰è¿œç¨‹è¿æ¥ä¸ä¸Šmysql(hostä¸º % è¡¨ç¤ºä¸é™åˆ¶ip localhostè¡¨ç¤ºæœ¬æœºä½¿ç”¨ )ï¼Œè¿™æ—¶å°±éœ€è¦ä¿®æ”¹rootçš„æƒé™ mysql&gt; select host,user,plugin,authentication_string from mysql.user; mysql&gt; alter user &#39;root&#39;@&#39;%&#39; identified with mysql_native_password by &#39;123456&#39;; mysql&gt; FLUSH PRIVILEGES; è¿æ¥å®Œæˆåï¼Œå¦‚æœä½ æ²¡æœ‰åç»­çš„åŠ¨ä½œï¼Œè¿™ä¸ªè¿æ¥å°±å¤„äºç©ºé—²çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨ show processlist å‘½ä»¤ä¸­çœ‹åˆ°å®ƒã€‚æ–‡æœ¬ä¸­è¿™ä¸ªå›¾æ˜¯ show processlist çš„ç»“æœï¼Œå…¶ä¸­çš„ Command åˆ—æ˜¾ç¤ºä¸ºâ€œSleepâ€çš„è¿™ä¸€è¡Œï¼Œå°±è¡¨ç¤ºç°åœ¨ç³»ç»Ÿé‡Œé¢æœ‰ä¸€ä¸ªç©ºé—²è¿æ¥ã€‚ å®¢æˆ·ç«¯å¦‚æœå¤ªé•¿æ—¶é—´æ²¡åŠ¨é™ï¼Œè¿æ¥å™¨å°±ä¼šè‡ªåŠ¨å°†å®ƒæ–­å¼€ã€‚è¿™ä¸ªæ—¶é—´æ˜¯ç”±å‚æ•° wait_timeout æ§åˆ¶çš„ï¼Œé»˜è®¤å€¼æ˜¯ 8 å°æ—¶ã€‚ å¦‚æœåœ¨è¿æ¥è¢«æ–­å¼€ä¹‹åï¼Œå®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚çš„è¯ï¼Œå°±ä¼šæ”¶åˆ°ä¸€ä¸ªé”™è¯¯æé†’ï¼š Lost connection to MySQL server during queryã€‚è¿™æ—¶å€™å¦‚æœä½ è¦ç»§ç»­ï¼Œå°±éœ€è¦é‡è¿ï¼Œç„¶åå†æ‰§è¡Œè¯·æ±‚äº†ã€‚ æ•°æ®åº“é‡Œé¢ï¼Œé•¿è¿æ¥æ˜¯æŒ‡è¿æ¥æˆåŠŸåï¼Œå¦‚æœå®¢æˆ·ç«¯æŒç»­æœ‰è¯·æ±‚ï¼Œåˆ™ä¸€ç›´ä½¿ç”¨åŒä¸€ä¸ªè¿æ¥ã€‚çŸ­è¿æ¥åˆ™æ˜¯æŒ‡æ¯æ¬¡æ‰§è¡Œå®Œå¾ˆå°‘çš„å‡ æ¬¡æŸ¥è¯¢å°±æ–­å¼€è¿æ¥ï¼Œä¸‹æ¬¡æŸ¥è¯¢å†é‡æ–°å»ºç«‹ä¸€ä¸ªã€‚ å»ºç«‹è¿æ¥çš„è¿‡ç¨‹é€šå¸¸æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œæ‰€ä»¥æˆ‘å»ºè®®ä½ åœ¨ä½¿ç”¨ä¸­è¦å°½é‡å‡å°‘å»ºç«‹è¿æ¥çš„åŠ¨ä½œï¼Œä¹Ÿå°±æ˜¯å°½é‡ä½¿ç”¨é•¿è¿æ¥ã€‚ ä½†æ˜¯å…¨éƒ¨ä½¿ç”¨é•¿è¿æ¥åï¼Œä½ å¯èƒ½ä¼šå‘ç°ï¼Œæœ‰äº›æ—¶å€™ MySQL å ç”¨å†…å­˜æ¶¨å¾—ç‰¹åˆ«å¿«ï¼Œè¿™æ˜¯å› ä¸º MySQL åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸´æ—¶ä½¿ç”¨çš„å†…å­˜æ˜¯ç®¡ç†åœ¨è¿æ¥å¯¹è±¡é‡Œé¢çš„ã€‚è¿™äº›èµ„æºä¼šåœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰é‡Šæ”¾ã€‚æ‰€ä»¥å¦‚æœé•¿è¿æ¥ç´¯ç§¯ä¸‹æ¥ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜å ç”¨å¤ªå¤§ï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œæ€æ‰ï¼ˆOOMï¼‰ï¼Œä»ç°è±¡çœ‹å°±æ˜¯ MySQL å¼‚å¸¸é‡å¯äº†ã€‚ æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿä½ å¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆã€‚ å®šæœŸæ–­å¼€é•¿è¿æ¥ã€‚ä½¿ç”¨ä¸€æ®µæ—¶é—´ï¼Œæˆ–è€…ç¨‹åºé‡Œé¢åˆ¤æ–­æ‰§è¡Œè¿‡ä¸€ä¸ªå ç”¨å†…å­˜çš„å¤§æŸ¥è¯¢åï¼Œæ–­å¼€è¿æ¥ï¼Œä¹‹åè¦æŸ¥è¯¢å†é‡è¿ã€‚ å¦‚æœä½ ç”¨çš„æ˜¯ MySQL 5.7 æˆ–æ›´æ–°ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ“ä½œåï¼Œé€šè¿‡æ‰§è¡Œ mysql_reset_connection æ¥é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºã€‚è¿™ä¸ªè¿‡ç¨‹ä¸éœ€è¦é‡è¿å’Œé‡æ–°åšæƒé™éªŒè¯ï¼Œä½†æ˜¯ä¼šå°†è¿æ¥æ¢å¤åˆ°åˆšåˆšåˆ›å»ºå®Œæ—¶çš„çŠ¶æ€ã€‚ æŸ¥è¯¢ç¼“å­˜è¿æ¥å»ºç«‹å®Œæˆåï¼Œä½ å°±å¯ä»¥æ‰§è¡Œ select è¯­å¥äº†ã€‚æ‰§è¡Œé€»è¾‘å°±ä¼šæ¥åˆ°ç¬¬äºŒæ­¥ï¼šæŸ¥è¯¢ç¼“å­˜ã€‚ MySQL æ‹¿åˆ°ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚åï¼Œä¼šå…ˆåˆ°æŸ¥è¯¢ç¼“å­˜çœ‹çœ‹ï¼Œä¹‹å‰æ˜¯ä¸æ˜¯æ‰§è¡Œè¿‡è¿™æ¡è¯­å¥ã€‚ä¹‹å‰æ‰§è¡Œè¿‡çš„è¯­å¥åŠå…¶ç»“æœå¯èƒ½ä¼šä»¥ key-value å¯¹çš„å½¢å¼ï¼Œè¢«ç›´æ¥ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚key æ˜¯æŸ¥è¯¢çš„è¯­å¥ï¼Œvalue æ˜¯æŸ¥è¯¢çš„ç»“æœã€‚å¦‚æœä½ çš„æŸ¥è¯¢èƒ½å¤Ÿç›´æ¥åœ¨è¿™ä¸ªç¼“å­˜ä¸­æ‰¾åˆ° keyï¼Œé‚£ä¹ˆè¿™ä¸ª value å°±ä¼šè¢«ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ å¦‚æœè¯­å¥ä¸åœ¨æŸ¥è¯¢ç¼“å­˜ä¸­ï¼Œå°±ä¼šç»§ç»­åé¢çš„æ‰§è¡Œé˜¶æ®µã€‚æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œç»“æœä¼šè¢«å­˜å…¥æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæŸ¥è¯¢å‘½ä¸­ç¼“å­˜ï¼ŒMySQL ä¸éœ€è¦æ‰§è¡Œåé¢çš„å¤æ‚æ“ä½œï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›ç»“æœï¼Œè¿™ä¸ªæ•ˆç‡ä¼šå¾ˆé«˜ã€‚ ä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä¼šå»ºè®®ä½ ä¸è¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæŸ¥è¯¢ç¼“å­˜å¾€å¾€å¼Šå¤§äºåˆ©ã€‚ æŸ¥è¯¢ç¼“å­˜çš„å¤±æ•ˆéå¸¸é¢‘ç¹ï¼Œåªè¦æœ‰å¯¹ä¸€ä¸ªè¡¨çš„æ›´æ–°ï¼Œè¿™ä¸ªè¡¨ä¸Šæ‰€æœ‰çš„æŸ¥è¯¢ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºã€‚å› æ­¤å¾ˆå¯èƒ½ä½ è´¹åŠ²åœ°æŠŠç»“æœå­˜èµ·æ¥ï¼Œè¿˜æ²¡ä½¿ç”¨å‘¢ï¼Œå°±è¢«ä¸€ä¸ªæ›´æ–°å…¨æ¸…ç©ºäº†ã€‚å¯¹äºæ›´æ–°å‹åŠ›å¤§çš„æ•°æ®åº“æ¥è¯´ï¼ŒæŸ¥è¯¢ç¼“å­˜çš„å‘½ä¸­ç‡ä¼šéå¸¸ä½ã€‚é™¤éä½ çš„ä¸šåŠ¡å°±æ˜¯æœ‰ä¸€å¼ é™æ€è¡¨ï¼Œå¾ˆé•¿æ—¶é—´æ‰ä¼šæ›´æ–°ä¸€æ¬¡ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªç³»ç»Ÿé…ç½®è¡¨ï¼Œé‚£è¿™å¼ è¡¨ä¸Šçš„æŸ¥è¯¢æ‰é€‚åˆä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚ å¥½åœ¨ MySQL ä¹Ÿæä¾›äº†è¿™ç§â€œæŒ‰éœ€ä½¿ç”¨â€çš„æ–¹å¼ã€‚ä½ å¯ä»¥å°†å‚æ•° query_cache_type è®¾ç½®æˆ DEMANDï¼Œè¿™æ ·å¯¹äºé»˜è®¤çš„ SQL è¯­å¥éƒ½ä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚è€Œå¯¹äºä½ ç¡®å®šè¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„è¯­å¥ï¼Œå¯ä»¥ç”¨ SQL_CACHE æ˜¾å¼æŒ‡å®šï¼Œåƒä¸‹é¢è¿™ä¸ªè¯­å¥ä¸€æ ·ï¼š mysql&gt; select SQL_CACHE * from T where ID&#x3D;10ï¼› éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMySQL 8.0 ç‰ˆæœ¬ç›´æ¥å°†æŸ¥è¯¢ç¼“å­˜çš„æ•´å—åŠŸèƒ½åˆ æ‰äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ 8.0 å¼€å§‹å½»åº•æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½äº†ã€‚ åˆ†æå™¨å¦‚æœæ²¡æœ‰å‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼Œå°±è¦å¼€å§‹çœŸæ­£æ‰§è¡Œè¯­å¥äº†ã€‚é¦–å…ˆï¼ŒMySQL éœ€è¦çŸ¥é“ä½ è¦åšä»€ä¹ˆï¼Œå› æ­¤éœ€è¦å¯¹ SQL è¯­å¥åšè§£æã€‚ åˆ†æå™¨å…ˆä¼šåšâ€œè¯æ³•åˆ†æâ€ã€‚ä½ è¾“å…¥çš„æ˜¯ç”±å¤šä¸ªå­—ç¬¦ä¸²å’Œç©ºæ ¼ç»„æˆçš„ä¸€æ¡ SQL è¯­å¥ï¼ŒMySQL éœ€è¦è¯†åˆ«å‡ºé‡Œé¢çš„å­—ç¬¦ä¸²åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆã€‚ MySQL ä»ä½ è¾“å…¥çš„â€selectâ€è¿™ä¸ªå…³é”®å­—è¯†åˆ«å‡ºæ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å®ƒä¹Ÿè¦æŠŠå­—ç¬¦ä¸²â€œTâ€è¯†åˆ«æˆâ€œè¡¨å Tâ€ï¼ŒæŠŠå­—ç¬¦ä¸²â€œIDâ€è¯†åˆ«æˆâ€œåˆ— IDâ€ã€‚ åšå®Œäº†è¿™äº›è¯†åˆ«ä»¥åï¼Œå°±è¦åšâ€œè¯­æ³•åˆ†æâ€ã€‚æ ¹æ®è¯æ³•åˆ†æçš„ç»“æœï¼Œè¯­æ³•åˆ†æå™¨ä¼šæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ª SQL è¯­å¥æ˜¯å¦æ»¡è¶³ MySQL è¯­æ³•ã€‚ å¦‚æœä½ çš„è¯­å¥ä¸å¯¹ï¼Œå°±ä¼šæ”¶åˆ°â€œYou have an error in your SQL syntaxâ€çš„é”™è¯¯æé†’ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªè¯­å¥ select å°‘æ‰“äº†å¼€å¤´çš„å­—æ¯â€œsâ€ã€‚ mysql&gt; elect * from t where ID&#x3D;1; ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;elect * from t where ID&#x3D;1&#39; at line 1 ä¸€èˆ¬è¯­æ³•é”™è¯¯ä¼šæç¤ºç¬¬ä¸€ä¸ªå‡ºç°é”™è¯¯çš„ä½ç½®ï¼Œæ‰€ä»¥ä½ è¦å…³æ³¨çš„æ˜¯ç´§æ¥â€œuse nearâ€çš„å†…å®¹ã€‚ ä¼˜åŒ–å™¨ç»è¿‡äº†åˆ†æå™¨ï¼ŒMySQL å°±çŸ¥é“ä½ è¦åšä»€ä¹ˆäº†ã€‚åœ¨å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼Œè¿˜è¦å…ˆç»è¿‡ä¼˜åŒ–å™¨çš„å¤„ç†ã€‚ ä¼˜åŒ–å™¨æ˜¯åœ¨è¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªç´¢å¼•ï¼›æˆ–è€…åœ¨ä¸€ä¸ªè¯­å¥æœ‰å¤šè¡¨å…³è”ï¼ˆjoinï¼‰çš„æ—¶å€™ï¼Œå†³å®šå„ä¸ªè¡¨çš„è¿æ¥é¡ºåºã€‚æ¯”å¦‚ä½ æ‰§è¡Œä¸‹é¢è¿™æ ·çš„è¯­å¥ï¼Œè¿™ä¸ªè¯­å¥æ˜¯æ‰§è¡Œä¸¤ä¸ªè¡¨çš„ joinï¼š mysql&gt; select * from t1 join t2 using(ID) where t1.c&#x3D;10 and t2.d&#x3D;20; æ—¢å¯ä»¥å…ˆä»è¡¨ t1 é‡Œé¢å–å‡º c&#x3D;10 çš„è®°å½•çš„ ID å€¼ï¼Œå†æ ¹æ® ID å€¼å…³è”åˆ°è¡¨ t2ï¼Œå†åˆ¤æ–­ t2 é‡Œé¢ d çš„å€¼æ˜¯å¦ç­‰äº 20ã€‚ ä¹Ÿå¯ä»¥å…ˆä»è¡¨ t2 é‡Œé¢å–å‡º d&#x3D;20 çš„è®°å½•çš„ ID å€¼ï¼Œå†æ ¹æ® ID å€¼å…³è”åˆ° t1ï¼Œå†åˆ¤æ–­ t1 é‡Œé¢ c çš„å€¼æ˜¯å¦ç­‰äº 10ã€‚ è¿™ä¸¤ç§æ‰§è¡Œæ–¹æ³•çš„é€»è¾‘ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æ‰§è¡Œçš„æ•ˆç‡ä¼šæœ‰ä¸åŒï¼Œè€Œä¼˜åŒ–å™¨çš„ä½œç”¨å°±æ˜¯å†³å®šé€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªæ–¹æ¡ˆã€‚ ä¼˜åŒ–å™¨é˜¶æ®µå®Œæˆåï¼Œè¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæ–¹æ¡ˆå°±ç¡®å®šä¸‹æ¥äº†ï¼Œç„¶åè¿›å…¥æ‰§è¡Œå™¨é˜¶æ®µã€‚å¦‚æœä½ è¿˜æœ‰ä¸€äº›ç–‘é—®ï¼Œæ¯”å¦‚ä¼˜åŒ–å™¨æ˜¯æ€ä¹ˆé€‰æ‹©ç´¢å¼•çš„ï¼Œæœ‰æ²¡æœ‰å¯èƒ½é€‰æ‹©é”™ç­‰ç­‰ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­å•ç‹¬å±•å¼€è¯´æ˜ä¼˜åŒ–å™¨çš„å†…å®¹ã€‚ æ‰§è¡Œå™¨MySQL é€šè¿‡åˆ†æå™¨çŸ¥é“äº†ä½ è¦åšä»€ä¹ˆï¼Œé€šè¿‡ä¼˜åŒ–å™¨çŸ¥é“äº†è¯¥æ€ä¹ˆåšï¼Œäºæ˜¯å°±è¿›å…¥äº†æ‰§è¡Œå™¨é˜¶æ®µï¼Œå¼€å§‹æ‰§è¡Œè¯­å¥ã€‚ å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œè¦å…ˆåˆ¤æ–­ä¸€ä¸‹ä½ å¯¹è¿™ä¸ªè¡¨ T æœ‰æ²¡æœ‰æ‰§è¡ŒæŸ¥è¯¢çš„æƒé™ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šè¿”å›æ²¡æœ‰æƒé™çš„é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤º (åœ¨å·¥ç¨‹å®ç°ä¸Šï¼Œå¦‚æœå‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼Œä¼šåœ¨æŸ¥è¯¢ç¼“å­˜è¿”å›ç»“æœçš„æ—¶å€™ï¼Œåšæƒé™éªŒè¯ã€‚æŸ¥è¯¢ä¹Ÿä¼šåœ¨ä¼˜åŒ–å™¨ä¹‹å‰è°ƒç”¨ precheck éªŒè¯æƒé™)ã€‚ mysql&gt; select * from T where ID&#x3D;10; ERROR 1142 (42000): SELECT command denied to user &#39;b&#39;@&#39;localhost&#39; for table &#39;T&#39; å¦‚æœæœ‰æƒé™ï¼Œå°±æ‰“å¼€è¡¨ç»§ç»­æ‰§è¡Œã€‚æ‰“å¼€è¡¨çš„æ—¶å€™ï¼Œæ‰§è¡Œå™¨å°±ä¼šæ ¹æ®è¡¨çš„å¼•æ“å®šä¹‰ï¼Œå»ä½¿ç”¨è¿™ä¸ªå¼•æ“æä¾›çš„æ¥å£ã€‚ æ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­çš„è¡¨ T ä¸­ï¼ŒID å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆæ‰§è¡Œå™¨çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š è°ƒç”¨ InnoDB å¼•æ“æ¥å£å–è¿™ä¸ªè¡¨çš„ç¬¬ä¸€è¡Œï¼Œåˆ¤æ–­ ID å€¼æ˜¯ä¸æ˜¯ 10ï¼Œå¦‚æœä¸æ˜¯åˆ™è·³è¿‡ï¼Œå¦‚æœæ˜¯åˆ™å°†è¿™è¡Œå­˜åœ¨ç»“æœé›†ä¸­ï¼› è°ƒç”¨å¼•æ“æ¥å£å–â€œä¸‹ä¸€è¡Œâ€ï¼Œé‡å¤ç›¸åŒçš„åˆ¤æ–­é€»è¾‘ï¼Œç›´åˆ°å–åˆ°è¿™ä¸ªè¡¨çš„æœ€åä¸€è¡Œã€‚ æ‰§è¡Œå™¨å°†ä¸Šè¿°éå†è¿‡ç¨‹ä¸­æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œç»„æˆçš„è®°å½•é›†ä½œä¸ºç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ è‡³æ­¤ï¼Œè¿™ä¸ªè¯­å¥å°±æ‰§è¡Œå®Œæˆäº†ã€‚ å¯¹äºæœ‰ç´¢å¼•çš„è¡¨ï¼Œæ‰§è¡Œçš„é€»è¾‘ä¹Ÿå·®ä¸å¤šã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ˜¯â€œå–æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€è¡Œâ€è¿™ä¸ªæ¥å£ï¼Œä¹‹åå¾ªç¯å–â€œæ»¡è¶³æ¡ä»¶çš„ä¸‹ä¸€è¡Œâ€è¿™ä¸ªæ¥å£ï¼Œè¿™äº›æ¥å£éƒ½æ˜¯å¼•æ“ä¸­å·²ç»å®šä¹‰å¥½çš„ã€‚ ä½ ä¼šåœ¨æ•°æ®åº“çš„æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­çœ‹åˆ°ä¸€ä¸ª rows_examined çš„å­—æ®µï¼Œè¡¨ç¤ºè¿™ä¸ªè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰«æäº†å¤šå°‘è¡Œã€‚è¿™ä¸ªå€¼å°±æ˜¯åœ¨æ‰§è¡Œå™¨æ¯æ¬¡è°ƒç”¨å¼•æ“è·å–æ•°æ®è¡Œçš„æ—¶å€™ç´¯åŠ çš„ã€‚ åœ¨æœ‰äº›åœºæ™¯ä¸‹ï¼Œæ‰§è¡Œå™¨è°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨å¼•æ“å†…éƒ¨åˆ™æ‰«æäº†å¤šè¡Œï¼Œå› æ­¤å¼•æ“æ‰«æè¡Œæ•°è·Ÿ rows_examined å¹¶ä¸æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚æˆ‘ä»¬åé¢ä¼šä¸“é—¨æœ‰ä¸€ç¯‡æ–‡ç« æ¥è®²å­˜å‚¨å¼•æ“çš„å†…éƒ¨æœºåˆ¶ï¼Œé‡Œé¢ä¼šæœ‰è¯¦ç»†çš„è¯´æ˜ã€‚ è¯¾åé—®é¢˜å¦‚æœè¡¨ T ä¸­æ²¡æœ‰å­—æ®µ kï¼Œè€Œä½ æ‰§è¡Œäº†è¿™ä¸ªè¯­å¥ select * from T where k&#x3D;1, é‚£è‚¯å®šæ˜¯ä¼šæŠ¥â€œä¸å­˜åœ¨è¿™ä¸ªåˆ—â€çš„é”™è¯¯ï¼š â€œUnknown column â€˜kâ€™ in â€˜where clauseâ€™â€ã€‚ä½ è§‰å¾—è¿™ä¸ªé”™è¯¯æ˜¯åœ¨æˆ‘ä»¬ä¸Šé¢æåˆ°çš„å“ªä¸ªé˜¶æ®µæŠ¥å‡ºæ¥çš„å‘¢ï¼Ÿ åˆ†æå™¨é˜¶æ®µï¼Œåœ¨åˆ†æå™¨é˜¶æ®µä¸»è¦ä¼šè¿›è¡Œä¸¤é¡¹äº‹ï¼Œä¸€æ˜¯è¯­æ³•åˆ†æï¼Œæ ¹æ®mysqlçš„å…³é”®å­—è¿›è¡ŒéªŒè¯å’Œè§£æï¼›äºŒæ˜¯è¯æ³•åˆ†æï¼Œä¼šåœ¨è¯æ³•è§£æçš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥åšè¡¨åå’Œå­—æ®µåç§°çš„éªŒè¯å’Œè§£æï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ª SQL è¯­å¥æ˜¯å¦æ»¡è¶³ MySQL è¯­æ³•ã€‚å› ä¸ºæ²¡æœ‰kè¿™ä¸€åˆ—æ‰€ä»¥åœ¨è¯­æ³•åˆ†ææ—¶ä¼šæŠ¥é”™ã€‚","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://blog.ehzyil.xyz/tags/MySQL/"}],"author":"ehzyil"},{"title":"äº‹åŠ¡éš”ç¦»ï¼šä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§ï¼Ÿ","slug":"2023/äº‹åŠ¡éš”ç¦»ï¼šä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§ï¼Ÿ","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/26/2023/äº‹åŠ¡éš”ç¦»ï¼šä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§ï¼Ÿ/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%A0%E6%94%B9%E4%BA%86%E6%88%91%E8%BF%98%E7%9C%8B%E4%B8%8D%E8%A7%81%EF%BC%9F/","excerpt":"","text":"äº‹åŠ¡éš”ç¦»ï¼šä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§ï¼Ÿ è½¬è½½MySQLå®æˆ˜45è®²| 03 | äº‹åŠ¡éš”ç¦»ï¼šä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§ï¼Ÿ æåˆ°äº‹åŠ¡ï¼Œä½ è‚¯å®šä¸é™Œç”Ÿï¼Œå’Œæ•°æ®åº“æ‰“äº¤é“çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¼šç”¨åˆ°äº‹åŠ¡ã€‚æœ€ç»å…¸çš„ä¾‹å­å°±æ˜¯è½¬è´¦ï¼Œä½ è¦ç»™æœ‹å‹å°ç‹è½¬ 100 å—é’±ï¼Œè€Œæ­¤æ—¶ä½ çš„é“¶è¡Œå¡åªæœ‰ 100 å—é’±ã€‚ è½¬è´¦è¿‡ç¨‹å…·ä½“åˆ°ç¨‹åºé‡Œä¼šæœ‰ä¸€ç³»åˆ—çš„æ“ä½œï¼Œæ¯”å¦‚æŸ¥è¯¢ä½™é¢ã€åšåŠ å‡æ³•ã€æ›´æ–°ä½™é¢ç­‰ï¼Œè¿™äº›æ“ä½œå¿…é¡»ä¿è¯æ˜¯ä¸€ä½“çš„ï¼Œä¸ç„¶ç­‰ç¨‹åºæŸ¥å®Œä¹‹åï¼Œè¿˜æ²¡åšå‡æ³•ä¹‹å‰ï¼Œä½ è¿™ 100 å—é’±ï¼Œå®Œå…¨å¯ä»¥å€Ÿç€è¿™ä¸ªæ—¶é—´å·®å†æŸ¥ä¸€æ¬¡ï¼Œç„¶åå†ç»™å¦å¤–ä¸€ä¸ªæœ‹å‹è½¬è´¦ï¼Œå¦‚æœé“¶è¡Œè¿™ä¹ˆæ•´ï¼Œä¸å°±ä¹±äº†ä¹ˆï¼Ÿè¿™æ—¶å°±è¦ç”¨åˆ°â€œäº‹åŠ¡â€è¿™ä¸ªæ¦‚å¿µäº†ã€‚ ç®€å•æ¥è¯´ï¼Œäº‹åŠ¡å°±æ˜¯è¦ä¿è¯ä¸€ç»„æ•°æ®åº“æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚åœ¨ MySQL ä¸­ï¼Œäº‹åŠ¡æ”¯æŒæ˜¯åœ¨å¼•æ“å±‚å®ç°çš„ã€‚ä½ ç°åœ¨çŸ¥é“ï¼ŒMySQL æ˜¯ä¸€ä¸ªæ”¯æŒå¤šå¼•æ“çš„ç³»ç»Ÿï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„å¼•æ“éƒ½æ”¯æŒäº‹åŠ¡ã€‚æ¯”å¦‚ MySQL åŸç”Ÿçš„ MyISAM å¼•æ“å°±ä¸æ”¯æŒäº‹åŠ¡ï¼Œè¿™ä¹Ÿæ˜¯ MyISAM è¢« InnoDB å–ä»£çš„é‡è¦åŸå› ä¹‹ä¸€ã€‚ ä»Šå¤©çš„æ–‡ç« é‡Œï¼Œæˆ‘å°†ä¼šä»¥ InnoDB ä¸ºä¾‹ï¼Œå‰–æ MySQL åœ¨äº‹åŠ¡æ”¯æŒæ–¹é¢çš„ç‰¹å®šå®ç°ï¼Œå¹¶åŸºäºåŸç†ç»™å‡ºç›¸åº”çš„å®è·µå»ºè®®ï¼Œå¸Œæœ›è¿™äº›æ¡ˆä¾‹èƒ½åŠ æ·±ä½ å¯¹ MySQL äº‹åŠ¡åŸç†çš„ç†è§£ã€‚ éš”ç¦»æ€§ä¸éš”ç¦»çº§åˆ«æåˆ°äº‹åŠ¡ï¼Œä½ è‚¯å®šä¼šæƒ³åˆ° ACIDï¼ˆAtomicityã€Consistencyã€Isolationã€Durabilityï¼Œå³åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥è¯´è¯´å…¶ä¸­ Iï¼Œä¹Ÿå°±æ˜¯â€œéš”ç¦»æ€§â€ã€‚ å½“æ•°æ®åº“ä¸Šæœ‰å¤šä¸ªäº‹åŠ¡åŒæ—¶æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±å¯èƒ½å‡ºç°è„è¯»ï¼ˆdirty readï¼‰ã€ä¸å¯é‡å¤è¯»ï¼ˆnon-repeatable readï¼‰ã€å¹»è¯»ï¼ˆphantom readï¼‰çš„é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œå°±æœ‰äº†â€œéš”ç¦»çº§åˆ«â€çš„æ¦‚å¿µã€‚ åœ¨è°ˆéš”ç¦»çº§åˆ«ä¹‹å‰ï¼Œä½ é¦–å…ˆè¦çŸ¥é“ï¼Œä½ éš”ç¦»å¾—è¶Šä¸¥å®ï¼Œæ•ˆç‡å°±ä¼šè¶Šä½ã€‚å› æ­¤å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éƒ½è¦åœ¨äºŒè€…ä¹‹é—´å¯»æ‰¾ä¸€ä¸ªå¹³è¡¡ç‚¹ã€‚SQL æ ‡å‡†çš„äº‹åŠ¡éš”ç¦»çº§åˆ«åŒ…æ‹¬ï¼šè¯»æœªæäº¤ï¼ˆread uncommittedï¼‰ã€è¯»æäº¤ï¼ˆread committedï¼‰ã€å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆserializable ï¼‰ã€‚ä¸‹é¢æˆ‘é€ä¸€ä¸ºä½ è§£é‡Šï¼š è¯»æœªæäº¤æ˜¯æŒ‡ï¼Œä¸€ä¸ªäº‹åŠ¡è¿˜æ²¡æäº¤æ—¶ï¼Œå®ƒåšçš„å˜æ›´å°±èƒ½è¢«åˆ«çš„äº‹åŠ¡çœ‹åˆ°ã€‚ è¯»æäº¤æ˜¯æŒ‡ï¼Œä¸€ä¸ªäº‹åŠ¡æäº¤ä¹‹åï¼Œå®ƒåšçš„å˜æ›´æ‰ä¼šè¢«å…¶ä»–äº‹åŠ¡çœ‹åˆ°ã€‚ å¯é‡å¤è¯»æ˜¯æŒ‡ï¼Œä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çœ‹åˆ°çš„æ•°æ®ï¼Œæ€»æ˜¯è·Ÿè¿™ä¸ªäº‹åŠ¡åœ¨å¯åŠ¨æ—¶çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚å½“ç„¶åœ¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹ï¼Œæœªæäº¤å˜æ›´å¯¹å…¶ä»–äº‹åŠ¡ä¹Ÿæ˜¯ä¸å¯è§çš„ã€‚ ä¸²è¡ŒåŒ–ï¼Œé¡¾åæ€ä¹‰æ˜¯å¯¹äºåŒä¸€è¡Œè®°å½•ï¼Œâ€œå†™â€ä¼šåŠ â€œå†™é”â€ï¼Œâ€œè¯»â€ä¼šåŠ â€œè¯»é”â€ã€‚å½“å‡ºç°è¯»å†™é”å†²çªçš„æ—¶å€™ï¼Œåè®¿é—®çš„äº‹åŠ¡å¿…é¡»ç­‰å‰ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œæˆï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚ å…¶ä¸­â€œè¯»æäº¤â€å’Œâ€œå¯é‡å¤è¯»â€æ¯”è¾ƒéš¾ç†è§£ï¼Œæ‰€ä»¥æˆ‘ç”¨ä¸€ä¸ªä¾‹å­è¯´æ˜è¿™å‡ ç§éš”ç¦»çº§åˆ«ã€‚å‡è®¾æ•°æ®è¡¨ T ä¸­åªæœ‰ä¸€åˆ—ï¼Œå…¶ä¸­ä¸€è¡Œçš„å€¼ä¸º 1ï¼Œä¸‹é¢æ˜¯æŒ‰ç…§æ—¶é—´é¡ºåºæ‰§è¡Œä¸¤ä¸ªäº‹åŠ¡çš„è¡Œä¸ºã€‚ mysql&gt; create table T(c int) engine&#x3D;InnoDB; insert into T(c) values(1); æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨ä¸åŒçš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œäº‹åŠ¡ A ä¼šæœ‰å“ªäº›ä¸åŒçš„è¿”å›ç»“æœï¼Œä¹Ÿå°±æ˜¯å›¾é‡Œé¢ V1ã€V2ã€V3 çš„è¿”å›å€¼åˆ†åˆ«æ˜¯ä»€ä¹ˆã€‚ è‹¥éš”ç¦»çº§åˆ«æ˜¯â€œè¯»æœªæäº¤â€ï¼Œ åˆ™ V1 çš„å€¼å°±æ˜¯ 2ã€‚è¿™æ—¶å€™äº‹åŠ¡ B è™½ç„¶è¿˜æ²¡æœ‰æäº¤ï¼Œä½†æ˜¯ç»“æœå·²ç»è¢« A çœ‹åˆ°äº†ã€‚å› æ­¤ï¼ŒV2ã€V3 ä¹Ÿéƒ½æ˜¯ 2ã€‚ è‹¥éš”ç¦»çº§åˆ«æ˜¯â€œè¯»æäº¤â€ï¼Œåˆ™ V1 æ˜¯ 1ï¼ŒV2 çš„å€¼æ˜¯ 2ã€‚äº‹åŠ¡ B çš„æ›´æ–°åœ¨æäº¤åæ‰èƒ½è¢« A çœ‹åˆ°ã€‚æ‰€ä»¥ï¼Œ V3 çš„å€¼ä¹Ÿæ˜¯ 2ã€‚ è‹¥éš”ç¦»çº§åˆ«æ˜¯â€œå¯é‡å¤è¯»â€ï¼Œåˆ™ V1ã€V2 æ˜¯ 1ï¼ŒV3 æ˜¯ 2ã€‚ä¹‹æ‰€ä»¥ V2 è¿˜æ˜¯ 1ï¼Œéµå¾ªçš„å°±æ˜¯è¿™ä¸ªè¦æ±‚ï¼šäº‹åŠ¡åœ¨æ‰§è¡ŒæœŸé—´çœ‹åˆ°çš„æ•°æ®å‰åå¿…é¡»æ˜¯ä¸€è‡´çš„ã€‚ è‹¥éš”ç¦»çº§åˆ«æ˜¯â€œä¸²è¡ŒåŒ–â€ï¼Œåˆ™åœ¨äº‹åŠ¡ B æ‰§è¡Œâ€œå°† 1 æ”¹æˆ 2â€çš„æ—¶å€™ï¼Œä¼šè¢«é”ä½ã€‚ç›´åˆ°äº‹åŠ¡ A æäº¤åï¼Œäº‹åŠ¡ B æ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚æ‰€ä»¥ä» A çš„è§’åº¦çœ‹ï¼Œ V1ã€V2 å€¼æ˜¯ 1ï¼ŒV3 çš„å€¼æ˜¯ 2ã€‚ åœ¨å®ç°ä¸Šï¼Œæ•°æ®åº“é‡Œé¢ä¼šåˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œè®¿é—®çš„æ—¶å€™ä»¥è§†å›¾çš„é€»è¾‘ç»“æœä¸ºå‡†ã€‚åœ¨â€œå¯é‡å¤è¯»â€éš”ç¦»çº§åˆ«ä¸‹ï¼Œè¿™ä¸ªè§†å›¾æ˜¯åœ¨äº‹åŠ¡å¯åŠ¨æ—¶åˆ›å»ºçš„ï¼Œæ•´ä¸ªäº‹åŠ¡å­˜åœ¨æœŸé—´éƒ½ç”¨è¿™ä¸ªè§†å›¾ã€‚åœ¨â€œè¯»æäº¤â€éš”ç¦»çº§åˆ«ä¸‹ï¼Œè¿™ä¸ªè§†å›¾æ˜¯åœ¨æ¯ä¸ª SQL è¯­å¥å¼€å§‹æ‰§è¡Œçš„æ—¶å€™åˆ›å»ºçš„ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œâ€œè¯»æœªæäº¤â€éš”ç¦»çº§åˆ«ä¸‹ç›´æ¥è¿”å›è®°å½•ä¸Šçš„æœ€æ–°å€¼ï¼Œæ²¡æœ‰è§†å›¾æ¦‚å¿µï¼›è€Œâ€œä¸²è¡ŒåŒ–â€éš”ç¦»çº§åˆ«ä¸‹ç›´æ¥ç”¨åŠ é”çš„æ–¹å¼æ¥é¿å…å¹¶è¡Œè®¿é—®ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ä¸åŒçš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œæ•°æ®åº“è¡Œä¸ºæ˜¯æœ‰æ‰€ä¸åŒçš„ã€‚Oracle æ•°æ®åº“çš„é»˜è®¤éš”ç¦»çº§åˆ«å…¶å®å°±æ˜¯â€œè¯»æäº¤â€ï¼Œå› æ­¤å¯¹äºä¸€äº›ä» Oracle è¿ç§»åˆ° MySQL çš„åº”ç”¨ï¼Œä¸ºä¿è¯æ•°æ®åº“éš”ç¦»çº§åˆ«çš„ä¸€è‡´ï¼Œä½ ä¸€å®šè¦è®°å¾—å°† MySQL çš„éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºâ€œè¯»æäº¤â€ã€‚ é…ç½®çš„æ–¹å¼æ˜¯ï¼Œå°†å¯åŠ¨å‚æ•° transaction-isolation çš„å€¼è®¾ç½®æˆ READ-COMMITTEDã€‚ä½ å¯ä»¥ç”¨ show variables æ¥æŸ¥çœ‹å½“å‰çš„å€¼ã€‚ mysql&gt; show variables like &#39;transaction_isolation&#39;; +-----------------------+----------------+ | Variable_name | Value | +-----------------------+----------------+ | transaction_isolation | READ-COMMITTED | +-----------------------+----------------+ æ€»ç»“æ¥è¯´ï¼Œå­˜åœ¨å³åˆç†ï¼Œå“ªä¸ªéš”ç¦»çº§åˆ«éƒ½æœ‰å®ƒè‡ªå·±çš„ä½¿ç”¨åœºæ™¯ï¼Œä½ è¦æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æƒ…å†µæ¥å®šã€‚æˆ‘æƒ³ä½ å¯èƒ½ä¼šé—®é‚£ä»€ä¹ˆæ—¶å€™éœ€è¦â€œå¯é‡å¤è¯»â€çš„åœºæ™¯å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ•°æ®æ ¡å¯¹é€»è¾‘çš„æ¡ˆä¾‹ã€‚ å‡è®¾ä½ åœ¨ç®¡ç†ä¸€ä¸ªä¸ªäººé“¶è¡Œè´¦æˆ·è¡¨ã€‚ä¸€ä¸ªè¡¨å­˜äº†æ¯ä¸ªæœˆæœˆåº•çš„ä½™é¢ï¼Œä¸€ä¸ªè¡¨å­˜äº†è´¦å•æ˜ç»†ã€‚è¿™æ—¶å€™ä½ è¦åšæ•°æ®æ ¡å¯¹ï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­ä¸Šä¸ªæœˆçš„ä½™é¢å’Œå½“å‰ä½™é¢çš„å·®é¢ï¼Œæ˜¯å¦ä¸æœ¬æœˆçš„è´¦å•æ˜ç»†ä¸€è‡´ã€‚ä½ ä¸€å®šå¸Œæœ›åœ¨æ ¡å¯¹è¿‡ç¨‹ä¸­ï¼Œå³ä½¿æœ‰ç”¨æˆ·å‘ç”Ÿäº†ä¸€ç¬”æ–°çš„äº¤æ˜“ï¼Œä¹Ÿä¸å½±å“ä½ çš„æ ¡å¯¹ç»“æœã€‚ è¿™æ—¶å€™ä½¿ç”¨â€œå¯é‡å¤è¯»â€éš”ç¦»çº§åˆ«å°±å¾ˆæ–¹ä¾¿ã€‚äº‹åŠ¡å¯åŠ¨æ—¶çš„è§†å›¾å¯ä»¥è®¤ä¸ºæ˜¯é™æ€çš„ï¼Œä¸å—å…¶ä»–äº‹åŠ¡æ›´æ–°çš„å½±å“ã€‚ äº‹åŠ¡éš”ç¦»çš„å®ç°ç†è§£äº†äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹äº‹åŠ¡éš”ç¦»å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„ã€‚è¿™é‡Œæˆ‘ä»¬å±•å¼€è¯´æ˜â€œå¯é‡å¤è¯»â€ã€‚ åœ¨ MySQL ä¸­ï¼Œå®é™…ä¸Šæ¯æ¡è®°å½•åœ¨æ›´æ–°çš„æ—¶å€™éƒ½ä¼šåŒæ—¶è®°å½•ä¸€æ¡å›æ»šæ“ä½œã€‚è®°å½•ä¸Šçš„æœ€æ–°å€¼ï¼Œé€šè¿‡å›æ»šæ“ä½œï¼Œéƒ½å¯ä»¥å¾—åˆ°å‰ä¸€ä¸ªçŠ¶æ€çš„å€¼ã€‚ å‡è®¾ä¸€ä¸ªå€¼ä» 1 è¢«æŒ‰é¡ºåºæ”¹æˆäº† 2ã€3ã€4ï¼Œåœ¨å›æ»šæ—¥å¿—é‡Œé¢å°±ä¼šæœ‰ç±»ä¼¼ä¸‹é¢çš„è®°å½•ã€‚ å½“å‰å€¼æ˜¯ 4ï¼Œä½†æ˜¯åœ¨æŸ¥è¯¢è¿™æ¡è®°å½•çš„æ—¶å€™ï¼Œä¸åŒæ—¶åˆ»å¯åŠ¨çš„äº‹åŠ¡ä¼šæœ‰ä¸åŒçš„ read-viewã€‚å¦‚å›¾ä¸­çœ‹åˆ°çš„ï¼Œåœ¨è§†å›¾ Aã€Bã€C é‡Œé¢ï¼Œè¿™ä¸€ä¸ªè®°å½•çš„å€¼åˆ†åˆ«æ˜¯ 1ã€2ã€4ï¼ŒåŒä¸€æ¡è®°å½•åœ¨ç³»ç»Ÿä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªç‰ˆæœ¬ï¼Œå°±æ˜¯æ•°æ®åº“çš„å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCC)ã€‚å¯¹äº read-view Aï¼Œè¦å¾—åˆ° 1ï¼Œå°±å¿…é¡»å°†å½“å‰å€¼ä¾æ¬¡æ‰§è¡Œå›¾ä¸­æ‰€æœ‰çš„å›æ»šæ“ä½œå¾—åˆ°ã€‚ åŒæ—¶ä½ ä¼šå‘ç°ï¼Œå³ä½¿ç°åœ¨æœ‰å¦å¤–ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å°† 4 æ”¹æˆ 5ï¼Œè¿™ä¸ªäº‹åŠ¡è·Ÿ read-view Aã€Bã€C å¯¹åº”çš„äº‹åŠ¡æ˜¯ä¸ä¼šå†²çªçš„ã€‚ ä½ ä¸€å®šä¼šé—®ï¼Œå›æ»šæ—¥å¿—æ€»ä¸èƒ½ä¸€ç›´ä¿ç•™å§ï¼Œä»€ä¹ˆæ—¶å€™åˆ é™¤å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œåœ¨ä¸éœ€è¦çš„æ—¶å€™æ‰åˆ é™¤ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç³»ç»Ÿä¼šåˆ¤æ–­ï¼Œå½“æ²¡æœ‰äº‹åŠ¡å†éœ€è¦ç”¨åˆ°è¿™äº›å›æ»šæ—¥å¿—æ—¶ï¼Œå›æ»šæ—¥å¿—ä¼šè¢«åˆ é™¤ã€‚ ä»€ä¹ˆæ—¶å€™æ‰ä¸éœ€è¦äº†å‘¢ï¼Ÿå°±æ˜¯å½“ç³»ç»Ÿé‡Œæ²¡æœ‰æ¯”è¿™ä¸ªå›æ»šæ—¥å¿—æ›´æ—©çš„ read-view çš„æ—¶å€™ã€‚ åŸºäºä¸Šé¢çš„è¯´æ˜ï¼Œæˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹ä¸ºä»€ä¹ˆå»ºè®®ä½ å°½é‡ä¸è¦ä½¿ç”¨é•¿äº‹åŠ¡ã€‚ é•¿äº‹åŠ¡æ„å‘³ç€ç³»ç»Ÿé‡Œé¢ä¼šå­˜åœ¨å¾ˆè€çš„äº‹åŠ¡è§†å›¾ã€‚ç”±äºè¿™äº›äº‹åŠ¡éšæ—¶å¯èƒ½è®¿é—®æ•°æ®åº“é‡Œé¢çš„ä»»ä½•æ•°æ®ï¼Œæ‰€ä»¥è¿™ä¸ªäº‹åŠ¡æäº¤ä¹‹å‰ï¼Œæ•°æ®åº“é‡Œé¢å®ƒå¯èƒ½ç”¨åˆ°çš„å›æ»šè®°å½•éƒ½å¿…é¡»ä¿ç•™ï¼Œè¿™å°±ä¼šå¯¼è‡´å¤§é‡å ç”¨å­˜å‚¨ç©ºé—´ã€‚ åœ¨ MySQL 5.5 åŠä»¥å‰çš„ç‰ˆæœ¬ï¼Œå›æ»šæ—¥å¿—æ˜¯è·Ÿæ•°æ®å­—å…¸ä¸€èµ·æ”¾åœ¨ ibdata æ–‡ä»¶é‡Œçš„ï¼Œå³ä½¿é•¿äº‹åŠ¡æœ€ç»ˆæäº¤ï¼Œå›æ»šæ®µè¢«æ¸…ç†ï¼Œæ–‡ä»¶ä¹Ÿä¸ä¼šå˜å°ã€‚æˆ‘è§è¿‡æ•°æ®åªæœ‰ 20GBï¼Œè€Œå›æ»šæ®µæœ‰ 200GB çš„åº“ã€‚æœ€ç»ˆåªå¥½ä¸ºäº†æ¸…ç†å›æ»šæ®µï¼Œé‡å»ºæ•´ä¸ªåº“ã€‚ é™¤äº†å¯¹å›æ»šæ®µçš„å½±å“ï¼Œé•¿äº‹åŠ¡è¿˜å ç”¨é”èµ„æºï¼Œä¹Ÿå¯èƒ½æ‹–å®æ•´ä¸ªåº“ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¼šåœ¨åé¢è®²é”çš„æ—¶å€™å±•å¼€ã€‚ äº‹åŠ¡çš„å¯åŠ¨æ–¹å¼å¦‚å‰é¢æ‰€è¿°ï¼Œé•¿äº‹åŠ¡æœ‰è¿™äº›æ½œåœ¨é£é™©ï¼Œæˆ‘å½“ç„¶æ˜¯å»ºè®®ä½ å°½é‡é¿å…ã€‚å…¶å®å¾ˆå¤šæ—¶å€™ä¸šåŠ¡å¼€å‘åŒå­¦å¹¶ä¸æ˜¯æœ‰æ„ä½¿ç”¨é•¿äº‹åŠ¡ï¼Œé€šå¸¸æ˜¯ç”±äºè¯¯ç”¨æ‰€è‡´ã€‚MySQL çš„äº‹åŠ¡å¯åŠ¨æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š æ˜¾å¼å¯åŠ¨äº‹åŠ¡è¯­å¥ï¼Œ begin æˆ– start transactionã€‚é…å¥—çš„æäº¤è¯­å¥æ˜¯ commitï¼Œå›æ»šè¯­å¥æ˜¯ rollbackã€‚ set autocommit&#x3D;0ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šå°†è¿™ä¸ªçº¿ç¨‹çš„è‡ªåŠ¨æäº¤å…³æ‰ã€‚æ„å‘³ç€å¦‚æœä½ åªæ‰§è¡Œä¸€ä¸ª select è¯­å¥ï¼Œè¿™ä¸ªäº‹åŠ¡å°±å¯åŠ¨äº†ï¼Œè€Œä¸”å¹¶ä¸ä¼šè‡ªåŠ¨æäº¤ã€‚è¿™ä¸ªäº‹åŠ¡æŒç»­å­˜åœ¨ç›´åˆ°ä½ ä¸»åŠ¨æ‰§è¡Œ commit æˆ– rollback è¯­å¥ï¼Œæˆ–è€…æ–­å¼€è¿æ¥ã€‚ æœ‰äº›å®¢æˆ·ç«¯è¿æ¥æ¡†æ¶ä¼šé»˜è®¤è¿æ¥æˆåŠŸåå…ˆæ‰§è¡Œä¸€ä¸ª set autocommit&#x3D;0 çš„å‘½ä»¤ã€‚è¿™å°±å¯¼è‡´æ¥ä¸‹æ¥çš„æŸ¥è¯¢éƒ½åœ¨äº‹åŠ¡ä¸­ï¼Œå¦‚æœæ˜¯é•¿è¿æ¥ï¼Œå°±å¯¼è‡´äº†æ„å¤–çš„é•¿äº‹åŠ¡ã€‚ å› æ­¤ï¼Œæˆ‘ä¼šå»ºè®®ä½ æ€»æ˜¯ä½¿ç”¨ set autocommit&#x3D;1, é€šè¿‡æ˜¾å¼è¯­å¥çš„æ–¹å¼æ¥å¯åŠ¨äº‹åŠ¡ã€‚ ä½†æ˜¯æœ‰çš„å¼€å‘åŒå­¦ä¼šçº ç»“â€œå¤šä¸€æ¬¡äº¤äº’â€çš„é—®é¢˜ã€‚å¯¹äºä¸€ä¸ªéœ€è¦é¢‘ç¹ä½¿ç”¨äº‹åŠ¡çš„ä¸šåŠ¡ï¼Œç¬¬äºŒç§æ–¹å¼æ¯ä¸ªäº‹åŠ¡åœ¨å¼€å§‹æ—¶éƒ½ä¸éœ€è¦ä¸»åŠ¨æ‰§è¡Œä¸€æ¬¡ â€œbeginâ€ï¼Œå‡å°‘äº†è¯­å¥çš„äº¤äº’æ¬¡æ•°ã€‚å¦‚æœä½ ä¹Ÿæœ‰è¿™ä¸ªé¡¾è™‘ï¼Œæˆ‘å»ºè®®ä½ ä½¿ç”¨ commit work and chain è¯­æ³•ã€‚ åœ¨ autocommit ä¸º 1 çš„æƒ…å†µä¸‹ï¼Œç”¨ begin æ˜¾å¼å¯åŠ¨çš„äº‹åŠ¡ï¼Œå¦‚æœæ‰§è¡Œ commit åˆ™æäº¤äº‹åŠ¡ã€‚å¦‚æœæ‰§è¡Œ commit work and chainï¼Œåˆ™æ˜¯æäº¤äº‹åŠ¡å¹¶è‡ªåŠ¨å¯åŠ¨ä¸‹ä¸€ä¸ªäº‹åŠ¡ï¼Œè¿™æ ·ä¹Ÿçœå»äº†å†æ¬¡æ‰§è¡Œ begin è¯­å¥çš„å¼€é”€ã€‚åŒæ—¶å¸¦æ¥çš„å¥½å¤„æ˜¯ä»ç¨‹åºå¼€å‘çš„è§’åº¦æ˜ç¡®åœ°çŸ¥é“æ¯ä¸ªè¯­å¥æ˜¯å¦å¤„äºäº‹åŠ¡ä¸­ã€‚ ä½ å¯ä»¥åœ¨ information_schema åº“çš„ innodb_trx è¿™ä¸ªè¡¨ä¸­æŸ¥è¯¢é•¿äº‹åŠ¡ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªè¯­å¥ï¼Œç”¨äºæŸ¥æ‰¾æŒç»­æ—¶é—´è¶…è¿‡ 60s çš„äº‹åŠ¡ã€‚ select * from information_schema.innodb_trx where TIME_TO_SEC(timediff(now(),trx_started))&gt;60 î˜“å¤åˆ¶ä»£ç  å°ç»“è¿™ç¯‡æ–‡ç« é‡Œé¢ï¼Œä»‹ç»äº† MySQL çš„äº‹åŠ¡éš”ç¦»çº§åˆ«çš„ç°è±¡å’Œå®ç°ï¼Œæ ¹æ®å®ç°åŸç†åˆ†æäº†é•¿äº‹åŠ¡å­˜åœ¨çš„é£é™©ï¼Œä»¥åŠå¦‚ä½•ç”¨æ­£ç¡®çš„æ–¹å¼é¿å…é•¿äº‹åŠ¡ã€‚å¸Œæœ›æˆ‘ä¸¾çš„ä¾‹å­èƒ½å¤Ÿå¸®åŠ©ä½ ç†è§£äº‹åŠ¡ï¼Œå¹¶æ›´å¥½åœ°ä½¿ç”¨ MySQL çš„äº‹åŠ¡ç‰¹æ€§ã€‚ è¯¾åé¢˜ä½ ç°åœ¨çŸ¥é“äº†ç³»ç»Ÿé‡Œé¢åº”è¯¥é¿å…é•¿äº‹åŠ¡ï¼Œå¦‚æœä½ æ˜¯ä¸šåŠ¡å¼€å‘è´Ÿè´£äººåŒæ—¶ä¹Ÿæ˜¯æ•°æ®åº“è´Ÿè´£äººï¼Œä½ ä¼šæœ‰ä»€ä¹ˆæ–¹æ¡ˆæ¥é¿å…å‡ºç°æˆ–è€…å¤„ç†è¿™ç§æƒ…å†µå‘¢ï¼Ÿ è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä»åº”ç”¨å¼€å‘ç«¯å’Œæ•°æ®åº“ç«¯æ¥çœ‹ã€‚ é¦–å…ˆï¼Œä»åº”ç”¨å¼€å‘ç«¯æ¥çœ‹ï¼š ç¡®è®¤æ˜¯å¦ä½¿ç”¨äº† set autocommit&#x3D;0ã€‚è¿™ä¸ªç¡®è®¤å·¥ä½œå¯ä»¥åœ¨æµ‹è¯•ç¯å¢ƒä¸­å¼€å±•ï¼ŒæŠŠ MySQL çš„ general_log å¼€èµ·æ¥ï¼Œç„¶åéšä¾¿è·‘ä¸€ä¸ªä¸šåŠ¡é€»è¾‘ï¼Œé€šè¿‡ general_log çš„æ—¥å¿—æ¥ç¡®è®¤ã€‚ä¸€èˆ¬æ¡†æ¶å¦‚æœä¼šè®¾ç½®è¿™ä¸ªå€¼ï¼Œä¹Ÿå°±ä¼šæä¾›å‚æ•°æ¥æ§åˆ¶è¡Œä¸ºï¼Œä½ çš„ç›®æ ‡å°±æ˜¯æŠŠå®ƒæ”¹æˆ 1ã€‚ ç¡®è®¤æ˜¯å¦æœ‰ä¸å¿…è¦çš„åªè¯»äº‹åŠ¡ã€‚æœ‰äº›æ¡†æ¶ä¼šä¹ æƒ¯ä¸ç®¡ä»€ä¹ˆè¯­å¥å…ˆç”¨ begin&#x2F;commit æ¡†èµ·æ¥ã€‚æˆ‘è§è¿‡æœ‰äº›æ˜¯ä¸šåŠ¡å¹¶æ²¡æœ‰è¿™ä¸ªéœ€è¦ï¼Œä½†æ˜¯ä¹ŸæŠŠå¥½å‡ ä¸ª select è¯­å¥æ”¾åˆ°äº†äº‹åŠ¡ä¸­ã€‚è¿™ç§åªè¯»äº‹åŠ¡å¯ä»¥å»æ‰ã€‚ ä¸šåŠ¡è¿æ¥æ•°æ®åº“çš„æ—¶å€™ï¼Œæ ¹æ®ä¸šåŠ¡æœ¬èº«çš„é¢„ä¼°ï¼Œé€šè¿‡ SET MAX_EXECUTION_TIME å‘½ä»¤ï¼Œæ¥æ§åˆ¶æ¯ä¸ªè¯­å¥æ‰§è¡Œçš„æœ€é•¿æ—¶é—´ï¼Œé¿å…å•ä¸ªè¯­å¥æ„å¤–æ‰§è¡Œå¤ªé•¿æ—¶é—´ã€‚ï¼ˆä¸ºä»€ä¹ˆä¼šæ„å¤–ï¼Ÿåœ¨åç»­çš„æ–‡ç« ä¸­ä¼šæåˆ°è¿™ç±»æ¡ˆä¾‹ï¼‰ å…¶æ¬¡ï¼Œä»æ•°æ®åº“ç«¯æ¥çœ‹ï¼š ç›‘æ§ information_schema.Innodb_trx è¡¨ï¼Œè®¾ç½®é•¿äº‹åŠ¡é˜ˆå€¼ï¼Œè¶…è¿‡å°±æŠ¥è­¦ &#x2F; æˆ–è€… killï¼› Percona çš„ pt-kill è¿™ä¸ªå·¥å…·ä¸é”™ï¼Œæ¨èä½¿ç”¨ï¼› åœ¨ä¸šåŠ¡åŠŸèƒ½æµ‹è¯•é˜¶æ®µè¦æ±‚è¾“å‡ºæ‰€æœ‰çš„ general_logï¼Œåˆ†ææ—¥å¿—è¡Œä¸ºæå‰å‘ç°é—®é¢˜ï¼› å¦‚æœä½¿ç”¨çš„æ˜¯ MySQL 5.6 æˆ–è€…æ›´æ–°ç‰ˆæœ¬ï¼ŒæŠŠ innodb_undo_tablespaces è®¾ç½®æˆ 2ï¼ˆæˆ–æ›´å¤§çš„å€¼ï¼‰ã€‚å¦‚æœçœŸçš„å‡ºç°å¤§äº‹åŠ¡å¯¼è‡´å›æ»šæ®µè¿‡å¤§ï¼Œè¿™æ ·è®¾ç½®åæ¸…ç†èµ·æ¥æ›´æ–¹ä¾¿ã€‚","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://blog.ehzyil.xyz/tags/MySQL/"}],"author":"ehzyil"},{"title":"å¼€å¯ Azure è™šæ‹Ÿæœºçš„ root è´¦æˆ·","slug":"2023/å¼€å¯ Azure è™šæ‹Ÿæœºçš„ root è´¦æˆ·","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/26/2023/å¼€å¯ Azure è™šæ‹Ÿæœºçš„ root è´¦æˆ·/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/%E5%BC%80%E5%90%AF%20Azure%20%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%20root%20%E8%B4%A6%E6%88%B7/","excerpt":"","text":"ä½¿ç”¨finalshellè¿æ¥ç™½å«–çš„azureè™šæ‹ŸæœåŠ¡å™¨å‘ç°rootè´¦å·å¿˜äº†ï¼Œäºæ˜¯æŸ¥è¯¢å¾—çŸ¥ä¸‹é¢çš„æ•™ç¨‹ã€‚ é»˜è®¤æƒ…å†µå¾®è½¯ Azure äº‘æ˜¯æ²¡æœ‰å¼€å¯ root è´¦æˆ·çš„ï¼Œroot è´¦æˆ·æ˜¯ç¦ç”¨çŠ¶æ€ã€‚ é¦–å…ˆæ‰§è¡Œï¼šsudo passwd root å‘½ä»¤åˆå§‹åŒ–rootç”¨æˆ·å¯†ç  sudo passwd root ä¿®æ”¹ sshd_config æ–‡ä»¶ å¼€å¯ root è®¿é—®æƒé™ sudo vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config åœ¨ sshd_config æ–‡ä»¶é‡Œçš„ Authentication éƒ¨åˆ†åŠ ä¸Šä»¥ä¸‹å†…å®¹ï¼š PermitRootLogin yes ç¼–è¾‘å®Œæ¯•åï¼Œé‡å¯ ssh æœåŠ¡ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š sudo systemctl restart sshd # é‡å¯ ssh æœåŠ¡ä»¥åº”ç”¨æ›´æ”¹ æœ€åå°è¯•ä»¥ root ç”¨æˆ·ç™»é™†ï¼Œæ˜¾ç¤ºç™»é™†æˆåŠŸï¼Œå¹¶ä¸”ç”¨æˆ·ä¸ºrootè´¦æˆ·ã€‚ æ‰§è¡Œçš„ä»£ç å’Œç»“æœå¦‚ä¸‹ï¼š ehzyil@AzureVM:~&#x2F;data&#x2F;script$ sudo passwd root New password: Retype new password: passwd: password updated successfully ehzyil@AzureVM:~&#x2F;data&#x2F;script$ sudo vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config ehzyil@AzureVM:~&#x2F;data&#x2F;script$ sudo systemctl restart sshd ehzyil@AzureVM:~&#x2F;data&#x2F;script$ su Password: root@AzureVM:&#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;script# bash &lt;(curl -L https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;v2fly&#x2F;fhs-install-v2ray&#x2F;master&#x2F;install-release.sh) ç›¸ä¼¼ç³»ç»Ÿå¯ç”¨Rootç”¨æˆ· â€‹ Ubuntu åŠ Ubuntu SSH å¯ç”¨ Root ç”¨æˆ· - æ¬§å°¼é…±çš„å°å±‹","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"linux","slug":"linux","permalink":"https://blog.ehzyil.xyz/tags/linux/"},{"name":"Azure","slug":"Azure","permalink":"https://blog.ehzyil.xyz/tags/Azure/"}],"author":"ehzyil"},{"title":"æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸Šï¼‰","slug":"2023/æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸Šï¼‰","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/26/2023/æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸Šï¼‰/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E7%B4%A2%E5%BC%95%EF%BC%88%E4%B8%8A%EF%BC%89/","excerpt":"","text":"æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸Šï¼‰ è½¬è½½MySQLå®æˆ˜45è®²| 04 | æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸Šï¼‰ æåˆ°æ•°æ®åº“ç´¢å¼•ï¼Œæˆ‘æƒ³ä½ å¹¶ä¸é™Œç”Ÿï¼Œåœ¨æ—¥å¸¸å·¥ä½œä¸­ä¼šç»å¸¸æ¥è§¦åˆ°ã€‚æ¯”å¦‚æŸä¸€ä¸ª SQL æŸ¥è¯¢æ¯”è¾ƒæ…¢ï¼Œåˆ†æå®ŒåŸå› ä¹‹åï¼Œä½ å¯èƒ½å°±ä¼šè¯´â€œç»™æŸä¸ªå­—æ®µåŠ ä¸ªç´¢å¼•å§â€ä¹‹ç±»çš„è§£å†³æ–¹æ¡ˆã€‚ä½†åˆ°åº•ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Œç´¢å¼•åˆæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿä»Šå¤©å°±è®©æˆ‘ä»¬ä¸€èµ·æ¥èŠèŠè¿™ä¸ªè¯é¢˜å§ã€‚ æ•°æ®åº“ç´¢å¼•çš„å†…å®¹æ¯”è¾ƒå¤šï¼Œæˆ‘åˆ†æˆäº†ä¸Šä¸‹ä¸¤ç¯‡æ–‡ç« ã€‚ç´¢å¼•æ˜¯æ•°æ®åº“ç³»ç»Ÿé‡Œé¢æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼Œæ‰€ä»¥æˆ‘å¸Œæœ›ä½ èƒ½å¤Ÿè€å¿ƒçœ‹å®Œã€‚åœ¨åé¢çš„å®æˆ˜æ–‡ç« ä¸­ï¼Œæˆ‘ä¹Ÿä¼šç»å¸¸å¼•ç”¨è¿™ä¸¤ç¯‡æ–‡ç« ä¸­æåˆ°çš„çŸ¥è¯†ç‚¹ï¼ŒåŠ æ·±ä½ å¯¹æ•°æ®åº“ç´¢å¼•çš„ç†è§£ã€‚ ä¸€å¥è¯ç®€å•æ¥è¯´ï¼Œç´¢å¼•çš„å‡ºç°å…¶å®å°±æ˜¯ä¸ºäº†æé«˜æ•°æ®æŸ¥è¯¢çš„æ•ˆç‡ï¼Œå°±åƒä¹¦çš„ç›®å½•ä¸€æ ·ã€‚ä¸€æœ¬ 500 é¡µçš„ä¹¦ï¼Œå¦‚æœä½ æƒ³å¿«é€Ÿæ‰¾åˆ°å…¶ä¸­çš„æŸä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œåœ¨ä¸å€ŸåŠ©ç›®å½•çš„æƒ…å†µä¸‹ï¼Œé‚£æˆ‘ä¼°è®¡ä½ å¯å¾—æ‰¾ä¸€ä¼šå„¿ã€‚åŒæ ·ï¼Œå¯¹äºæ•°æ®åº“çš„è¡¨è€Œè¨€ï¼Œç´¢å¼•å…¶å®å°±æ˜¯å®ƒçš„â€œç›®å½•â€ã€‚ ç´¢å¼•çš„å¸¸è§æ¨¡å‹ç´¢å¼•çš„å‡ºç°æ˜¯ä¸ºäº†æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œä½†æ˜¯å®ç°ç´¢å¼•çš„æ–¹å¼å´æœ‰å¾ˆå¤šç§ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå°±å¼•å…¥äº†ç´¢å¼•æ¨¡å‹çš„æ¦‚å¿µã€‚å¯ä»¥ç”¨äºæé«˜è¯»å†™æ•ˆç‡çš„æ•°æ®ç»“æ„å¾ˆå¤šï¼Œè¿™é‡Œæˆ‘å…ˆç»™ä½ ä»‹ç»ä¸‰ç§å¸¸è§ã€ä¹Ÿæ¯”è¾ƒç®€å•çš„æ•°æ®ç»“æ„ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯å“ˆå¸Œè¡¨ã€æœ‰åºæ•°ç»„å’Œæœç´¢æ ‘ã€‚ ä¸‹é¢æˆ‘ä¸»è¦ä»ä½¿ç”¨çš„è§’åº¦ï¼Œä¸ºä½ ç®€å•åˆ†æä¸€ä¸‹è¿™ä¸‰ç§æ¨¡å‹çš„åŒºåˆ«ã€‚ å“ˆå¸Œè¡¨æ˜¯ä¸€ç§ä»¥é”® - å€¼ï¼ˆkey-valueï¼‰å­˜å‚¨æ•°æ®çš„ç»“æ„ï¼Œæˆ‘ä»¬åªè¦è¾“å…¥å¾…æŸ¥æ‰¾çš„å€¼å³ keyï¼Œå°±å¯ä»¥æ‰¾åˆ°å…¶å¯¹åº”çš„å€¼å³ Valueã€‚å“ˆå¸Œçš„æ€è·¯å¾ˆç®€å•ï¼ŒæŠŠå€¼æ”¾åœ¨æ•°ç»„é‡Œï¼Œç”¨ä¸€ä¸ªå“ˆå¸Œå‡½æ•°æŠŠ key æ¢ç®—æˆä¸€ä¸ªç¡®å®šçš„ä½ç½®ï¼Œç„¶åæŠŠ value æ”¾åœ¨æ•°ç»„çš„è¿™ä¸ªä½ç½®ã€‚ ä¸å¯é¿å…åœ°ï¼Œå¤šä¸ª key å€¼ç»è¿‡å“ˆå¸Œå‡½æ•°çš„æ¢ç®—ï¼Œä¼šå‡ºç°åŒä¸€ä¸ªå€¼çš„æƒ…å†µã€‚å¤„ç†è¿™ç§æƒ…å†µçš„ä¸€ç§æ–¹æ³•æ˜¯ï¼Œæ‹‰å‡ºä¸€ä¸ªé“¾è¡¨ã€‚ å‡è®¾ï¼Œä½ ç°åœ¨ç»´æŠ¤ç€ä¸€ä¸ªèº«ä»½è¯ä¿¡æ¯å’Œå§“åçš„è¡¨ï¼Œéœ€è¦æ ¹æ®èº«ä»½è¯å·æŸ¥æ‰¾å¯¹åº”çš„åå­—ï¼Œè¿™æ—¶å¯¹åº”çš„å“ˆå¸Œç´¢å¼•çš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š å›¾ä¸­ï¼ŒUser2 å’Œ User4 æ ¹æ®èº«ä»½è¯å·ç®—å‡ºæ¥çš„å€¼éƒ½æ˜¯ Nï¼Œä½†æ²¡å…³ç³»ï¼Œåé¢è¿˜è·Ÿäº†ä¸€ä¸ªé“¾è¡¨ã€‚å‡è®¾ï¼Œè¿™æ—¶å€™ä½ è¦æŸ¥ ID_card_n2 å¯¹åº”çš„åå­—æ˜¯ä»€ä¹ˆï¼Œå¤„ç†æ­¥éª¤å°±æ˜¯ï¼šé¦–å…ˆï¼Œå°† ID_card_n2 é€šè¿‡å“ˆå¸Œå‡½æ•°ç®—å‡º Nï¼›ç„¶åï¼ŒæŒ‰é¡ºåºéå†ï¼Œæ‰¾åˆ° User2ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå›¾ä¸­å››ä¸ª ID_card_n çš„å€¼å¹¶ä¸æ˜¯é€’å¢çš„ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å¢åŠ æ–°çš„ User æ—¶é€Ÿåº¦ä¼šå¾ˆå¿«ï¼Œåªéœ€è¦å¾€åè¿½åŠ ã€‚ä½†ç¼ºç‚¹æ˜¯ï¼Œå› ä¸ºä¸æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥å“ˆå¸Œç´¢å¼•åšåŒºé—´æŸ¥è¯¢çš„é€Ÿåº¦æ˜¯å¾ˆæ…¢çš„ã€‚ ä½ å¯ä»¥è®¾æƒ³ä¸‹ï¼Œå¦‚æœä½ ç°åœ¨è¦æ‰¾èº«ä»½è¯å·åœ¨ [ID_card_X, ID_card_Y] è¿™ä¸ªåŒºé—´çš„æ‰€æœ‰ç”¨æˆ·ï¼Œå°±å¿…é¡»å…¨éƒ¨æ‰«æä¸€éäº†ã€‚ æ‰€ä»¥ï¼Œå“ˆå¸Œè¡¨è¿™ç§ç»“æ„é€‚ç”¨äºåªæœ‰ç­‰å€¼æŸ¥è¯¢çš„åœºæ™¯ï¼Œæ¯”å¦‚ Memcached åŠå…¶ä»–ä¸€äº› NoSQL å¼•æ“ã€‚ è€Œæœ‰åºæ•°ç»„åœ¨ç­‰å€¼æŸ¥è¯¢å’ŒèŒƒå›´æŸ¥è¯¢åœºæ™¯ä¸­çš„æ€§èƒ½å°±éƒ½éå¸¸ä¼˜ç§€ã€‚è¿˜æ˜¯ä¸Šé¢è¿™ä¸ªæ ¹æ®èº«ä»½è¯å·æŸ¥åå­—çš„ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨æœ‰åºæ•°ç»„æ¥å®ç°çš„è¯ï¼Œç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š è¿™é‡Œæˆ‘ä»¬å‡è®¾èº«ä»½è¯å·æ²¡æœ‰é‡å¤ï¼Œè¿™ä¸ªæ•°ç»„å°±æ˜¯æŒ‰ç…§èº«ä»½è¯å·é€’å¢çš„é¡ºåºä¿å­˜çš„ã€‚è¿™æ—¶å€™å¦‚æœä½ è¦æŸ¥ ID_card_n2 å¯¹åº”çš„åå­—ï¼Œç”¨äºŒåˆ†æ³•å°±å¯ä»¥å¿«é€Ÿå¾—åˆ°ï¼Œè¿™ä¸ªæ—¶é—´å¤æ‚åº¦æ˜¯ O(log(N))ã€‚ åŒæ—¶å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªç´¢å¼•ç»“æ„æ”¯æŒèŒƒå›´æŸ¥è¯¢ã€‚ä½ è¦æŸ¥èº«ä»½è¯å·åœ¨ [ID_card_X, ID_card_Y] åŒºé—´çš„ Userï¼Œå¯ä»¥å…ˆç”¨äºŒåˆ†æ³•æ‰¾åˆ° ID_card_Xï¼ˆå¦‚æœä¸å­˜åœ¨ ID_card_Xï¼Œå°±æ‰¾åˆ°å¤§äº ID_card_X çš„ç¬¬ä¸€ä¸ª Userï¼‰ï¼Œç„¶åå‘å³éå†ï¼Œç›´åˆ°æŸ¥åˆ°ç¬¬ä¸€ä¸ªå¤§äº ID_card_Y çš„èº«ä»½è¯å·ï¼Œé€€å‡ºå¾ªç¯ã€‚ å¦‚æœä»…ä»…çœ‹æŸ¥è¯¢æ•ˆç‡ï¼Œæœ‰åºæ•°ç»„å°±æ˜¯æœ€å¥½çš„æ•°æ®ç»“æ„äº†ã€‚ä½†æ˜¯ï¼Œåœ¨éœ€è¦æ›´æ–°æ•°æ®çš„æ—¶å€™å°±éº»çƒ¦äº†ï¼Œä½ å¾€ä¸­é—´æ’å…¥ä¸€ä¸ªè®°å½•å°±å¿…é¡»å¾—æŒªåŠ¨åé¢æ‰€æœ‰çš„è®°å½•ï¼Œæˆæœ¬å¤ªé«˜ã€‚ æ‰€ä»¥ï¼Œæœ‰åºæ•°ç»„ç´¢å¼•åªé€‚ç”¨äºé™æ€å­˜å‚¨å¼•æ“ï¼Œæ¯”å¦‚ä½ è¦ä¿å­˜çš„æ˜¯ 2017 å¹´æŸä¸ªåŸå¸‚çš„æ‰€æœ‰äººå£ä¿¡æ¯ï¼Œè¿™ç±»ä¸ä¼šå†ä¿®æ”¹çš„æ•°æ®ã€‚ äºŒå‰æœç´¢æ ‘ä¹Ÿæ˜¯è¯¾æœ¬é‡Œçš„ç»å…¸æ•°æ®ç»“æ„äº†ã€‚è¿˜æ˜¯ä¸Šé¢æ ¹æ®èº«ä»½è¯å·æŸ¥åå­—çš„ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬ç”¨äºŒå‰æœç´¢æ ‘æ¥å®ç°çš„è¯ï¼Œç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š äºŒå‰æœç´¢æ ‘çš„ç‰¹ç‚¹æ˜¯ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„å·¦å„¿å­å°äºçˆ¶èŠ‚ç‚¹ï¼Œçˆ¶èŠ‚ç‚¹åˆå°äºå³å„¿å­ã€‚è¿™æ ·å¦‚æœä½ è¦æŸ¥ ID_card_n2 çš„è¯ï¼ŒæŒ‰ç…§å›¾ä¸­çš„æœç´¢é¡ºåºå°±æ˜¯æŒ‰ç…§ UserA -&gt; UserC -&gt; UserF -&gt; User2 è¿™ä¸ªè·¯å¾„å¾—åˆ°ã€‚è¿™ä¸ªæ—¶é—´å¤æ‚åº¦æ˜¯ O(log(N))ã€‚ å½“ç„¶ä¸ºäº†ç»´æŒ O(log(N)) çš„æŸ¥è¯¢å¤æ‚åº¦ï¼Œä½ å°±éœ€è¦ä¿æŒè¿™æ£µæ ‘æ˜¯å¹³è¡¡äºŒå‰æ ‘ã€‚ä¸ºäº†åšè¿™ä¸ªä¿è¯ï¼Œæ›´æ–°çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ O(log(N))ã€‚ æ ‘å¯ä»¥æœ‰äºŒå‰ï¼Œä¹Ÿå¯ä»¥æœ‰å¤šå‰ã€‚å¤šå‰æ ‘å°±æ˜¯æ¯ä¸ªèŠ‚ç‚¹æœ‰å¤šä¸ªå„¿å­ï¼Œå„¿å­ä¹‹é—´çš„å¤§å°ä¿è¯ä»å·¦åˆ°å³é€’å¢ã€‚äºŒå‰æ ‘æ˜¯æœç´¢æ•ˆç‡æœ€é«˜çš„ï¼Œä½†æ˜¯å®é™…ä¸Šå¤§å¤šæ•°çš„æ•°æ®åº“å­˜å‚¨å´å¹¶ä¸ä½¿ç”¨äºŒå‰æ ‘ã€‚å…¶åŸå› æ˜¯ï¼Œç´¢å¼•ä¸æ­¢å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜è¦å†™åˆ°ç£ç›˜ä¸Šã€‚ ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹ä¸€æ£µ 100 ä¸‡èŠ‚ç‚¹çš„å¹³è¡¡äºŒå‰æ ‘ï¼Œæ ‘é«˜ 20ã€‚ä¸€æ¬¡æŸ¥è¯¢å¯èƒ½éœ€è¦è®¿é—® 20 ä¸ªæ•°æ®å—ã€‚åœ¨æœºæ¢°ç¡¬ç›˜æ—¶ä»£ï¼Œä»ç£ç›˜éšæœºè¯»ä¸€ä¸ªæ•°æ®å—éœ€è¦ 10 ms å·¦å³çš„å¯»å€æ—¶é—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ª 100 ä¸‡è¡Œçš„è¡¨ï¼Œå¦‚æœä½¿ç”¨äºŒå‰æ ‘æ¥å­˜å‚¨ï¼Œå•ç‹¬è®¿é—®ä¸€ä¸ªè¡Œå¯èƒ½éœ€è¦ 20 ä¸ª 10 ms çš„æ—¶é—´ï¼Œè¿™ä¸ªæŸ¥è¯¢å¯çœŸå¤Ÿæ…¢çš„ã€‚ ä¸ºäº†è®©ä¸€ä¸ªæŸ¥è¯¢å°½é‡å°‘åœ°è¯»ç£ç›˜ï¼Œå°±å¿…é¡»è®©æŸ¥è¯¢è¿‡ç¨‹è®¿é—®å°½é‡å°‘çš„æ•°æ®å—ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ä¸åº”è¯¥ä½¿ç”¨äºŒå‰æ ‘ï¼Œè€Œæ˜¯è¦ä½¿ç”¨â€œN å‰â€æ ‘ã€‚è¿™é‡Œï¼Œâ€œN å‰â€æ ‘ä¸­çš„â€œNâ€å–å†³äºæ•°æ®å—çš„å¤§å°ã€‚ ä»¥ InnoDB çš„ä¸€ä¸ªæ•´æ•°å­—æ®µç´¢å¼•ä¸ºä¾‹ï¼Œè¿™ä¸ª N å·®ä¸å¤šæ˜¯ 1200ã€‚è¿™æ£µæ ‘é«˜æ˜¯ 4 çš„æ—¶å€™ï¼Œå°±å¯ä»¥å­˜ 1200 çš„ 3 æ¬¡æ–¹ä¸ªå€¼ï¼Œè¿™å·²ç» 17 äº¿äº†ã€‚è€ƒè™‘åˆ°æ ‘æ ¹çš„æ•°æ®å—æ€»æ˜¯åœ¨å†…å­˜ä¸­çš„ï¼Œä¸€ä¸ª 10 äº¿è¡Œçš„è¡¨ä¸Šä¸€ä¸ªæ•´æ•°å­—æ®µçš„ç´¢å¼•ï¼ŒæŸ¥æ‰¾ä¸€ä¸ªå€¼æœ€å¤šåªéœ€è¦è®¿é—® 3 æ¬¡ç£ç›˜ã€‚å…¶å®ï¼Œæ ‘çš„ç¬¬äºŒå±‚ä¹Ÿæœ‰å¾ˆå¤§æ¦‚ç‡åœ¨å†…å­˜ä¸­ï¼Œé‚£ä¹ˆè®¿é—®ç£ç›˜çš„å¹³å‡æ¬¡æ•°å°±æ›´å°‘äº†ã€‚ N å‰æ ‘ç”±äºåœ¨è¯»å†™ä¸Šçš„æ€§èƒ½ä¼˜ç‚¹ï¼Œä»¥åŠé€‚é…ç£ç›˜çš„è®¿é—®æ¨¡å¼ï¼Œå·²ç»è¢«å¹¿æ³›åº”ç”¨åœ¨æ•°æ®åº“å¼•æ“ä¸­äº†ã€‚ ä¸ç®¡æ˜¯å“ˆå¸Œè¿˜æ˜¯æœ‰åºæ•°ç»„ï¼Œæˆ–è€… N å‰æ ‘ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸æ–­è¿­ä»£ã€ä¸æ–­ä¼˜åŒ–çš„äº§ç‰©æˆ–è€…è§£å†³æ–¹æ¡ˆã€‚æ•°æ®åº“æŠ€æœ¯å‘å±•åˆ°ä»Šå¤©ï¼Œè·³è¡¨ã€LSM æ ‘ç­‰æ•°æ®ç»“æ„ä¹Ÿè¢«ç”¨äºå¼•æ“è®¾è®¡ä¸­ï¼Œè¿™é‡Œæˆ‘å°±ä¸å†ä¸€ä¸€å±•å¼€äº†ã€‚ ä½ å¿ƒé‡Œè¦æœ‰ä¸ªæ¦‚å¿µï¼Œæ•°æ®åº“åº•å±‚å­˜å‚¨çš„æ ¸å¿ƒå°±æ˜¯åŸºäºè¿™äº›æ•°æ®æ¨¡å‹çš„ã€‚æ¯ç¢°åˆ°ä¸€ä¸ªæ–°æ•°æ®åº“ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå…³æ³¨å®ƒçš„æ•°æ®æ¨¡å‹ï¼Œè¿™æ ·æ‰èƒ½ä»ç†è®ºä¸Šåˆ†æå‡ºè¿™ä¸ªæ•°æ®åº“çš„é€‚ç”¨åœºæ™¯ã€‚ æˆªæ­¢åˆ°è¿™é‡Œï¼Œæˆ‘ç”¨äº†åŠç¯‡æ–‡ç« çš„ç¯‡å¹…å’Œä½ ä»‹ç»äº†ä¸åŒçš„æ•°æ®ç»“æ„ï¼Œä»¥åŠå®ƒä»¬çš„é€‚ç”¨åœºæ™¯ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—æœ‰äº›æ¯ç‡¥ã€‚ä½†æ˜¯ï¼Œæˆ‘å»ºè®®ä½ è¿˜æ˜¯è¦å¤šèŠ±ä¸€äº›æ—¶é—´æ¥ç†è§£è¿™éƒ¨åˆ†å†…å®¹ï¼Œæ¯•ç«Ÿè¿™æ˜¯æ•°æ®åº“å¤„ç†æ•°æ®çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ï¼Œåœ¨åˆ†æé—®é¢˜çš„æ—¶å€™ä¼šç»å¸¸ç”¨åˆ°ã€‚å½“ä½ ç†è§£äº†ç´¢å¼•çš„æ¨¡å‹åï¼Œå°±ä¼šå‘ç°åœ¨åˆ†æé—®é¢˜çš„æ—¶å€™ä¼šæœ‰ä¸€ä¸ªæ›´æ¸…æ™°çš„è§†è§’ï¼Œä½“ä¼šåˆ°å¼•æ“è®¾è®¡çš„ç²¾å¦™ä¹‹å¤„ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬ä¸€èµ·è¿›å…¥ç›¸å¯¹åå®æˆ˜çš„å†…å®¹å§ã€‚ åœ¨ MySQL ä¸­ï¼Œç´¢å¼•æ˜¯åœ¨å­˜å‚¨å¼•æ“å±‚å®ç°çš„ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰ç»Ÿä¸€çš„ç´¢å¼•æ ‡å‡†ï¼Œå³ä¸åŒå­˜å‚¨å¼•æ“çš„ç´¢å¼•çš„å·¥ä½œæ–¹å¼å¹¶ä¸ä¸€æ ·ã€‚è€Œå³ä½¿å¤šä¸ªå­˜å‚¨å¼•æ“æ”¯æŒåŒä¸€ç§ç±»å‹çš„ç´¢å¼•ï¼Œå…¶åº•å±‚çš„å®ç°ä¹Ÿå¯èƒ½ä¸åŒã€‚ç”±äº InnoDB å­˜å‚¨å¼•æ“åœ¨ MySQL æ•°æ®åº“ä¸­ä½¿ç”¨æœ€ä¸ºå¹¿æ³›ï¼Œæ‰€ä»¥ä¸‹é¢æˆ‘å°±ä»¥ InnoDB ä¸ºä¾‹ï¼Œå’Œä½ åˆ†æä¸€ä¸‹å…¶ä¸­çš„ç´¢å¼•æ¨¡å‹ã€‚ InnoDB çš„ç´¢å¼•æ¨¡å‹åœ¨ InnoDB ä¸­ï¼Œè¡¨éƒ½æ˜¯æ ¹æ®ä¸»é”®é¡ºåºä»¥ç´¢å¼•çš„å½¢å¼å­˜æ”¾çš„ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼çš„è¡¨ç§°ä¸ºç´¢å¼•ç»„ç»‡è¡¨ã€‚åˆå› ä¸ºå‰é¢æˆ‘ä»¬æåˆ°çš„ï¼ŒInnoDB ä½¿ç”¨äº† B+ æ ‘ç´¢å¼•æ¨¡å‹ï¼Œæ‰€ä»¥æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨ B+ æ ‘ä¸­çš„ã€‚ æ¯ä¸€ä¸ªç´¢å¼•åœ¨ InnoDB é‡Œé¢å¯¹åº”ä¸€æ£µ B+ æ ‘ã€‚ å‡è®¾ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸»é”®åˆ—ä¸º ID çš„è¡¨ï¼Œè¡¨ä¸­æœ‰å­—æ®µ kï¼Œå¹¶ä¸”åœ¨ k ä¸Šæœ‰ç´¢å¼•ã€‚ è¿™ä¸ªè¡¨çš„å»ºè¡¨è¯­å¥æ˜¯ï¼š mysql&gt; create table T( id int primary key, k int not null, name varchar(16), index (k))engine&#x3D;InnoDB; è¡¨ä¸­ R1~R5 çš„ (ID,k) å€¼åˆ†åˆ«ä¸º (100,1)ã€(200,2)ã€(300,3)ã€(500,5) å’Œ (600,6)ï¼Œä¸¤æ£µæ ‘çš„ç¤ºä¾‹ç¤ºæ„å›¾å¦‚ä¸‹ã€‚ ä»å›¾ä¸­ä¸éš¾çœ‹å‡ºï¼Œæ ¹æ®å¶å­èŠ‚ç‚¹çš„å†…å®¹ï¼Œç´¢å¼•ç±»å‹åˆ†ä¸ºä¸»é”®ç´¢å¼•å’Œéä¸»é”®ç´¢å¼•ã€‚ ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜çš„æ˜¯æ•´è¡Œæ•°æ®ã€‚åœ¨ InnoDB é‡Œï¼Œä¸»é”®ç´¢å¼•ä¹Ÿè¢«ç§°ä¸ºèšç°‡ç´¢å¼•ï¼ˆclustered indexï¼‰ã€‚ éä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å†…å®¹æ˜¯ä¸»é”®çš„å€¼ã€‚åœ¨ InnoDB é‡Œï¼Œéä¸»é”®ç´¢å¼•ä¹Ÿè¢«ç§°ä¸ºäºŒçº§ç´¢å¼•ï¼ˆsecondary indexï¼‰ã€‚ æ ¹æ®ä¸Šé¢çš„ç´¢å¼•ç»“æ„è¯´æ˜ï¼Œæˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸ªé—®é¢˜ï¼šåŸºäºä¸»é”®ç´¢å¼•å’Œæ™®é€šç´¢å¼•çš„æŸ¥è¯¢æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å¦‚æœè¯­å¥æ˜¯ select * from T where ID&#x3D;500ï¼Œå³ä¸»é”®æŸ¥è¯¢æ–¹å¼ï¼Œåˆ™åªéœ€è¦æœç´¢ ID è¿™æ£µ B+ æ ‘ï¼› å¦‚æœè¯­å¥æ˜¯ select * from T where k&#x3D;5ï¼Œå³æ™®é€šç´¢å¼•æŸ¥è¯¢æ–¹å¼ï¼Œåˆ™éœ€è¦å…ˆæœç´¢ k ç´¢å¼•æ ‘ï¼Œå¾—åˆ° ID çš„å€¼ä¸º 500ï¼Œå†åˆ° ID ç´¢å¼•æ ‘æœç´¢ä¸€æ¬¡ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå›è¡¨ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸºäºéä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€æ£µç´¢å¼•æ ‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­åº”è¯¥å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ã€‚ ç´¢å¼•ç»´æŠ¤B+ æ ‘ä¸ºäº†ç»´æŠ¤ç´¢å¼•æœ‰åºæ€§ï¼Œåœ¨æ’å…¥æ–°å€¼çš„æ—¶å€™éœ€è¦åšå¿…è¦çš„ç»´æŠ¤ã€‚ä»¥ä¸Šé¢è¿™ä¸ªå›¾ä¸ºä¾‹ï¼Œå¦‚æœæ’å…¥æ–°çš„è¡Œ ID å€¼ä¸º 700ï¼Œåˆ™åªéœ€è¦åœ¨ R5 çš„è®°å½•åé¢æ’å…¥ä¸€ä¸ªæ–°è®°å½•ã€‚å¦‚æœæ–°æ’å…¥çš„ ID å€¼ä¸º 400ï¼Œå°±ç›¸å¯¹éº»çƒ¦äº†ï¼Œéœ€è¦é€»è¾‘ä¸ŠæŒªåŠ¨åé¢çš„æ•°æ®ï¼Œç©ºå‡ºä½ç½®ã€‚ è€Œæ›´ç³Ÿçš„æƒ…å†µæ˜¯ï¼Œå¦‚æœ R5 æ‰€åœ¨çš„æ•°æ®é¡µå·²ç»æ»¡äº†ï¼Œæ ¹æ® B+ æ ‘çš„ç®—æ³•ï¼Œè¿™æ—¶å€™éœ€è¦ç”³è¯·ä¸€ä¸ªæ–°çš„æ•°æ®é¡µï¼Œç„¶åæŒªåŠ¨éƒ¨åˆ†æ•°æ®è¿‡å»ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºé¡µåˆ†è£‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ€§èƒ½è‡ªç„¶ä¼šå—å½±å“ã€‚ é™¤äº†æ€§èƒ½å¤–ï¼Œé¡µåˆ†è£‚æ“ä½œè¿˜å½±å“æ•°æ®é¡µçš„åˆ©ç”¨ç‡ã€‚åŸæœ¬æ”¾åœ¨ä¸€ä¸ªé¡µçš„æ•°æ®ï¼Œç°åœ¨åˆ†åˆ°ä¸¤ä¸ªé¡µä¸­ï¼Œæ•´ä½“ç©ºé—´åˆ©ç”¨ç‡é™ä½å¤§çº¦ 50%ã€‚ å½“ç„¶æœ‰åˆ†è£‚å°±æœ‰åˆå¹¶ã€‚å½“ç›¸é‚»ä¸¤ä¸ªé¡µç”±äºåˆ é™¤äº†æ•°æ®ï¼Œåˆ©ç”¨ç‡å¾ˆä½ä¹‹åï¼Œä¼šå°†æ•°æ®é¡µåšåˆå¹¶ã€‚åˆå¹¶çš„è¿‡ç¨‹ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯åˆ†è£‚è¿‡ç¨‹çš„é€†è¿‡ç¨‹ã€‚ åŸºäºä¸Šé¢çš„ç´¢å¼•ç»´æŠ¤è¿‡ç¨‹è¯´æ˜ï¼Œæˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸ªæ¡ˆä¾‹ï¼š ä½ å¯èƒ½åœ¨ä¸€äº›å»ºè¡¨è§„èŒƒé‡Œé¢è§åˆ°è¿‡ç±»ä¼¼çš„æè¿°ï¼Œè¦æ±‚å»ºè¡¨è¯­å¥é‡Œä¸€å®šè¦æœ‰è‡ªå¢ä¸»é”®ã€‚å½“ç„¶äº‹æ— ç»å¯¹ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å“ªäº›åœºæ™¯ä¸‹åº”è¯¥ä½¿ç”¨è‡ªå¢ä¸»é”®ï¼Œè€Œå“ªäº›åœºæ™¯ä¸‹ä¸åº”è¯¥ã€‚ è‡ªå¢ä¸»é”®æ˜¯æŒ‡è‡ªå¢åˆ—ä¸Šå®šä¹‰çš„ä¸»é”®ï¼Œåœ¨å»ºè¡¨è¯­å¥ä¸­ä¸€èˆ¬æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼š NOT NULL PRIMARY KEY AUTO_INCREMENTã€‚ æ’å…¥æ–°è®°å½•çš„æ—¶å€™å¯ä»¥ä¸æŒ‡å®š ID çš„å€¼ï¼Œç³»ç»Ÿä¼šè·å–å½“å‰ ID æœ€å¤§å€¼åŠ  1 ä½œä¸ºä¸‹ä¸€æ¡è®°å½•çš„ ID å€¼ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè‡ªå¢ä¸»é”®çš„æ’å…¥æ•°æ®æ¨¡å¼ï¼Œæ­£ç¬¦åˆäº†æˆ‘ä»¬å‰é¢æåˆ°çš„é€’å¢æ’å…¥çš„åœºæ™¯ã€‚æ¯æ¬¡æ’å…¥ä¸€æ¡æ–°è®°å½•ï¼Œéƒ½æ˜¯è¿½åŠ æ“ä½œï¼Œéƒ½ä¸æ¶‰åŠåˆ°æŒªåŠ¨å…¶ä»–è®°å½•ï¼Œä¹Ÿä¸ä¼šè§¦å‘å¶å­èŠ‚ç‚¹çš„åˆ†è£‚ã€‚ è€Œæœ‰ä¸šåŠ¡é€»è¾‘çš„å­—æ®µåšä¸»é”®ï¼Œåˆ™å¾€å¾€ä¸å®¹æ˜“ä¿è¯æœ‰åºæ’å…¥ï¼Œè¿™æ ·å†™æ•°æ®æˆæœ¬ç›¸å¯¹è¾ƒé«˜ã€‚ é™¤äº†è€ƒè™‘æ€§èƒ½å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä»å­˜å‚¨ç©ºé—´çš„è§’åº¦æ¥çœ‹ã€‚å‡è®¾ä½ çš„è¡¨ä¸­ç¡®å®æœ‰ä¸€ä¸ªå”¯ä¸€å­—æ®µï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ç±»å‹çš„èº«ä»½è¯å·ï¼Œé‚£åº”è¯¥ç”¨èº«ä»½è¯å·åšä¸»é”®ï¼Œè¿˜æ˜¯ç”¨è‡ªå¢å­—æ®µåšä¸»é”®å‘¢ï¼Ÿ ç”±äºæ¯ä¸ªéä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šéƒ½æ˜¯ä¸»é”®çš„å€¼ã€‚å¦‚æœç”¨èº«ä»½è¯å·åšä¸»é”®ï¼Œé‚£ä¹ˆæ¯ä¸ªäºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å ç”¨çº¦ 20 ä¸ªå­—èŠ‚ï¼Œè€Œå¦‚æœç”¨æ•´å‹åšä¸»é”®ï¼Œåˆ™åªè¦ 4 ä¸ªå­—èŠ‚ï¼Œå¦‚æœæ˜¯é•¿æ•´å‹ï¼ˆbigintï¼‰åˆ™æ˜¯ 8 ä¸ªå­—èŠ‚ã€‚ æ˜¾ç„¶ï¼Œä¸»é”®é•¿åº¦è¶Šå°ï¼Œæ™®é€šç´¢å¼•çš„å¶å­èŠ‚ç‚¹å°±è¶Šå°ï¼Œæ™®é€šç´¢å¼•å ç”¨çš„ç©ºé—´ä¹Ÿå°±è¶Šå°ã€‚ æ‰€ä»¥ï¼Œä»æ€§èƒ½å’Œå­˜å‚¨ç©ºé—´æ–¹é¢è€ƒé‡ï¼Œè‡ªå¢ä¸»é”®å¾€å¾€æ˜¯æ›´åˆç†çš„é€‰æ‹©ã€‚ æœ‰æ²¡æœ‰ä»€ä¹ˆåœºæ™¯é€‚åˆç”¨ä¸šåŠ¡å­—æ®µç›´æ¥åšä¸»é”®çš„å‘¢ï¼Ÿè¿˜æ˜¯æœ‰çš„ã€‚æ¯”å¦‚ï¼Œæœ‰äº›ä¸šåŠ¡çš„åœºæ™¯éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼š åªæœ‰ä¸€ä¸ªç´¢å¼•ï¼› è¯¥ç´¢å¼•å¿…é¡»æ˜¯å”¯ä¸€ç´¢å¼•ã€‚ ä½ ä¸€å®šçœ‹å‡ºæ¥äº†ï¼Œè¿™å°±æ˜¯å…¸å‹çš„ KV åœºæ™¯ã€‚ ç”±äºæ²¡æœ‰å…¶ä»–ç´¢å¼•ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸ç”¨è€ƒè™‘å…¶ä»–ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å¤§å°çš„é—®é¢˜ã€‚ è¿™æ—¶å€™æˆ‘ä»¬å°±è¦ä¼˜å…ˆè€ƒè™‘ä¸Šä¸€æ®µæåˆ°çš„â€œå°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢â€åŸåˆ™ï¼Œç›´æ¥å°†è¿™ä¸ªç´¢å¼•è®¾ç½®ä¸ºä¸»é”®ï¼Œå¯ä»¥é¿å…æ¯æ¬¡æŸ¥è¯¢éœ€è¦æœç´¢ä¸¤æ£µæ ‘ã€‚ å°ç»“ä»Šå¤©ï¼Œæˆ‘è·Ÿä½ åˆ†æäº†æ•°æ®åº“å¼•æ“å¯ç”¨çš„æ•°æ®ç»“æ„ï¼Œä»‹ç»äº† InnoDB é‡‡ç”¨çš„ B+ æ ‘ç»“æ„ï¼Œä»¥åŠä¸ºä»€ä¹ˆ InnoDB è¦è¿™ä¹ˆé€‰æ‹©ã€‚B+ æ ‘èƒ½å¤Ÿå¾ˆå¥½åœ°é…åˆç£ç›˜çš„è¯»å†™ç‰¹æ€§ï¼Œå‡å°‘å•æ¬¡æŸ¥è¯¢çš„ç£ç›˜è®¿é—®æ¬¡æ•°ã€‚ ç”±äº InnoDB æ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä¼šå»ºè®®ä½ åˆ›å»ºä¸€ä¸ªè‡ªå¢ä¸»é”®ï¼Œè¿™æ ·éä¸»é”®ç´¢å¼•å ç”¨çš„ç©ºé—´æœ€å°ã€‚ä½†äº‹æ— ç»å¯¹ï¼Œæˆ‘ä¹Ÿè·Ÿä½ è®¨è®ºäº†ä½¿ç”¨ä¸šåŠ¡é€»è¾‘å­—æ®µåšä¸»é”®çš„åº”ç”¨åœºæ™¯ã€‚ è¯¾åé¢˜å¯¹äºä¸Šé¢ä¾‹å­ä¸­çš„ InnoDB è¡¨ Tï¼Œå¦‚æœä½ è¦é‡å»ºç´¢å¼• kï¼Œä½ çš„ä¸¤ä¸ª SQL è¯­å¥å¯ä»¥è¿™ä¹ˆå†™ï¼š alter table T drop index k; alter table T add index(k); å¦‚æœä½ è¦é‡å»ºä¸»é”®ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ï¼š alter table T drop primary key; alter table T add primary key(id); æˆ‘çš„é—®é¢˜æ˜¯ï¼Œå¯¹äºä¸Šé¢è¿™ä¸¤ä¸ªé‡å»ºç´¢å¼•çš„ä½œæ³•ï¼Œè¯´å‡ºä½ çš„ç†è§£ã€‚å¦‚æœæœ‰ä¸åˆé€‚çš„ï¼Œä¸ºä»€ä¹ˆï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ ä¸ºä»€ä¹ˆè¦é‡å»ºç´¢å¼•ã€‚æˆ‘ä»¬æ–‡ç« é‡Œé¢æœ‰æåˆ°ï¼Œç´¢å¼•å¯èƒ½å› ä¸ºåˆ é™¤ï¼Œæˆ–è€…é¡µåˆ†è£‚ç­‰åŸå› ï¼Œå¯¼è‡´æ•°æ®é¡µæœ‰ç©ºæ´ï¼Œé‡å»ºç´¢å¼•çš„è¿‡ç¨‹ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç´¢å¼•ï¼ŒæŠŠæ•°æ®æŒ‰é¡ºåºæ’å…¥ï¼Œè¿™æ ·é¡µé¢çš„åˆ©ç”¨ç‡æœ€é«˜ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•æ›´ç´§å‡‘ã€æ›´çœç©ºé—´ã€‚ é‡å»ºç´¢å¼• k çš„åšæ³•æ˜¯åˆç†çš„ï¼Œå¯ä»¥è¾¾åˆ°çœç©ºé—´çš„ç›®çš„ã€‚ä½†æ˜¯ï¼Œé‡å»ºä¸»é”®çš„è¿‡ç¨‹ä¸åˆç†ã€‚ä¸è®ºæ˜¯åˆ é™¤ä¸»é”®è¿˜æ˜¯åˆ›å»ºä¸»é”®ï¼Œéƒ½ä¼šå°†æ•´ä¸ªè¡¨é‡å»ºã€‚æ‰€ä»¥è¿ç€æ‰§è¡Œè¿™ä¸¤ä¸ªè¯­å¥çš„è¯ï¼Œç¬¬ä¸€ä¸ªè¯­å¥å°±ç™½åšäº†ã€‚è¿™ä¸¤ä¸ªè¯­å¥ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªè¯­å¥ä»£æ›¿ ï¼š alter table T engine&#x3D;InnoDBã€‚","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://blog.ehzyil.xyz/tags/MySQL/"}],"author":"ehzyil"},{"title":"æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸‹ï¼‰","slug":"2023/æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸‹ï¼‰","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/26/2023/æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸‹ï¼‰/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%E7%B4%A2%E5%BC%95%EF%BC%88%E4%B8%8B%EF%BC%89/","excerpt":"","text":"è½¬è½½MySQLå®æˆ˜45è®² | 05 | æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸‹ï¼‰ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å’Œä½ ä»‹ç»äº† InnoDB ç´¢å¼•çš„æ•°æ®ç»“æ„æ¨¡å‹ï¼Œä»Šå¤©æˆ‘ä»¬å†ç»§ç»­èŠèŠè·Ÿ MySQL ç´¢å¼•æœ‰å…³çš„æ¦‚å¿µã€‚ åœ¨å¼€å§‹è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼š åœ¨ä¸‹é¢è¿™ä¸ªè¡¨ T ä¸­ï¼Œå¦‚æœæˆ‘æ‰§è¡Œ select * from T where k between 3 and 5ï¼Œéœ€è¦æ‰§è¡Œå‡ æ¬¡æ ‘çš„æœç´¢æ“ä½œï¼Œä¼šæ‰«æå¤šå°‘è¡Œï¼Ÿ ä¸‹é¢æ˜¯è¿™ä¸ªè¡¨çš„åˆå§‹åŒ–è¯­å¥ã€‚ mysql&gt; create table T ( ID int primary key, k int NOT NULL DEFAULT 0, s varchar(16) NOT NULL DEFAULT &#39;&#39;, index k(k)) engine&#x3D;InnoDB; insert into T values(100,1, &#39;aa&#39;),(200,2,&#39;bb&#39;),(300,3,&#39;cc&#39;),(500,5,&#39;ee&#39;),(600,6,&#39;ff&#39;),(700,7,&#39;gg&#39;); ç°åœ¨ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹è¿™æ¡ SQL æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œæµç¨‹ï¼š åœ¨ k ç´¢å¼•æ ‘ä¸Šæ‰¾åˆ° k&#x3D;3 çš„è®°å½•ï¼Œå–å¾— ID &#x3D; 300ï¼› å†åˆ° ID ç´¢å¼•æ ‘æŸ¥åˆ° ID&#x3D;300 å¯¹åº”çš„ R3ï¼› åœ¨ k ç´¢å¼•æ ‘å–ä¸‹ä¸€ä¸ªå€¼ k&#x3D;5ï¼Œå–å¾— ID&#x3D;500ï¼› å†å›åˆ° ID ç´¢å¼•æ ‘æŸ¥åˆ° ID&#x3D;500 å¯¹åº”çš„ R4ï¼› åœ¨ k ç´¢å¼•æ ‘å–ä¸‹ä¸€ä¸ªå€¼ k&#x3D;6ï¼Œä¸æ»¡è¶³æ¡ä»¶ï¼Œå¾ªç¯ç»“æŸã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå›åˆ°ä¸»é”®ç´¢å¼•æ ‘æœç´¢çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¸ºå›è¡¨ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæŸ¥è¯¢è¿‡ç¨‹è¯»äº† k ç´¢å¼•æ ‘çš„ 3 æ¡è®°å½•ï¼ˆæ­¥éª¤ 1ã€3 å’Œ 5ï¼‰ï¼Œå›è¡¨äº†ä¸¤æ¬¡ï¼ˆæ­¥éª¤ 2 å’Œ 4ï¼‰ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”±äºæŸ¥è¯¢ç»“æœæ‰€éœ€è¦çš„æ•°æ®åªåœ¨ä¸»é”®ç´¢å¼•ä¸Šæœ‰ï¼Œæ‰€ä»¥ä¸å¾—ä¸å›è¡¨ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰å¯èƒ½ç»è¿‡ç´¢å¼•ä¼˜åŒ–ï¼Œé¿å…å›è¡¨è¿‡ç¨‹å‘¢ï¼Ÿ è¦†ç›–ç´¢å¼•å¦‚æœæ‰§è¡Œçš„è¯­å¥æ˜¯ select ID from T where k between 3 and 5ï¼Œè¿™æ—¶åªéœ€è¦æŸ¥ ID çš„å€¼ï¼Œè€Œ ID çš„å€¼å·²ç»åœ¨ k ç´¢å¼•æ ‘ä¸Šäº†ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æä¾›æŸ¥è¯¢ç»“æœï¼Œä¸éœ€è¦å›è¡¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿™ä¸ªæŸ¥è¯¢é‡Œé¢ï¼Œç´¢å¼• k å·²ç»â€œè¦†ç›–äº†â€æˆ‘ä»¬çš„æŸ¥è¯¢éœ€æ±‚ï¼Œæˆ‘ä»¬ç§°ä¸ºè¦†ç›–ç´¢å¼•ã€‚ ç”±äºè¦†ç›–ç´¢å¼•å¯ä»¥å‡å°‘æ ‘çš„æœç´¢æ¬¡æ•°ï¼Œæ˜¾è‘—æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œæ‰€ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¼•æ“å†…éƒ¨ä½¿ç”¨è¦†ç›–ç´¢å¼•åœ¨ç´¢å¼• k ä¸Šå…¶å®è¯»äº†ä¸‰ä¸ªè®°å½•ï¼ŒR3~R5ï¼ˆå¯¹åº”çš„ç´¢å¼• k ä¸Šçš„è®°å½•é¡¹ï¼‰ï¼Œä½†æ˜¯å¯¹äº MySQL çš„ Server å±‚æ¥è¯´ï¼Œå®ƒå°±æ˜¯æ‰¾å¼•æ“æ‹¿åˆ°äº†ä¸¤æ¡è®°å½•ï¼Œå› æ­¤ MySQL è®¤ä¸ºæ‰«æè¡Œæ•°æ˜¯ 2ã€‚ å¤‡æ³¨ï¼šå…³äºå¦‚ä½•æŸ¥çœ‹æ‰«æè¡Œæ•°çš„é—®é¢˜ï¼Œæˆ‘å°†ä¼šåœ¨ç¬¬ 16 æ–‡ç« ã€Šå¦‚ä½•æ­£ç¡®åœ°æ˜¾ç¤ºéšæœºæ¶ˆæ¯ï¼Ÿã€‹ä¸­ï¼Œå’Œä½ è¯¦ç»†è®¨è®ºã€‚ åŸºäºä¸Šé¢è¦†ç›–ç´¢å¼•çš„è¯´æ˜ï¼Œæˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸ªé—®é¢˜ï¼šåœ¨ä¸€ä¸ªå¸‚æ°‘ä¿¡æ¯è¡¨ä¸Šï¼Œæ˜¯å¦æœ‰å¿…è¦å°†èº«ä»½è¯å·å’Œåå­—å»ºç«‹è”åˆç´¢å¼•ï¼Ÿ å‡è®¾è¿™ä¸ªå¸‚æ°‘è¡¨çš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š CREATE TABLE &#96;tuser&#96; ( &#96;id&#96; int(11) NOT NULL, &#96;id_card&#96; varchar(32) DEFAULT NULL, &#96;name&#96; varchar(32) DEFAULT NULL, &#96;age&#96; int(11) DEFAULT NULL, &#96;ismale&#96; tinyint(1) DEFAULT NULL, PRIMARY KEY (&#96;id&#96;), KEY &#96;id_card&#96; (&#96;id_card&#96;), KEY &#96;name_age&#96; (&#96;name&#96;,&#96;age&#96;) ) ENGINE&#x3D;InnoDB æˆ‘ä»¬çŸ¥é“ï¼Œèº«ä»½è¯å·æ˜¯å¸‚æ°‘çš„å”¯ä¸€æ ‡è¯†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæœ‰æ ¹æ®èº«ä»½è¯å·æŸ¥è¯¢å¸‚æ°‘ä¿¡æ¯çš„éœ€æ±‚ï¼Œæˆ‘ä»¬åªè¦åœ¨èº«ä»½è¯å·å­—æ®µä¸Šå»ºç«‹ç´¢å¼•å°±å¤Ÿäº†ã€‚è€Œå†å»ºç«‹ä¸€ä¸ªï¼ˆèº«ä»½è¯å·ã€å§“åï¼‰çš„è”åˆç´¢å¼•ï¼Œæ˜¯ä¸æ˜¯æµªè´¹ç©ºé—´ï¼Ÿ å¦‚æœç°åœ¨æœ‰ä¸€ä¸ªé«˜é¢‘è¯·æ±‚ï¼Œè¦æ ¹æ®å¸‚æ°‘çš„èº«ä»½è¯å·æŸ¥è¯¢ä»–çš„å§“åï¼Œè¿™ä¸ªè”åˆç´¢å¼•å°±æœ‰æ„ä¹‰äº†ã€‚å®ƒå¯ä»¥åœ¨è¿™ä¸ªé«˜é¢‘è¯·æ±‚ä¸Šç”¨åˆ°è¦†ç›–ç´¢å¼•ï¼Œä¸å†éœ€è¦å›è¡¨æŸ¥æ•´è¡Œè®°å½•ï¼Œå‡å°‘è¯­å¥çš„æ‰§è¡Œæ—¶é—´ã€‚ å½“ç„¶ï¼Œç´¢å¼•å­—æ®µçš„ç»´æŠ¤æ€»æ˜¯æœ‰ä»£ä»·çš„ã€‚å› æ­¤ï¼Œåœ¨å»ºç«‹å†—ä½™ç´¢å¼•æ¥æ”¯æŒè¦†ç›–ç´¢å¼•æ—¶å°±éœ€è¦æƒè¡¡è€ƒè™‘äº†ã€‚è¿™æ­£æ˜¯ä¸šåŠ¡ DBAï¼Œæˆ–è€…ç§°ä¸ºä¸šåŠ¡æ•°æ®æ¶æ„å¸ˆçš„å·¥ä½œã€‚ æœ€å·¦å‰ç¼€åŸåˆ™çœ‹åˆ°è¿™é‡Œä½ ä¸€å®šæœ‰ä¸€ä¸ªç–‘é—®ï¼Œå¦‚æœä¸ºæ¯ä¸€ç§æŸ¥è¯¢éƒ½è®¾è®¡ä¸€ä¸ªç´¢å¼•ï¼Œç´¢å¼•æ˜¯ä¸æ˜¯å¤ªå¤šäº†ã€‚å¦‚æœæˆ‘ç°åœ¨è¦æŒ‰ç…§å¸‚æ°‘çš„èº«ä»½è¯å·å»æŸ¥ä»–çš„å®¶åº­åœ°å€å‘¢ï¼Ÿè™½ç„¶è¿™ä¸ªæŸ¥è¯¢éœ€æ±‚åœ¨ä¸šåŠ¡ä¸­å‡ºç°çš„æ¦‚ç‡ä¸é«˜ï¼Œä½†æ€»ä¸èƒ½è®©å®ƒèµ°å…¨è¡¨æ‰«æå§ï¼Ÿåè¿‡æ¥è¯´ï¼Œå•ç‹¬ä¸ºä¸€ä¸ªä¸é¢‘ç¹çš„è¯·æ±‚åˆ›å»ºä¸€ä¸ªï¼ˆèº«ä»½è¯å·ï¼Œåœ°å€ï¼‰çš„ç´¢å¼•åˆæ„Ÿè§‰æœ‰ç‚¹æµªè´¹ã€‚åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ è¿™é‡Œï¼Œæˆ‘å…ˆå’Œä½ è¯´ç»“è®ºå§ã€‚B+ æ ‘è¿™ç§ç´¢å¼•ç»“æ„ï¼Œå¯ä»¥åˆ©ç”¨ç´¢å¼•çš„â€œæœ€å·¦å‰ç¼€â€ï¼Œæ¥å®šä½è®°å½•ã€‚ ä¸ºäº†ç›´è§‚åœ°è¯´æ˜è¿™ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬ç”¨ï¼ˆnameï¼Œageï¼‰è¿™ä¸ªè”åˆç´¢å¼•æ¥åˆ†æã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç´¢å¼•é¡¹æ˜¯æŒ‰ç…§ç´¢å¼•å®šä¹‰é‡Œé¢å‡ºç°çš„å­—æ®µé¡ºåºæ’åºçš„ã€‚ å½“ä½ çš„é€»è¾‘éœ€æ±‚æ˜¯æŸ¥åˆ°æ‰€æœ‰åå­—æ˜¯â€œå¼ ä¸‰â€çš„äººæ—¶ï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ° ID4ï¼Œç„¶åå‘åéå†å¾—åˆ°æ‰€æœ‰éœ€è¦çš„ç»“æœã€‚ å¦‚æœä½ è¦æŸ¥çš„æ˜¯æ‰€æœ‰åå­—ç¬¬ä¸€ä¸ªå­—æ˜¯â€œå¼ â€çš„äººï¼Œä½ çš„ SQL è¯­å¥çš„æ¡ä»¶æ˜¯â€where name like â€˜å¼  %â€™â€ã€‚è¿™æ—¶ï¼Œä½ ä¹Ÿèƒ½å¤Ÿç”¨ä¸Šè¿™ä¸ªç´¢å¼•ï¼ŒæŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„è®°å½•æ˜¯ ID3ï¼Œç„¶åå‘åéå†ï¼Œç›´åˆ°ä¸æ»¡è¶³æ¡ä»¶ä¸ºæ­¢ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œä¸åªæ˜¯ç´¢å¼•çš„å…¨éƒ¨å®šä¹‰ï¼Œåªè¦æ»¡è¶³æœ€å·¦å‰ç¼€ï¼Œå°±å¯ä»¥åˆ©ç”¨ç´¢å¼•æ¥åŠ é€Ÿæ£€ç´¢ã€‚è¿™ä¸ªæœ€å·¦å‰ç¼€å¯ä»¥æ˜¯è”åˆç´¢å¼•çš„æœ€å·¦ N ä¸ªå­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²ç´¢å¼•çš„æœ€å·¦ M ä¸ªå­—ç¬¦ã€‚ åŸºäºä¸Šé¢å¯¹æœ€å·¦å‰ç¼€ç´¢å¼•çš„è¯´æ˜ï¼Œæˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸ªé—®é¢˜ï¼šåœ¨å»ºç«‹è”åˆç´¢å¼•çš„æ—¶å€™ï¼Œå¦‚ä½•å®‰æ’ç´¢å¼•å†…çš„å­—æ®µé¡ºåºã€‚ è¿™é‡Œæˆ‘ä»¬çš„è¯„ä¼°æ ‡å‡†æ˜¯ï¼Œç´¢å¼•çš„å¤ç”¨èƒ½åŠ›ã€‚å› ä¸ºå¯ä»¥æ”¯æŒæœ€å·¦å‰ç¼€ï¼Œæ‰€ä»¥å½“å·²ç»æœ‰äº† (a,b) è¿™ä¸ªè”åˆç´¢å¼•åï¼Œä¸€èˆ¬å°±ä¸éœ€è¦å•ç‹¬åœ¨ a ä¸Šå»ºç«‹ç´¢å¼•äº†ã€‚å› æ­¤ï¼Œç¬¬ä¸€åŸåˆ™æ˜¯ï¼Œå¦‚æœé€šè¿‡è°ƒæ•´é¡ºåºï¼Œå¯ä»¥å°‘ç»´æŠ¤ä¸€ä¸ªç´¢å¼•ï¼Œé‚£ä¹ˆè¿™ä¸ªé¡ºåºå¾€å¾€å°±æ˜¯éœ€è¦ä¼˜å…ˆè€ƒè™‘é‡‡ç”¨çš„ã€‚ æ‰€ä»¥ç°åœ¨ä½ çŸ¥é“äº†ï¼Œè¿™æ®µå¼€å¤´çš„é—®é¢˜é‡Œï¼Œæˆ‘ä»¬è¦ä¸ºé«˜é¢‘è¯·æ±‚åˆ›å»º (èº«ä»½è¯å·ï¼Œå§“åï¼‰è¿™ä¸ªè”åˆç´¢å¼•ï¼Œå¹¶ç”¨è¿™ä¸ªç´¢å¼•æ”¯æŒâ€œæ ¹æ®èº«ä»½è¯å·æŸ¥è¯¢åœ°å€â€çš„éœ€æ±‚ã€‚ é‚£ä¹ˆï¼Œå¦‚æœæ—¢æœ‰è”åˆæŸ¥è¯¢ï¼Œåˆæœ‰åŸºäº aã€b å„è‡ªçš„æŸ¥è¯¢å‘¢ï¼ŸæŸ¥è¯¢æ¡ä»¶é‡Œé¢åªæœ‰ b çš„è¯­å¥ï¼Œæ˜¯æ— æ³•ä½¿ç”¨ (a,b) è¿™ä¸ªè”åˆç´¢å¼•çš„ï¼Œè¿™æ—¶å€™ä½ ä¸å¾—ä¸ç»´æŠ¤å¦å¤–ä¸€ä¸ªç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ éœ€è¦åŒæ—¶ç»´æŠ¤ (a,b)ã€(b) è¿™ä¸¤ä¸ªç´¢å¼•ã€‚ è¿™æ—¶å€™ï¼Œæˆ‘ä»¬è¦è€ƒè™‘çš„åŸåˆ™å°±æ˜¯ç©ºé—´äº†ã€‚æ¯”å¦‚ä¸Šé¢è¿™ä¸ªå¸‚æ°‘è¡¨çš„æƒ…å†µï¼Œname å­—æ®µæ˜¯æ¯” age å­—æ®µå¤§çš„ ï¼Œé‚£æˆ‘å°±å»ºè®®ä½ åˆ›å»ºä¸€ä¸ªï¼ˆname,age) çš„è”åˆç´¢å¼•å’Œä¸€ä¸ª (age) çš„å•å­—æ®µç´¢å¼•ã€‚ ç´¢å¼•ä¸‹æ¨ä¸Šä¸€æ®µæˆ‘ä»¬è¯´åˆ°æ»¡è¶³æœ€å·¦å‰ç¼€åŸåˆ™çš„æ—¶å€™ï¼Œæœ€å·¦å‰ç¼€å¯ä»¥ç”¨äºåœ¨ç´¢å¼•ä¸­å®šä½è®°å½•ã€‚è¿™æ—¶ï¼Œä½ å¯èƒ½è¦é—®ï¼Œé‚£äº›ä¸ç¬¦åˆæœ€å·¦å‰ç¼€çš„éƒ¨åˆ†ï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ æˆ‘ä»¬è¿˜æ˜¯ä»¥å¸‚æ°‘è¡¨çš„è”åˆç´¢å¼•ï¼ˆname, ageï¼‰ä¸ºä¾‹ã€‚å¦‚æœç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼šæ£€ç´¢å‡ºè¡¨ä¸­â€œåå­—ç¬¬ä¸€ä¸ªå­—æ˜¯å¼ ï¼Œè€Œä¸”å¹´é¾„æ˜¯ 10 å²çš„æ‰€æœ‰ç”·å­©â€ã€‚é‚£ä¹ˆï¼ŒSQL è¯­å¥æ˜¯è¿™ä¹ˆå†™çš„ï¼š mysql&gt; select * from tuser where name like &#39;å¼  %&#39; and age&#x3D;10 and ismale&#x3D;1; î˜“å¤åˆ¶ä»£ç  ä½ å·²ç»çŸ¥é“äº†å‰ç¼€ç´¢å¼•è§„åˆ™ï¼Œæ‰€ä»¥è¿™ä¸ªè¯­å¥åœ¨æœç´¢ç´¢å¼•æ ‘çš„æ—¶å€™ï¼Œåªèƒ½ç”¨ â€œå¼ â€ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½• ID3ã€‚å½“ç„¶ï¼Œè¿™è¿˜ä¸é”™ï¼Œæ€»æ¯”å…¨è¡¨æ‰«æè¦å¥½ã€‚ ç„¶åå‘¢ï¼Ÿ å½“ç„¶æ˜¯åˆ¤æ–­å…¶ä»–æ¡ä»¶æ˜¯å¦æ»¡è¶³ã€‚ åœ¨ MySQL 5.6 ä¹‹å‰ï¼Œåªèƒ½ä» ID3 å¼€å§‹ä¸€ä¸ªä¸ªå›è¡¨ã€‚åˆ°ä¸»é”®ç´¢å¼•ä¸Šæ‰¾å‡ºæ•°æ®è¡Œï¼Œå†å¯¹æ¯”å­—æ®µå€¼ã€‚ è€Œ MySQL 5.6 å¼•å…¥çš„ç´¢å¼•ä¸‹æ¨ä¼˜åŒ–ï¼ˆindex condition pushdown)ï¼Œ å¯ä»¥åœ¨ç´¢å¼•éå†è¿‡ç¨‹ä¸­ï¼Œå¯¹ç´¢å¼•ä¸­åŒ…å«çš„å­—æ®µå…ˆåšåˆ¤æ–­ï¼Œç›´æ¥è¿‡æ»¤æ‰ä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå‡å°‘å›è¡¨æ¬¡æ•°ã€‚ å›¾ 3æ— ç´¢å¼•ä¸‹æ¨æ‰§è¡Œæµç¨‹ å’Œå›¾ 4ç´¢å¼•ä¸‹æ¨æ‰§è¡Œæµç¨‹ï¼Œæ˜¯è¿™ä¸¤ä¸ªè¿‡ç¨‹çš„æ‰§è¡Œæµç¨‹å›¾ã€‚ åœ¨å›¾ 3 å’Œ 4 è¿™ä¸¤ä¸ªå›¾é‡Œé¢ï¼Œæ¯ä¸€ä¸ªè™šçº¿ç®­å¤´è¡¨ç¤ºå›è¡¨ä¸€æ¬¡ã€‚ å›¾ 3 ä¸­ï¼Œåœ¨ (name,age) ç´¢å¼•é‡Œé¢æˆ‘ç‰¹æ„å»æ‰äº† age çš„å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹ InnoDB å¹¶ä¸ä¼šå»çœ‹ age çš„å€¼ï¼Œåªæ˜¯æŒ‰é¡ºåºæŠŠâ€œname ç¬¬ä¸€ä¸ªå­—æ˜¯â€™å¼ â€™â€çš„è®°å½•ä¸€æ¡æ¡å–å‡ºæ¥å›è¡¨ã€‚å› æ­¤ï¼Œéœ€è¦å›è¡¨ 4 æ¬¡ã€‚ å›¾ 4 è·Ÿå›¾ 3 çš„åŒºåˆ«æ˜¯ï¼ŒInnoDB åœ¨ (name,age) ç´¢å¼•å†…éƒ¨å°±åˆ¤æ–­äº† age æ˜¯å¦ç­‰äº 10ï¼Œå¯¹äºä¸ç­‰äº 10 çš„è®°å½•ï¼Œç›´æ¥åˆ¤æ–­å¹¶è·³è¿‡ã€‚åœ¨æˆ‘ä»¬çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œåªéœ€è¦å¯¹ ID4ã€ID5 è¿™ä¸¤æ¡è®°å½•å›è¡¨å–æ•°æ®åˆ¤æ–­ï¼Œå°±åªéœ€è¦å›è¡¨ 2 æ¬¡ã€‚ å°ç»“ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å’Œä½ ç»§ç»­è®¨è®ºäº†æ•°æ®åº“ç´¢å¼•çš„æ¦‚å¿µï¼ŒåŒ…æ‹¬äº†è¦†ç›–ç´¢å¼•ã€å‰ç¼€ç´¢å¼•ã€ç´¢å¼•ä¸‹æ¨ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ»¡è¶³è¯­å¥éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œ å°½é‡å°‘åœ°è®¿é—®èµ„æºæ˜¯æ•°æ®åº“è®¾è®¡çš„é‡è¦åŸåˆ™ä¹‹ä¸€ã€‚æˆ‘ä»¬åœ¨ä½¿ç”¨æ•°æ®åº“çš„æ—¶å€™ï¼Œå°¤å…¶æ˜¯åœ¨è®¾è®¡è¡¨ç»“æ„æ—¶ï¼Œä¹Ÿè¦ä»¥å‡å°‘èµ„æºæ¶ˆè€—ä½œä¸ºç›®æ ‡ã€‚ è¯¾åé¢˜å®é™…ä¸Šä¸»é”®ç´¢å¼•ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨å¤šä¸ªå­—æ®µçš„ã€‚DBA å°å•åœ¨å…¥èŒæ–°å…¬å¸çš„æ—¶å€™ï¼Œå°±å‘ç°è‡ªå·±æ¥æ‰‹ç»´æŠ¤çš„åº“é‡Œé¢ï¼Œæœ‰è¿™ä¹ˆä¸€ä¸ªè¡¨ï¼Œè¡¨ç»“æ„å®šä¹‰ç±»ä¼¼è¿™æ ·çš„ï¼š CREATE TABLE &#96;geek&#96; ( &#96;a&#96; int(11) NOT NULL, &#96;b&#96; int(11) NOT NULL, &#96;c&#96; int(11) NOT NULL, &#96;d&#96; int(11) NOT NULL, PRIMARY KEY (&#96;a&#96;,&#96;b&#96;), KEY &#96;c&#96; (&#96;c&#96;), KEY &#96;ca&#96; (&#96;c&#96;,&#96;a&#96;), KEY &#96;cb&#96; (&#96;c&#96;,&#96;b&#96;) ) ENGINE&#x3D;InnoDB; å…¬å¸çš„åŒäº‹å‘Šè¯‰ä»–è¯´ï¼Œç”±äºå†å²åŸå› ï¼Œè¿™ä¸ªè¡¨éœ€è¦ aã€b åšè”åˆä¸»é”®ï¼Œè¿™ä¸ªå°å•ç†è§£äº†ã€‚ ä½†æ˜¯ï¼Œå­¦è¿‡æœ¬ç« å†…å®¹çš„å°å•åˆçº³é—·äº†ï¼Œæ—¢ç„¶ä¸»é”®åŒ…å«äº† aã€b è¿™ä¸¤ä¸ªå­—æ®µï¼Œé‚£æ„å‘³ç€å•ç‹¬åœ¨å­—æ®µ c ä¸Šåˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œå°±å·²ç»åŒ…å«äº†ä¸‰ä¸ªå­—æ®µäº†å‘€ï¼Œä¸ºä»€ä¹ˆè¦åˆ›å»ºâ€œcaâ€â€œcbâ€è¿™ä¸¤ä¸ªç´¢å¼•ï¼Ÿ åŒäº‹å‘Šè¯‰ä»–ï¼Œæ˜¯å› ä¸ºä»–ä»¬çš„ä¸šåŠ¡é‡Œé¢æœ‰è¿™æ ·çš„ä¸¤ç§è¯­å¥ï¼š select * from geek where c&#x3D;N order by a limit 1; select * from geek where c&#x3D;N order by b limit 1; æˆ‘ç»™ä½ çš„é—®é¢˜æ˜¯ï¼Œè¿™ä½åŒäº‹çš„è§£é‡Šå¯¹å—ï¼Œä¸ºäº†è¿™ä¸¤ä¸ªæŸ¥è¯¢æ¨¡å¼ï¼Œè¿™ä¸¤ä¸ªç´¢å¼•æ˜¯å¦éƒ½æ˜¯å¿…é¡»çš„ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Ÿ è¡¨è®°å½•â€“aâ€“|â€“bâ€“|â€“câ€“|â€“dâ€“1 2 3 d1 3 2 d1 4 3 d2 1 3 d2 2 2 d2 3 4 dä¸»é”® aï¼Œb çš„èšç°‡ç´¢å¼•ç»„ç»‡é¡ºåºç›¸å½“äº order by a,b ï¼Œä¹Ÿå°±æ˜¯å…ˆæŒ‰ a æ’åºï¼Œå†æŒ‰ b æ’åºï¼Œc æ— åºã€‚ ç´¢å¼• ca çš„ç»„ç»‡æ˜¯å…ˆæŒ‰ c æ’åºï¼Œå†æŒ‰ a æ’åºï¼ŒåŒæ—¶è®°å½•ä¸»é”®â€“câ€“|â€“aâ€“|â€“ä¸»é”®éƒ¨åˆ†bâ€“ ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œä¸æ˜¯ abï¼Œè€Œæ˜¯åªæœ‰ bï¼‰2 1 32 2 23 1 23 1 43 2 14 2 3è¿™ä¸ªè·Ÿç´¢å¼• c çš„æ•°æ®æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ ç´¢å¼• cb çš„ç»„ç»‡æ˜¯å…ˆæŒ‰ c æ’åºï¼Œåœ¨æŒ‰ b æ’åºï¼ŒåŒæ—¶è®°å½•ä¸»é”®â€“câ€“|â€“bâ€“|â€“ä¸»é”®éƒ¨åˆ†aâ€“ ï¼ˆåŒä¸Šï¼‰2 2 22 3 13 1 23 2 13 4 14 3 2 æ‰€ä»¥ï¼Œç»“è®ºæ˜¯ ca å¯ä»¥å»æ‰ï¼Œcb éœ€è¦ä¿ç•™ã€‚","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://blog.ehzyil.xyz/tags/MySQL/"}],"author":"ehzyil"},{"title":"Javaçº¿ç¨‹æ± ","slug":"2023/çº¿ç¨‹æ± ","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/26/2023/çº¿ç¨‹æ± /","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/%E7%BA%BF%E7%A8%8B%E6%B1%A0/","excerpt":"","text":"æ„é€ æ–¹æ³•æˆ‘ä»¬åœ¨æ„é€ çº¿ç¨‹æ± çš„æ—¶å€™ï¼Œä½¿ç”¨äº†ThreadPoolExecutorçš„æ„é€ æ–¹æ³•ï¼š public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable> workQueue) &#123; this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, Executors.defaultThreadFactory(), defaultHandler); &#125; å…ˆæ¥çœ‹çœ‹å‡ ä¸ªå‚æ•°çš„å«ä¹‰ï¼š corePoolSize: æ ¸å¿ƒçº¿ç¨‹æ•° maximumPoolSize:å…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°ï¼ˆæ ¸å¿ƒçº¿ç¨‹æ•°+éæ ¸å¿ƒçº¿ç¨‹æ•°ï¼‰ workQueue:çº¿ç¨‹æ± ä»»åŠ¡é˜Ÿåˆ— ç”¨æ¥ä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ï¼Œå¸¸è§é˜»å¡é˜Ÿåˆ—æœ‰ ArrayBlockingQueueï¼šä¸€ä¸ªåŸºäºæ•°ç»„ç»“æ„çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ— LinkedBlockingQueueï¼šåŸºäºé“¾è¡¨ç»“æ„çš„é˜»å¡é˜Ÿåˆ— SynchronousQueueï¼šä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ— PriorityBlockingQueueï¼šå…·æœ‰ä¼˜å…ˆçº§çš„æ— é™é˜»å¡é˜Ÿåˆ— handler: çº¿ç¨‹æ± é¥±å’Œæ‹’ç»ç­–ç•¥ JDKçº¿ç¨‹æ± æ¡†æ¶æä¾›äº†å››ç§ç­–ç•¥ï¼š ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„åº”ç”¨åœºæ™¯ï¼Œå®ç°RejectedExecutionHandleræ¥å£æ¥è‡ªå®šä¹‰ç­–ç•¥ã€‚ AbortPolicyï¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œé»˜è®¤ç­–ç•¥ã€‚ CallerRunsPolicyï¼šç”¨è°ƒç”¨è€…æ‰€åœ¨çº¿ç¨‹æ¥è¿è¡Œä»»åŠ¡ã€‚ DiscardOldestPolicyï¼šä¸¢å¼ƒä»»åŠ¡é˜Ÿåˆ—é‡Œæœ€è€çš„ä»»åŠ¡ DiscardPolicy:ä¸å¤„ç†ï¼Œä¸¢å¼ƒå½“å‰ä»»åŠ¡ ä¸Šé¢å››ä¸ªæ˜¯å’Œçº¿ç¨‹æ± å·¥ä½œæµç¨‹æ¯æ¯ç›¸å…³çš„å‚æ•°ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å‰©ä¸‹ä¸‰ä¸ªå‚æ•°ã€‚ keepAliveTime:éæ ¸å¿ƒçº¿ç¨‹é—²ç½®ä¸‹æ¥æœ€å¤šå­˜æ´»çš„æ—¶é—´ unitï¼šçº¿ç¨‹æ± ä¸­éæ ¸å¿ƒçº¿ç¨‹ä¿æŒå­˜æ´»çš„æ—¶é—´ threadFactory:åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ—¶ä½¿ç”¨çš„å·¥å‚ï¼Œå¯ä»¥ç”¨æ¥è®¾å®šçº¿ç¨‹åç­‰(ä¸æŒ‡å®šä½¿ç”¨é»˜è®¤çº¿ç¨‹å·¥å‚) çº¿ç¨‹æ± å·¥ä½œæµç¨‹ å‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡çš„æ—¶å€™ï¼š å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹å°‘äºæ ¸å¿ƒçº¿ç¨‹æ•°corePoolSizeï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ å¦‚æœè¿è¡Œçš„çº¿ç¨‹ç­‰äºæˆ–å¤šäºæ ¸å¿ƒçº¿ç¨‹æ•°corePoolSizeï¼Œåˆ™å°†ä»»åŠ¡åŠ å…¥ä»»åŠ¡é˜Ÿåˆ—workQueue å¦‚æœä»»åŠ¡é˜Ÿåˆ—workQueueå·²æ»¡ï¼Œåˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ å¦‚æœåˆ›å»ºæ–°çº¿ç¨‹ä½¿å½“å‰æ€»çº¿ç¨‹æ•°è¶…è¿‡æœ€å¤§çº¿ç¨‹æ•°maximumPoolSizeï¼Œä»»åŠ¡å°†è¢«æ‹’ç»ï¼Œçº¿ç¨‹æ± æ‹’ç»ç­–ç•¥handleræ‰§è¡Œ çº¿ç¨‹æ± å·¥ä½œæºç åˆ†ææäº¤çº¿ç¨‹ï¼ˆexecuteï¼‰çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡çš„æ–¹æ³•å¦‚ä¸‹ï¼š public void execute(Runnable command) &#123; if (command == null) throw new NullPointerException(); //è·å–å½“å‰çº¿ç¨‹æ± çš„çŠ¶æ€+çº¿ç¨‹ä¸ªæ•°å˜é‡çš„ç»„åˆå€¼ int c = ctl.get(); //1.å¦‚æœæ­£åœ¨è¿è¡Œçº¿ç¨‹æ•°å°‘äºæ ¸å¿ƒçº¿ç¨‹æ•° if (workerCountOf(c) &lt; corePoolSize) &#123; //å¼€å¯æ–°çº¿ç¨‹è¿è¡Œ if (addWorker(command, true)) return; c = ctl.get(); &#125; //2. åˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œæ˜¯åˆ™æ·»åŠ ä»»åŠ¡åˆ°é˜»å¡é˜Ÿåˆ— if (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123; //äºŒæ¬¡æ£€æŸ¥ int recheck = ctl.get(); //å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸æ˜¯è¿è¡ŒçŠ¶æ€ï¼Œåˆ™ä»é˜Ÿåˆ—ä¸­ç§»é™¤ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œæ‹’ç»ç­–ç•¥ if (! isRunning(recheck) &amp;&amp; remove(command)) reject(command); //å¦‚è‹¥å½“å‰çº¿ç¨‹æ± ä¸ºç©ºï¼Œåˆ™æ·»åŠ ä¸€ä¸ªæ–°çº¿ç¨‹ else if (workerCountOf(recheck) == 0) addWorker(null, false); &#125; //æœ€åå°è¯•æ·»åŠ çº¿ç¨‹ï¼Œå¦‚è‹¥æ·»åŠ å¤±è´¥ï¼Œæ‰§è¡Œæ‹’ç»ç­–ç•¥ else if (!addWorker(command, false)) reject(command); &#125; æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹execute()çš„è¯¦ç»†æµç¨‹å›¾ï¼š æ–°å¢çº¿ç¨‹ (addWorker)åœ¨executeæ–¹æ³•ä»£ç é‡Œï¼Œæœ‰ä¸ªå…³é”®çš„æ–¹æ³•private boolean addWorker(Runnable firstTask, boolean core)ï¼Œè¿™ä¸ªæ–¹æ³•ä¸»è¦å®Œæˆä¸¤éƒ¨åˆ†å·¥ä½œï¼šå¢åŠ çº¿ç¨‹æ•°ã€æ·»åŠ ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€éƒ¨åˆ†å¢åŠ çº¿ç¨‹æ•°ï¼š retry: for (;;) &#123; int c &#x3D; ctl.get(); int rs &#x3D; runStateOf(c); &#x2F;&#x2F; 1.æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦åªåœ¨å¿…è¦æ—¶ä¸ºç©ºï¼ˆåˆ¤æ–­çº¿ç¨‹çŠ¶æ€ï¼Œä¸”é˜Ÿåˆ—ä¸ä¸ºç©ºï¼‰ if (rs &gt;&#x3D; SHUTDOWN &amp;&amp; ! (rs &#x3D;&#x3D; SHUTDOWN &amp;&amp; firstTask &#x3D;&#x3D; null &amp;&amp; ! workQueue.isEmpty())) return false; &#x2F;&#x2F;2.å¾ªç¯CASå¢åŠ çº¿ç¨‹ä¸ªæ•° for (;;) &#123; int wc &#x3D; workerCountOf(c); &#x2F;&#x2F;2.1 å¦‚æœçº¿ç¨‹ä¸ªæ•°è¶…é™åˆ™è¿”å› false if (wc &gt;&#x3D; CAPACITY || wc &gt;&#x3D; (core ? corePoolSize : maximumPoolSize)) return false; &#x2F;&#x2F;2.2 CASæ–¹å¼å¢åŠ çº¿ç¨‹ä¸ªæ•°ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹æˆåŠŸï¼ŒæˆåŠŸè·³å‡ºå¾ªç¯ if (compareAndIncrementWorkerCount(c)) break retry; &#x2F;&#x2F;2.3 CASå¤±è´¥ï¼Œçœ‹çº¿ç¨‹æ± çŠ¶æ€æ˜¯å¦å˜åŒ–ï¼Œå˜åŒ–åˆ™è·³åˆ°å¤–å±‚ï¼Œå°è¯•é‡æ–°è·å–çº¿ç¨‹æ± çŠ¶æ€ï¼Œå¦åˆ™å†…å±‚é‡æ–°CAS c &#x3D; ctl.get(); &#x2F;&#x2F; Re-read ctl if (runStateOf(c) !&#x3D; rs) continue retry; &#125; &#125; &#x2F;&#x2F;3. åˆ°è¿™è¯´æ˜CASæˆåŠŸäº† boolean workerStarted &#x3D; false; boolean workerAdded &#x3D; false; æ¥ç€æ¥çœ‹ç¬¬äºŒéƒ¨åˆ†æ·»åŠ ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ Worker w &#x3D; null; try &#123; &#x2F;&#x2F;4.åˆ›å»ºworker w &#x3D; new Worker(firstTask); final Thread t &#x3D; w.thread; if (t !&#x3D; null) &#123; &#x2F;&#x2F;4.1ã€åŠ ç‹¬å é” ï¼Œä¸ºäº†å®ç°workersåŒæ­¥ï¼Œå› ä¸ºå¯èƒ½å¤šä¸ªçº¿ç¨‹è°ƒç”¨äº†çº¿ç¨‹æ± çš„excuteæ–¹æ³• final ReentrantLock mainLock &#x3D; this.mainLock; mainLock.lock(); try &#123; &#x2F;&#x2F;4.2ã€é‡æ–°æ£€æŸ¥çº¿ç¨‹æ± çŠ¶æ€ï¼Œä»¥é¿å…åœ¨è·å–é”å‰è°ƒç”¨äº†shutdownæ¥å£ int rs &#x3D; runStateOf(ctl.get()); if (rs &lt; SHUTDOWN || (rs &#x3D;&#x3D; SHUTDOWN &amp;&amp; firstTask &#x3D;&#x3D; null)) &#123; if (t.isAlive()) &#x2F;&#x2F; precheck that t is startable throw new IllegalThreadStateException(); &#x2F;&#x2F;4.3æ·»åŠ ä»»åŠ¡ workers.add(w); int s &#x3D; workers.size(); if (s &gt; largestPoolSize) largestPoolSize &#x3D; s; workerAdded &#x3D; true; &#125; &#125; finally &#123; mainLock.unlock(); &#125; &#x2F;&#x2F;4.4ã€æ·»åŠ æˆåŠŸä¹‹åå¯åŠ¨ä»»åŠ¡ if (workerAdded) &#123; t.start(); workerStarted &#x3D; true; &#125; &#125; &#125; finally &#123; if (! workerStarted) addWorkerFailed(w); &#125; return workerStarted; æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ•´ä½“çš„æµç¨‹ï¼š æ‰§è¡Œçº¿ç¨‹(runWorker)ç”¨æˆ·çº¿ç¨‹æäº¤åˆ°çº¿ç¨‹æ± ä¹‹åï¼Œç”±Workeræ‰§è¡Œï¼ŒWorkeræ˜¯çº¿ç¨‹æ± å†…éƒ¨ä¸€ä¸ªç»§æ‰¿AQSã€å®ç°Runnableæ¥å£çš„è‡ªå®šä¹‰ç±»ï¼Œå®ƒæ˜¯å…·ä½“æ‰¿è½½ä»»åŠ¡çš„å¯¹è±¡ã€‚ å…ˆçœ‹ä¸€ä¸‹å®ƒçš„æ„é€ æ–¹æ³•ï¼š Worker(Runnable firstTask) &#123; setState(-1); &#x2F;&#x2F; åœ¨è°ƒç”¨runWorkerä¹‹å‰ç¦æ­¢ä¸­æ–­ this.firstTask &#x3D; firstTask; this.thread &#x3D; getThreadFactory().newThread(this); &#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ &#125; åœ¨æ„é€ å‡½æ•°å†… é¦–å…ˆè®¾ç½® state&#x3D;-1,ç°äº†ç®€å•ä¸å¯é‡å…¥ç‹¬å é”ï¼Œstate&#x3D;0è¡¨ç¤ºé”æœªè¢«è·å–çŠ¶æ€ï¼Œstate&#x3D;1è¡¨ç¤ºé”å·²è¢«è·å–çŠ¶æ€ï¼Œè®¾ç½®çŠ¶æ€å¤§å°ä¸º-1ï¼Œæ˜¯ä¸ºäº†é¿å…çº¿ç¨‹åœ¨è¿è¡ŒrunWorker()æ–¹æ³•ä¹‹å‰è¢«ä¸­æ–­ firstTaskè®°å½•è¯¥å·¥ä½œçº¿ç¨‹çš„ç¬¬ä¸€ä¸ªä»»åŠ¡ threadæ˜¯å…·ä½“æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ å®ƒçš„runæ–¹æ³•ç›´æ¥è°ƒç”¨runWorkerï¼ŒçœŸæ­£åœ°æ‰§è¡Œçº¿ç¨‹å°±æ˜¯åœ¨æˆ‘ä»¬çš„runWorker æ–¹æ³•é‡Œï¼š final void runWorker(Worker w) &#123; Thread wt &#x3D; Thread.currentThread(); Runnable task &#x3D; w.firstTask; w.firstTask &#x3D; null; w.unlock(); &#x2F;&#x2F; å…è®¸ä¸­æ–­ boolean completedAbruptly &#x3D; true; try &#123; &#x2F;&#x2F;è·å–å½“å‰ä»»åŠ¡ï¼Œä»é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ while (task !&#x3D; null || (task &#x3D; getTask()) !&#x3D; null) &#123; w.lock(); â€¦â€¦â€¦â€¦ try &#123; &#x2F;&#x2F;æ‰§è¡Œä»»åŠ¡å‰åšä¸€äº›ç±»ä¼¼ç»Ÿè®¡ä¹‹ç±»çš„äº‹æƒ… beforeExecute(wt, task); Throwable thrown &#x3D; null; try &#123; &#x2F;&#x2F;æ‰§è¡Œä»»åŠ¡ task.run(); &#125; catch (RuntimeException x) &#123; thrown &#x3D; x; throw x; &#125; catch (Error x) &#123; thrown &#x3D; x; throw x; &#125; catch (Throwable x) &#123; thrown &#x3D; x; throw new Error(x); &#125; finally &#123; &#x2F;&#x2F; æ‰§è¡Œä»»åŠ¡å®Œæ¯•åå¹²ä¸€äº›äº›äº‹æƒ… afterExecute(task, thrown); &#125; &#125; finally &#123; task &#x3D; null; &#x2F;&#x2F; ç»Ÿè®¡å½“å‰Worker å®Œæˆäº†å¤šå°‘ä¸ªä»»åŠ¡ w.completedTasks++; w.unlock(); &#125; &#125; completedAbruptly &#x3D; false; &#125; finally &#123; &#x2F;&#x2F;æ‰§è¡Œæ¸…ç†å·¥ä½œ processWorkerExit(w, completedAbruptly); &#125; &#125; ä»£ç çœ‹ç€å¤šï¼Œå…¶å®ç æ‰æè”“ï¼Œæœ€æ ¸å¿ƒçš„ç‚¹å°±æ˜¯task.run()è®©çº¿ç¨‹è·‘èµ·æ¥ã€‚ è·å–ä»»åŠ¡(getTask)æˆ‘ä»¬åœ¨ä¸Šé¢çš„æ‰§è¡Œä»»åŠ¡runWorkeré‡Œçœ‹åˆ°ï¼Œè¿™ä¹ˆä¸€å¥while (task != null || (task = getTask()) != null),æ‰§è¡Œçš„ä»»åŠ¡æ˜¯è¦ä¹ˆå½“å‰ä¼ å…¥çš„firstTaskï¼Œæˆ–è€…è¿˜å¯ä»¥é€šè¿‡getTask()è·å–ï¼Œè¿™ä¸ªgetTaskçš„æ ¸å¿ƒç›®çš„å°±æ˜¯ä»é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ã€‚ private Runnable getTask() &#123; &#x2F;&#x2F;poll()æ–¹æ³•æ˜¯å¦è¶…æ—¶ boolean timedOut &#x3D; false; &#x2F;&#x2F;å¾ªç¯è·å– for (;;) &#123; int c &#x3D; ctl.get(); int rs &#x3D; runStateOf(c); &#x2F;&#x2F; 1.çº¿ç¨‹æ± æœªç»ˆæ­¢ï¼Œä¸”é˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›null if (rs &gt;&#x3D; SHUTDOWN &amp;&amp; (rs &gt;&#x3D; STOP || workQueue.isEmpty())) &#123; decrementWorkerCount(); return null; &#125; &#x2F;&#x2F;å·¥ä½œçº¿ç¨‹æ•° int wc &#x3D; workerCountOf(c); boolean timed &#x3D; allowCoreThreadTimeOut || wc &gt; corePoolSize; &#x2F;&#x2F;2.åˆ¤æ–­å·¥ä½œçº¿ç¨‹æ•°æ˜¯å¦è¶…è¿‡æœ€å¤§çº¿ç¨‹æ•° &amp;&amp; è¶…æ—¶åˆ¤æ–­ &amp;&amp; å·¥ä½œçº¿ç¨‹æ•°å¤§äº0æˆ–é˜Ÿåˆ—ä¸ºç©º if ((wc &gt; maximumPoolSize || (timed &amp;&amp; timedOut)) &amp;&amp; (wc &gt; 1 || workQueue.isEmpty())) &#123; if (compareAndDecrementWorkerCount(c)) return null; continue; &#125; try &#123; &#x2F;&#x2F;ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–çº¿ç¨‹ Runnable r &#x3D; timed ? workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS) : workQueue.take(); &#x2F;&#x2F;è·å–æˆåŠŸ if (r !&#x3D; null) return r; timedOut &#x3D; true; &#125; catch (InterruptedException retry) &#123; timedOut &#x3D; false; &#125; &#125; &#125; æ€»ç»“ä¸€ä¸‹ï¼ŒWorkeræ‰§è¡Œä»»åŠ¡çš„æ¨¡å‹å¦‚ä¸‹ï¼š çº¿ç¨‹æ± çš„å…³é—­çº¿ç¨‹æ± æä¾›äº† shutdown å’Œ shutdownNow ä¸¤ä¸ªâ½…æ³•æ¥å…³é—­çº¿ç¨‹æ± ã€‚ shutdown() /** * å¯åŠ¨â¼€æ¬¡é¡ºåºå…³é—­ï¼Œåœ¨è¿™æ¬¡å…³é—­ä¸­ï¼Œæ‰§â¾å™¨ä¸å†æ¥å—æ–°ä»»åŠ¡ï¼Œä½†ä¼šç»§ç»­å¤„ç†é˜Ÿåˆ—ä¸­çš„å·²å­˜åœ¨ä»»åŠ¡ã€‚ * å½“æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆåï¼Œçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä¼šé€æ¸é€€å‡ºã€‚ */ public void shutdown() &#123; final ReentrantLock mainLock = this.mainLock; // ThreadPoolExecutorçš„ä¸»é” mainLock.lock(); // åŠ é”ä»¥ç¡®ä¿ç‹¬å è®¿é—® try &#123; checkShutdownAccess(); // æ£€æŸ¥æ˜¯å¦æœ‰å…³é—­çš„æƒé™ advanceRunState(SHUTDOWN); // å°†æ‰§â¾å™¨çš„çŠ¶æ€æ›´æ–°ä¸ºSHUTDOWN interruptIdleWorkers(); // ä¸­æ–­æ‰€æœ‰é—²ç½®çš„â¼¯ä½œçº¿ç¨‹ onShutdown(); // ScheduledThreadPoolExecutorä¸­çš„æŒ‚é’©â½…æ³•ï¼Œå¯ä¾›â¼¦ç±»á¯¿å†™ä»¥è¿›â¾é¢å¤–æ“ä½œ &#125; finally &#123; mainLock.unlock(); // â½†è®ºtryå—å¦‚ä½•é€€å‡ºéƒ½è¦é‡Šæ”¾é” &#125; tryTerminate(); // å¦‚æœæ¡ä»¶å…è®¸ï¼Œå°è¯•ç»ˆâ½Œæ‰§â¾å™¨ &#125; å°±æ˜¯å°†çº¿ç¨‹æ± çš„çŠ¶æ€ä¿®æ”¹ä¸º SHUTDOWNï¼Œç„¶åå°è¯•æ‰“æ–­ç©ºé—²çš„çº¿ç¨‹ï¼ˆå¦‚ä½•åˆ¤æ–­ç©ºé—²ï¼Œä¸Šâ¾¯åœ¨è¯´ Worker ç»§æ‰¿ AQS çš„æ—¶å€™è¯´è¿‡ï¼‰ï¼Œä¹Ÿå°±æ˜¯åœ¨é˜»å¡ç­‰å¾…ä»»åŠ¡çš„çº¿ç¨‹ shutdownNow () &#x2F;** * å°è¯•åœâ½Œæ‰€æœ‰æ­£åœ¨æ‰§â¾çš„ä»»åŠ¡ï¼Œåœâ½Œå¤„ç†ç­‰å¾…çš„ä»»åŠ¡ï¼Œ * å¹¶è¿”å›ç­‰å¾…å¤„ç†çš„ä»»åŠ¡åˆ—è¡¨ã€‚ * * @return ä»æœªå¼€å§‹æ‰§â¾çš„ä»»åŠ¡åˆ—è¡¨ *&#x2F; public List&lt;Runnable&gt; shutdownNow() &#123; List&lt;Runnable&gt; tasks; &#x2F;&#x2F; â½¤äºå­˜å‚¨æœªæ‰§â¾çš„ä»»åŠ¡çš„åˆ—è¡¨ final ReentrantLock mainLock &#x3D; this.mainLock; &#x2F;&#x2F; ThreadPoolExecutorçš„ä¸»é” mainLock.lock(); &#x2F;&#x2F; åŠ é”ä»¥ç¡®ä¿ç‹¬å è®¿é—® try &#123; checkShutdownAccess(); &#x2F;&#x2F; æ£€æŸ¥æ˜¯å¦æœ‰å…³é—­çš„æƒé™ advanceRunState(STOP); &#x2F;&#x2F; å°†æ‰§â¾å™¨çš„çŠ¶æ€æ›´æ–°ä¸ºSTOP interruptWorkers(); &#x2F;&#x2F; ä¸­æ–­æ‰€æœ‰â¼¯ä½œçº¿ç¨‹ tasks &#x3D; drainQueue(); &#x2F;&#x2F; æ¸…ç©ºé˜Ÿåˆ—å¹¶å°†ç»“æœæ”¾â¼Šä»»åŠ¡åˆ—è¡¨ä¸­ &#125; finally &#123; mainLock.unlock(); &#x2F;&#x2F; â½†è®ºtryå—å¦‚ä½•é€€å‡ºéƒ½è¦é‡Šæ”¾é” &#125; tryTerminate(); &#x2F;&#x2F; å¦‚æœæ¡ä»¶å…è®¸ï¼Œå°è¯•ç»ˆâ½Œæ‰§â¾å™¨ return tasks; &#x2F;&#x2F; è¿”å›é˜Ÿåˆ—ä¸­æœªè¢«æ‰§â¾çš„ä»»åŠ¡åˆ—è¡¨ &#125; å°±æ˜¯å°†çº¿ç¨‹æ± çš„çŠ¶æ€ä¿®æ”¹ä¸º STOPï¼Œç„¶åå°è¯•æ‰“æ–­æ‰€æœ‰çš„çº¿ç¨‹ï¼Œä»é˜»å¡é˜Ÿåˆ—ä¸­ç§»é™¤å‰©ä½™çš„ä»»åŠ¡ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ shutdownNow ä¸èƒ½æ‰§â¾å‰©ä½™ä»»åŠ¡çš„åŸå› ã€‚ æ‰€ä»¥ä¹Ÿå¯ä»¥çœ‹å‡º shutdown â½…æ³•å’Œ shutdownNow â½…æ³•çš„ä¸»è¦åŒºåˆ«å°±æ˜¯ï¼Œshutdown ä¹‹åè¿˜èƒ½å¤„ç†åœ¨é˜Ÿåˆ—ä¸­çš„ä»» åŠ¡ï¼ŒshutdownNow ç›´æ¥å°±å°†ä»»åŠ¡ä»é˜Ÿåˆ—ä¸­ç§»é™¤ï¼Œçº¿ç¨‹æ± â¾¥çš„çº¿ç¨‹å°±ä¸å†å¤„ç†äº†ã€‚ çº¿ç¨‹æ± çš„ç›‘æ§å¦‚æœåœ¨ç³»ç»Ÿä¸­å¤§é‡ä½¿ç”¨çº¿ç¨‹æ± ï¼Œåˆ™æœ‰å¿…è¦å¯¹çº¿ç¨‹æ± è¿›è¡Œç›‘æ§ï¼Œæ–¹ä¾¿åœ¨å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥æ ¹æ®çº¿ç¨‹æ± çš„ä½¿ç”¨çŠ¶å†µå¿«é€Ÿå®šä½é—®é¢˜ã€‚ å¯ä»¥é€šè¿‡çº¿ç¨‹æ± æä¾›çš„å‚æ•°å’Œæ–¹æ³•æ¥ç›‘æ§çº¿ç¨‹æ± ï¼š getActiveCount() ï¼šçº¿ç¨‹æ± ä¸­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ•°é‡ getCompletedTaskCount() ï¼šçº¿ç¨‹æ± å·²å®Œæˆçš„ä»»åŠ¡æ•°é‡ï¼Œè¯¥å€¼å°äºç­‰äº taskCount getCorePoolSize() ï¼šçº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°é‡ getLargestPoolSize()ï¼šçº¿ç¨‹æ± æ›¾ç»åˆ›å»ºè¿‡çš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚é€šè¿‡è¿™ä¸ªæ•°æ®å¯ä»¥çŸ¥é“çº¿ç¨‹æ± æ˜¯å¦æ»¡è¿‡ï¼Œä¹Ÿå°±æ˜¯è¾¾åˆ°äº† maximumPoolSize getMaximumPoolSize()ï¼šçº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°é‡ getPoolSize() ï¼šçº¿ç¨‹æ± å½“å‰çš„çº¿ç¨‹æ•°é‡ getTaskCount() ï¼šçº¿ç¨‹æ± å·²ç»æ‰§è¡Œçš„å’Œæœªæ‰§è¡Œçš„ä»»åŠ¡æ€»æ•° è¿˜å¯ä»¥é€šè¿‡æ‰©å±•çº¿ç¨‹æ± æ¥è¿›è¡Œç›‘æ§ï¼š é€šè¿‡ç»§æ‰¿çº¿ç¨‹æ± æ¥è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œé‡å†™çº¿ç¨‹æ± çš„beforeExecuteã€afterExecuteå’Œterminatedæ–¹æ³•ï¼Œ ä¹Ÿå¯ä»¥åœ¨ä»»åŠ¡æ‰§è¡Œå‰ã€æ‰§è¡Œåå’Œçº¿ç¨‹æ± å…³é—­å‰æ‰§è¡Œä¸€äº›ä»£ç æ¥è¿›è¡Œç›‘æ§ã€‚ä¾‹å¦‚ï¼Œç›‘æ§ä»»åŠ¡çš„å¹³å‡æ‰§è¡Œæ—¶é—´ã€æœ€å¤§æ‰§è¡Œæ—¶é—´å’Œæœ€å°æ‰§è¡Œæ—¶é—´ç­‰ã€‚ å°ç»“åˆ°è¿™ï¼Œäº†è§£äº†executeå’Œworkerçš„ä¸€äº›æµç¨‹ï¼Œå¯ä»¥è¯´å…¶å®ThreadPoolExecutor çš„å®ç°å°±æ˜¯ä¸€ä¸ªç”Ÿäº§æ¶ˆè´¹æ¨¡å‹ã€‚ å½“ç”¨æˆ·æ·»åŠ ä»»åŠ¡åˆ°çº¿ç¨‹æ± æ—¶ç›¸å½“äºç”Ÿäº§è€…ç”Ÿäº§å…ƒç´ ï¼Œworkers çº¿ç¨‹å·¥ä½œé›†ä¸­çš„çº¿ç¨‹ç›´æ¥æ‰§è¡Œä»»åŠ¡æˆ–è€…ä»ä»»åŠ¡é˜Ÿåˆ—é‡Œé¢è·å–ä»»åŠ¡æ—¶åˆ™ç›¸å½“äºæ¶ˆè´¹è€…æ¶ˆè´¹å…ƒç´ ã€‚ çº¿ç¨‹æ± ç”Ÿå‘½å‘¨æœŸçº¿ç¨‹æ± çŠ¶æ€è¡¨ç¤ºåœ¨ThreadPoolExecutoré‡Œå®šä¹‰äº†ä¸€äº›çŠ¶æ€ï¼ŒåŒæ—¶åˆ©ç”¨é«˜ä½ä½çš„æ–¹å¼ï¼Œè®©ctlè¿™ä¸ªå‚æ•°èƒ½å¤Ÿä¿å­˜çŠ¶æ€ï¼Œåˆèƒ½ä¿å­˜çº¿ç¨‹æ•°é‡ï¼Œéå¸¸å·§å¦™ï¼[6] &#x2F;&#x2F;è®°å½•çº¿ç¨‹æ± çŠ¶æ€å’Œçº¿ç¨‹æ•°é‡ private final AtomicInteger ctl &#x3D; new AtomicInteger(ctlOf(RUNNING, 0)); &#x2F;&#x2F;29 private static final int COUNT_BITS &#x3D; Integer.SIZE - 3; private static final int CAPACITY &#x3D; (1 &lt;&lt; COUNT_BITS) - 1; &#x2F;&#x2F; çº¿ç¨‹æ± çŠ¶æ€ private static final int RUNNING &#x3D; -1 &lt;&lt; COUNT_BITS; private static final int SHUTDOWN &#x3D; 0 &lt;&lt; COUNT_BITS; private static final int STOP &#x3D; 1 &lt;&lt; COUNT_BITS; private static final int TIDYING &#x3D; 2 &lt;&lt; COUNT_BITS; private static final int TERMINATED &#x3D; 3 &lt;&lt; COUNT_BITS; é«˜3ä½è¡¨ç¤ºçŠ¶æ€ï¼Œä½29ä½è®°å½•çº¿ç¨‹æ•°é‡ï¼š çº¿ç¨‹æ± çŠ¶æ€æµè½¬çº¿ç¨‹æ± ä¸€å…±å®šä¹‰äº†äº”ç§çŠ¶æ€ï¼Œæ¥çœ‹çœ‹è¿™äº›çŠ¶æ€æ˜¯æ€ä¹ˆæµè½¬çš„[6]ï¼š RUNNINGï¼šè¿è¡ŒçŠ¶æ€ï¼Œæ¥å—æ–°çš„ä»»åŠ¡å¹¶ä¸”å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚ SHUTDOWNï¼šå…³é—­çŠ¶æ€(è°ƒç”¨äº† shutdown æ–¹æ³•)ã€‚ä¸æ¥å—æ–°ä»»åŠ¡ï¼Œ,ä½†æ˜¯è¦å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚ STOPï¼šåœæ­¢çŠ¶æ€(è°ƒç”¨äº† shutdownNow æ–¹æ³•)ã€‚ä¸æ¥å—æ–°ä»»åŠ¡ï¼Œä¹Ÿä¸å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œå¹¶ä¸”è¦ä¸­æ–­æ­£åœ¨å¤„ç†çš„ä»»åŠ¡ã€‚ TIDYINGï¼šæ‰€æœ‰çš„ä»»åŠ¡éƒ½å·²ç»ˆæ­¢äº†ï¼ŒworkerCount ä¸º 0ï¼Œçº¿ç¨‹æ± è¿›å…¥è¯¥çŠ¶æ€åä¼šè°ƒterminated() æ–¹æ³•è¿›å…¥ TERMINATED çŠ¶æ€ã€‚ TERMINATEDï¼šç»ˆæ­¢çŠ¶æ€ï¼Œterminated() æ–¹æ³•è°ƒç”¨ç»“æŸåçš„çŠ¶æ€ã€‚ Executors æ„å»ºçº¿ç¨‹æ± åœ¨ä¸Šâ¾¯çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿â½¤äº† JDK å†…éƒ¨æä¾›çš„ Executors â¼¯å…·ç±»æ¥å¿«é€Ÿåˆ›å»ºçº¿ç¨‹æ± ã€‚ 1ï¼‰å›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ï¼šæ ¸â¼¼çº¿ç¨‹æ•°ä¸æœ€â¼¤çº¿ç¨‹æ•°ç›¸ç­‰ public static ExecutorService newFixedThreadPool(int nThreads) &#123; return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()); &#125; 2ï¼‰å•ä¸ªçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ±  public static ExecutorService newSingleThreadExecutor() &#123; return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;())); &#125; 3ï¼‰æ¥è¿‘â½†é™â¼¤çº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ±  public static ExecutorService newCachedThreadPool() &#123; return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;()); &#125; 4ï¼‰å¸¦å®šæ—¶è°ƒåº¦åŠŸèƒ½çš„çº¿ç¨‹æ±  public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) &#123; return new ScheduledThreadPoolExecutor(corePoolSize); &#125; è™½ç„¶JDK æä¾›äº†å¿«é€Ÿåˆ›å»ºçº¿ç¨‹æ± çš„æ–¹æ³•ï¼Œä½†å…¶å®ä¸æ¨èä½¿ç”¨ Exeutors æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œå› ä¸ºä»ä¸Šé¢æ„é€ çº¿ç¨‹æ± çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼ŒnewFixedThreadPool çº¿ç¨‹æ± ç”±äºä½¿ç”¨äº† LinkedBlockingOueueï¼Œé˜Ÿåˆ—çš„å®¹é‡é»˜è®¤æ— é™å¤§ï¼Œå®é™…ä½¿ç”¨ä¸­å‡ºç°ä»»åŠ¡è¿‡å¤šæ—¶ä¼šå¯¼è‡´å†…å­˜æº¢å‡º; newCachedThreadPool çº¿ç¨‹æ± ç”±äºæ ¸å¿ƒçº¿ç¨‹æ•°æ— é™å¤§ï¼Œå½“ä»»åŠ¡è¿‡å¤šçš„æ—¶å€™ä¼šå¯¼è‡´åˆ›å»ºå¤§é‡çš„çº¿ç¨‹ï¼Œå¯èƒ½æœºå™¨è´Ÿè½½è¿‡é«˜å¯¼è‡´æœåŠ¡å®•æœºã€‚ å¦‚ä½•åˆç†çš„â¾ƒå®šä¹‰çº¿ç¨‹æ± çº¿ç¨‹æ± å¤§å° å…³äºçº¿ç¨‹æ± çš„å¤§å°ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªéœ€è¦ä¸¥æ ¼éµå®ˆçš„â€œé‡‘è§„é“å¾‹â€ï¼ŒæŒ‰ç…§ä»»åŠ¡æ€§è´¨ï¼Œå¤§æ¦‚å¯ä»¥åˆ†ä¸ºCPUå¯†é›†å‹ä»»åŠ¡ã€IOå¯†é›†å‹ä»»åŠ¡å’Œæ··åˆå‹ä»»åŠ¡ã€‚ CPUå¯†é›†å‹ä»»åŠ¡ï¼šCPUå¯†é›†å‹ä»»åŠ¡åº”é…ç½®å°½å¯èƒ½å°çš„çº¿ç¨‹ï¼Œå¦‚é…ç½®Ncpu+1ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚ IOå¯†é›†å‹ä»»åŠ¡ï¼šIOå¯†é›†å‹ä»»åŠ¡çº¿ç¨‹å¹¶ä¸æ˜¯ä¸€ç›´åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œåˆ™åº”é…ç½®å°½å¯èƒ½å¤šçš„çº¿ç¨‹ï¼Œå¦‚2*Ncpuã€‚ æ··åˆå‹ä»»åŠ¡ï¼šæ··åˆå‹ä»»åŠ¡å¯ä»¥æŒ‰éœ€æ‹†åˆ†æˆCPUå¯†é›†å‹ä»»åŠ¡å’ŒIOå¯†é›†å‹ä»»åŠ¡ã€‚ å½“ç„¶ï¼Œè¿™ä¸ªåªæ˜¯å»ºè®®ï¼Œå®é™…ä¸Šå…·ä½“æ€ä¹ˆé…ç½®ï¼Œè¿˜è¦ç»“åˆäº‹å‰è¯„ä¼°å’Œæµ‹è¯•ã€äº‹ä¸­ç›‘æ§æ¥ç¡®å®šä¸€ä¸ªå¤§è‡´çš„çº¿ç¨‹çº¿ç¨‹æ± å¤§å°ã€‚çº¿ç¨‹æ± å¤§å°ä¹Ÿå¯ä»¥ä¸ç”¨å†™æ­»ï¼Œä½¿ç”¨åŠ¨æ€é…ç½®çš„æ–¹å¼ï¼Œä»¥ä¾¿è°ƒæ•´ã€‚ çº¿ç¨‹å·¥å‚ä¸€èˆ¬å»ºè®®è‡ªå®šä¹‰çº¿ç¨‹å·¥å‚ï¼Œæ„å»ºçº¿ç¨‹çš„æ—¶å€™è®¾ç½®çº¿ç¨‹çš„åç§°ï¼Œè¿™æ ·åœ¨æŸ¥æ—¥å¿—çš„æ—¶å€™å°±æ–¹ä¾¿çŸ¥é“æ˜¯å“ªä¸ªçº¿ç¨‹æ‰§è¡Œçš„ä»£ç ã€‚ import java.util.concurrent.ThreadFactory; import java.util.concurrent.atomic.AtomicInteger; /** * @author ehyzil * @Description * @create 2023-12-2023/12/26-19:05 */ public class MyThreadFactory implements ThreadFactory &#123; private static final AtomicInteger poolNumber = new AtomicInteger(1); private final ThreadGroup group; private final AtomicInteger threadNumber = new AtomicInteger(1); private final String namePrefix; /** * æ„é€ å‡½æ•°ä¼ å…¥æˆ‘ä»¬æƒ³ä¸šåŠ¡éœ€è¦çš„çº¿ç¨‹åå­—threadNameï¼Œæ–¹ä¾¿å‘ç”Ÿå¼‚å¸¸æ˜¯è¿½æº¯ * @param threadName */ public MyThreadFactory(String threadName) &#123; SecurityManager s = System.getSecurityManager(); group = (s != null) ? s.getThreadGroup() : Thread.currentThread().getThreadGroup(); if (threadName == null || threadName.isEmpty())&#123; threadName = \"pool\"; &#125; namePrefix = threadName + poolNumber.getAndIncrement() + \"-thread-\"; &#125; @Override public Thread newThread(Runnable r) &#123; Thread t = new Thread(group, r, namePrefix + threadNumber.getAndIncrement(), 0); if (t.isDaemon()) t.setDaemon(false); if (t.getPriority() != Thread.NORM_PRIORITY) t.setPriority(Thread.NORM_PRIORITY); return t; &#125; &#125; //æµ‹è¯•ç±» import java.util.concurrent.ArrayBlockingQueue; import java.util.concurrent.ThreadPoolExecutor; import java.util.concurrent.TimeUnit; /** * @author ehyzil * @Description * @create 2023-12-2023/12/26-19:06 */ public class Test &#123; public static void main(String[] args) &#123; ThreadPoolExecutor executor = new ThreadPoolExecutor(3, 5, 5, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;>(100), new MyThreadFactory(\"æµ‹è¯•è‡ªå»ºçº¿ç¨‹å·¥å‚\")); for (int i = 0; i &lt; 100; i++) &#123; executor.execute(new Runnable() &#123; @Override public void run() &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(Thread.currentThread().getName()); &#125; &#125;); &#125; &#125; &#125; æ‰§è¡Œç»“æœ æµ‹è¯•è‡ªå»ºçº¿ç¨‹å·¥å‚1-thread-1 æµ‹è¯•è‡ªå»ºçº¿ç¨‹å·¥å‚1-thread-2 æµ‹è¯•è‡ªå»ºçº¿ç¨‹å·¥å‚1-thread-3 æµ‹è¯•è‡ªå»ºçº¿ç¨‹å·¥å‚1-thread-2 æœ‰ç•Œé˜Ÿåˆ—ä¸€èˆ¬éœ€è¦è®¾ç½®æœ‰ç•Œé˜Ÿåˆ—çš„å¤§å°ï¼Œæ¯”å¦‚ LinkedBlockingOueue åœ¨æ„é€ çš„æ—¶å€™å¯ä»¥ä¼ å…¥å‚æ•°æ¥é™åˆ¶é˜Ÿåˆ—ä¸­ä»»åŠ¡æ•°æ®çš„å¤§å°ï¼Œè¿™æ ·å°±ä¸ä¼šå› ä¸ºæ— é™å¾€é˜Ÿåˆ—ä¸­æ‰”ä»»åŠ¡å¯¼è‡´ç³»ç»Ÿçš„ oomã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"},{"name":"å¹¶å‘","slug":"å¹¶å‘","permalink":"https://blog.ehzyil.xyz/tags/%E5%B9%B6%E5%8F%91/"}],"author":"ehzyil"},{"title":"è®°å½•éœ€æ±‚ä¸­å†™çš„é€’å½’æ–¹æ³•","slug":"2023/è®°å½•éœ€æ±‚ä¸­å†™çš„é€’å½’æ–¹æ³•","date":"2023-12-26T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/12/26/2023/è®°å½•éœ€æ±‚ä¸­å†™çš„é€’å½’æ–¹æ³•/","link":"","permalink":"https://blog.ehzyil.xyz/2023/12/26/2023/%E8%AE%B0%E5%BD%95%E9%9C%80%E6%B1%82%E4%B8%AD%E5%86%99%E7%9A%84%E9%80%92%E5%BD%92%E6%96%B9%E6%B3%95/","excerpt":"","text":"è®°å½•éœ€æ±‚ä¸­å†™çš„é€’å½’æ–¹æ³•é€’å½’éå†jsonæ•°æ®ï¼Œå°†å…¶è½¬æ¢æˆ List&lt;Map&lt;String, Object&gt;&gt;åˆ—è¡¨public static List&lt;Map&lt;String, Object>> json2List(com.alibaba.fastjson.JSONArray array) &#123; // åˆ›å»ºä¸€ä¸ªç©ºçš„åˆ—è¡¨ List&lt;Map&lt;String, Object>> list = new ArrayList&lt;>(); // éå†jsonæ•°ç»„ä¸­çš„æ¯ä¸ªå¯¹è±¡ for (Object obj : array) &#123; // å°†å¯¹è±¡è½¬æ¢ä¸ºJSONObject com.alibaba.fastjson.JSONObject object = (com.alibaba.fastjson.JSONObject) obj; // åˆ›å»ºä¸€ä¸ªç©ºçš„HashMap HashMap&lt;String, Object> map = new HashMap&lt;>(); // è·å–å¯¹è±¡ä¸­åä¸º\"children\"çš„æ•°ç»„ com.alibaba.fastjson.JSONArray children = object.getJSONArray(\"children\"); // å¦‚æœ\"children\"ä¸ä¸ºç©ºï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºåˆ—è¡¨ if (children != null) &#123; List&lt;Map&lt;String, Object>> childrenList = json2List(children); map.put(\"children\", childrenList); &#125; // å°†å¯¹è±¡ä¸­çš„\"name\"ã€\"id\"ã€\"value\"æ”¾å…¥mapä¸­ map.put(\"name\", object.getString(\"name\")); map.put(\"id\", object.getString(\"id\")); map.put(\"value\", object.getString(\"value\")); // å°†mapæ·»åŠ åˆ°åˆ—è¡¨ä¸­ list.add(map); &#125; // è¿”å›æœ€ç»ˆçš„åˆ—è¡¨ return list; &#125; é€’å½’è°ƒç”¨æ–¹æ³•å¤„ç†ä¼ å…¥çš„åˆ—è¡¨å°†å¤åˆæ¡ä»¶çš„èŠ‚ç‚¹æ·»åŠ æŒ‡å®šå±æ€§/** * é€’å½’è®¾ç½®èŠ‚ç‚¹çš„æ‰“å¼€çŠ¶æ€ * @param list å¾…å¤„ç†çš„èŠ‚ç‚¹åˆ—è¡¨ * @param target * @return è®¾ç½®æ‰“å¼€çŠ¶æ€åçš„èŠ‚ç‚¹åˆ—è¡¨ */ public static List&lt;Map&lt;String, Object>> recursiveSetopen(List&lt;Map&lt;String, Object>> list, List&lt;String> target) &#123; for (Map&lt;String, Object> map : list) &#123; List&lt;Map&lt;String, Object>> children = (List&lt;Map&lt;String, Object>>) map.get(\"children\"); if (map.get(\"children\") != null) &#123; // é€’å½’è®¾ç½®å­èŠ‚ç‚¹çš„æ‰“å¼€çŠ¶æ€ recursiveSetOpen(children, target); String open = \"\"; for (Map&lt;String, Object> child : children) &#123; open = MapUtils.getString(child, \"open\"); if (StringUtils.isNotEmpty(open)) &#123; // å¦‚æœå­èŠ‚ç‚¹å·²ç»æ‰“å¼€ï¼Œåˆ™å°†çˆ¶èŠ‚ç‚¹è®¾ç½®ä¸ºæ‰“å¼€çŠ¶æ€ Map&lt;String, Object> objectMap = list.get(list.indexOf(map)); objectMap.put(\"open\", true); list.set(list.indexOf(map), objectMap); break; &#125; &#125; &#125; else &#123; String name = map.get(\"name\").toString(); if (target.contains(name)) &#123; // å¦‚æœèŠ‚ç‚¹åœ¨ç›®æ ‡åˆ—è¡¨ä¸­ï¼Œåˆ™è®¾ç½®ä¸ºæ‰“å¼€çŠ¶æ€å’Œé€‰ä¸­çŠ¶æ€ map.put(\"open\", true); map.put(\"checked\", true); &#125; &#125; &#125; return list; &#125; JSONæ•°æ®ï¼š &#123; \"beans\":[ &#123; \"name\":\"æ²Ÿé€šæŠ€å·§ç±»\", \"value\":\"4\", \"id\":\"4\", \"children\":[ &#123; \"name\":\"æ²Ÿé€šè¿‡äºéšæ„æˆ–ä½¿ç”¨ä¸æ°å½“è¯­è¨€\", \"value\":\"401\", \"id\":\"401\" &#125;, &#123; \"name\":\"è¯­éŸ³ã€è¯­è°ƒã€è¯­é€Ÿè¿ç”¨ä¸ä½³\", \"value\":\"402\", \"id\":\"402\" &#125; ] &#125;, &#123; \"name\":\"ä¸šåŠ¡èƒ½åŠ›ç±»\", \"value\":\"3\", \"id\":\"3\", \"children\":[ &#123; \"name\":\"ä¸šåŠ¡è§£é‡Šæˆ–åŠç†å·®é”™\", \"value\":\"309\", \"id\":\"309\" &#125;, &#123; \"name\":\"ä¸šåŠ¡ä¸ç†Ÿç»ƒ\", \"value\":\"305\", \"id\":\"305\" &#125;, &#123; \"name\":\"æ‰¿è¯ºæœªå…‘ç°\", \"value\":\"310\", \"id\":\"310\" &#125;, &#123; \"name\":\"æœªæ‰§è¡Œå…¬å¸å†…éƒ¨å„ç±»æµç¨‹è§„èŒƒ\", \"value\":\"311\", \"id\":\"311\" &#125; ] &#125;, &#123; \"name\":\"æœåŠ¡èƒ½åŠ›ç±»\", \"value\":\"2\", \"id\":\"2\", \"children\":[ &#123; \"name\":\"æŠ“ä¸ä½å®¢æˆ·é‡ç‚¹\", \"value\":\"201\", \"id\":\"201\" &#125;, &#123; \"name\":\"æœºæ¢°åŒ–æœåŠ¡ã€æœåŠ¡ä¸çµæ´»\", \"value\":\"202\", \"id\":\"202\" &#125; ] &#125;, &#123; \"name\":\"æœåŠ¡æ„è¯†ç±»\", \"value\":\"1\", \"id\":\"1\", \"children\":[ &#123; \"name\":\"æ•·è¡ã€æªå¡ã€æ¨è¯¿å®¢æˆ·\", \"value\":\"107\", \"id\":\"107\" &#125;, &#123; \"name\":\"åé—®ã€è´¨é—®ã€æŒ‡è´£å®¢æˆ·\", \"value\":\"102\", \"id\":\"102\" &#125;, &#123; \"name\":\"æŠ¢è¯ã€æ’è¯\", \"value\":\"103\", \"id\":\"103\" &#125;, &#123; \"name\":\"å¼ºåˆ¶è½¬æ¥æˆ–æŒ‚æœº\", \"value\":\"104\", \"id\":\"104\" &#125;, &#123; \"name\":\"å‡ºç°ä¸æ–‡æ˜ç”¨è¯­\", \"value\":\"105\", \"id\":\"105\" &#125;, &#123; \"name\":\"æ•…æ„å¼•å¯¼å®¢æˆ·å‡çº§æŠ•è¯‰\", \"value\":\"106\", \"id\":\"106\" &#125; ] &#125;, &#123; \"name\":\"æœåŠ¡ç¦å¿Œç±»\", \"value\":\"0\", \"id\":\"0\", \"children\":[ &#123; \"name\":\"è¾±éª‚å®¢æˆ·\", \"value\":\"001\", \"id\":\"001\" &#125;, &#123; \"name\":\"å¨èƒæå“å®¢æˆ·\", \"value\":\"002\", \"id\":\"002\" &#125;, &#123; \"name\":\"æ¶æ„éªšæ‰°æŠ¥å¤å®¢æˆ·\", \"value\":\"007\", \"id\":\"007\" &#125;, &#123; \"name\":\"æ¬ºç’ã€è¯±å¯¼å®¢æˆ·\", \"value\":\"010\", \"id\":\"010\" &#125;, &#123; \"name\":\"ä¸å®¢æˆ·å‘ç”Ÿäº‰åµè¨€è¯­è¿‡æ¿€æ”»å‡»å®¢æˆ·\", \"value\":\"008\", \"id\":\"008\" &#125;, &#123; \"name\":\"è¿åäº”æ¡ç¦ä»¤\", \"value\":\"009\", \"id\":\"009\" &#125; ] &#125;, &#123; \"name\":\"æ— é—®é¢˜\", \"value\":\"5\", \"id\":\"5\" &#125; ] &#125; é€’å½’å¯»æ‰¾æ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹-è¿”å›å­èŠ‚ç‚¹åˆ°çˆ¶èŠ‚ç‚¹çš„é“¾è·¯public static StringBuffer recursiveForAllName(List&lt;Map&lt;String, Object>> list, String target, StringBuffer result) &#123; if (CollectionUtils.isEmpty(list)) &#123; return result.append(target); &#125; for (Map&lt;String, Object> map : list) &#123; List&lt;Map&lt;String, Object>> children = (List&lt;Map&lt;String, Object>>) map.get(\"children\"); if (map.get(\"children\") != null) &#123; // Recursively set the open state of the child nodes recursiveForAllName(children, target, result); if (StringUtils.isNotBlank(result)) &#123; result.insert(0, map.get(\"name\") + \"_\"); break; &#125; else &#123; String name = map.get(\"name\").toString(); if (target.contains(name)) &#123; result.insert(0, name); break; &#125; &#125; &#125; &#125; return result; &#125; è°ƒç”¨æ–¹æ³• public static List&lt;Map&lt;String, Object>> handleExportData(List&lt;Map&lt;String, Object>> checkResults, List&lt;Map&lt;String, Object>> exportNeedModels) throws IOException &#123; // MODELS_NM ----> List&lt;Map&lt;String, Object>> controlå±‚è·å– // problemTypeNm é—®é¢˜åˆ¤å®š com.alibaba.fastjson.JSONObject problemTypeObj = getProblemTypeObj(); com.alibaba.fastjson.JSONArray beansArray = problemTypeObj.getJSONArray(\"beans\"); List&lt;Map&lt;String, Object>> beans = json2List(beansArray); for (Map&lt;String, Object> map : checkResults) &#123; String problemTypeNm = map.get(\"problemTypeNm\").toString(); if (StringUtils.isNotEmpty(problemTypeNm)) &#123; StringBuffer stringBuffer = new StringBuffer(); String[] split = problemTypeNm.split(\";\"); for (String singleProblemTypeNm : split) &#123; stringBuffer.append(recursiveForAllName(beans, singleProblemTypeNm, new StringBuffer())).append(\",\"); &#125; map.put(\"problemTypeNm\", stringBuffer.toString()); &#125; String checkComment = map.get(\"MODELS_NM\").toString(); if (StringUtils.isNotEmpty(checkComment)) &#123; StringBuffer stringBuffer = new StringBuffer(); String[] split = checkComment.split(\";\"); for (String singleModel : split) &#123; stringBuffer.append(recursiveForAllName(exportNeedModels, singleModel, new StringBuffer())).append(\";\"); &#125; map.put(\"MODELS_NM\", stringBuffer.toString()); &#125; &#125; return checkResults; &#125;","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"}],"author":"ehzyil"},{"title":"CentOS7åŒæ­¥æ—¶é—´","slug":"2023/CentOS 7åŒæ­¥æ—¶é—´","date":"2023-11-11T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/11/11/2023/CentOS 7åŒæ­¥æ—¶é—´/","link":"","permalink":"https://blog.ehzyil.xyz/2023/11/11/2023/CentOS%207%E5%90%8C%E6%AD%A5%E6%97%B6%E9%97%B4/","excerpt":"","text":"é—®é¢˜æè¿°The difference between the request time and the current time is too largeã€‚ ç”±äºminioéƒ¨ç½²åœ¨centosçš„dockerå®¹å™¨ä¸­ï¼Œè™šæ‹ŸæœºæŒ‚èµ·å†å¯åŠ¨åæ—¶é—´ä¸ä¼šåŒæ­¥ï¼Œé€ æˆä¸Šè¿°é—®é¢˜ã€‚ è§£å†³æ–¹æ³•æ˜¯åŒæ­¥è™šæ‹Ÿæœºçš„æ—¶é—´ã€‚ è®¾ç½®æ—¶åŒºï¼ˆCentOS 7ï¼‰å…ˆæ‰§è¡Œå‘½ä»¤timedatectl status|grep &#39;Time zone&#39;æŸ¥çœ‹å½“å‰æ—¶åŒºï¼Œå¦‚æœä¸æ˜¯ä¸­å›½æ—¶åŒºï¼ˆAsia&#x2F;Shanghaiï¼‰ï¼Œåˆ™éœ€è¦å…ˆè®¾ç½®ä¸ºä¸­å›½æ—¶åŒºï¼Œå¦åˆ™æ—¶åŒºä¸åŒä¼šå­˜åœ¨æ—¶å·®ã€‚ #å·²ç»æ˜¯Asia/Shanghaiï¼Œåˆ™æ— éœ€è®¾ç½® [root@xiaoz shadowsocks]# timedatectl status|grep 'Time zone' Time zone: Asia/Shanghai (CST, +0800) æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è®¾ç½®æ—¶åŒº #è®¾ç½®ç¡¬ä»¶æ—¶é’Ÿè°ƒæ•´ä¸ºä¸æœ¬åœ°æ—¶é’Ÿä¸€è‡´ timedatectl set-local-rtc 1 #è®¾ç½®æ—¶åŒºä¸ºä¸Šæµ· timedatectl set-timezone Asia/Shanghai ä½¿ç”¨ntpdateåŒæ­¥æ—¶é—´ç›®å‰æ¯”è¾ƒå¸¸ç”¨çš„åšæ³•å°±æ˜¯ä½¿ç”¨ntpdateå‘½ä»¤æ¥åŒæ­¥æ—¶é—´ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š #å®‰è£…ntpdate yum -y install ntpdate #åŒæ­¥æ—¶é—´ ntpdate -u pool.ntp.org #åŒæ­¥å®Œæˆå,dateå‘½ä»¤æŸ¥çœ‹æ—¶é—´æ˜¯å¦æ­£ç¡® date","categories":[{"name":"Linux","slug":"Linux","permalink":"https://blog.ehzyil.xyz/categories/Linux/"}],"tags":[{"name":"CentOS","slug":"CentOS","permalink":"https://blog.ehzyil.xyz/tags/CentOS/"}],"author":"ehzyil"},{"title":"åœ¨æœåŠ¡å™¨ä¸Šæ­å»ºAlistæ–‡ä»¶åˆ—è¡¨ç¨‹åº","slug":"2023/åœ¨æœåŠ¡å™¨ä¸Šæ­å»ºAlistæ–‡ä»¶åˆ—è¡¨ç¨‹åº","date":"2023-10-22T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/22/2023/åœ¨æœåŠ¡å™¨ä¸Šæ­å»ºAlistæ–‡ä»¶åˆ—è¡¨ç¨‹åº/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/22/2023/%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E6%90%AD%E5%BB%BAAlist%E6%96%87%E4%BB%B6%E5%88%97%E8%A1%A8%E7%A8%8B%E5%BA%8F/","excerpt":"","text":"åœ¨æˆ‘ä»¬ä½¿ç”¨ç½‘ç›˜çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™éœ€è¦æ­å»ºä¸€ä¸ªåˆ†äº«é¡µã€‚ä½†æ˜¯é»˜è®¤çš„ç½‘ç›˜åˆ†äº«é¡µæœ‰äº›éº»çƒ¦ã€‚åœ¨è¿™ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ¥å’Œå¤§å®¶ä¸€èµ·åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨shellè„šæœ¬ä¸€é”®æ­å»ºAlistæ–‡ä»¶åˆ—è¡¨ç¨‹åº å‡†å¤‡ææ–™ æœåŠ¡å™¨ä¸€å° éƒ¨ç½²æ­¥éª¤ SSHè¿›å…¥æœåŠ¡å™¨çš„æ§åˆ¶å°ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ curl -fsSL &quot;https:&#x2F;&#x2F;alist.nn.ci&#x2F;v3.sh&quot; | bash -s install 2.è„šæœ¬å°†ä¼šæç¤ºè®¿é—®IPåœ°å€ã€ç®¡ç†å‘˜ç”¨æˆ·ååŠå¯†ç  3.é…ç½®æœåŠ¡å™¨å®‰å…¨ç»„çš„è§„åˆ™ 4.å¦‚éœ€è¦æ›´æ–°Alistï¼Œåˆ™ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ SHELL å¤åˆ¶æˆåŠŸcurl -fsSL &quot;https:&#x2F;&#x2F;alist.nn.ci&#x2F;v3.sh&quot; | bash -s update 5.å¦‚éœ€è¦å¸è½½Alistï¼Œåˆ™ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ SHELL curl -fsSL &quot;https:&#x2F;&#x2F;alist.nn.ci&#x2F;v3.sh&quot; | bash -s update é…ç½®Alisthttps://alist.nn.ci/zh/guide/drivers/aliyundrive.html","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"ç½‘ç›˜","slug":"ç½‘ç›˜","permalink":"https://blog.ehzyil.xyz/tags/%E7%BD%91%E7%9B%98/"}],"author":"ehzyil"},{"title":"å°ç™½åˆé‡æœåŠ¡å™¨","slug":"2023/å°ç™½åˆé‡æœåŠ¡å™¨","date":"2023-10-22T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/22/2023/å°ç™½åˆé‡æœåŠ¡å™¨/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/22/2023/%E5%B0%8F%E7%99%BD%E5%88%9D%E9%81%87%E6%9C%8D%E5%8A%A1%E5%99%A8/","excerpt":"","text":"å‰è¨€ç™½é£˜äº†é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œåˆ›å»ºå®ä¾‹åä¸€è„¸æ‡µé€¼ï¼Œå®Œå…¨ä¸çŸ¥é“åœ¨å“ªæŸ¥çœ‹å¯†ç ã€é€‰æ‹©çš„å®å¡”é•œåƒæ€ä¹ˆä½¿ç”¨ã€åœ¨å“ªé‡Œæ‰“å¼€ç­‰ç­‰ï¼Œäºæ˜¯å°±æœ‰äº†æœ¬æ–‡ï¼Œç”¨æ¥è®°å½•ä¸€äº›é…ç½®è¿‡ç¨‹ï¼Œæ–¹ä¾¿ä¸‹æ¬¡åˆ›å»ºæœåŠ¡å™¨çš„æ—¶å€™ç›´æ¥copyé…ç½®ï¼Œç°åœ¨å°±å¼€å§‹ç©ä¸€ç©æœåŠ¡å™¨å§ï¼ŒæŠ˜è…¾èµ·æ¥ï¼ 0.æ›´æ–°ã€å®‰è£…å¿…å¤‡è½¯ä»¶yum update &amp;&amp; yum install -y wget vim #centos apt-get update &amp;&amp; apt-get install -y wget vim #dibian 1.å®‰è£…å®å¡”é¢æ¿æµç¨‹æœ¬æ–‡æ˜¯ä»¥é˜¿é‡Œäº‘æœåŠ¡å™¨ECSä¸ºä¾‹ï¼ŒCentOSæ“ä½œç³»ç»Ÿï¼Œæ‰‹åŠ¨å®‰è£…å®å¡”Linuxé¢æ¿ï¼Œå¤§è‡´æµç¨‹ä¸ºï¼šå…ˆè¿œç¨‹è¿æ¥åˆ°äº‘æœåŠ¡å™¨ï¼Œæ‰§è¡Œå®å¡”é¢æ¿å®‰è£…å‘½ä»¤ï¼Œå®‰è£…å®Œæ¯•åä¿å­˜å¥½å®å¡”ç™»å½•åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ç­‰ä¿¡æ¯ï¼Œç„¶ååœ¨äº‘æœåŠ¡å™¨å®‰å…¨ç»„å¼€é€šå®å¡”é¢æ¿ç«¯å£å·ï¼Œæœ€åç™»å½•åˆ°å®å¡”é¢æ¿å®‰è£…æ‰€éœ€çš„è¿è¡Œç¯å¢ƒã€‚æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š 1ã€å…ˆåˆ›å»ºäº‘æœåŠ¡å™¨ECSï¼Œäº‘æœåŠ¡å™¨é…ç½®é€‰æ‹©ï¼› 2ã€è¿œç¨‹è¿æ¥åˆ°äº‘æœåŠ¡å™¨ï¼› 3ã€æ‰§è¡Œå®å¡”é¢æ¿å®‰è£…å‘½ä»¤è„šæœ¬ï¼› 4ã€ä¿å­˜å®å¡”é¢æ¿ç™»å½•åœ°å€ã€è´¦å·å’Œå¯†ç ï¼› 5ã€åœ¨äº‘æœåŠ¡å™¨çš„å®‰å…¨ç»„ä¸­å¼€é€šå®å¡”é¢æ¿æ‰€éœ€ç«¯å£å·ï¼› 6ã€ç™»å½•å®å¡”é¢æ¿åå°ï¼Œå¹¶å®‰è£…åº”ç”¨ç¨‹åºç¯å¢ƒã€‚ æ­¥éª¤ä¸€ï¼šé˜¿é‡Œäº‘æœåŠ¡å™¨é…ç½®é€‰æ‹©æ­¥éª¤äºŒï¼šè¿œç¨‹è¿æ¥ç™»å½•åˆ°äº‘æœåŠ¡å™¨é˜¿é‡Œäº‘æœåŠ¡å™¨æ”¯æŒå¤šç§è¿œç¨‹è¿æ¥æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨é˜¿é‡Œäº‘è‡ªå¸¦çš„Workbenchè¿œç¨‹è¿æ¥æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹SSHè¿œç¨‹è¿æ¥è½¯ä»¶å¦‚PuTTYã€Xshellç­‰ã€‚é˜¿é‡Œäº‘æœåŠ¡å™¨ç½‘ä½¿ç”¨é˜¿é‡Œäº‘è‡ªå¸¦çš„è¿œç¨‹è¿æ¥æ–¹å¼ï¼š é¦–å…ˆç™»å½•åˆ°äº‘æœåŠ¡å™¨ECSç®¡ç†æ§åˆ¶å°ï¼Œå·¦ä¾§æ ã€å®ä¾‹ä¸é•œåƒã€‘&gt;&gt;ã€å®ä¾‹ã€‘ï¼Œæ‰¾åˆ°ç›®æ ‡äº‘æœåŠ¡å™¨ECSå®ä¾‹ï¼Œç„¶åç‚¹å‡»å³ä¾§çš„ã€è¿œç¨‹è¿æ¥ã€‘ã€‚ æ­¥éª¤ä¸‰ï¼šæ‰§è¡Œå®å¡”é¢æ¿çš„å®‰è£…å‘½ä»¤ç™»å½•åˆ°ä½ çš„äº‘æœåŠ¡å™¨åï¼Œæ‰§è¡Œå®å¡”é¢æ¿å®‰è£…å‘½ä»¤ï¼Œé˜¿é‡Œäº‘æœåŠ¡å™¨ç½‘ä½¿ç”¨çš„CentOSæ“ä½œç³»ç»Ÿï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š yum install -y wget &amp;&amp; wget -O install.sh https:&#x2F;&#x2F;download.bt.cn&#x2F;install&#x2F;install_6.0.sh &amp;&amp; sh install.sh ed8484bec æ‰§è¡Œå®å¡”Linuxé¢æ¿å®‰è£…å‘½ä»¤åï¼Œä¼šæç¤ºå¦‚ä¸‹ï¼š Do you want to install Bt-Panel to the &#x2F;www directory now?(y&#x2F;n): y ä¿æŒé»˜è®¤ï¼Œå›å¤ä¸ªå­—æ¯â€œyâ€ã€‚ ç„¶åå›è½¦ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å®‰è£…ï¼Œå¤§çº¦1åˆ†é’Ÿå·¦å³ä¼šè‡ªåŠ¨å®‰è£…å®Œæˆã€‚ æ­¥éª¤å››ï¼šå®å¡”é¢æ¿ç™»å½•åœ°å€ã€è´¦å·å’Œå¯†ç å®å¡”é¢æ¿è‡ªåŠ¨å®‰è£…å®Œæˆåï¼Œä¼šæ˜¾ç¤ºå®å¡”åå°ç™»å½•åœ°å€ã€usernameå’Œpasswordï¼Œå¦‚ä¸‹ï¼š &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; BT-Panel default info! # æ³¨æ„: 5.xç³»åˆ—Linuxé¢æ¿ä»2020å¹´1æœˆ1æ—¥èµ·ç»ˆæ­¢ç»´æŠ¤ï¼Œä¸æŠ€æœ¯æ”¯æŒï¼Œè¯·è€ƒè™‘å®‰è£…å…¨æ–°çš„7.xç‰ˆæœ¬ å®å¡”å®˜ç½‘: https:&#x2F;&#x2F;www.bt.cn &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Bt-Panel: http:&#x2F;&#x2F;IP:8888 username: 08bnpksl password: 89b58de05321 Warning: If you cannot access the panel, release the following port (8888|888|80|443|20|21) in the security group [root@iZ2ze552628d2crm1m97ppZ ~]# bt default cd &#x2F;www&#x2F;server&#x2F;panel &amp;&amp; btpython tools.py panel testpasswd a æ­¥éª¤äº”ï¼šåœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨æ§åˆ¶å°å¼€é€šå®å¡”é¢æ¿ç«¯å£1ã€ç™»å½•åˆ°ECSäº‘æœåŠ¡å™¨ç®¡ç†æ§åˆ¶å° 2ã€å·¦ä¾§æ æ‰¾åˆ°ã€å®ä¾‹ä¸é•œåƒã€‘&gt;&gt;ã€å®ä¾‹ã€‘ï¼Œæ‰¾åˆ°ç›®æ ‡ECSå®ä¾‹ï¼Œç‚¹å‡»å®ä¾‹IDè¿›å…¥åˆ°å®ä¾‹è¯¦æƒ…é¡µ 3ã€åˆ‡æ¢åˆ°ã€å®‰å…¨ç»„ã€‘é¡µé¢ï¼Œç‚¹å‡»å³ä¾§ã€é…ç½®è§„åˆ™ã€‘ï¼Œå¦‚ä¸‹å›¾ï¼š å…³äºé˜¿é‡Œäº‘å®‰å…¨ç»„å¼€é€šç«¯å£è¯¦ç»†æ•™ç¨‹å‚è€ƒä¸‹æ–¹æ–‡æ¡£ï¼š è¯¦ç»†æ•™ç¨‹å‚è€ƒï¼šhttps://help.aliyun.com/document_detail&#x2F;25471.html é…ç½®æˆå¦‚ä¸‹ï¼š æ­¥éª¤å…­ï¼šç™»å½•åˆ°å®å¡”ç®¡ç†åœ°å€å¹¶å®‰è£…LNMPç¯å¢ƒç™»å½•åä¼šè‡ªåŠ¨å¼¹å‡ºæ­¤ç•Œé¢ï¼ŒæŒ‰éœ€æ±‚é€‰æ‹©è½¯ä»¶å¹¶å®‰è£…ï¼Œä¹Ÿå¯ä»¥åˆ°è½¯ä»¶ç®¡ç†å»å®‰è£…ã€‚ 2.å®‰è£… Dockerã€Docker-composeå›½å†…æœºå›½å†…æœºå®‰è£… dockercurl -sSL https://get.daocloud.io/docker | sh å›½å†…æœºå®‰è£… docker-composecurl -L https://get.daocloud.io/docker/compose/releases/download/v2.1.1/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose chmod +x /usr/local/bin/docker-compose å¸è½½ dockersudo apt-get remove docker docker-engine rm -fr /var/lib/docker/ æµ·å¤–æœåŠ¡å™¨éå¤§é™† Docker å®‰è£…BASHwget -qO- get.docker.com | bash å¸è½½ Dockersudo apt-get purge docker-ce docker-ce-cli containerd.io sudo rm -rf &#x2F;var&#x2F;lib&#x2F;docker sudo rm -rf &#x2F;var&#x2F;lib&#x2F;containerd éå¤§é™† Docker-compose å®‰è£…sudo curl -L &quot;https:&#x2F;&#x2F;github.com&#x2F;docker&#x2F;compose&#x2F;releases&#x2F;download&#x2F;1.29.2&#x2F;docker-compose-$(uname -s)-$(uname -m)&quot; -o &#x2F;usr&#x2F;local&#x2F;bin&#x2F;docker-compose sudo chmod +x &#x2F;usr&#x2F;local&#x2F;bin&#x2F;docker-compose æŸ¥çœ‹ç‰ˆæœ¬ å…ˆè¿›å…¥ docker-compose --version # /usr/local/bin/ ä¿®æ”¹ Docker é…ç½®ï¼ˆæ¥è‡ªçƒ§é¥¼åšå®¢ï¼‰ä»¥ä¸‹é…ç½®ä¼šå¢åŠ ä¸€æ®µè‡ªå®šä¹‰å†…ç½‘ IPv6 åœ°å€ï¼Œå¼€å¯å®¹å™¨çš„ IPv6 åŠŸèƒ½ï¼Œä»¥åŠé™åˆ¶æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé˜²æ­¢ Docker æ—¥å¿—å¡æ»¡ç¡¬ç›˜ï¼ˆæ³ªçš„æ•™è®­ï¼‰ï¼š cat &gt; &#x2F;etc&#x2F;docker&#x2F;daemon.json &lt;&lt;EOF &#123; &quot;log-driver&quot;: &quot;json-file&quot;, &quot;log-opts&quot;: &#123; &quot;max-size&quot;: &quot;20m&quot;, &quot;max-file&quot;: &quot;3&quot; &#125;, &quot;ipv6&quot;: true, &quot;fixed-cidr-v6&quot;: &quot;fd00:dead:beef:c0::&#x2F;80&quot;, &quot;experimental&quot;:true, &quot;ip6tables&quot;:true &#125; EOF ç„¶åé‡å¯ Docker æœåŠ¡ï¼š systemctl restart docker æ–‡ä»¶ç®¡ç†å¼ºçƒˆå»ºè®®ä¸“é—¨ç»™ Docker çš„æ•°æ®ã€é…ç½®æ–‡ä»¶æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œ mkdir -p data&#x2F;docker_data å¸¸ç”¨æŒ‡ä»¤ï¼š æŸ¥çœ‹ Docker å®‰è£…ç‰ˆæœ¬ç­‰ä¿¡æ¯ docker version å¯åŠ¨ Docker æœåŠ¡ systemctl start docker æŸ¥çœ‹ Docker è¿è¡ŒçŠ¶æ€ systemctl status docker å°† Docker æœåŠ¡åŠ å…¥å¼€æœºè‡ªå¯åŠ¨ systemctl enable docker Docker é¡¹ç›®å¸è½½ï¼ˆåŒ…æ‹¬å¸è½½ Dockerã€docker-composeï¼‰docker å‘½ä»¤æ­å»ºçš„å¸¸ç”¨å¸è½½æ–¹æ³•docker ps docker stop å®¹å™¨åå­— cd ~ docker rm -f å®¹å™¨åå­— rm -rf æ˜ å°„å‡ºæ¥çš„è·¯å¾„ docker-compose æ­å»ºçš„å¸è½½æ–¹æ³•cd &#x2F;root&#x2F;data&#x2F;docker_data&#x2F;xxx docker-compose down cd ~ rm -rf &#x2F;root&#x2F;data&#x2F;docker_data&#x2F;xxx # rm -rf æ˜ å°„å‡ºæ¥çš„è·¯å¾„ å¸è½½ docker æœ¬èº«yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-selinux \\ docker-engine-selinux \\ docker-engine \\ docker-ce sudo rm -rf &#x2F;var&#x2F;lib&#x2F;docker sudo rm -rf &#x2F;var&#x2F;lib&#x2F;containerd å¸è½½ docker-composecd &#x2F;usr&#x2F;local&#x2F;bin&#x2F; rm -rf docker-compose 3.é˜²ç«å¢™CentOS å…³é—­é˜²ç«å¢™systemctl start supervisord systemctl disable firewalld systemctl stop firewalld 4.å®‰è£…å®å¡”å›½é™…ç‰ˆ aapanelå®å¡”æ€»æ˜¯ç™»å½•ä¸ä¸Šå»äºæ˜¯å°±æ¢æˆäº†dibianç³»ç»Ÿï¼Œä»æ–°å¼€å§‹ Debian : wget -O install.sh http:&#x2F;&#x2F;www.aapanel.com&#x2F;script&#x2F;install-ubuntu_6.0_en.sh &amp;&amp; bash install.sh forum aaPanel Internet Address: http://47.93.26.115:7800/7417c54faaPanel Internal Address: http://172.25.138.127:7800/7417c54 é™„ä¸Šç›¸å…³æ•™ç¨‹ï¼šå®å¡”é¢æ¿ 7.8 æ— ç¼è½¬ä¸ºå®å¡”å›½é™…ç‰ˆ aapanelï¼Œé™„å®å¡” 7.8 é™çº§ä¸ºå®å¡” 7.7 5.å®‰è£…alist æ™®é€šç‰ˆ docker run -d --restart&#x3D;always -v &#x2F;root&#x2F;data&#x2F;docker_data&#x2F;alist:&#x2F;opt&#x2F;alist&#x2F;data -p 5244:5244 --name&#x3D;&quot;alist&quot; xhofe&#x2F;alist:latest é¢„è£…äº†aria2ç‰ˆ docker run -d --restart=always -v /root/data/docker_data/alist:/opt/alist/data -p 5244:5244 -e PUID=0 -e PGID=0 -e UMASK=022 --name=\"alist\" xhofe/alist-aria2:latest æŸ¥çœ‹å¯†ç  docker logs alist 2f6e1555-20e5-492d-9e26-5e4ce90a0a45.id.repl.co 5.å®‰è£…MySql1.æ‹‰å–é•œåƒ sudo docker pull mysql:8.0.23 2.å®‰è£… sudo docker run -p 3306:3306 --name mysql8 \\ --restart unless-stopped \\ -v /root/data/docker_data/mysql/mysql-files:/var/lib/mysql-files \\ -v /root/data/docker_data/mysql/conf:/etc/mysql \\ -v /root/data/docker_data/mysql/logs:/var/log/mysql \\ -v /root/data/docker_data/mysql/data:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=666666 \\ -d mysql:8.0.23 3.è¿›å…¥å®¹å™¨å†…éƒ¨ä¿®æ”¹rootå…è®¸è¿œç¨‹ç™»å½•ã€‚ è¿›å…¥å®¹å™¨å†…éƒ¨ docker exec -it mysql8 bash ç™»å½•mysqlï¼Œå¹¶ä¸€æ¬¡æ‰§è¡Œä¸‹åˆ—å‘½ä»¤ï¼Œå…è®¸è¿œç¨‹è®¿é—® mysql -uroot -p use mysql; alter user 'root'@'%' identified with mysql_native_password by 'xxxx' flush privileges; select host,user,plugin,authentication_string from mysql.user 6.å®‰è£…redis1.ä¸€èˆ¬éœ€è¦çš„é…ç½®æ–‡ä»¶ bind 127.0.0.1 #é™åˆ¶redisåªèƒ½æœ¬åœ°è®¿é—®ï¼Œè‹¥éœ€è¦å…¶ä»–ipåœ°å€è®¿é—®éœ€è¦æ³¨é‡Š protected-mode yes #æ˜¯å¦å¼€å¯ä¿æŠ¤æ¨¡å¼ï¼Œé»˜è®¤å€¼ä¸ºyesï¼Œå¼€å¯åé™åˆ¶ä¸ºæœ¬åœ°è®¿é—®ï¼Œä¿®æ”¹ä¸ºno daemonize no #é»˜è®¤noï¼Œä¿®æ”¹ä¸ºyesä¼šä½¿dockerä½¿ç”¨é…ç½®æ–‡ä»¶æ–¹å¼å¯åŠ¨rediså¤±è´¥ï¼Œyesï¼šä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼å¯åŠ¨ï¼Œå¯åå°è¿è¡Œï¼Œé™¤ékillè¿›ç¨‹ requirepass 666666 #rediså¯†ç  appendonly yes #é»˜è®¤yesï¼Œå¼€å¯AOFæ¨¡å¼æŒä¹…åŒ– databases 16 #æ•°æ®åº“ä¸ªæ•° dir ./ #redisæ•°æ®åº“å­˜æ”¾æ–‡ä»¶å¤¹ åˆ›å»ºå°†é…ç½®æ–‡ä»¶æ”¹ä¸ºredis.conf #bind 127.0.0.1 protected-mode no daemonize no requirepass 666666 appendonly no databases 16 dir ./ 2.æ‹‰å–é•œåƒ docker pull redis 3.ä»¥é…ç½®æ–‡ä»¶å¯åŠ¨ docker run -p 6379:6379 --name redis -v /root/data/docker_data/redis/redis.conf:/etc/redis/redis.conf -v /root/data/docker_data/redis/data:/data -d redis redis-server /etc/redis/redis.conf --appendonly yes 4.ä¸€äº›å‘½ä»¤ docker exec -it redis bash #è¿›å…¥å®¹å™¨å†…éƒ¨ docker exec -ti redis redis-cli #æ‰§è¡Œå®¹å™¨å†…çš„redis auth xxx #ç™»å½• 7.å®‰è£…memosdocker run -d --name memos -p 5230:5230 -v &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;memos&#x2F;:&#x2F;var&#x2F;opt&#x2F;memos ghcr.io&#x2F;usememos&#x2F;memos:latest 8.å®‰è£… nginx-proxy-manager æ–°å»ºdocker-compose.ymlæ–‡ä»¶ vi docker-compose.yml version: &quot;3&quot; services: app: image: &#39;jc21&#x2F;nginx-proxy-manager:latest&#39; restart: unless-stopped ports: - &#39;80:80&#39; - &#39;443:443&#39; - &#39;81:81&#39; volumes: - &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;ng&#x2F;data:&#x2F;data - &#x2F;home&#x2F;ehzyil&#x2F;data&#x2F;docker_data&#x2F;ng&#x2F;letsencrypt:&#x2F;etc&#x2F;letsencrypt å¯åŠ¨å®¹å™¨ docker-compose up -d åœ¨ç¡®ä¿äº‘æœåŠ¡å™¨é˜²ç«å¢™å·²ç»æ”¾è¡Œ80ã€81å’Œ443ç«¯å£åå³å¯è®¿é—®æœåŠ¡å™¨ip:81 è¿›å…¥ngingx_proxy_managerçš„webç®¡ç†ç•Œé¢ã€‚é»˜è®¤å¯†ç ä¸ºï¼š Email: admin@example.com Password: changeme 9.å®‰è£…rustdeskversion: &#39;3&#39; networks: rustdesk-net: external: false services: hbbs: container_name: hbbs ports: - 21115:21115 - 21116:21116 - 21116:21116&#x2F;udp - 21118:21118 image: rustdesk&#x2F;rustdesk-server:latest command: hbbs -r 520217.xyz:21117 volumes: - .&#x2F;rustdesk:&#x2F;root networks: - rustdesk-net depends_on: - hbbr restart: unless-stopped hbbr: container_name: hbbr ports: - 21117:21117 - 21119:21119 image: rustdesk&#x2F;rustdesk-server:latest command: hbbr volumes: - .&#x2F;rustdesk:&#x2F;root networks: - rustdesk-net restart: unless-stopped æ‰“å¼€é˜²ç«å¢™çš„ç«¯å£ 21115ã€21116ã€21117ã€21118ã€21119 é»˜è®¤æƒ…å†µä¸‹ï¼Œhbbs ç›‘å¬ 21115(tcp), 21116(tcp/udp), 21118(tcp)ï¼Œhbbr ç›‘å¬ 21117(tcp), 21119(tcp)ã€‚ åŠ¡å¿…åœ¨é˜²ç«å¢™å¼€å¯è¿™å‡ ä¸ªç«¯å£ï¼Œ **è¯·æ³¨æ„ 21116 åŒæ—¶è¦å¼€å¯ TCP å’Œ UDP**ã€‚ å…¶ä¸­ 21115 æ˜¯ hbbs ç”¨ä½œ NAT ç±»å‹æµ‹è¯•ï¼Œ21116/UDP æ˜¯ hbbs ç”¨ä½œ ID æ³¨å†Œä¸å¿ƒè·³æœåŠ¡ï¼Œ21116/TCP æ˜¯ hbbs ç”¨ä½œ TCP æ‰“æ´ä¸è¿æ¥æœåŠ¡ï¼Œ21117 æ˜¯ hbbr ç”¨ä½œä¸­ç»§æœåŠ¡ï¼Œ21118 å’Œ 21119 æ˜¯ä¸ºäº†æ”¯æŒç½‘é¡µå®¢æˆ·ç«¯ã€‚ å¦‚æœæ‚¨ä¸éœ€è¦ç½‘é¡µå®¢æˆ·ç«¯ï¼ˆ21118ï¼Œ21119ï¼‰æ”¯æŒï¼Œå¯¹åº”ç«¯å£å¯ä»¥ä¸å¼€ã€‚ å¸è½½ cd &#x2F;data # è¿›å…¥docker-composeæ‰€åœ¨çš„æ–‡ä»¶å¤¹ docker compose down # åœæ­¢å®¹å™¨ï¼Œæ­¤æ—¶ä¸ä¼šåˆ é™¤æ˜ å°„åˆ°æœ¬åœ°çš„æ•°æ® rm -rf &#x2F;data # å®Œå…¨åˆ é™¤æ˜ å°„åˆ°æœ¬åœ°çš„æ•°æ® åŠ å¯† version: &#39;3&#39; networks: rustdesk-net: external: false services: hbbs: container_name: hbbs ports: - 21115:21115 - 21116:21116 - 21116:21116&#x2F;udp - 21118:21118 image: rustdesk&#x2F;rustdesk-server:latest command: hbbs -r 520217.xyz:21117 -k volumes: - .&#x2F;rustdesk:&#x2F;root networks: - rustdesk-net depends_on: - hbbr restart: unless-stopped hbbr: container_name: hbbr ports: - 21117:21117 - 21119:21119 image: rustdesk&#x2F;rustdesk-server:latest command: hbbr -k volumes: - .&#x2F;rustdesk:&#x2F;root networks: - rustdesk-net restart: unless-stopped åŠ å¯†åæ— æ³•ä½¿ç”¨ é‡æ–°å›å¤","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://blog.ehzyil.xyz/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"}],"author":"ehzyil"},{"title":"è‡ªå»ºrssèšåˆé˜…è¯»å·¥å…·","slug":"2023/è‡ªå»ºrssèšåˆé˜…è¯»å·¥å…·","date":"2023-10-22T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/22/2023/è‡ªå»ºrssèšåˆé˜…è¯»å·¥å…·/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/22/2023/%E8%87%AA%E5%BB%BArss%E8%81%9A%E5%90%88%E9%98%85%E8%AF%BB%E5%B7%A5%E5%85%B7/","excerpt":"è‡ªå»ºrssèšåˆé˜…è¯»å·¥å…·ï¼Œæå…¶è½»é‡åŒ–é…åˆRenderâš¡ï¸ä¸€é”®éƒ¨ç½²ï¼Œè¿˜èƒ½ç»‘å®šè‡ªå®šä¹‰åŸŸå","text":"è‡ªå»ºrssèšåˆé˜…è¯»å·¥å…·ï¼Œæå…¶è½»é‡åŒ–é…åˆRenderâš¡ï¸ä¸€é”®éƒ¨ç½²ï¼Œè¿˜èƒ½ç»‘å®šè‡ªå®šä¹‰åŸŸå å‰ç½®å‡†å¤‡1.ä¸€ä¸ªRenderè´¦å·Renderæ˜¯ä¸€æ¬¾å¯ä»¥ç™½å«–çš„Paasæä¾›å•†ï¼Œä¸éœ€è¦ç»‘å¡ä»€ä¹ˆçš„ï¼Œå¯ä»¥ç™½å«–ğŸ˜„ğŸ˜„ğŸ˜„ã€‚ 2.ä¸€ä¸ªGitHubè´¦å· GitHubæ˜¯ä¸€ä¸ªå¯ä»¥ä¿å­˜è‡ªå·±ä»£ç çš„åœ°æ–¹ï¼Œä»£ç æ‰˜ç®¡ã€‚ 3.ä¸€ä¸ªæ‰˜ç®¡äº†åŸŸåçš„CloudFlare è´¦å·(å¯é€‰) CloudFlare æ˜¯ä¸€å®¶å…¨çƒçŸ¥åçš„CDNæœåŠ¡å•†ï¼Œå¹¶ä¸”æä¾›äº†å…è´¹çš„ CDN å¥—é¤ï¼Œè¿˜ä¸é™æµé‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨ä¸éœ€è¦èŠ±ä¸€åˆ†é’±å°±èƒ½ä½¿ç”¨å®ƒçš„ CDN æœåŠ¡ã€‚ å¼€å§‹æ­å»ºForkæºä»£ç åˆ°è‡ªå·±çš„ä»“åº“é¡¹ç›®åå­—ï¼šrss-reader https://github.com/srcrs/rss-reader è¿›å…¥ä¸Šæ–¹é“¾æ¥è¿›å…¥è¯¥æºç çš„Githubä»“åº“ Forkåˆ°è‡ªå·±ä»“åº“ã€‚ å› ä¸ºå½“å‰çš„ä»£ç é…ç½®å®Œå…¨æ˜¯åŸä½œè€…çš„ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®æˆè‡ªå·±å–œæ¬¢çš„rssã€‚å…·ä½“å¦‚ä½•ä¿®æ”¹README.mdä¸­éƒ½æœ‰æ•™ç¨‹è‡ªå·±é…ç½®ã€‚ ä¿®æ”¹æ–¹å¼æœ‰ä¸¤ç§ï¼Œå¯ä»¥è‡ªå·±æŠŠä»£ç æ‹‰åˆ°æœ¬åœ°ä¿®æ”¹å®Œå†commitæˆ–è€…ç›´æ¥åœ¨è‡ªå·±çš„ä»£ç åº“ä¿®æ”¹ã€‚ ä½¿ç”¨Renderè¿›è¡Œä¸€é”®éƒ¨ç½²è¿›å…¥Renderçš„Dashboardç‚¹å‡»Newï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ç‚¹å‡»Web Service ç»‘å®šè‡ªå·±çš„Githubåæ“ä½œå¦‚ä¸‹ï¼š æ‰¾åˆ°ä½ è¦éƒ¨ç½²çš„åˆ†æ”¯ï¼š å¡«å†™éƒ¨ç½²çš„é¡¹ç›®åç§°å’Œéƒ¨ç½²æ–¹å¼ï¼ŒDocker é€‰æ‹©å®ä¾‹ç±»å‹ï¼Œæ–¹ç„¶æ˜¯Freeç™½å«–äº† ç‚¹å‡»æœ€ä¸‹æ–¹çš„Create Web Serviceç­‰å¾…éƒ¨ç½²å®Œæˆå³å¯. éƒ¨ç½²å®Œæˆåå¯ä»¥ç‚¹å‡»è“è‰²è¿æ¥å³å¯è®¿é—®ã€‚ è‡³æ­¤è¯¥é¡¹ç›®æ­å»ºå®Œæˆã€‚ è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰Renderå…è´¹æä¾›éƒ¨ç½²å¥½çš„é¡¹ç›®çš„åŸŸåğŸŒ¹ï¼Œçœ‹ç€å¤ªé•¿ä¸å¥½è®°æˆ–è€…ä¸å–œæ¬¢å¯ä»¥æ›´æ”¹æˆè‡ªå·±çš„åŸŸåã€‚ è¿›å…¥Renderè¿›è¡Œä»¥ä¸‹æ“ä½œ ç„¶åç™»å½•CloudFlareå»ä½ æ‰€è¦ç»‘å®šåŸŸåçš„ç•Œé¢è¿›è¡Œä»¥ä¸‹æ“ä½œï¼Œçº¢è‰²æ¡†é‡Œçš„å†…å®¹ç”±ä¸Šå›¾å¤åˆ¶ã€‚ çº¢è‰²æ¡†é‡Œçš„Typeæ”¹æˆCNAMEï¼ˆæ‡’å¾—ç¼–è¾‘å›¾ç‰‡äº†ï¼‰ ç„¶åå›åˆ°Renderï¼Œç‚¹å‡»Verify æ˜¾ç¤ºå¦‚ä¸‹ï¼ŒåŸŸåå°±ç»‘å®šæˆåŠŸäº† ç°åœ¨å°±å¯ä»¥ä»è‡ªå·±é…ç½®çš„åŸŸåè®¿é—®äº†ã€‚","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"rss","slug":"rss","permalink":"https://blog.ehzyil.xyz/tags/rss/"},{"name":"render","slug":"render","permalink":"https://blog.ehzyil.xyz/tags/render/"}],"author":"ehzyil"},{"title":"é€šè¿‡ BotFather åˆ›å»º Telegram æœºå™¨äºº","slug":"2023/é€šè¿‡ BotFather åˆ›å»º Telegram æœºå™¨äºº","date":"2023-10-22T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/22/2023/é€šè¿‡ BotFather åˆ›å»º Telegram æœºå™¨äºº/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/22/2023/%E9%80%9A%E8%BF%87%20BotFather%20%E5%88%9B%E5%BB%BA%20Telegram%20%E6%9C%BA%E5%99%A8%E4%BA%BA/","excerpt":"","text":"åœ¨æˆ‘ä»¬ä½¿ç”¨ Telegram çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªæœºå™¨äººã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±å¾—ä» @BotFather å¤„è¿›è¡Œç”³è¯·ã€‚åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘æ¥å’Œå¤§å®¶ä¸€èµ·é€šè¿‡ BotFather åœ¨ Telegram ä¸Šåˆ›å»ºä¸€ä¸ªå±äºè‡ªå·±çš„æœºå™¨äººã€‚ å‡†å¤‡ææ–™ Telegram è´¦æˆ· åˆ›å»ºæ­¥éª¤ æ‰“å¼€ Telegramï¼Œæœç´¢ BotFather ï¼ˆä¸€å®šè¦æ‰¾åˆ°æœ‰å®˜æ–¹è®¤è¯çš„ Botï¼‰ è¾“å…¥ /newbot å‘½ä»¤ï¼Œç„¶åè¾“å…¥æœºå™¨äººåç§°ã€ç”¨æˆ·åï¼ˆä¸€å®šè¦ä»¥ bot æˆ– _bot ç»“å°¾ï¼‰ ç„¶åä½ ä¼šå¾—åˆ°ä¸€ä¸ª Bot Tokenï¼Œè¿™æ ·ä¸€ä¸ª Telegram Bot å°±åˆ›å»ºæˆåŠŸäº†","categories":[{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"}],"tags":[{"name":"Telegram","slug":"Telegram","permalink":"https://blog.ehzyil.xyz/tags/Telegram/"}],"author":"ehzyil"},{"title":"JVMå­¦ä¹ ç¬”è®°","slug":"2023/JVMå­¦ä¹ ç¬”è®°","date":"2023-10-19T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/19/2023/JVMå­¦ä¹ ç¬”è®°/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/19/2023/JVM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","excerpt":"","text":"åˆå§‹JVMä»€ä¹ˆæ˜¯JVMJVM å…¨ç§°æ˜¯ Java Virtual Machineï¼Œä¸­æ–‡è¯‘å Javaè™šæ‹Ÿæœºã€‚ JVM æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨è®¡ç®—æœºä¸Šçš„ç¨‹åºï¼Œä»–çš„èŒè´£æ˜¯è¿è¡ŒJavaå­—èŠ‚ç æ–‡ä»¶ã€‚ JVM çš„åŠŸèƒ½è§£é‡Šå’Œè¿è¡Œ å¯¹å­—èŠ‚ç æ–‡ä»¶ä¸­çš„æŒ‡ä»¤å®æ—¶çš„è§£é‡Šæˆæœºå™¨ç è®©è®¡ç®—æœºæ‰§è¡Œ å†…å­˜ç®¡ç† è‡ªåŠ¨ä¸ºå¯¹è±¡ã€æ–¹æ³•ç­‰åˆ†é…å†…å­˜ è‡ªåŠ¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå›æ”¶ä¸å†ä½¿ç”¨çš„å¯¹è±¡ å³æ—¶ç¼–è¯‘ â€”â€”ä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒè·¨å¹³å°ç‰¹æ€§ã€‚ å¯¹çƒ­ç‚¹ä»£ç è¿›è¡Œä¼˜åŒ–æå‡æ‰§è¡Œæ•ˆç‡ JVMæä¾›äº†å³æ—¶ç¼–è¯‘ï¼ˆJust-In-Time ç®€ç§°JIT) è¿›è¡Œæ€§èƒ½çš„ä¼˜åŒ–ï¼Œæœ€ç»ˆèƒ½è¾¾åˆ°æ¥è¿‘Cã€C++è¯­è¨€çš„è¿è¡Œæ€§èƒ½ ç”šè‡³åœ¨ç‰¹å®šåœºæ™¯ä¸‹å®ç°è¶…è¶Šã€‚ å¸¸è§çš„JVMå¸¸è§çš„JVMæœ‰HotSpotã€GraalVMã€OpenJ9ç­‰ï¼Œå¦å¤–DragonWellé¾™äº•JDKä¹Ÿ æä¾›äº†ä¸€æ¬¾åŠŸèƒ½å¢å¼ºç‰ˆçš„JVMã€‚å…¶ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„æ˜¯HotSpotè™šæ‹Ÿæœºã€‚ å¸¸è§çš„JVM: Javaè™šæ‹Ÿæœºè§„èŒƒ ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹ç”±Oracleåˆ¶å®šï¼Œå†…å®¹ä¸»è¦åŒ…å«äº†Javaè™šæ‹Ÿæœºåœ¨è®¾è®¡å’Œå®ç°æ—¶éœ€è¦éµå®ˆçš„è§„èŒƒï¼Œä¸» è¦åŒ…å«classå­—èŠ‚ç æ–‡ä»¶çš„å®šä¹‰ã€ç±»å’Œæ¥å£çš„åŠ è½½å’Œåˆå§‹åŒ–ã€æŒ‡ä»¤é›†ç­‰å†…å®¹ã€‚ ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹æ˜¯å¯¹è™šæ‹Ÿæœºè®¾è®¡çš„è¦æ±‚ï¼Œè€Œä¸æ˜¯å¯¹Javaè®¾è®¡çš„è¦æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´è™šæ‹Ÿæœºå¯ä»¥è¿è¡Œåœ¨ å…¶ä»–çš„è¯­è¨€æ¯”å¦‚Groovyã€Scalaç”Ÿæˆçš„classå­—èŠ‚ç æ–‡ä»¶ä¹‹ä¸Šã€‚ å®˜ç½‘åœ°å€ï¼šhttps://docs.oracle.com/javase/specs/index.htm è¯¦è§£å­—èŠ‚ç æ–‡ä»¶Javaå†…å­˜åŒºåŸŸåƒåœ¾å›æ”¶","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"},{"name":"JVM","slug":"JVM","permalink":"https://blog.ehzyil.xyz/tags/JVM/"}],"author":"ehzyil"},{"title":"LeetCodeåˆ·é¢˜ç¬”è®°","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•/LeetCodeåˆ·é¢˜ç¬”è®°","date":"2023-10-19T00:00:00.000Z","updated":"2024-01-30T06:30:58.147Z","comments":true,"path":"2023/10/19/æ•°æ®ç»“æ„ä¸ç®—æ³•/LeetCodeåˆ·é¢˜ç¬”è®°/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/19/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/LeetCode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/","excerpt":"","text":"1ã€ä¸¤æ•°ä¹‹å’Œç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡º å’Œä¸ºç›®æ ‡å€¼ target çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚ ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°ã€‚ ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šnums &#x3D; [2,7,11,15], target &#x3D; 9 è¾“å‡ºï¼š[0,1] è§£é‡Šï¼šå› ä¸º nums[0] + nums[1] &#x3D;&#x3D; 9 ï¼Œè¿”å› [0, 1] ã€‚ ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šnums &#x3D; [3,2,4], target &#x3D; 6 è¾“å‡ºï¼š[1,2] ç¤ºä¾‹ 3ï¼š è¾“å…¥ï¼šnums &#x3D; [3,3], target &#x3D; 6 è¾“å‡ºï¼š[0,1] æç¤ºï¼š 2 &lt;= nums.length &lt;= 104 -109 &lt;= nums[i] &lt;= 109 -109 &lt;= target &lt;= 109 åªä¼šå­˜åœ¨ä¸€ä¸ªæœ‰æ•ˆç­”æ¡ˆ è§£æ³•ä¸€ â€‹ åŒé‡forå¾ªç¯éå†è·å–ä¸¤ä¸ªå…ƒç´ åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ ç›¸åŠ æ˜¯å¦æ»¡è¶³ç›®æ ‡å€¼ï¼Œè¿”å›ç´¢å¼•å€¼ã€‚ class Solution &#123; public int[] twoSum(int[] nums, int target) &#123; // åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º2çš„æ•´å‹æ•°ç»„ï¼Œç”¨äºå­˜å‚¨ç»“æœ int[] arr = new int[2]; // éå†ç»™å®šçš„numsæ•°ç»„ for (int i = 0; i &lt; nums.length; i++) &#123; // å†…å±‚å¾ªç¯éå†ç´¢å¼•èŒƒå›´ä¸º0åˆ°iä¹‹é—´çš„å…ƒç´  for (int j = 0; j &lt; i; j++) &#123; // å¦‚æœå½“å‰å…ƒç´ nums[i]å’Œnums[j]çš„å’Œç­‰äºç›®æ ‡å€¼target if (nums[i] + nums[j] == target) &#123; // å°†å½“å‰çš„iå’Œjä½œä¸ºç»“æœå­˜å…¥æ•°ç»„arrä¸­ arr[0] = i; arr[1] = j; &#125; &#125; &#125; return arr; &#125; &#125; æ—¶é—´å¤æ‚åº¦ä¸ºO($n^{2}$) è§£æ³•äºŒ å¾ªç¯éå†æ•°ç»„å…ƒç´ ï¼Œè®¡ç®—å‡ºtargetå‡å»arr[i]çš„å€¼å¦ä¸€ä¸ªæ•°çš„å€¼å°†å…¶å­˜å…¥mapï¼Œæ¯æ¬¡å¾ªç¯åˆ¤æ–­mapä¸­æ˜¯å¦æœ‰å¯ä»¥æ»¡è¶³æ¡ä»¶çš„å€¼ï¼Œè‹¥æœ‰å°±è¿”å›ï¼Œå¦åˆ™ç»§ç»­å¾ªç¯ã€‚ å¦‚ä½•æ„å»ºmapï¼Ÿ mapå¸¸ç”¨äºå­˜å‚¨é”®å€¼å¯¹ï¼Œå°±æœ¬é¢˜è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•°ç»„å…ƒç´ çš„å€¼å½“åšé”®ï¼Œç´¢å¼•å½“åšå€¼ã€‚ class Solution &#123; public int[] twoSum(int[] nums, int target) &#123; //mapç”¨ä¸å­˜å‚¨å€¼-ç´¢å¼• è‹¥target-nums[i]çš„å€¼(mapçš„é”®åœ¨å­˜åœ¨è¯´æ˜é”™åœ¨å¦ä¸€ä¸ªå€¼å¯ä»¥å‡‘æˆtarget) // è¿™æ ·åªéœ€è¦ä¸€ä¸ªforå¾ªç¯ HashMap&lt;Integer, Integer> map = new HashMap&lt;Integer, Integer>(); int[] arr = new int[2]; for (int i = 0; i &lt; nums.length; i++) &#123; // åˆ¤æ–­HashMapä¸­æ˜¯å¦å­˜åœ¨é”®ä¸ºtarget - nums[i]çš„å…ƒç´  if (map.containsKey(target - nums[i])) &#123; // å¦‚æœå­˜åœ¨ï¼Œåˆ™å°†å½“å‰ç´¢å¼•iå’ŒHashMapä¸­å¯¹åº”çš„å€¼ä½œä¸ºç»“æœå­˜å…¥æ•°ç»„arrä¸­ arr[0] = i; arr[1] = map.get(target - nums[i]); // è·³å‡ºå¾ªç¯ï¼Œç»“æŸæŸ¥æ‰¾ break; &#125; // å°†å½“å‰å…ƒç´ nums[i]ä½œä¸ºé”®ï¼Œå°†å½“å‰ç´¢å¼•iä½œä¸ºå€¼ï¼Œå­˜å…¥HashMapä¸­ map.put(nums[i], i); &#125; return arr; &#125; &#125; è§£æ³•ä¸‰ â€‹ ç°å°†æ•°ç»„æ’åº,ä½¿ç”¨äºŒåˆ†æ³•æ€æƒ³å¯»æ‰¾ä¸¤è¾¹ç•ŒæŒ‡å‘å…ƒç´ å€¼çš„å’Œäºtargetæ¯”è¾ƒï¼Œé€šè¿‡ä¸æ–­ç¼©å°è¾¹ç•Œæ¥å¯»æ‰¾ç›®æ ‡å€¼ï¼Œ class Solution &#123; public int[] twoSum(int[] nums, int target) &#123; Arrays.sort(nums); int left = 0, right = nums.length - 1; int[] arr = new int[2]; while (left &lt; right) &#123; int sum = nums[left] + nums[right]; if (sum &lt; target) &#123; left++; &#125; else if (sum > target) &#123; right--; &#125; else if (sum == target) &#123; arr[0] = left; arr[1] = right; return arr; &#125; &#125; return new int[]&#123;&#125;; &#125; &#125; 2ã€ä¸¤æ•°ç›¸åŠ ç»™ä½ ä¸¤ä¸ª éç©º çš„é“¾è¡¨ï¼Œè¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å®ƒä»¬æ¯ä½æ•°å­—éƒ½æ˜¯æŒ‰ç…§ é€†åº çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨ ä¸€ä½ æ•°å­—ã€‚ è¯·ä½ å°†ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œå¹¶ä»¥ç›¸åŒå½¢å¼è¿”å›ä¸€ä¸ªè¡¨ç¤ºå’Œçš„é“¾è¡¨ã€‚ ä½ å¯ä»¥å‡è®¾é™¤äº†æ•°å­— 0 ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥ 0 å¼€å¤´ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šl1 &#x3D; [2,4,3], l2 &#x3D; [5,6,4] è¾“å‡ºï¼š[7,0,8] è§£é‡Šï¼š342 + 465 &#x3D; 807. ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šl1 &#x3D; [0], l2 &#x3D; [0] è¾“å‡ºï¼š[0] ç¤ºä¾‹ 3ï¼š è¾“å…¥ï¼šl1 &#x3D; [9,9,9,9,9,9,9], l2 &#x3D; [9,9,9,9] è¾“å‡ºï¼š[8,9,9,9,0,0,0,1] æç¤ºï¼š æ¯ä¸ªé“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°åœ¨èŒƒå›´ [1, 100] å†… 0 &lt;= Node.val &lt;= 9 é¢˜ç›®æ•°æ®ä¿è¯åˆ—è¡¨è¡¨ç¤ºçš„æ•°å­—ä¸å«å‰å¯¼é›¶ è§£æ³•ä¸€ class Solution &#123; public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123; ListNode p1 = l1, p2 = l2; //åˆ›å»ºä¸€ä¸ªå¤´ç»“ç‚¹æ¥ä½œä¸ºå¤´èŠ‚ç‚¹ å¯ä»¥é¿å…å¤„ç†åˆå§‹çš„ç©ºæŒ‡é’ˆæƒ…å†µ ListNode dummy = new ListNode(-1); //pä½œä¸ºæŒ‡é’ˆç§»åŠ¨ ç”¨æ¥æ·»åŠ å…ƒç´  ListNode p = dummy; //å­˜æ”¾è¿›ä½çš„æ•° int carry = 0; //å½“æœ‰é“¾è¡¨ä¸ä¸ºç©ºæˆ–è€…æœ‰è¿›ä½çš„æ•°ä½åŠ å…¥é“¾è¡¨ while (p1 != null || p2 != null || carry > 0) &#123; int sum = carry; //åŠ ä¸Šp1çš„å€¼å¹¶è®©p1æŒ‡é’ˆåç§» if (p1 != null) &#123; sum += p1.val; p1 = p1.next; &#125; //åŠ ä¸Šp2çš„å€¼å¹¶è®©p1æŒ‡é’ˆåç§» if (p2 != null) &#123; sum += p2.val; p2 = p2.next; &#125; //æ¨¡10 å¾—åˆ°è¿›ä½çš„æ•° carry = sum / 10; //é™¤10 å¾—åˆ°ä½™æ•° sum = sum % 10; //å°†ä½™æ•°åŠ å…¥é“¾è¡¨ é“¾è¡¨æŒ‡é’ˆåç§» p.next = new ListNode(sum); p = p.next; &#125; return dummy.next; &#125; &#125; 3ã€æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦ã€‚ ç¤ºä¾‹ 1: è¾“å…¥: s &#x3D; &quot;abcabcbb&quot; è¾“å‡º: 3 è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;abc&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ ç¤ºä¾‹ 2: è¾“å…¥: s &#x3D; &quot;bbbbb&quot; è¾“å‡º: 1 è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;b&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚ ç¤ºä¾‹ 3: è¾“å…¥: s &#x3D; &quot;pwwkew&quot; è¾“å‡º: 3 è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;wke&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚ è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ&quot;pwke&quot; æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚ æç¤ºï¼š 0 &lt;= s.length &lt;= 5 * 104 s ç”±è‹±æ–‡å­—æ¯ã€æ•°å­—ã€ç¬¦å·å’Œç©ºæ ¼ç»„æˆ è§£æ³•ä¸€ public static int lengthOfLongestSubstring(String s) &#123; int res = 0; // ç”¨äºå­˜å‚¨æœ€å¤§é•¿åº¦ for (int i = 0; i &lt; s.length(); i++) &#123; // å¤–å±‚å¾ªç¯ï¼Œéå†å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ boolean[] book = new boolean[300]; // ç”¨äºè®°å½•å­—ç¬¦æ˜¯å¦å‡ºç°è¿‡çš„æ•°ç»„ for (int j = i; j > 0; j--) &#123; // å†…å±‚å¾ªç¯ï¼Œä»å½“å‰å­—ç¬¦å¼€å§‹å‘å‰éå† if (book[s.charAt(j)]) &#123; // å¦‚æœå½“å‰å­—ç¬¦å·²ç»å‡ºç°è¿‡ï¼Œè¯´æ˜å·²ç»æ‰¾åˆ°ä»¥å½“å‰å­—ç¬¦ä¸ºç»“å°¾çš„æœ€é•¿å­ä¸² break; // ç»“æŸå†…å±‚å¾ªç¯ &#125; book[s.charAt(j)] = true; // å°†å½“å‰å­—ç¬¦æ ‡è®°ä¸ºå·²å‡ºç° res = Math.max(res, i - j + 1); &#125; &#125; return res; // è¿”å›æœ€å¤§é•¿åº¦ &#125; å†…å±‚forå¾ªç¯é€’å‡çš„åŸå› : ä¸ºäº†æ‰¾åˆ°ä»¥å½“å‰å­—ç¬¦ä¸ºç»“å°¾çš„æœ€é•¿å­ä¸²ã€‚å¦‚æœå†…å±‚forå¾ªç¯é€’å¢ï¼Œé‚£ä¹ˆæ¯æ¬¡å¾ªç¯éƒ½æ˜¯ä»å­—ç¬¦ä¸²çš„å¼€å¤´å¼€å§‹ï¼Œè¿™æ ·å°±æ— æ³•æ‰¾åˆ°ä»¥å½“å‰å­—ç¬¦ä¸ºç»“å°¾çš„æœ€é•¿å­ä¸²ã€‚è€Œé€’å‡çš„è¯ï¼Œæ¯æ¬¡å¾ªç¯éƒ½æ˜¯ä»å½“å‰å­—ç¬¦å¼€å§‹ï¼Œé€æ¸å‘å‰éå†ï¼Œå¯ä»¥æ‰¾åˆ°ä»¥å½“å‰å­—ç¬¦ä¸ºç»“å°¾çš„æœ€é•¿å­ä¸²ã€‚ ä¸‹åˆ—ä»£ç çš„æ„æ€æ˜¯è·å–å­—ç¬¦ä¸²jç´¢å¼•ä½ç½®çš„å€¼ï¼Œå› ä¸ºæ˜¯charç±»å‹å½“å°†å…¶æ”¾å…¥æ•°ç»„æ˜¯ä¼šè½¬æ¢å±‚intå‹æ¯”å¦‚ a(char)-&gt;99(int) book[s.charAt(j)] &#x3D; true; è§£æ³•äºŒ æˆ‘ä»¬çŸ¥é“ï¼Œé¢˜ç›®è¦æˆ‘ä»¬æ±‚è§£çš„æ˜¯ä¸€ä¸ªåŒºé—´ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘è®¾ç½®ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡å‘è¿™ä¸ªåŒºé—´çš„å¼€å¤´ï¼Œå¦å¤–ä¸€ä¸ªåˆ™æŒ‡å‘è¿™ä¸ªåŒºé—´çš„ç»“å°¾ã€‚æˆ‘ä»¬è®©å¤´æŒ‡é’ˆä¸åŠ¨ï¼Œå‘åæ‰©å±•å°¾æŒ‡é’ˆï¼Œç›´åˆ°é‡è§é‡å¤å…ƒç´  (è§ä¸‹å›¾) public static int lengthOfLongestSubstring(String s) &#123; int res = 0; // ç”¨äºå­˜å‚¨æœ€å¤§é•¿åº¦ Map&lt;Character, Integer> window = new HashMap&lt;>(); //iæ˜¯å·¦æŒ‡é’ˆï¼Œjæ˜¯å³æŒ‡é’ˆ for (int i = 0, j = 0; j &lt; s.length(); j++) &#123; //è‹¥s.charAt(j)å·²åœ¨windowä¸­åˆ™ç§»åŠ¨içš„å€¼åˆ°ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®çš„å³ä¾§ if (window.containsKey(s.charAt(j))) &#123; i = Math.max(i, window.get(s.charAt(j)) + 1); &#125; res = Math.max(res, j - i + 1); window.put(s.charAt(j), j); &#125; return res; // è¿”å›æœ€å¤§é•¿åº¦ &#125;","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://blog.ehzyil.xyz/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"https://blog.ehzyil.xyz/tags/Leetcode/"}],"author":"ehzyil"},{"title":"CentOSä¸‹çš„è½¯ä»¶","slug":"2023/CentOSä¸‹çš„è½¯ä»¶","date":"2023-10-17T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/17/2023/CentOSä¸‹çš„è½¯ä»¶/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/17/2023/CentOS%E4%B8%8B%E7%9A%84%E8%BD%AF%E4%BB%B6/","excerpt":"","text":"CentOSä¸‹MySQLMySQL8.0.27 å®‰è£…[root@localhost ~]# uname -m x86_64 [root@localhost ~]# cat &#x2F;etc&#x2F;redhat-release CentOS Linux release 7.9.2009 (Core) #è§£å‹ tar -zxvf mysql-8.0.27-1.el7.x86_64.rpm-bundle.tar tar -xvf mysql-8.0.27-1.el7.x86_64.rpm-bundle.tar\\ #å®‰è£…é¡ºåº rpm -ivh mysql-community-common-8.0.27-1.el7.x86_64.rpm rpm -ivh mysql-community-client-plugins-8.0.27-1.el7.x86_64.rpm rpm -ivh mysql-community-libs-8.0.27-1.el7.x86_64.rpm yum install openssl-devel -y rpm -ivh mysql-community-devel-8.0.27-1.el7.x86_64.rpm rpm -ivh mysql-community-libs-compat-8.0.27-1.el7.x86_64.rpm rpm -ivh mysql-community-client-8.0.27-1.el7.x86_64.rpm yum install net-tools yum install -y perl-Module-Install.noarch rpm -ivh mysql-community-server-8.0.27-1.el7.x86_64.rpm MySQL8.0ä¸»ä»å¤åˆ¶çš„é…ç½®&#x2F;&#x2F;ä¸»æœº CREATE USER &#39;ehzyil&#39;@&#39;%&#39; IDENTIFIED BY &#39;Li021712.&#39;; GRANT REPLICATION SLAVE ON *.* TO &#39;ehzyil&#39;@&#39;%&#39;; &#x2F;&#x2F;ä»æœº CHANGE REPLICATION SOURCE TO SOURCE_HOST&#x3D;&#39;192.168.154.141&#39;,SOURCE_PORT&#x3D;3306,SOURCE_USER&#x3D;&#39;ehzyil&#39;,SOURCE_PASSWORD&#x3D;&#39;Li021712.&#39;,SOURCE_LOG_FILE&#x3D;&#39;mysql-bin.000004&#39;,SOURCE_LOG_POS&#x3D;685; start slave; â€‹ è‹¥æŸ¥è¯¢slaveçŠ¶æ€ï¼Œå‡ºç°ä»¥ä¸‹æƒ…å†µ mysql&gt; show slave status\\G; *************************** 1. row *************************** Slave_IO_State: Connecting to source Master_Host: 192.168.154.141 Master_User: ehzyil Master_Port: 3306 Connect_Retry: 60 Master_Log_File: mysql-bin.000004 Read_Master_Log_Pos: 685 Relay_Log_File: localhost-relay-bin.000001 Relay_Log_Pos: 4 Relay_Master_Log_File: mysql-bin.000004 Slave_IO_Running: Connecting Slave_SQL_Running: Yes ... Last_IO_Errno: 2061 Last_IO_Error: error connecting to master &#39;ehzyil@192.168.154.141:3306&#39; - retry-time: 60 retries: 1 message: Authentication plugin &#39;caching_sha2_password&#39; reported error: Authentication requires secure connection. ... åˆ†ææŠ¥é”™ï¼Œåº”è¯¥æ˜¯è¿æ¥çš„ç”¨æˆ·é…ç½®æœ‰é—®é¢˜ã€‚ æ‰€ä»¥å»ä¸»åº“mysqlä¸ŠæŸ¥è¯¢å½“å‰ç”¨æˆ·ä¿¡æ¯ SELECT plugin FROM user where user &#x3D; â€˜ehzyilâ€™; åŸæ¥æ˜¯ä¸»åº“repluserçš„pluginæ˜¯caching_sha2_password å¯¼è‡´è¿æ¥ä¸ä¸Šï¼Œä¿®æ”¹ä¸ºmysql_native_passwordå³å¯è§£å†³ã€‚ ALTER USER â€˜ehzyilâ€˜@â€™%â€™ IDENTIFIED WITH mysql_native_password BY â€˜Li021712.â€™; mysql&gt; use mysql; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql&gt; SELECT plugin FROM &#96;user&#96; where user &#x3D; &#39;ehzyil&#39;; +-----------------------+ | plugin | +-----------------------+ | caching_sha2_password | +-----------------------+ 1 row in set (0.00 sec) mysql&gt; ALTER USER &#39;ehzyil&#39;@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;Li021712.&#39;; Query OK, 0 rows affected (0.00 sec) ä¿®æ”¹åï¼Œé‡æ–°é…ç½®ä»åº“binlogä½ç½®åé‡å¯çŠ¶æ€å±•ç¤ºå¦‚ä¸‹ï¼š Slave_IO_State: Waiting for source to send event Slave_IO_Running: Yes Slave_SQL_Running: Yes çœ‹åˆ°ä»¥ä¸Šä¸‰è¡Œé…ç½®ç›¸åŒï¼Œåˆ™ä¸»ä»è¿æ¥æˆåŠŸã€‚ MySQLæ¸…é™¤ä¸»ä»å¤åˆ¶å…³ç³»mysqlä¸»ä»å¤åˆ¶ä¸­ï¼Œéœ€è¦å°†ä¸»ä»å¤åˆ¶å…³ç³»æ¸…é™¤ï¼Œéœ€è¦å–æ¶ˆå…¶ä»åº“è§’è‰²ã€‚è¿™å¯é€šè¿‡æ‰§è¡ŒRESET SLAVE ALLæ¸…é™¤ä»åº“çš„åŒæ­¥å¤åˆ¶ä¿¡æ¯ã€åŒ…æ‹¬è¿æ¥ä¿¡æ¯å’ŒäºŒè¿›åˆ¶æ–‡ä»¶åã€ä½ç½®ã€‚ä»åº“ä¸Šæ‰§è¡Œè¿™ä¸ªå‘½ä»¤åï¼Œä½¿ç”¨show slave statuså°†ä¸ä¼šæœ‰è¾“å‡ºã€‚reset slaveæ˜¯å„ç‰ˆæœ¬Mysqléƒ½æœ‰çš„åŠŸèƒ½ï¼Œåœ¨stop slaveä¹‹åä½¿ç”¨ã€‚ä¸»è¦åšï¼šåˆ é™¤master.infoå’Œrelay-log.infoæ–‡ä»¶ï¼›åˆ é™¤æ‰€æœ‰çš„relay logï¼ˆåŒ…æ‹¬è¿˜æ²¡æœ‰åº”ç”¨å®Œçš„æ—¥å¿—ï¼‰ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„relay logæ–‡ä»¶ï¼›ä»Mysql 5.5å¼€å§‹ï¼Œå¤šäº†ä¸€ä¸ªallå‚æ•°ã€‚å¦‚æœä¸åŠ allå‚æ•°ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è¿æ¥ä¿¡æ¯ä»ç„¶ä¿ç•™åœ¨å†…å­˜ä¸­ï¼ŒåŒ…æ‹¬ä¸»åº“åœ°å€ã€ç«¯å£ã€ç”¨æˆ·ã€å¯†ç ç­‰ã€‚è¿™æ ·å¯ä»¥ç›´æ¥è¿è¡Œstart slaveå‘½ä»¤è€Œä¸å¿…é‡æ–°è¾“å…¥change master toå‘½ä»¤ï¼Œè€Œè¿è¡Œshow slave statusä¹Ÿä»å’Œæ²¡æœ‰è¿è¡Œreset slaveä¸€æ ·ï¼Œæœ‰æ­£å¸¸çš„è¾“å‡ºã€‚ä½†å¦‚æœåŠ äº†allå‚æ•°ï¼Œé‚£ä¹ˆè¿™äº›å†…å­˜ä¸­çš„æ•°æ®ä¹Ÿä¼šè¢«æ¸…é™¤æ‰ï¼Œè¿è¡Œshow slave statuså°±è¾“å‡ºä¸ºç©ºäº†ã€‚ mysql&gt; stop slave; Query OK, 0 rows affected, 2 warnings (0.00 sec) mysql&gt; reset slave all; Query OK, 0 rows affected, 1 warning (0.00 sec) mysql&gt; show slave status\\G Empty set, 1 warning (0.00 sec) nginxCentOSä¸‹Nginxçš„å®‰è£…å®‰è£… nginx ç¼–è¯‘éœ€è¦ä¾èµ– gcc ç¯å¢ƒ: yum install gcc-c++ å®‰è£…ä¸¤ä¸ªå®‰è£…åŒ…pcreå’Œpcre-develï¼š yum install -y pcre pcre-devel å®‰è£…zlibï¼ŒNginxçš„å„ç§æ¨¡å—ä¸­éœ€è¦ä½¿ç”¨gzipå‹ç¼©ï¼š yum install -y zlib zlib-devel å¦‚æœä½¿ç”¨äº† httpsï¼Œéœ€è¦å®‰è£… OpenSSL åº“ã€‚å®‰è£…æŒ‡ä»¤å¦‚ä¸‹ï¼š yum install -y openssl openssl-devel ä¸€é”®å®‰è£…ä¸Šé¢å››ä¸ªä¾èµ–ï¼ˆè¿½æ±‚å®‰è£…é€Ÿåº¦å¯ç›´æ¥ç”¨è¿™æ¡æŒ‡ä»¤ï¼‰ yum -y install gcc zlib zlib-devel pcre-devel openssl openssl-devel è¿›å…¥usr&#x2F;local æ–‡ä»¶è·¯å¾„(è·¯å¾„å¯è‡ªé€‰)åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹nginxä¿å­˜ä½¿ç”¨wgetä¸‹è½½çš„nginxå‹ç¼©åŒ… &#x2F;&#x2F;ä¸‹è½½nginxå‹ç¼©åŒ… wget http:&#x2F;&#x2F;nginx.org&#x2F;download&#x2F;nginx-1.24.0.tar.gz tar -zxvf nginx-1.24.0.tar.gz -C &#x2F;usr&#x2F;local&#x2F; cd &#x2F;usr&#x2F;local&#x2F;nginx-1.24.0&#x2F; &#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ mkdir &#x2F;usr&#x2F;local&#x2F;nginx &#x2F;&#x2F;å®‰è£…å‰æ£€æŸ¥å·¥ä½œ .&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx &#x2F;&#x2F;å®‰è£… make &amp;&amp; make install &#x2F;&#x2F;æ–‡ä»¶ç›®å½•æ ‘çŠ¶å›¾ nginx â”œâ”€â”€ conf &lt;-- Nginxé…ç½®æ–‡ä»¶ â”‚ â”œâ”€â”€ fastcgi.conf â”‚ â”œâ”€â”€ fastcgi.conf.default â”‚ â”œâ”€â”€ fastcgi_params â”‚ â”œâ”€â”€ fastcgi_params.default â”‚ â”œâ”€â”€ koi-utf â”‚ â”œâ”€â”€ koi-win â”‚ â”œâ”€â”€ mime.types â”‚ â”œâ”€â”€ mime.types.default â”‚ â”œâ”€â”€ nginx.conf &lt;-- è¿™ä¸ªæ–‡ä»¶æˆ‘ä»¬ç»å¸¸æ“ä½œ â”‚ â”œâ”€â”€ nginx.conf.default â”‚ â”œâ”€â”€ scgi_params â”‚ â”œâ”€â”€ scgi_params.default â”‚ â”œâ”€â”€ uwsgi_params â”‚ â”œâ”€â”€ uwsgi_params.default â”‚ â””â”€â”€ win-utf â”œâ”€â”€ html &lt;-- å­˜æ”¾é™æ€æ–‡ä»¶ï¼Œæˆ‘ä»¬åæœŸéƒ¨ç½²é¡¹ç›®ï¼Œå°±è¦å°†é™æ€æ–‡ä»¶æ”¾åœ¨è¿™ â”‚ â”œâ”€â”€ 50x.html â”‚ â””â”€â”€ index.html &lt;-- æä¾›çš„é»˜è®¤çš„é¡µé¢ â”œâ”€â”€ logs â””â”€â”€ sbin â””â”€â”€ nginx &lt;-- å¯åŠ¨æ–‡ä»¶ é…ç½®ç¯å¢ƒå˜é‡ ä½¿ç”¨vim /etc/profileå‘½ä»¤æ‰“å¼€é…ç½®æ–‡ä»¶ï¼Œå¹¶é…ç½®ç¯å¢ƒå˜é‡ï¼Œä¿å­˜å¹¶é€€å‡º ä¹‹åé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨source /etc/profileå‘½ä»¤ï¼Œç„¶åæˆ‘ä»¬åœ¨ä»»æ„ä½ç½®è¾“å…¥nginxå³å¯å¯åŠ¨æœåŠ¡ï¼Œnginx -s stopå³å¯åœæ­¢æœåŠ¡ Nginxå¸¸ç”¨å‘½ä»¤ å¯åŠ¨Nginxï¼š nginx å¯åŠ¨NginxæœåŠ¡å™¨ã€‚ åœæ­¢Nginxï¼š nginx -s stop åœæ­¢æ­£åœ¨è¿è¡Œçš„NginxæœåŠ¡å™¨ã€‚ é‡æ–°åŠ è½½Nginxé…ç½®ï¼š nginx -s reload é‡æ–°åŠ è½½Nginxçš„é…ç½®æ–‡ä»¶ï¼Œä½¿æ–°çš„é…ç½®ç”Ÿæ•ˆï¼Œè€Œæ— éœ€åœæ­¢æœåŠ¡å™¨ã€‚ æ£€æŸ¥Nginxé…ç½®æ˜¯å¦æ­£ç¡®ï¼š nginx -t æ£€æŸ¥Nginxçš„é…ç½®æ–‡ä»¶è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæœ‰é”™è¯¯ï¼Œå®ƒä¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚ æŸ¥çœ‹Nginxç‰ˆæœ¬ï¼šnginx -v æˆ– nginx -V ç¬¬ä¸€ä¸ªå‘½ä»¤ä¼šæ˜¾ç¤ºNginxçš„ç‰ˆæœ¬å·ï¼Œç¬¬äºŒä¸ªå‘½ä»¤ä¼šæ˜¾ç¤ºç¼–è¯‘æ—¶çš„è¯¦ç»†é…ç½®ä¿¡æ¯ã€‚ æŸ¥çœ‹Nginxè¿›ç¨‹çŠ¶æ€ï¼š nginx -s status æ˜¾ç¤ºNginxè¿›ç¨‹çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ•°é‡å’Œå…¶å®ƒç›¸å…³ä¿¡æ¯ã€‚ é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶ï¼š nginx -s reopen é‡æ–°æ‰“å¼€Nginxçš„æ—¥å¿—æ–‡ä»¶ï¼Œå¯ä»¥ç”¨äºå®ç°æ—¥å¿—æ–‡ä»¶çš„åˆ‡å‰²å’Œå½’æ¡£ã€‚ CentOS 7CentOS 7ä¸Šé˜²ç«å¢™è®¾ç½®åœ¨CentOS 7ä¸Šè®¾ç½®é˜²ç«å¢™å¯ä»¥ä½¿ç”¨firewalldæœåŠ¡è¿›è¡Œç®¡ç†ã€‚ ä»¥ä¸‹æ˜¯åœ¨CentOS 7ä¸Šè®¾ç½®é˜²ç«å¢™çš„ä¸€äº›å¸¸ç”¨æ“ä½œï¼š æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€ï¼š sudo firewall-cmd --state è¿™å°†æ˜¾ç¤ºé˜²ç«å¢™çš„å½“å‰çŠ¶æ€ï¼Œå¦‚æœé˜²ç«å¢™å·²å¯ç”¨ï¼Œå®ƒä¼šæ˜¾ç¤ºâ€runningâ€ã€‚ æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™ï¼š sudo firewall-cmd --list-all è¿™å°†æ˜¾ç¤ºé˜²ç«å¢™çš„å½“å‰è§„åˆ™åˆ—è¡¨ã€‚ å¯åŠ¨é˜²ç«å¢™æœåŠ¡ï¼š sudo systemctl start firewalld åœæ­¢é˜²ç«å¢™æœåŠ¡ï¼š sudo systemctl stop firewalld è®¾ç½®é˜²ç«å¢™å¼€æœºå¯åŠ¨ï¼š sudo systemctl enable firewalld åœç”¨é˜²ç«å¢™å¼€æœºå¯åŠ¨ï¼š sudo systemctl disable firewalld å¼€æ”¾ç«¯å£ï¼š sudo firewall-cmd --zone&#x3D;public --add-port&#x3D;&lt;port&gt;&#x2F;tcp --permanent å°†&lt;port&gt;æ›¿æ¢ä¸ºè¦å¼€æ”¾çš„ç«¯å£å·ã€‚æ­¤å‘½ä»¤ä¼šæ°¸ä¹…æ€§åœ°åœ¨é˜²ç«å¢™ä¸­å¼€æ”¾æŒ‡å®šçš„ç«¯å£ã€‚ ç§»é™¤å·²å¼€æ”¾çš„ç«¯å£ï¼š sudo firewall-cmd --zone&#x3D;public --remove-port&#x3D;&lt;port&gt;&#x2F;tcp --permanent å°†&lt;port&gt;æ›¿æ¢ä¸ºè¦ç§»é™¤çš„ç«¯å£å·ã€‚æ­¤å‘½ä»¤ä¼šæ°¸ä¹…æ€§åœ°ä»é˜²ç«å¢™ä¸­ç§»é™¤æŒ‡å®šçš„ç«¯å£ã€‚ é‡æ–°åŠ è½½é˜²ç«å¢™é…ç½®ï¼š sudo firewall-cmd --reload åœ¨ä¿®æ”¹é˜²ç«å¢™è§„åˆ™åï¼Œä½¿ç”¨æ­¤å‘½ä»¤é‡æ–°åŠ è½½é…ç½®ï¼Œä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚ 10.éªŒè¯è§„åˆ™æ˜¯å¦ç”Ÿæ•ˆï¼š sudo firewall-cmd --zone&#x3D;public --list-all æ£€æŸ¥è§„åˆ™åˆ—è¡¨ä»¥ç¡®è®¤æ·»åŠ æˆ–åˆ é™¤çš„è§„åˆ™å·²æ­£ç¡®åº”ç”¨ã€‚ æŸ¥çœ‹yumå·²å®‰è£…çš„åŒ…åœ¨linuxä¸‹å¦‚ä½•ä½¿ç”¨yumæŸ¥çœ‹å®‰è£…äº†å“ªäº›è½¯ä»¶åŒ… åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶åŒ…yum list installed yumé’ˆå¯¹è½¯ä»¶åŒ…æ“ä½œå¸¸ç”¨å‘½ä»¤ï¼š 1.ä½¿ç”¨ yum æŸ¥æ‰¾è½¯ä»¶åŒ…å‘½ä»¤ï¼šyum search 2.åˆ—å‡ºæ‰€æœ‰å¯å®‰è£…çš„è½¯ä»¶åŒ…å‘½ä»¤ï¼š yum list 3.åˆ—å‡ºæ‰€æœ‰å¯æ›´æ–°çš„è½¯ä»¶åŒ…å‘½ä»¤ï¼š yum list updates 4.åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶åŒ…å‘½ä»¤ï¼š yum list installed yum è¯­æ³•yum [options] [command] [package ...] options å¯é€‰ï¼Œé€‰é¡¹åŒ…æ‹¬ -hï¼ˆå¸®åŠ©ï¼‰ï¼Œ-yï¼ˆå½“å®‰è£…è¿‡ç¨‹æç¤ºé€‰æ‹©å…¨éƒ¨ä¸ºâ€yesâ€ï¼‰ï¼Œ-qï¼ˆä¸æ˜¾ç¤ºå®‰è£…çš„è¿‡ç¨‹ï¼‰ç­‰ç­‰ã€‚ command è¦è¿›è¡Œçš„æ“ä½œã€‚ package æ“ä½œçš„å¯¹è±¡ã€‚ å…¶å®ƒçš„ä¾‹å­å°±ä¸åˆ—ä¸¾äº†ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹æŸ¥çœ‹yumå®‰è£…äº†å“ªäº›è½¯ä»¶åŒ… æŸ¥çœ‹ yum å·²å®‰è£… docker çš„åŒ… yum list installed docker æŸ¥çœ‹ yum å·²å®‰è£… dockerç›¸å…³çš„åŒ… yum list installed docker* [root@iZ2ze552628d2crm1m97ppZ ~]# yum list installed docker* å·²åŠ è½½æ’ä»¶ï¼šfastestmirror Loading mirror speeds from cached hostfile å·²å®‰è£…çš„è½¯ä»¶åŒ… docker-buildx-plugin.x86_64 0.11.2-1.el7 @docker-ce-stable docker-ce.x86_64 3:24.0.6-1.el7 @docker-ce-stable docker-ce-cli.x86_64 1:24.0.6-1.el7 @docker-ce-stable docker-ce-rootless-extras.x86_64 24.0.6-1.el7 @docker-ce-stable docker-compose-plugin.x86_64 2.21.0-1.el7 @docker-ce-stable [root@iZ2ze552628d2crm1m97ppZ ~]#","categories":[{"name":"Linux","slug":"Linux","permalink":"https://blog.ehzyil.xyz/categories/Linux/"}],"tags":[{"name":"CentOS","slug":"CentOS","permalink":"https://blog.ehzyil.xyz/tags/CentOS/"},{"name":"è½¯ä»¶","slug":"è½¯ä»¶","permalink":"https://blog.ehzyil.xyz/tags/%E8%BD%AF%E4%BB%B6/"}],"author":"ehzyil"},{"title":"SpringBooté¡¹ç›®ä¸­é›†æˆç¬¬ä¸‰æ–¹ç™»å½•åŠŸèƒ½","slug":"2023/SpringBooté¡¹ç›®ä¸­é›†æˆç¬¬ä¸‰æ–¹ç™»å½•åŠŸèƒ½","date":"2023-10-17T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/17/2023/SpringBooté¡¹ç›®ä¸­é›†æˆç¬¬ä¸‰æ–¹ç™»å½•åŠŸèƒ½/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/17/2023/SpringBoot%E9%A1%B9%E7%9B%AE%E4%B8%AD%E9%9B%86%E6%88%90%E7%AC%AC%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD/","excerpt":"","text":"TODOï¼ï¼ï¼","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"}],"author":"ehzyil"},{"title":"åŸºäº@ControllerAdviceå®ç°å…¨å±€å¼‚å¸¸å¤„ç†","slug":"2023/åŸºäº@ControllerAdviceå®ç°å…¨å±€å¼‚å¸¸å¤„ç†","date":"2023-10-17T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/17/2023/åŸºäº@ControllerAdviceå®ç°å…¨å±€å¼‚å¸¸å¤„ç†/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/17/2023/%E5%9F%BA%E4%BA%8E@ControllerAdvice%E5%AE%9E%E7%8E%B0%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/","excerpt":"","text":"RestControllerAdviceæ³¨è§£ä¸å…¨å±€å¼‚å¸¸å¤„ç†1.å‰ç½®çŸ¥è¯†@RestControllerAdvice å’Œ @ExceptionHandler æ˜¯ Spring æ¡†æ¶ä¸­ç”¨äºå¤„ç†å…¨å±€å¼‚å¸¸çš„æ³¨è§£ã€‚ @RestControllerAdvice: @RestControllerAdvice æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œç»“åˆäº† @ControllerAdvice å’Œ @ResponseBodyã€‚å®ƒç”¨äºå…¨å±€å¤„ç†æ§åˆ¶å™¨å±‚ï¼ˆControllerï¼‰æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¯ä»¥å°†å¤„ç†ç»“æœç›´æ¥ä»¥ JSON æ ¼å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ å…·ä½“ç”¨é€”åŒ…æ‹¬ä½†ä¸é™äºï¼š å…¨å±€å¼‚å¸¸å¤„ç†ï¼šæ•è·æ‰€æœ‰ Controller å±‚æŠ›å‡ºçš„å¼‚å¸¸ï¼Œç»Ÿä¸€è¿›è¡Œå¤„ç†ï¼Œé¿å…å¼‚å¸¸ç›´æ¥ä¼ é€’åˆ°å®¢æˆ·ç«¯ã€‚ å…¨å±€æ•°æ®ç»‘å®šï¼šå¯ä»¥åœ¨è¿™é‡Œå¯¹è¯·æ±‚å‚æ•°è¿›è¡Œå…¨å±€çš„é¢„å¤„ç†æˆ–æ ¡éªŒã€‚ å…¨å±€æ•°æ®é¢„å¤„ç†ï¼šå¯ä»¥åœ¨è¿™é‡Œå¯¹è¿”å›çš„æ•°æ®è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚ @ExceptionHandler: @ExceptionHandler æ˜¯ä¸€ä¸ªå±€éƒ¨å¼‚å¸¸å¤„ç†çš„æ³¨è§£ï¼Œå®ƒå¯ä»¥ç”¨åœ¨æ§åˆ¶å™¨å±‚çš„æ–¹æ³•ä¸Šï¼Œç”¨äºå¤„ç†æŒ‡å®šç±»å‹çš„å¼‚å¸¸ã€‚ å…·ä½“ç”¨é€”åŒ…æ‹¬ä½†ä¸é™äºï¼š å¤„ç†ç‰¹å®šç±»å‹çš„å¼‚å¸¸ï¼šå°†æŒ‡å®šç±»å‹çš„å¼‚å¸¸æ•è·ï¼Œç„¶åæ‰§è¡Œç›¸åº”çš„å¤„ç†é€»è¾‘ã€‚ æä¾›è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†é€»è¾‘ï¼šå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚ç¼–å†™ç‰¹å®šçš„å¼‚å¸¸å¤„ç†ä»£ç ã€‚ 2.ä¸¾ä¾‹ ä¸¾ä¾‹ï¼š @RestControllerAdvice public class GlobalExceptionHandler &#123; @ExceptionHandler(Exception.class) public ResponseEntity&lt;String> handleException(Exception e) &#123; return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(\"Internal Server Error\"); &#125; @ExceptionHandler(UserNotFoundException.class) public ResponseEntity&lt;String> handleUserNotFoundException(UserNotFoundException e) &#123; return ResponseEntity.status(HttpStatus.NOT_FOUND).body(\"User Not Found\"); &#125; &#125; åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒGlobalExceptionHandler ç±»ä½¿ç”¨ @RestControllerAdvice æ³¨è§£æ¥æŒ‡ç¤ºå®ƒæ˜¯ä¸€ä¸ªå…¨å±€å¼‚å¸¸å¤„ç†å™¨ã€‚ç„¶åï¼Œä½¿ç”¨ @ExceptionHandler æ³¨è§£æ¥å®šä¹‰å¤„ç†ç‰¹å®šç±»å‹å¼‚å¸¸çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼ŒhandleException æ–¹æ³•å¤„ç†æ‰€æœ‰ç±»å‹çš„å¼‚å¸¸ï¼Œè€Œ handleUserNotFoundException æ–¹æ³•åªå¤„ç† UserNotFoundException ç±»å‹çš„å¼‚å¸¸ã€‚ æ€»çš„æ¥è¯´ï¼Œ@RestControllerAdvice å’Œ @ExceptionHandler çš„ç»„åˆå…è®¸ä½ åœ¨åº”ç”¨ç¨‹åºä¸­å»ºç«‹ä¸€å¥—å…¨å±€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œæé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¥å£®æ€§ã€‚ 3.ä»£ç å®ç°è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»ServiceException package com.ehzyil.exception; import lombok.Getter; import static com.ehzyil.enums.StatusCodeEnum.FAIL; /** * ä¸šåŠ¡å¼‚å¸¸ **/ @Getter public final class ServiceException extends RuntimeException &#123; /** * è¿”å›å¤±è´¥çŠ¶æ€ç  */ private Integer code = FAIL.getCode(); /** * è¿”å›ä¿¡æ¯ */ private final String message; public ServiceException(String message) &#123; this.message = message; &#125; &#125; å…¨å±€å¼‚å¸¸å¤„ç†ç±»GlobalExceptionHandler.java package com.ehzyil.handler; import cn.dev33.satoken.exception.DisableServiceException; import cn.dev33.satoken.exception.NotLoginException; import cn.dev33.satoken.exception.NotPermissionException; import cn.dev33.satoken.exception.NotRoleException; import com.ehzyil.exception.ServiceException; import com.ehzyil.model.vo.Result; import org.springframework.web.bind.MethodArgumentNotValidException; import org.springframework.web.bind.annotation.ExceptionHandler; import org.springframework.web.bind.annotation.RestControllerAdvice; import java.util.Objects; import static com.ehzyil.enums.StatusCodeEnum.*; /** * @author ehyzil * @Description å…¨å±€å¼‚å¸¸å¤„ç† * @create 2023-09-2023/9/30-22:47 */ @RestControllerAdvice public class GlobalExceptionHandler &#123; /** * å¤„ç†ä¸šåŠ¡å¼‚å¸¸ * * @param e * @return */ @ExceptionHandler(value = ServiceException.class) public Result&lt;?> handleServiceException(ServiceException e) &#123; return Result.fail(e.getMessage()); &#125; /** * å¤„ç†Assertå¼‚å¸¸ */ @ExceptionHandler(value = IllegalArgumentException.class) public Result&lt;?> handleIllegalArgumentException(IllegalArgumentException e) &#123; return Result.fail(e.getMessage()); &#125; /** * å¤„ç†å‚æ•°æ ¡éªŒå¼‚å¸¸ */ @ExceptionHandler(value = MethodArgumentNotValidException.class) public Result&lt;?> handleMethodArgumentNotValidException(MethodArgumentNotValidException e) &#123; return Result.fail(VALID_ERROR.getCode(), Objects.requireNonNull(e.getBindingResult().getFieldError()).getDefaultMessage()); &#125; /** * å¤„ç†æƒé™ä¸è¶³ */ @ExceptionHandler(value = NotPermissionException.class) public Result&lt;?> handleNotPermissionException() &#123; return Result.fail(\"æƒé™ä¸è¶³\"); &#125; /** * å¤„ç†è´¦å·å°ç¦ */ @ExceptionHandler(value = DisableServiceException.class) public Result&lt;?> handleDisableServiceExceptionException() &#123; return Result.fail(\"æ­¤è´¦å·å·²è¢«ç¦æ­¢è®¿é—®æœåŠ¡\"); &#125; /** * å¤„ç†æ— æ­¤è§’è‰²å¼‚å¸¸ */ @ExceptionHandler(value = NotRoleException.class) public Result&lt;?> handleNotRoleException() &#123; return Result.fail(\"æƒé™ä¸è¶³\"); &#125; /** * å¤„ç†SaTokenå¼‚å¸¸ */ @ExceptionHandler(value = NotLoginException.class) public Result&lt;?> handlerNotLoginException(NotLoginException nle) &#123; // åˆ¤æ–­åœºæ™¯å€¼ï¼Œå®šåˆ¶åŒ–å¼‚å¸¸ä¿¡æ¯ String message; if (nle.getType().equals(NotLoginException.NOT_TOKEN)) &#123; message = \"æœªæä¾›token\"; &#125; else if (nle.getType().equals(NotLoginException.INVALID_TOKEN)) &#123; message = \"tokenæ— æ•ˆ\"; &#125; else if (nle.getType().equals(NotLoginException.TOKEN_TIMEOUT)) &#123; message = \"tokenå·²è¿‡æœŸ\"; &#125; else &#123; message = \"å½“å‰ä¼šè¯æœªç™»å½•\"; &#125; // è¿”å›ç»™å‰ç«¯ return Result.fail(UNAUTHORIZED.getCode(), message); &#125; /** * å¤„ç†ç³»ç»Ÿå¼‚å¸¸ */ @ExceptionHandler(value = Exception.class) public Result&lt;?> handleSystemException() &#123; return Result.fail(SYSTEM_ERROR.getCode(), SYSTEM_ERROR.getMsg()); &#125; &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"},{"name":"å¼‚å¸¸","slug":"å¼‚å¸¸","permalink":"https://blog.ehzyil.xyz/tags/%E5%BC%82%E5%B8%B8/"}],"author":"ehzyil"},{"title":"åŸºäºAOPå®ç°è®¿å®¢æ—¥å¿—è®°å½•","slug":"2023/åŸºäºAOPå®ç°è®¿å®¢æ—¥å¿—è®°å½•","date":"2023-10-17T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/17/2023/åŸºäºAOPå®ç°è®¿å®¢æ—¥å¿—è®°å½•/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/17/2023/%E5%9F%BA%E4%BA%8EAOP%E5%AE%9E%E7%8E%B0%E8%AE%BF%E5%AE%A2%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95/","excerpt":"","text":"åŸºäºAOPå®ç°è®¿å®¢æ—¥å¿—è®°å½•1.å‡†å¤‡æ‰€éœ€çš„æ—¥å¿—è¡¨create table t_visit_log ( id int auto_increment comment 'id' primary key, page varchar(50) null comment 'è®¿é—®é¡µé¢', ip_address varchar(50) null comment 'è®¿é—®ip', ip_source varchar(50) null comment 'è®¿é—®åœ°å€', os varchar(50) null comment 'æ“ä½œç³»ç»Ÿ', browser varchar(50) null comment 'æµè§ˆå™¨', create_time datetime not null comment 'è®¿é—®æ—¶é—´' ); 2.pomä¾èµ–â€¦ 3.å®ä½“/** * è®¿é—®æ—¥å¿— */ @Data public class VisitLog &#123; /** * id */ @TableId(type = IdType.AUTO) private Integer id; /** * è®¿é—®é¡µé¢ */ private String page; /** * è®¿é—®ip */ private String ipAddress; /** * è®¿é—®åœ°å€ */ private String ipSource; /** * æ“ä½œç³»ç»Ÿ */ private String os; /** * æµè§ˆå™¨ */ private String browser; /** * è®¿é—®æ—¶é—´ */ @TableField(fill = FieldFill.INSERT) private LocalDateTime createTime; &#125; 4.è‡ªå®šä¹‰æ—¥å¿—æ³¨è§£/** * @author ehyzil * @Description è®¿é—®æ—¥å¿—æ³¨è§£ * @create 2023-10-2023/10/1-20:37 */ @Documented @Target(ElementType.METHOD) @Retention(RetentionPolicy.RUNTIME) public @interface VisitLogger &#123; /** * * @return è®¿é—®é¡µé¢ */ String value() default \"\"; &#125; 5.Springå®ä¾‹è·å–å·¥å…·ç±»// è¿™æ˜¯ä¸€ä¸ªå®ç”¨å·¥å…·ç±»ï¼Œç”¨äºä¸Springå®¹å™¨äº¤äº’ï¼Œè·å–Beanå®ä¾‹ç­‰åŠŸèƒ½ã€‚ public final class SpringUtils implements BeanFactoryPostProcessor &#123; private static ConfigurableListableBeanFactory beanFactory; @Override public void postProcessBeanFactory(@NotNull ConfigurableListableBeanFactory beanFactory) throws BeansException &#123; SpringUtils.beanFactory = beanFactory; &#125; /** * è·å–æŒ‡å®šåç§°çš„å¯¹è±¡ * @param name å¯¹è±¡çš„åç§° * @return è·å–åˆ°çš„å¯¹è±¡å®ä¾‹ */ @SuppressWarnings(\"unchecked\") public static &lt;T> T getBean(String name) throws BeansException &#123; return (T) beanFactory.getBean(name); &#125; /** * è·å–æŒ‡å®šç±»å‹çš„å¯¹è±¡ * @param clz å¯¹è±¡çš„ç±»å‹ * @return è·å–åˆ°çš„å¯¹è±¡å®ä¾‹ */ public static &lt;T> T getBean(Class&lt;T> clz) throws BeansException &#123; return beanFactory.getBean(clz); &#125; /** * è·å–æŒ‡å®šåç§°çš„Beançš„ç±»å‹ * @param name Beançš„åç§° * @return Beançš„ç±»å‹ * @throws NoSuchBeanDefinitionException å¦‚æœæ‰¾ä¸åˆ°å¯¹åº”çš„Beanå®šä¹‰ */ public static Class&lt;?> getType(String name) throws NoSuchBeanDefinitionException &#123; return beanFactory.getType(name); &#125; &#125; 6.IPåœ°å€å·¥å…·ç±»package com.ehzyil.utils; import com.ehzyil.exception.ServiceException; import org.lionsoul.ip2region.xdb.Searcher; import org.springframework.core.io.ClassPathResource; import org.springframework.util.FileCopyUtils; import org.springframework.util.StringUtils; import javax.servlet.http.HttpServletRequest; import java.io.IOException; import java.io.InputStream; import java.net.InetAddress; import java.net.UnknownHostException; import java.util.Objects; /** * IPåœ°å€å·¥å…·ç±» * * @author ehzyil */ @SuppressWarnings(\"all\") public class IpUtils &#123; private static Searcher searcher; static &#123; // è§£å†³é¡¹ç›®æ‰“åŒ…æ‰¾ä¸åˆ°ip2region.xdb try &#123; InputStream inputStream = new ClassPathResource(\"/ipdb/ip2region.xdb\").getInputStream(); //å°† ip2region.db è½¬ä¸º ByteArray byte[] cBuff = FileCopyUtils.copyToByteArray(inputStream); searcher = Searcher.newWithBuffer(cBuff); &#125; catch (IOException e) &#123; throw new ServiceException(\"ip2region.xdbåŠ è½½å¤±è´¥\"); &#125; &#125; /** * åœ¨Nginxç­‰ä»£ç†ä¹‹åè·å–ç”¨æˆ·çœŸå®IPåœ°å€ */ public static String getIpAddress(HttpServletRequest request) &#123; String ip; try &#123; ip = request.getHeader(\"X-Real-IP\"); if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) &#123; ip = request.getHeader(\"x-forwarded-for\"); &#125; if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) &#123; ip = request.getHeader(\"Proxy-Client-IP\"); &#125; if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) &#123; ip = request.getHeader(\"WL-Proxy-Client-IP\"); &#125; if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) &#123; ip = request.getHeader(\"HTTP_CLIENT_IP\"); &#125; if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) &#123; ip = request.getHeader(\"HTTP_X_FORWARDED_FOR\"); &#125; if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) &#123; ip = request.getRemoteAddr(); if (\"127.0.0.1\".equals(ip) || \"0:0:0:0:0:0:0:1\".equals(ip)) &#123; //æ ¹æ®ç½‘å¡å–æœ¬æœºé…ç½®çš„IP InetAddress inet = null; try &#123; inet = InetAddress.getLocalHost(); &#125; catch (UnknownHostException e) &#123; throw new UnknownHostException(\"æ— æ³•ç¡®å®šä¸»æœºçš„IPåœ°å€\"); &#125; ip = inet.getHostAddress(); &#125; &#125; // ä½¿ç”¨ä»£ç†ï¼Œåˆ™è·å–ç¬¬ä¸€ä¸ªIPåœ°å€ if (!StringUtils.hasText(ip) &amp;&amp; Objects.requireNonNull(ip).length() > 15) &#123; int idx = ip.indexOf(\",\"); if (idx > 0) &#123; ip = ip.substring(0, idx); &#125; &#125; &#125; catch (Exception e) &#123; ip = \"\"; &#125; return ip; &#125; /** * æ ¹æ®ipä» ip2region.db ä¸­è·å–åœ°ç†ä½ç½® * * @param ip * @return */ public static String getIpSource(String ip) &#123; try &#123; String address = searcher.searchByStr(ip); if (StringUtils.hasText(address)) &#123; address = address.replace(\"|0\", \"\"); address = address.replace(\"0|\", \"\"); return address; &#125; return address; &#125; catch (Exception e) &#123; return \"\"; &#125; &#125; &#125; 7.çº¿ç¨‹æ± é…ç½®ThreadPoolPropertiesç±»æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„å±æ€§ç±»ï¼Œç”¨äºé…ç½®çº¿ç¨‹æ± çš„ç›¸å…³å±æ€§ã€‚ package com.ican.config.properties; import lombok.Data; import org.springframework.boot.context.properties.ConfigurationProperties; import org.springframework.context.annotation.Configuration; /** * çº¿ç¨‹æ± å‚æ•° **/ @Data @Configuration @ConfigurationProperties(prefix = \"thread.pool\") public class ThreadPoolProperties &#123; /** * æ ¸å¿ƒçº¿ç¨‹æ± å¤§å° */ private int corePoolSize; /** * æœ€å¤§å¯åˆ›å»ºçš„çº¿ç¨‹æ•° */ private int maxPoolSize; /** * é˜Ÿåˆ—æœ€å¤§é•¿åº¦ */ private int queueCapacity; /** * çº¿ç¨‹æ± ç»´æŠ¤çº¿ç¨‹æ‰€å…è®¸çš„ç©ºé—²æ—¶é—´ */ private int keepAliveSeconds; &#125; çº¿ç¨‹æ± é…ç½® threadPoolTaskExecutor()æ–¹æ³•ï¼Œä½¿ç”¨@Beanæ³¨è§£å°†å…¶å£°æ˜ä¸ºä¸€ä¸ªBeanã€‚è¯¥æ–¹æ³•è¿”å›äº†ä¸€ä¸ªThreadPoolTaskExecutorå¯¹è±¡ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹æ± ã€‚ /** * çº¿ç¨‹æ± é…ç½® **/ @Configuration public class ThreadPoolConfig &#123; @Autowired private ThreadPoolProperties threadPoolProperties; /** * åˆ›å»ºçº¿ç¨‹æ±  * * @return çº¿ç¨‹æ±  */ @Bean public ThreadPoolTaskExecutor threadPoolTaskExecutor() &#123; ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor(); // æ ¸å¿ƒçº¿ç¨‹æ± å¤§å° executor.setCorePoolSize(threadPoolProperties.getCorePoolSize()); // æœ€å¤§å¯åˆ›å»ºçš„çº¿ç¨‹æ•° executor.setMaxPoolSize(threadPoolProperties.getMaxPoolSize()); // ç­‰å¾…é˜Ÿåˆ—æœ€å¤§é•¿åº¦ executor.setQueueCapacity(threadPoolProperties.getQueueCapacity()); // çº¿ç¨‹æ± ç»´æŠ¤çº¿ç¨‹æ‰€å…è®¸çš„ç©ºé—²æ—¶é—´ executor.setKeepAliveSeconds(threadPoolProperties.getKeepAliveSeconds()); // çº¿ç¨‹æ± å¯¹æ‹’ç»ä»»åŠ¡(æ— çº¿ç¨‹å¯ç”¨)çš„å¤„ç†ç­–ç•¥ executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy()); return executor; &#125; /** * æ‰§è¡Œå‘¨æœŸæ€§æˆ–å®šæ—¶ä»»åŠ¡ */ @Bean(name = \"scheduledExecutorService\") protected ScheduledExecutorService scheduledExecutorService() &#123; return new ScheduledThreadPoolExecutor(threadPoolProperties.getCorePoolSize(), new BasicThreadFactory.Builder().namingPattern(\"schedule-pool-%d\").daemon(true).build(), new ThreadPoolExecutor.CallerRunsPolicy()) &#123; @Override protected void afterExecute(Runnable r, Throwable t) &#123; super.afterExecute(r, t); ThreadUtils.printException(r, t); &#125; &#125;; &#125; &#125; ä½¿ç”¨äº†ThreadPoolExecutor.CallerRunsPolicy()ï¼Œè¡¨ç¤ºå½“çº¿ç¨‹æ± æ— æ³•æ¥å—æ–°ä»»åŠ¡æ—¶ï¼Œå°†ä»»åŠ¡å›é€€åˆ°è°ƒç”¨è€…çº¿ç¨‹ä¸­æ‰§è¡Œã€‚ 8.å¼‚æ­¥ä»»åŠ¡é…ç½®package com.ehzyil.manager; import com.ehzyil.utils.SpringUtils; import com.ehzyil.utils.ThreadUtils; import java.util.TimerTask; import java.util.concurrent.ScheduledExecutorService; import java.util.concurrent.TimeUnit; /** * å¼‚æ­¥ä»»åŠ¡ç®¡ç†å™¨ * * @author ehzyil */ public class AsyncManager &#123; /** * å•ä¾‹æ¨¡å¼ï¼Œç¡®ä¿ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ */ private AsyncManager() &#123; &#125; /** * é¥¿æ±‰å¼ï¼Œåœ¨ç±»åŠ è½½çš„æ—¶å€™ç«‹åˆ»è¿›è¡Œå®ä¾‹åŒ– */ private static final AsyncManager INSTANCE = new AsyncManager(); public static AsyncManager getInstance() &#123; return INSTANCE; &#125; /** * å¼‚æ­¥æ“ä½œä»»åŠ¡è°ƒåº¦çº¿ç¨‹æ±  */ private final ScheduledExecutorService executor = SpringUtils.getBean(\"scheduledExecutorService\"); /** * æ‰§è¡Œä»»åŠ¡ * * @param task ä»»åŠ¡ */ public void execute(TimerTask task) &#123; executor.schedule(task, 10, TimeUnit.MILLISECONDS); &#125; /** * åœæ­¢ä»»åŠ¡çº¿ç¨‹æ±  */ public void shutdown() &#123; ThreadUtils.shutdownAndAwaitTermination(executor); &#125; &#125; çº¿ç¨‹å·¥å…·ç±»ThreadUtils package com.ehzyil.utils; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.util.concurrent.*; /** * çº¿ç¨‹å·¥å…·ç±» * * @author ehzyil */ public class ThreadUtils &#123; private static final Logger logger = LoggerFactory.getLogger(ThreadUtils.class); private static final long OVERTIME = 120; /** * åœæ­¢çº¿ç¨‹æ±  * å…ˆä½¿ç”¨shutdown, åœæ­¢æ¥æ”¶æ–°ä»»åŠ¡å¹¶å°è¯•å®Œæˆæ‰€æœ‰å·²å­˜åœ¨ä»»åŠ¡. * å¦‚æœè¶…æ—¶, åˆ™è°ƒç”¨shutdownNow, å–æ¶ˆåœ¨workQueueä¸­Pendingçš„ä»»åŠ¡,å¹¶ä¸­æ–­æ‰€æœ‰é˜»å¡å‡½æ•°. * å¦‚æœä»ç„¶è¶…æ™‚ï¼Œå‰‡å¼·åˆ¶é€€å‡º. * å¦å¯¹åœ¨shutdownæ—¶çº¿ç¨‹æœ¬èº«è¢«è°ƒç”¨ä¸­æ–­åšäº†å¤„ç†. */ public static void shutdownAndAwaitTermination(ExecutorService pool) &#123; if (pool != null &amp;&amp; !pool.isShutdown()) &#123; pool.shutdown(); try &#123; if (!pool.awaitTermination(OVERTIME, TimeUnit.SECONDS)) &#123; pool.shutdownNow(); if (!pool.awaitTermination(OVERTIME, TimeUnit.SECONDS)) &#123; logger.info(\"Pool did not terminate\"); &#125; &#125; &#125; catch (InterruptedException ie) &#123; pool.shutdownNow(); Thread.currentThread().interrupt(); &#125; &#125; &#125; /** * æ‰“å°çº¿ç¨‹å¼‚å¸¸ä¿¡æ¯ */ public static void printException(Runnable r, Throwable t) &#123; if (t == null &amp;&amp; r instanceof Future&lt;?>) &#123; try &#123; Future&lt;?> future = (Future&lt;?>) r; if (future.isDone()) &#123; future.get(); &#125; &#125; catch (CancellationException ce) &#123; t = ce; &#125; catch (ExecutionException ee) &#123; t = ee.getCause(); &#125; catch (InterruptedException ie) &#123; Thread.currentThread().interrupt(); &#125; &#125; if (t != null) &#123; logger.error(t.getMessage(), t); &#125; &#125; &#125; 9.ä»»åŠ¡å·¥å‚é…ç½®/** * å¼‚æ­¥å·¥å‚ï¼ˆäº§ç”Ÿä»»åŠ¡ç”¨ï¼‰ */ public class AsyncFactory &#123; /** * è®°å½•è®¿é—®æ—¥å¿— * * @param visitLog è®¿é—®æ—¥å¿—ä¿¡æ¯ * @return ä»»åŠ¡task */ public static TimerTask recordVisit(VisitLog visitLog) &#123; return new TimerTask() &#123; @Override public void run() &#123; SpringUtils.getBean(VisitLogService.class).saveVisitLog(visitLog); &#125; &#125;; &#125; &#125; æ ¸å¿ƒåˆ‡é¢é…ç½®/** * AOPè®°å½•è®¿é—®æ—¥å¿— **/ @Aspect @Component public class VisitLogAspect &#123; @Pointcut(\"@annotation(com.ehzyil.annotation.VisitLogger)\") public void visitLogPointCut() &#123; &#125; /** * è¿æ¥ç‚¹æ­£å¸¸è¿”å›é€šçŸ¥ï¼Œæ‹¦æˆªç”¨æˆ·æ“ä½œæ—¥å¿—ï¼Œæ­£å¸¸æ‰§è¡Œå®Œæˆåæ‰§è¡Œï¼Œ å¦‚æœè¿æ¥ç‚¹æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ * * @param joinPoint åˆ‡é¢æ–¹æ³•çš„ä¿¡æ¯ * @param result è¿”å›ç»“æœ */ @AfterReturning(value = \"visitLogPointCut()\", returning = \"result\") public void doAfterReturning(JoinPoint joinPoint, Object result) &#123; // ä»åˆ‡é¢ç»‡å…¥ç‚¹å¤„é€šè¿‡åå°„æœºåˆ¶è·å–ç»‡å…¥ç‚¹å¤„çš„æ–¹æ³• MethodSignature signature = (MethodSignature) joinPoint.getSignature(); // è·å–åˆ‡å…¥ç‚¹æ‰€åœ¨çš„æ–¹æ³• Method method = signature.getMethod(); // è·å–æ“ä½œ VisitLogger visitLogger = method.getAnnotation(VisitLogger.class); // è·å–request ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes(); HttpServletRequest request = Objects.requireNonNull(attributes).getRequest(); VisitLog visitLog = new VisitLog(); String ipAddress = IpUtils.getIpAddress(request); String ipSource = IpUtils.getIpSource(ipAddress); // è§£æbrowserå’Œos Map&lt;String, String> userAgentMap = UserAgentUtils.parseOsAndBrowser(request.getHeader(\"User-Agent\")); visitLog.setIpAddress(ipAddress); visitLog.setIpSource(ipSource); visitLog.setOs(userAgentMap.get(\"os\")); visitLog.setBrowser(userAgentMap.get(\"browser\")); visitLog.setPage(visitLogger.value()); // ä¿å­˜åˆ°æ•°æ®åº“ AsyncManager.getInstance().execute(AsyncFactory.recordVisit(visitLog)); &#125; &#125; æ—¥å¿—Serviceå±‚/** * è®¿é—®ä¸šåŠ¡æ¥å£ */ public interface VisitLogService extends IService&lt;VisitLog> &#123; /** * ä¿å­˜è®¿é—®æ—¥å¿— * * @param visitLog è®¿é—®æ—¥å¿—ä¿¡æ¯ */ void saveVisitLog(VisitLog visitLog); &#125; @Service public class VisitLogServiceImpl extends ServiceImpl&lt;VisitLogMapper, VisitLog> implements VisitLogService &#123; @Autowired private VisitLogMapper visitLogMapper; @Override public void saveVisitLog(VisitLog visitLog) &#123; // ä¿å­˜è®¿é—®æ—¥å¿— visitLogMapper.insert(visitLog); &#125; æ§åˆ¶å™¨æµ‹è¯•/** * æŸ¥çœ‹é¦–é¡µæ–‡ç« åˆ—è¡¨ * * @return &#123;@link Result&lt;ArticleHomeVO>&#125; */ @VisitLogger(value = \"é¦–é¡µ\") @ApiOperation(value = \"æŸ¥çœ‹é¦–é¡µæ–‡ç« åˆ—è¡¨\") @GetMapping(\"/article/list\") public Result&lt;PageResult&lt;ArticleHomeVO>> listArticleHomeVO() &#123; return Result.success(articleService.listArticleHomeVO()); &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"},{"name":"AOP","slug":"AOP","permalink":"https://blog.ehzyil.xyz/tags/AOP/"},{"name":"æ—¥å¿—","slug":"æ—¥å¿—","permalink":"https://blog.ehzyil.xyz/tags/%E6%97%A5%E5%BF%97/"}],"author":"ehzyil"},{"title":"åŸºäºç­–ç•¥æ¨¡å¼å®ç°å›¾ç‰‡ä¸Šä¼ ","slug":"2023/åŸºäºç­–ç•¥æ¨¡å¼å®ç°å›¾ç‰‡ä¸Šä¼ ","date":"2023-10-17T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/17/2023/åŸºäºç­–ç•¥æ¨¡å¼å®ç°å›¾ç‰‡ä¸Šä¼ /","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/17/2023/%E5%9F%BA%E4%BA%8E%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/","excerpt":"","text":"åŸºäºç­–ç•¥æ¨¡å¼å®ç°å›¾ç‰‡ä¸Šä¼ 1.å‰ç½®å‡†å¤‡-ç­–ç•¥æ¥å£çš„ç¼–å†™æ–°å»ºä¸€ä¸ªåç§°ä¸º strategy çš„æ–‡ä»¶å¤¹ï¼ˆåœ¨ä»£ç è§„èŒƒä¸­ï¼Œä½¿ç”¨è®¾è®¡æ¨¡å¼è¦æ˜ç¡®çš„ä½“ç°å‡ºæ¥ï¼Œä¾¿äºåæœŸç»´æŠ¤ï¼‰ public interface UploadStrategy &#123; /** * ä¸Šä¼ æ–‡ä»¶ * * @param file æ–‡ä»¶ * @param path ä¸Šä¼ è·¯å¾„ * @return &#123;@link String&#125; æ–‡ä»¶åœ°å€ */ String uploadFile(MultipartFile file, String path); &#125; å®Œå–„é…ç½®æ–‡ä»¶ åœ¨ç¼–å†™å¯¹è±¡å­˜å‚¨å®ç°ç±»ä¹‹å‰ï¼Œæˆ‘é—¨ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬éœ€è¦å»å¯¹åº”çš„äº‘æœåŠ¡å‚å•†å¼€é€šå¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œç„¶åè·å–åˆ°accessKeyã€accessKeySecretã€endpointã€bucketã€domainUrlç­‰å¿…é¡»çš„å‚æ•°ã€‚å› ä¸ºè¿™äº›ä¿¡æ¯åŸºæœ¬æ˜¯ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä¿¡æ¯å­˜å‚¨åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬è¿˜éœ€è¦å¯¹æ–‡ä»¶ä¸Šä¼ è¿›è¡Œé…ç½®ï¼Œè®¾ç½®ä¸ºæœ€å¤§æ–‡ä»¶ä¸º100MB spring: servlet: multipart: max-file-size: 100MB max-request-size: 100MB # æ–‡ä»¶ä¸Šä¼ ç­–ç•¥ localã€ossã€cos upload: strategy: qiniu local: # nginxæ˜ å°„æœ¬åœ°æ–‡ä»¶è·¯å¾„ url: https://ä½ çš„æ–‡ä»¶ä¸Šä¼ å­åŸŸå/ # æœ¬åœ°æ–‡ä»¶å­˜å‚¨è·¯å¾„ path: /usr/local/upload/ # osså­˜å‚¨ oss: url: http://BucketåŸŸå/ endpoint: OSSé…ç½®endpoint bucketName: OSSé…ç½®bucketName accessKeyId: OSSé…ç½®accessKeyId accesskeySecret: OSSé…ç½®accesskeySecret # coså­˜å‚¨ cos: url: https://BucketåŸŸå/ secretId: COSé…ç½®secretId secretKey: COSé…ç½®secretKey region: COSé…ç½®region bucketName: COSé…ç½®bucketName # qiniuå­˜å‚¨(ä¸ƒç‰›äº‘) qiniu: url: http://s14jjz3r5.hb-bkt.clouddn.com/ # è®¿é—®åŸŸå(ç»™å­˜å‚¨æ¡¶ç»‘å®šçš„äºŒçº§åŸŸå) bucketName: ehzyil-blog # ç©ºé—´åç§°bucketName region: huabei # å­˜å‚¨åŒºåŸŸ åå—(huanan) ååŒ—(huabei)... accessKey: CSOFmR7_70ThEOZqlgTdbe2HnvOjbjPdCHt8CZrb #accessKey secretKey: _D-S6V1rBT2jjnZrX-Z_s30Aw6SNO1ydOFYHnUoC #secretKey å¼•å…¥è‡ªå®šä¹‰é…ç½®ä¾èµ– ä»¥åŠ äº‘æœåŠ¡ä¾èµ– &lt;!-- è…¾è®¯äº‘cos --> &lt;dependency> &lt;groupId>com.qcloud&lt;/groupId> &lt;artifactId>cos_api&lt;/artifactId> &lt;version>$&#123;cos.version&#125;&lt;/version> &lt;/dependency> &lt;!--ä¸ƒç‰›äº‘qiniu--> &lt;dependency> &lt;groupId>com.qiniu&lt;/groupId> &lt;artifactId>qiniu-java-sdk&lt;/artifactId> &lt;version>[7.2.0, 7.2.99]&lt;/version> &lt;/dependency> &lt;!-- é˜¿é‡Œäº‘oss --> &lt;dependency> &lt;groupId>com.aliyun.oss&lt;/groupId> &lt;artifactId>aliyun-sdk-oss&lt;/artifactId> &lt;version>$&#123;oss.version&#125;&lt;/version> &lt;/dependency> ç¼–å†™propertieså®ä½“ç±»ï¼Œé€šè¿‡@ConfigurationProperties()æ³¨è§£å¯ä»¥å°†é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹è¯»å–åˆ°å®ä½“ç±»ä¸­ã€‚ @Data @Configuration @ConfigurationProperties(prefix = \"upload.oss\") public class OssProperties &#123; /** * ossåŸŸå */ private String url; /** * ç»ˆç‚¹ */ private String endpoint; /** * è®¿é—®å¯†é’¥id */ private String accessKeyId; /** * è®¿é—®å¯†é’¥å¯†ç  */ private String accessKeySecret; /** * bucketåç§° */ private String bucketName; &#125; @Data @Configuration @ConfigurationProperties(prefix = \"upload.qiniu\") public class QiniuProperties &#123; private String url;//url æˆ–è€… åŸŸå private String bucketName; //å­˜å‚¨æ¡¶åå­— private String region;//åŒºåŸŸ å¦‚huanan hubei private String accessKey;//accessKey private String secretKey;//secretKey /** * é…ç½®ç©ºé—´çš„å­˜å‚¨åŒºåŸŸ */ @Bean public com.qiniu.storage.Configuration qiNiuConfig() &#123; switch (region) &#123; case \"huadong\": return new com.qiniu.storage.Configuration(Zone.huadong()); case \"huabei\": return new com.qiniu.storage.Configuration(Zone.huabei()); case \"huanan\": return new com.qiniu.storage.Configuration(Zone.huanan()); case \"beimei\": return new com.qiniu.storage.Configuration(Zone.beimei()); default: throw new RuntimeException(\"å­˜å‚¨åŒºåŸŸé…ç½®é”™è¯¯\"); &#125; &#125; /** * æ„å»ºä¸€ä¸ªä¸ƒç‰›ä¸Šä¼ å·¥å…·å®ä¾‹ */ @Bean public UploadManager uploadManager() &#123; return new UploadManager(qiNiuConfig()); &#125; /** * è®¤è¯ä¿¡æ¯å®ä¾‹ */ @Bean public Auth auth() &#123; return Auth.create(accessKey, secretKey); &#125; /** * æ„å»ºä¸ƒç‰›ç©ºé—´ç®¡ç†å®ä¾‹ */ @Bean public BucketManager bucketManager() &#123; return new BucketManager(auth(), qiNiuConfig()); &#125; &#125; æœ¬åœ°ä¸Šä¼ é…ç½®ä¿¡æ¯å®Œå–„ æœ¬åœ°ä¸Šä¼ ç›®å‰ä¸éœ€è¦è¿›è¡Œé…ç½®ï¼Œé¡¹ç›®ä¸Šçº¿å¯ä»¥è¿›è¡ŒåŸŸåé…ç½®åŸŸåé…åˆ¶ ä¸Šä¼ ç­–ç•¥æšä¸¾ @Getter @AllArgsConstructor public enum UploadModeEnum &#123; /** * æœ¬åœ° */ LOCAL(\"local\", \"localUploadStrategyImpl\"), /** * oss */ OSS(\"oss\", \"ossUploadStrategyImpl\"), /** * cos */ COS(\"cos\", \"cosUploadStrategyImpl\"), /** * qiniu */ QINIU(\"qiniu\", \"qiniuUploadStrategyImpl\"); /** * æ¨¡å¼ */ private final String mode; /** * ç­–ç•¥ */ private final String strategy; /** * è·å–ç­–ç•¥ * * @param mode æ¨¡å¼ * @return æœç´¢ç­–ç•¥ */ public static String getStrategy(String mode) &#123; for (UploadModeEnum value : UploadModeEnum.values()) &#123; if (value.getMode().equals(mode)) &#123; return value.getStrategy(); &#125; &#125; return null; &#125; &#125; 2.ç­–ç•¥å®ç°ç±»å†…éƒ¨å®ç°-æ¨¡æ¿è®¾è®¡æ¨¡å¼æˆ‘ä»¬åœ¨è¿›è¡Œå…·ä½“æ–‡ä»¶ä¸Šä¼ ç­–ç•¥å®ç°ä¹‹å‰æ€»ç»“ä¸€ä¸‹æ‰€æ¶‰åŠåˆ°çš„åŠŸèƒ½ã€‚ åˆå§‹åŒ–å®¢æˆ·ç«¯ æ–‡ä»¶æ˜¯å¦å·²ç»å­˜åœ¨ æ–‡ä»¶ä¸Šä¼  è·å–è®¿é—®è·¯å¾„ æˆ‘ä»¬ä¼šå‘ç°æ— è®ºæ˜¯é€šè¿‡å“ªä¸ªå¹³å°è¿›è¡Œæ–‡ä»¶çš„ä¸Šä¼ ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¼šä½¿ç”¨åˆ°ä¸Šè¿°çš„æ­¥éª¤ï¼Œä¹Ÿå°±æ˜¯è¯´éƒ½ä¼šä½¿ç”¨åˆ°ä¸Šè¿°çš„æ–¹æ³•ã€‚æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»æ¥è§„å®šå…·ä½“æ‰€éœ€è¦ä½¿ç”¨çš„æ–¹æ³•ï¼Œç„¶åå„ä¸ªå…·ä½“å®ç°æ¥ç»§æ‰¿æˆ‘ä»¬çš„æŠ½è±¡ç±»å³å¯ã€‚ public abstract class AbstractUploadStrategyImpl implements UploadStrategy &#123; @Override public String uploadFile(MultipartFile file, String path) &#123; try &#123; // åˆ¤æ–­æ–‡ä»¶å¤§å°æ˜¯å¦è¶…è¿‡2MBï¼ˆ2MB=2*1024*1024 bytesï¼‰ if (file.getSize() > 2 * 1024 * 1024) &#123; // æŠ›å‡ºæ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶çš„å¼‚å¸¸ throw new ServiceException(\"æ–‡ä»¶å¤§å°ä¸èƒ½è¶…å‡º2MBï¼\"); &#125; //è·å–æ–‡ä»¶md5å€¼ String md5 = FileUtils.getMd5(file.getInputStream()); //è·å–æ‹“å±•å String extName = FileUtils.getExtension(file); // é‡æ–°ç”Ÿæˆæ–‡ä»¶å String fileName = md5 + \".\" + extName; //region åˆå§‹åŒ– initClient(); //endregion // åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨ if (!exists(path + fileName)) &#123; // ä¸å­˜åœ¨åˆ™ç»§ç»­ä¸Šä¼  upload(path, fileName, file.getInputStream()); &#125; // è¿”å›æ–‡ä»¶è®¿é—®è·¯å¾„ String url=getFileAccessUrl(path + fileName); uploadToDB(file, path, md5, extName, url); return url; &#125; catch (Exception e) &#123; e.printStackTrace(); throw new ServiceException(\"æ–‡ä»¶ä¸Šä¼ å¤±è´¥\"); &#125; &#125; /** * åˆå§‹åŒ–å®¢æˆ·ç«¯ */ public abstract void initClient(); /** * åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ * * @param filePath æ–‡ä»¶è·¯å¾„ * @return &#123;@link Boolean&#125; */ public abstract Boolean exists(String filePath); /** * ä¸Šä¼  * * @param path è·¯å¾„ * @param fileName æ–‡ä»¶å * @param inputStream è¾“å…¥æµ * @throws IOException ioå¼‚å¸¸ */ public abstract void upload(String path, String fileName, InputStream inputStream) throws IOException; /** * è·å–æ–‡ä»¶è®¿é—®url * * @param filePath æ–‡ä»¶è·¯å¾„ * @return &#123;@link String&#125; æ–‡ä»¶url */ public abstract String getFileAccessUrl(String filePath); public abstract void uploadToDB(MultipartFile file, String path, String md5, String extName, String url); &#125; 3.Ossä¸Šä¼ ç­–ç•¥å…·ä½“å®ç°Ossä¸Šä¼ ç­–ç•¥å…·ä½“å®ç° @Slf4j @Service(\"ossUploadStrategyImpl\") public class OssUploadStrategyImpl extends AbstractUploadStrategyImpl &#123; @Autowired private OssProperties ossProperties; @Autowired @Lazy private IBlogFileService blogFileService; @Override public void initClient() &#123; &#125; @Override public Boolean exists(String filePath) &#123; return getOssClient().doesObjectExist(ossProperties.getBucketName(), filePath); &#125; @Override public void upload(String path, String fileName, InputStream inputStream) &#123; OSS ossClient = getOssClient(); try &#123; // è°ƒç”¨ossæ–¹æ³•ä¸Šä¼  ossClient.putObject(ossProperties.getBucketName(), path + fileName, inputStream); &#125; catch (OSSException oe) &#123; log.error(\"Error Message:\" + oe.getErrorMessage()); log.error(\"Error Code:\" + oe.getErrorCode()); log.info(\"Request ID:\" + oe.getRequestId()); log.info(\"Host ID:\" + oe.getHostId()); &#125; catch (ClientException ce) &#123; log.error(\"Caught an ClientException, Error Message:\" + ce.getMessage()); &#125; finally &#123; if (ossClient != null) &#123; ossClient.shutdown(); &#125; &#125; &#125; @Override public String getFileAccessUrl(String filePath) &#123; return ossProperties.getUrl() + filePath; &#125; @Override public void uploadToDB(MultipartFile file, String path, String md5, String extName, String url) &#123; blogFileService.uploadToDB(file,path,md5,extName,url); &#125; /** * è·å–ossClient * * @return &#123;@link OSS&#125; ossClient */ private OSS getOssClient() &#123; return new OSSClientBuilder().build(ossProperties.getEndpoint(), ossProperties.getAccessKeyId(), ossProperties.getAccessKeySecret()); &#125; &#125; Cosä¸Šä¼ ç­–ç•¥å…·ä½“å®ç° @Slf4j @Service(\"cosUploadStrategyImpl\") public class CosUploadStrategyImpl extends AbstractUploadStrategyImpl &#123; @Autowired private CosProperties cosProperties; @Autowired @Lazy private IBlogFileService blogFileService; @Override public void initClient() &#123; &#125; @Override public Boolean exists(String filePath) &#123; return getCosClient().doesObjectExist(cosProperties.getBucketName(), filePath); &#125; @Override public void upload(String path, String fileName, InputStream inputStream) &#123; COSClient cosClient = getCosClient(); try &#123; ObjectMetadata objectMetadata = new ObjectMetadata(); // ä¸Šä¼ çš„æµå¦‚æœèƒ½å¤Ÿè·å–å‡†ç¡®çš„æµé•¿åº¦ï¼Œåˆ™æ¨èä¸€å®šå¡«å†™ content-length objectMetadata.setContentLength(inputStream.available()); // è°ƒç”¨cosæ–¹æ³•ä¸Šä¼  cosClient.putObject(cosProperties.getBucketName(), path + fileName, inputStream, objectMetadata); &#125; catch (CosServiceException e) &#123; log.error(\"Error Message:\" + e.getErrorMessage()); log.error(\"Error Code:\" + e.getErrorCode()); log.info(\"Request ID:\" + e.getRequestId()); &#125; catch (CosClientException e) &#123; log.error(\"Caught an CosClientException, Error Message:\" + e.getMessage()); &#125; catch (IOException e) &#123; log.error(\"Caught an IOException, Error Message:\" + e.getMessage()); &#125; finally &#123; cosClient.shutdown(); &#125; &#125; @Override public String getFileAccessUrl(String filePath) &#123; return cosProperties.getUrl() + filePath; &#125; @Override public void uploadToDB(MultipartFile file, String path, String md5, String extName, String url) &#123; blogFileService.uploadToDB(file,path,md5,extName,url); &#125; /** * è·å–cosClient * * @return &#123;@link COSClient&#125; cosClient */ private COSClient getCosClient() &#123; // 1 åˆå§‹åŒ–ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼ˆsecretId, secretKeyï¼‰ã€‚ COSCredentials cred = new BasicCOSCredentials(cosProperties.getSecretId(), cosProperties.getSecretKey()); // 2 è®¾ç½® bucket çš„åœ°åŸŸ, COS åœ°åŸŸçš„ç®€ç§°è¯·å‚ç…§ https://cloud.tencent.com/document/product/436/6224 Region region = new Region(cosProperties.getRegion()); ClientConfig clientConfig = new ClientConfig(region); // è¿™é‡Œå»ºè®®è®¾ç½®ä½¿ç”¨ https åè®® // ä» 5.6.54 ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤ä½¿ç”¨äº† https clientConfig.setHttpProtocol(HttpProtocol.https); // 3 ç”Ÿæˆ cos å®¢æˆ·ç«¯ã€‚ return new COSClient(cred, clientConfig); &#125; &#125; æœ¬åœ°ä¸Šä¼ ç­–ç•¥å…·ä½“å®ç°-åœ¨LocalUploadStrategyImplå®ç°æ–‡ä»¶ä¸Šä¼ è‡³æœ¬åœ° @Slf4j @Getter @Setter @RequiredArgsConstructor @Service(\"localUploadStrategyImpl\") public class LocalUploadStrategyImpl extends AbstractUploadStrategyImpl &#123; /** * è®¿é—®url */ @Value(\"$&#123;upload.local.url&#125;\") private String localUrl; /** * æœ¬åœ°è·¯å¾„ */ @Value(\"$&#123;upload.local.path&#125;\") private String localPath; /** * æœ¬åœ°é¡¹ç›®ç«¯å£ */ @Value(\"$&#123;server.port&#125;\") private Integer port; @Autowired @Lazy private IBlogFileService blogFileService; //TODO æœ¬åœ°ä¸Šä¼ å¾…ä¼˜åŒ– @Override public void initClient() &#123; //win æœ¬åœ° // try &#123; // localPath = ResourceUtils.getURL(\"classpath:\").getPath() + \"static/imgs/\"; // &#125; catch (FileNotFoundException e) &#123; // e.printStackTrace(); // throw new ServiceException(\"æ–‡ä»¶ä¸å­˜åœ¨\"); // &#125; // åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨ File directory = new File(localPath); if (!directory.exists()) &#123; if (directory.mkdirs()) &#123; throw new ServiceException(\"åˆ›å»ºç›®å½•å¤±è´¥\"); &#125; &#125; &#125; @Override public Boolean exists(String filePath) &#123; return new File(localPath + filePath).exists(); &#125; @Override public void upload(String path, String fileName, InputStream inputStream) throws IOException &#123; // åˆ¤æ–­ä¸Šä¼ ç›®å½•æ˜¯å¦å­˜åœ¨ File directory = new File(localPath + path); if (!directory.exists()) &#123; if (!directory.mkdirs()) &#123; throw new ServiceException(\"åˆ›å»ºç›®å½•å¤±è´¥\"); &#125; &#125; // å†™å…¥æ–‡ä»¶ File file = new File(localPath + path + fileName); if (file.createNewFile()) &#123; //ä½¿ç”¨ç¼“å†²æµå†™å…¥æœ¬åœ° try (BufferedInputStream bis = new BufferedInputStream(inputStream); BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(file))) &#123; byte[] bytes = new byte[4096]; int length; while ((length = bis.read(bytes)) != -1) &#123; bos.write(bytes, 0, length); &#125; &#125; &#125; &#125; @Override public String getFileAccessUrl(String filePath) &#123; return localPath + filePath; &#125; @Override public void uploadToDB(MultipartFile file, String path, String md5, String extName, String url) &#123; blogFileService.uploadToDB(file,path,md5,extName,url); &#125; &#125; 4.ç­–ç•¥ä¸Šä¸‹æ–‡å®ç°æˆ‘ä»¬é€šè¿‡ç­–ç•¥ä¸Šä¸‹æ–‡æ¥é€‰æ‹©ä½¿ç”¨å“ªç§ä¸Šä¼ æ–¹å¼ã€‚æ³¨æ„ç‚¹ï¼š å½“Mapé›†åˆçš„Valueä¸ºæ¥å£ç±»å‹æ—¶ï¼ŒSpringä¼šè‡ªåŠ¨å¯¹Mapé›†åˆè¿›è¡Œæ³¨å…¥ã€‚ â€‹ å…¶ä¸­mapé›†åˆçš„keyä¸ºæ¥å£å¯¹åº”å®ç°ç±»çš„BeanNameâ€‹ å…¶ä¸­mapé›†åˆçš„vlaueä¸ºæ¥å£å¯¹åº”å®ç°ç±»çš„å®ä¾‹ å…¶ä¸­ä¼ å…¥çš„uploadServiceNameå°±æ˜¯å¯¹åº”ç­–ç•¥ç±»æ‰€è§„å®šçš„çš„BeanNameï¼Œè¿™é‡Œçš„BeanNameå°±ä½œä¸ºé€‰æ‹©çš„æ¡ä»¶ã€‚ @Service public class UploadStrategyContext &#123; /** * ä¸Šä¼ æ¨¡å¼ */ @Value(\"$&#123;upload.strategy&#125;\") private String uploadStrategy; @Autowired private Map&lt;String, UploadStrategy> uploadStrategyMap; /** * ä¸Šä¼ æ–‡ä»¶ * * @param file æ–‡ä»¶ * @param path è·¯å¾„ * @return &#123;@link String&#125; æ–‡ä»¶åœ°å€ */ public String executeUploadStrategy(MultipartFile file, String path) &#123; return uploadStrategyMap.get(getStrategy(uploadStrategy)).uploadFile(file, path); &#125; &#125; 5.ä¸åŒç­–ç•¥ä¸Šä¼ æµ‹è¯•@RestController @RequiredArgsConstructor public class UploadController &#123; private final UploadStrategyContext uploadStrategyContext; @PostMapping(\"/upload\") public ResponseResult&lt;?> upload(MultipartFile file) &#123; return ResponseResult.success(\"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼\",uploadStrategyContext.executeUploadStrategy(file,\"/blog/avatar\",\"cosUploadServiceImpl\")); &#125; &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"},{"name":"å›¾ç‰‡ä¸Šä¼ ","slug":"å›¾ç‰‡ä¸Šä¼ ","permalink":"https://blog.ehzyil.xyz/tags/%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/"}],"author":"ehzyil"},{"title":"å¼‚å¸¸ä¹‹doesn't have a default value","slug":"2023/å¼‚å¸¸ä¹‹doesn't have a default value","date":"2023-10-17T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/17/2023/å¼‚å¸¸ä¹‹doesn't have a default value/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/17/2023/%E5%BC%82%E5%B8%B8%E4%B9%8Bdoesn't%20have%20a%20default%20value/","excerpt":"","text":"MySQLæŠ¥é”™Field â€˜user_idâ€™ doesnâ€™t have a default valueä¸€ã€é—®é¢˜ æ‰§è¡Œsqlè¯­å¥æ—¶ï¼ŒæŠ¥é”™Field â€˜user_idâ€™ doesnâ€™t have a default valueï¼› ![image-20231017122452384](.&#x2F;images&#x2F;å¼‚å¸¸ä¹‹doesnâ€™t have a default value&#x2F;image-20231017122452384.png) äºŒã€è§£å†³ 1ã€è¡¨ç»“æ„ CREATE TABLE `sys_user_role` ( `user_id` bigint NOT NULL COMMENT 'ç”¨æˆ·ID', `role_id` bigint NOT NULL COMMENT 'è§’è‰²ID', ) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COMMENT='ç”¨æˆ·å’Œè§’è‰²å…³è”è¡¨' 2ã€æ‰§è¡Œçš„sql INSERT INTO sys_user_role ( role_id ) VALUES ( ? ) åœ¨æ’å…¥ä¿¡æ¯æ—¶åªæ’å…¥äº†â€™role_idâ€™æœªæ’å…¥â€™user_idâ€™,sqlä¸­æ²¡æœ‰å­—æ®µä¸” PRIMARY KEY (user_id,role_idï¼‰ å› æ­¤æ’å…¥æ—¶æŠ¥å¼‚å¸¸. ç»æŸ¥æ‰¾å®ä½“ç±»user_role å‘ç°åœ¨userIdä¸Šæ·»åŠ äº†å¦‚ä¸‹æ³¨è§£ @TableId(\"user_id\")//ç›¸å½“äº @TableId(\"user_id\") å¯¼è‡´æ— æ³•è·å–Userå®ä½“çš„userIdå­—æ®µã€‚ è§£å†³æ–¹æ¡ˆ å»æ‰@TableIdæ³¨è§£ å°†æ³¨è§£æ”¹ä¸ºï¼š@TableId(value &#x3D; â€œuser_idâ€, type &#x3D; IdType.INPUT) ä¸‰ã€å»¶ä¼¸ @TableIdæ³¨è§£ æè¿°ï¼šä¸»é”®æ³¨è§£ ä½¿ç”¨ä½ç½®ï¼šå®ä½“ç±»ä¸»é”®å­—æ®µ @TableName(\"sys_user\") public class User &#123; @TableId private Long id; private String name; private Integer age; private String email; &#125; å±æ€§ ç±»å‹ å¿…é¡»æŒ‡å®š é»˜è®¤å€¼ æè¿° value String å¦ â€œâ€ ä¸»é”®å­—æ®µå type Enum å¦ IdType.NONE æŒ‡å®šä¸»é”®ç±»å‹ IdType å€¼ æè¿° AUTO æ•°æ®åº“ ID è‡ªå¢ NONE æ— çŠ¶æ€ï¼Œè¯¥ç±»å‹ä¸ºæœªè®¾ç½®ä¸»é”®ç±»å‹ï¼ˆæ³¨è§£é‡Œç­‰äºè·Ÿéšå…¨å±€ï¼Œå…¨å±€é‡Œçº¦ç­‰äº INPUTï¼‰ INPUT insert å‰è‡ªè¡Œ set ä¸»é”®å€¼ ASSIGN_ID åˆ†é… ID(ä¸»é”®ç±»å‹ä¸º Number(Long å’Œ Integer)æˆ– String)(since 3.3.0),ä½¿ç”¨æ¥å£IdentifierGeneratorçš„æ–¹æ³•nextId(é»˜è®¤å®ç°ç±»ä¸ºDefaultIdentifierGeneratoré›ªèŠ±ç®—æ³•) ASSIGN_UUID åˆ†é… UUID,ä¸»é”®ç±»å‹ä¸º String(since 3.3.0),ä½¿ç”¨æ¥å£IdentifierGeneratorçš„æ–¹æ³•nextUUID(é»˜è®¤ default æ–¹æ³•) ID_WORKER åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€ ID é•¿æ•´å‹ç±»å‹(please use ASSIGN_ID) UUID 32 ä½ UUID å­—ç¬¦ä¸²(please use ASSIGN_UUID) ID_WORKER_STR åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€ ID å­—ç¬¦ä¸²ç±»å‹(please use ASSIGN_ID)","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://blog.ehzyil.xyz/tags/MySQL/"},{"name":"å¼‚å¸¸","slug":"å¼‚å¸¸","permalink":"https://blog.ehzyil.xyz/tags/%E5%BC%82%E5%B8%B8/"}],"author":"ehzyil"},{"title":"Spring Bootæ•´åˆQuartzå®ç°åŠ¨æ€å®šæ—¶ä»»åŠ¡","slug":"2023/Spring Bootæ•´åˆQuartzå®ç°åŠ¨æ€å®šæ—¶ä»»åŠ¡","date":"2023-10-16T20:22:46.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/16/2023/Spring Bootæ•´åˆQuartzå®ç°åŠ¨æ€å®šæ—¶ä»»åŠ¡/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/16/2023/Spring%20Boot%E6%95%B4%E5%90%88Quartz%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/","excerpt":"","text":"æœ¬æ–‡ç›®çš„æ˜¯Spring Bootæ•´åˆQuartzå®ç°åŠ¨æ€ä»»åŠ¡é…ç½®å’Œå®ç°å®šæ—¶æ¸…ç†æ—¥å¿—ã€‚ Spring Bootæ•´åˆQuartz è¯¦è§ Quartz ä½¿ç”¨æ•™ç¨‹ å‰ç½®å‡†å¤‡/** * å®šæ—¶ä»»åŠ¡ */ @Data @Builder @NoArgsConstructor @AllArgsConstructor public class Task &#123; /** * ä»»åŠ¡id */ @TableId(type = IdType.AUTO) private Integer id; /** * ä»»åŠ¡åç§° */ private String taskName; /** * ä»»åŠ¡ç»„å */ private String taskGroup; /** * è°ƒç”¨ç›®æ ‡ */ private String invokeTarget; /** * cronæ‰§è¡Œè¡¨è¾¾å¼ */ private String cronExpression; /** * è®¡åˆ’æ‰§è¡Œé”™è¯¯ç­–ç•¥ (1ç«‹å³æ‰§è¡Œ 2æ‰§è¡Œä¸€æ¬¡ 3æ”¾å¼ƒæ‰§è¡Œ) */ private Integer misfirePolicy; /** * æ˜¯å¦å¹¶å‘æ‰§è¡Œ (0å¦ 1æ˜¯) */ private Integer concurrent; /** * ä»»åŠ¡çŠ¶æ€ (0è¿è¡Œ 1æš‚åœ) */ private Integer status; /** * ä»»åŠ¡å¤‡æ³¨ä¿¡æ¯ */ private String remark; /** * åˆ›å»ºæ—¶é—´ */ @TableField(fill = FieldFill.INSERT) private LocalDateTime createTime; /** * æ›´æ–°æ—¶é—´ */ @TableField(fill = FieldFill.UPDATE) private LocalDateTime updateTime; &#125; SpringUtilså·¥å…·ç±»ï¼Œç”¨äºè·å–beanã€‚ @Component public final class SpringUtils implements BeanFactoryPostProcessor &#123; private static ConfigurableListableBeanFactory beanFactory; @Override public void postProcessBeanFactory(@NotNull ConfigurableListableBeanFactory beanFactory) throws BeansException &#123; SpringUtils.beanFactory = beanFactory; &#125; /** * è·å–å¯¹è±¡ */ @SuppressWarnings(\"unchecked\") public static &lt;T> T getBean(String name) throws BeansException &#123; return (T) beanFactory.getBean(name); &#125; /** * è·å–ç±»å‹ä¸ºrequiredTypeçš„å¯¹è±¡ */ public static &lt;T> T getBean(Class&lt;T> clz) throws BeansException &#123; return beanFactory.getBean(clz); &#125; public static Class&lt;?> getType(String name) throws NoSuchBeanDefinitionException &#123; return beanFactory.getType(name); &#125; &#125; åˆ›å»ºå®šæ—¶ä»»åŠ¡å·¥å…·ç±» /** * å®šæ—¶ä»»åŠ¡å·¥å…·ç±» * * @author ican */ public class ScheduleUtils &#123; /** * å¾—åˆ°quartzä»»åŠ¡ç±» * * @param task æ‰§è¡Œè®¡åˆ’ * @return å…·ä½“æ‰§è¡Œä»»åŠ¡ç±» */ private static Class&lt;? extends Job> getQuartzJobClass(Task task) &#123; boolean isConcurrent = TRUE.equals(task.getConcurrent()); return isConcurrent ? QuartzJobExecution.class : QuartzDisallowConcurrentExecution.class; &#125; /** * æ„å»ºä»»åŠ¡è§¦å‘å¯¹è±¡ */ public static TriggerKey getTriggerKey(Integer taskId, String taskGroup) &#123; return TriggerKey.triggerKey(ScheduleConstant.TASK_CLASS_NAME + taskId, taskGroup); &#125; /** * æ„å»ºä»»åŠ¡é”®å¯¹è±¡ */ public static JobKey getJobKey(Integer taskId, String taskGroup) &#123; return JobKey.jobKey(ScheduleConstant.TASK_CLASS_NAME + taskId, taskGroup); &#125; /** * åˆ›å»ºå®šæ—¶ä»»åŠ¡ */ public static void createScheduleJob(Scheduler scheduler, Task task) &#123; try &#123; Class&lt;? extends Job> jobClass = getQuartzJobClass(task); // æ„å»ºtaskä¿¡æ¯ Integer taskId = task.getId(); String taskGroup = task.getTaskGroup(); JobDetail jobDetail = JobBuilder.newJob(jobClass).withIdentity(getJobKey(taskId, taskGroup)).build(); // è¡¨è¾¾å¼è°ƒåº¦æ„å»ºå™¨ CronScheduleBuilder cronScheduleBuilder = CronScheduleBuilder.cronSchedule(task.getCronExpression()); cronScheduleBuilder = handleCronScheduleMisfirePolicy(task, cronScheduleBuilder); // æŒ‰æ–°çš„cronExpressionè¡¨è¾¾å¼æ„å»ºä¸€ä¸ªæ–°çš„trigger CronTrigger trigger = TriggerBuilder.newTrigger().withIdentity(getTriggerKey(taskId, taskGroup)) .withSchedule(cronScheduleBuilder).build(); // æ”¾å…¥å‚æ•°ï¼Œè¿è¡Œæ—¶çš„æ–¹æ³•å¯ä»¥è·å– jobDetail.getJobDataMap().put(ScheduleConstant.TASK_PROPERTIES, task); // åˆ¤æ–­æ˜¯å¦å­˜åœ¨ if (scheduler.checkExists(getJobKey(taskId, taskGroup))) &#123; // é˜²æ­¢åˆ›å»ºæ—¶å­˜åœ¨æ•°æ®é—®é¢˜ å…ˆç§»é™¤ï¼Œç„¶ååœ¨æ‰§è¡Œåˆ›å»ºæ“ä½œ scheduler.deleteJob(getJobKey(taskId, taskGroup)); &#125; scheduler.scheduleJob(jobDetail, trigger); // æš‚åœä»»åŠ¡ if (task.getStatus().equals(TaskStatusEnum.PAUSE.getStatus())) &#123; scheduler.pauseJob(ScheduleUtils.getJobKey(taskId, taskGroup)); &#125; &#125; catch (ServiceException | SchedulerException e) &#123; throw new ServiceException(e.getMessage()); &#125; &#125; /** * è®¾ç½®å®šæ—¶ä»»åŠ¡ç­–ç•¥ */ public static CronScheduleBuilder handleCronScheduleMisfirePolicy(Task task, CronScheduleBuilder cb) throws ServiceException &#123; switch (task.getMisfirePolicy()) &#123; case ScheduleConstant.MISFIRE_DEFAULT: return cb; case ScheduleConstant.MISFIRE_IGNORE_MISFIRES: return cb.withMisfireHandlingInstructionIgnoreMisfires(); case ScheduleConstant.MISFIRE_FIRE_AND_PROCEED: return cb.withMisfireHandlingInstructionFireAndProceed(); case ScheduleConstant.MISFIRE_DO_NOTHING: return cb.withMisfireHandlingInstructionDoNothing(); default: throw new ServiceException(\"The task misfire policy '\" + task.getMisfirePolicy() + \"' cannot be used in cron schedule tasks\"); &#125; &#125; &#125; ä»»åŠ¡æ‰§è¡Œå·¥å…· /** * ä»»åŠ¡æ‰§è¡Œå·¥å…· */ public class TaskInvokeUtils &#123; /** * æ‰§è¡Œæ–¹æ³• * * @param task ç³»ç»Ÿä»»åŠ¡ */ public static void invokeMethod(Task task) throws Exception &#123; String invokeTarget = task.getInvokeTarget(); String beanName = getBeanName(invokeTarget); String methodName = getMethodName(invokeTarget); List&lt;Object[]> methodParams = getMethodParams(invokeTarget); if (!isValidClassName(beanName)) &#123; Object bean = SpringUtils.getBean(beanName); invokeMethod(bean, methodName, methodParams); &#125; else &#123; Object bean = Class.forName(beanName).getDeclaredConstructor().newInstance(); invokeMethod(bean, methodName, methodParams); &#125; &#125; /** * è°ƒç”¨ä»»åŠ¡æ–¹æ³• * * @param bean ç›®æ ‡å¯¹è±¡ * @param methodName æ–¹æ³•åç§° * @param methodParams æ–¹æ³•å‚æ•° */ private static void invokeMethod(Object bean, String methodName, List&lt;Object[]> methodParams) throws NoSuchMethodException, SecurityException, IllegalAccessException, IllegalArgumentException, InvocationTargetException &#123; if (methodParams != null &amp;&amp; methodParams.size() > 0) &#123; Method method = bean.getClass().getDeclaredMethod(methodName, getMethodParamsType(methodParams)); method.invoke(bean, getMethodParamsValue(methodParams)); &#125; else &#123; Method method = bean.getClass().getDeclaredMethod(methodName); method.invoke(bean); &#125; &#125; /** * æ ¡éªŒæ˜¯å¦ä¸ºä¸ºclassåŒ…å * * @param invokeTarget è°ƒç”¨ç›®æ ‡ * @return trueæ˜¯ falseå¦ */ public static boolean isValidClassName(String invokeTarget) &#123; return StringUtils.countMatches(invokeTarget, \".\") > 1; &#125; /** * è·å–beanåç§° * * @param invokeTarget è°ƒç”¨ç›®æ ‡ * @return beanåç§° */ public static String getBeanName(String invokeTarget) &#123; String beanName = StringUtils.substringBefore(invokeTarget, \"(\"); return StringUtils.substringBeforeLast(beanName, \".\"); &#125; /** * è·å–beanæ–¹æ³• * * @param invokeTarget è°ƒç”¨ç›®æ ‡ * @return methodæ–¹æ³• */ public static String getMethodName(String invokeTarget) &#123; String methodName = StringUtils.substringBefore(invokeTarget, \"(\"); return StringUtils.substringAfterLast(methodName, \".\"); &#125; /** * è·å–methodæ–¹æ³•å‚æ•°ç›¸å…³åˆ—è¡¨ * * @param invokeTarget è°ƒç”¨ç›®æ ‡ * @return methodæ–¹æ³•ç›¸å…³å‚æ•°åˆ—è¡¨ */ public static List&lt;Object[]> getMethodParams(String invokeTarget) &#123; String methodStr = StringUtils.substringBetween(invokeTarget, \"(\", \")\"); if (StringUtils.isEmpty(methodStr)) &#123; return null; &#125; String[] methodParams = methodStr.split(\",(?=([^\\\"']*[\\\"'][^\\\"']*[\\\"'])*[^\\\"']*$)\"); List&lt;Object[]> clazz = new LinkedList&lt;>(); for (String methodParam : methodParams) &#123; String str = StringUtils.trimToEmpty(methodParam); // Stringå­—ç¬¦ä¸²ç±»å‹ï¼Œä»¥'æˆ–\"å¼€å¤´ if (StringUtils.startsWithAny(str, \"'\", \"\\\"\")) &#123; clazz.add(new Object[]&#123;StringUtils.substring(str, 1, str.length() - 1), String.class&#125;); &#125; // booleanå¸ƒå°”ç±»å‹ï¼Œç­‰äºtrueæˆ–è€…false else if (\"true\".equalsIgnoreCase(str) || \"false\".equalsIgnoreCase(str)) &#123; clazz.add(new Object[]&#123;Boolean.valueOf(str), Boolean.class&#125;); &#125; // longé•¿æ•´å½¢ï¼Œä»¥Lç»“å°¾ else if (StringUtils.endsWith(str, \"L\")) &#123; clazz.add(new Object[]&#123;Long.valueOf(StringUtils.substring(str, 0, str.length() - 1)), Long.class&#125;); &#125; // doubleæµ®ç‚¹ç±»å‹ï¼Œä»¥Dç»“å°¾ else if (StringUtils.endsWith(str, \"D\")) &#123; clazz.add(new Object[]&#123;Double.valueOf(StringUtils.substring(str, 0, str.length() - 1)), Double.class&#125;); &#125; // å…¶ä»–ç±»å‹å½’ç±»ä¸ºæ•´å½¢ else &#123; clazz.add(new Object[]&#123;Integer.valueOf(str), Integer.class&#125;); &#125; &#125; return clazz; &#125; /** * è·å–å‚æ•°ç±»å‹ * * @param methodParams å‚æ•°ç›¸å…³åˆ—è¡¨ * @return å‚æ•°ç±»å‹åˆ—è¡¨ */ public static Class&lt;?>[] getMethodParamsType(List&lt;Object[]> methodParams) &#123; Class&lt;?>[] clazz = new Class&lt;?>[methodParams.size()]; int index = 0; for (Object[] os : methodParams) &#123; clazz[index] = (Class&lt;?>) os[1]; index++; &#125; return clazz; &#125; /** * è·å–å‚æ•°å€¼ * * @param methodParams å‚æ•°ç›¸å…³åˆ—è¡¨ * @return å‚æ•°å€¼åˆ—è¡¨ */ public static Object[] getMethodParamsValue(List&lt;Object[]> methodParams) &#123; Object[] clazz = new Object[methodParams.size()]; int index = 0; for (Object[] os : methodParams) &#123; clazz[index] = os[0]; index++; &#125; return clazz; &#125; &#125; cronè¡¨è¾¾å¼å·¥å…·ç±» /** * cronè¡¨è¾¾å¼å·¥å…·ç±» */ public class CronUtils &#123; /** * è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ä»£è¡¨ä¸€ä¸ªç»™å®šçš„Cronè¡¨è¾¾å¼çš„æœ‰æ•ˆæ€§ * * @param cronExpression Cronè¡¨è¾¾å¼ * @return boolean è¡¨è¾¾å¼æ˜¯å¦æœ‰æ•ˆ */ public static boolean isValid(String cronExpression) &#123; return CronExpression.isValidExpression(cronExpression); &#125; /** * è¿”å›ä¸‹ä¸€ä¸ªæ‰§è¡Œæ—¶é—´æ ¹æ®ç»™å®šçš„Cronè¡¨è¾¾å¼ * * @param cronExpression Cronè¡¨è¾¾å¼ * @return Date ä¸‹æ¬¡Cronè¡¨è¾¾å¼æ‰§è¡Œæ—¶é—´ */ public static Date getNextExecution(String cronExpression) &#123; try &#123; CronExpression cron = new CronExpression(cronExpression); return cron.getNextValidTimeAfter(new Date(System.currentTimeMillis())); &#125; catch (ParseException e) &#123; throw new IllegalArgumentException(e.getMessage()); &#125; &#125; &#125; å®šæ—¶ä»»åŠ¡çš„é…ç½®ä¸å®ç°åŸºæœ¬é…ç½®1.åˆ›å»ºæŠ½è±¡ç±»ï¼šAbstractQuartzJob public abstract class AbstractQuartzJob implements Job &#123; private static final Logger log = LoggerFactory.getLogger(AbstractQuartzJob.class); //çº¿ç¨‹æœ¬åœ°å˜é‡ ç”¨äºå­˜å‚¨æ‰§è¡Œå¼€å§‹æ—¶é—´ private static ThreadLocal&lt;Date> threadLocal = new ThreadLocal&lt;>(); @Override public void execute(JobExecutionContext context) &#123; Task task = new Task(); BeanUtils.copyProperties(context.getMergedJobDataMap().get(ScheduleConstant.TASK_PROPERTIES), task); try &#123; before(context, task); doExecute(context, task); after(context, task, null); &#125; catch (Exception e) &#123; log.error(\"ä»»åŠ¡æ‰§è¡Œå¼‚å¸¸ - ï¼š\", e); after(context, task, e); &#125; &#125; /** * æ‰§è¡Œå * * @param context å·¥ä½œæ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡ * @param task ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ */ private void after(JobExecutionContext context, Task task, Exception e) &#123; //è·å–ä»»åŠ¡å¼€å§‹æ—¶é—´ Date startTime = threadLocal.get(); threadLocal.remove(); //è®°å½•ä»»åŠ¡æ—¥å¿— final TaskLog taskLog = new TaskLog(); taskLog.setTaskName(task.getTaskName()); taskLog.setTaskGroup(task.getTaskGroup()); taskLog.setInvokeTarget(task.getInvokeTarget()); long runTime = new Date().getTime() - startTime.getTime(); taskLog.setTaskMessage(taskLog.getTaskName() + \" æ€»å…±è€—æ—¶ï¼š\" + runTime + \"æ¯«ç§’\"); //å¤„ç†å¼‚å¸¸æƒ…å†µ if (e != null) &#123; taskLog.setStatus(FALSE); //æˆªå–å¼‚å¸¸ä¿¡æ¯ String errorMsg = StringUtils.substring(e.getMessage(), 0, 2000); taskLog.setErrorInfo(errorMsg); &#125; else &#123; //æ­£å¸¸æƒ…å†µ taskLog.setStatus(TRUE); &#125; // å†™å…¥æ•°æ®åº“å½“ä¸­ SpringUtils.getBean(TaskLogMapper.class).insert(taskLog); &#125; /** * æ‰§è¡Œæ–¹æ³•ï¼Œç”±å­ç±»é‡è½½ * * @param context å·¥ä½œæ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡ * @param task ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ * @throws Exception æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å¼‚å¸¸ */ protected abstract void doExecute(JobExecutionContext context, Task task) throws Exception; /** * æ‰§è¡Œå‰ * * @param context å·¥ä½œæ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡ * @param task ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ */ private void before(JobExecutionContext context, Task task) &#123; threadLocal.set(new Date()); &#125; &#125; è¯¥æŠ½è±¡ç±»ä¸ºè°ƒç”¨å®šæ—¶ä»»åŠ¡çš„æ¨¡æ¿ç±»ï¼Œå­ç±»é€šè¿‡é‡è½½æ¥å®ç°æ”¯æŒå¹¶å‘çš„ä»»åŠ¡å’Œé»˜è®¤çš„ä»»åŠ¡ï¼ˆéå¹¶å‘ï¼‰ã€‚ å…¶ä¸­ä¸‹åˆ—çš„before()æ–¹æ³•ç”¨äºè®°å½•ä»»åŠ¡å¼€å§‹çš„æ‰§è¡Œæ—¶é—´å¹¶å­˜å…¥çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­ã€‚ after()æ–¹æ³•ç”¨æ¥è®°å½•ä»»åŠ¡çš„æ‰§è¡Œæ—¥å¿—ã€‚ /** * æ‰§è¡Œå‰ * * @param context å·¥ä½œæ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡ * @param task ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ */ private void before(JobExecutionContext context, Task task) &#123; ... &#125; /** * æ‰§è¡Œå * * @param context å·¥ä½œæ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡ * @param task ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ */ private void after(JobExecutionContext context, Task task, Exception e) &#123; ... &#125; æŠ½è±¡ç±»AbstractQuartzJobçš„å®ç°ç±» /** * å®šæ—¶ä»»åŠ¡å¤„ç†ï¼ˆç¦æ­¢å¹¶å‘æ‰§è¡Œï¼‰ */ @DisallowConcurrentExecution public class QuartzDisallowConcurrentExecution extends AbstractQuartzJob &#123; @Override protected void doExecute(JobExecutionContext context, Task task) throws Exception &#123; TaskInvokeUtils.invokeMethod(task); &#125; &#125; /** * å®šæ—¶ä»»åŠ¡å¤„ç†ï¼ˆå…è®¸å¹¶å‘æ‰§è¡Œï¼‰ */ public class QuartzJobExecution extends AbstractQuartzJob &#123; @Override protected void doExecute(JobExecutionContext context, Task task) throws Exception &#123; TaskInvokeUtils.invokeMethod(task); &#125; &#125; åˆ›å»ºæ‰§è¡Œå®šæ—¶ä»»åŠ¡ç±»ï¼šTimedTask,å…¶ä¸­clearç”¨äºæ¸…é™¤åšå®¢è®¿é—®è®°å½•ï¼ŒclearVistiLog()ç”¨äº æ¸…é™¤ä¸€å‘¨å‰çš„è®¿é—®æ—¥å¿—ï¼Œclear() ç”¨äºæ‰§è¡Œæµ‹è¯•ä»»åŠ¡ã€‚ /** * æ‰§è¡Œå®šæ—¶ä»»åŠ¡ */ @SuppressWarnings(value = \"all\") @Component(\"timedTask\") public class TimedTask &#123; @Autowired private RedisService redisService; @Autowired private VisitLogMapper visitLogMapper; /** * æ¸…é™¤åšå®¢è®¿é—®è®°å½• */ public void clear() &#123; redisService.deleteObject(UNIQUE_VISITOR); &#125; /** * æµ‹è¯•ä»»åŠ¡ */ public void test() &#123; System.out.println(\"æµ‹è¯•ä»»åŠ¡\"); &#125; /** * æ¸…é™¤ä¸€å‘¨å‰çš„è®¿é—®æ—¥å¿— */ public void clearVistiLog() &#123; DateTime endTime = DateUtil.beginOfDay(DateUtil.offsetDay(new Date(), -7)); visitLogMapper.deleteVisitLog(endTime); &#125; &#125; è‡³æ­¤åªéœ€è¦å®ç°å®šæ—¶ä»»åŠ¡çš„è°ƒç”¨å³å¯ã€‚ç”±äºè¯¥é¡¹ç›®å®šæ—¶ä»»åŠ¡æŠ€æœ¯åŠ¨æ€é…ç½®å’Œæ¥å£æ¥å£è°ƒç”¨ï¼Œå› æ­¤ä½¿ç”¨æ‰‹åŠ¨è°ƒç”¨æ¥å£å®ç°ã€‚ é‡ç‚¹1.åˆ›å»ºå®šæ—¶ä»»åŠ¡ä¸è°ƒåº¦å™¨ Scheduler é€šè¿‡æŸ¥æ‰¾t_taskè¡¨æŸ¥è¯¢æ‰€æœ‰ä»»åŠ¡ é€šè¿‡ScheduleUtils.createScheduleJob(scheduler, task)åˆ›å»ºå®šæ—¶ä»»åŠ¡ @Autowired private Scheduler scheduler; @Autowired private TaskMapper taskMapper; /** * é¡¹ç›®å¯åŠ¨æ—¶ï¼Œåˆå§‹åŒ–å®šæ—¶å™¨ ä¸»è¦æ˜¯é˜²æ­¢æ‰‹åŠ¨ä¿®æ”¹æ•°æ®åº“å¯¼è‡´æœªåŒæ­¥åˆ°å®šæ—¶ä»»åŠ¡å¤„ç† * æ³¨ï¼šä¸èƒ½æ‰‹åŠ¨ä¿®æ”¹æ•°æ®åº“IDå’Œä»»åŠ¡ç»„åï¼Œå¦åˆ™ä¼šå¯¼è‡´è„æ•°æ® */ @PostConstruct public void init() throws SchedulerException &#123; scheduler.clear(); List&lt;Task> taskList = taskMapper.selectList(null); for (Task task : taskList) &#123; // åˆ›å»ºå®šæ—¶ä»»åŠ¡ ScheduleUtils.createScheduleJob(scheduler, task); &#125; &#125; 2.åˆ›å»ºJobDetailå®ä¾‹ä¸æ„å»ºTriggerå®ä¾‹ public static void createScheduleJob(Scheduler scheduler, Task task) &#123; try &#123; Class&lt;? extends Job> jobClass = getQuartzJobClass(task); // æ„å»ºtaskä¿¡æ¯ Integer taskId = task.getId(); String taskGroup = task.getTaskGroup(); JobDetail jobDetail = JobBuilder.newJob(jobClass).withIdentity(getJobKey(taskId, taskGroup)).build(); // è¡¨è¾¾å¼è°ƒåº¦æ„å»ºå™¨ CronScheduleBuilder cronScheduleBuilder = CronScheduleBuilder.cronSchedule(task.getCronExpression()); cronScheduleBuilder = handleCronScheduleMisfirePolicy(task, cronScheduleBuilder); // æŒ‰æ–°çš„cronExpressionè¡¨è¾¾å¼æ„å»ºä¸€ä¸ªæ–°çš„trigger CronTrigger trigger = TriggerBuilder.newTrigger().withIdentity(getTriggerKey(taskId, taskGroup)) .withSchedule(cronScheduleBuilder).build(); // æ”¾å…¥å‚æ•°ï¼Œè¿è¡Œæ—¶çš„æ–¹æ³•å¯ä»¥è·å– jobDetail.getJobDataMap().put(ScheduleConstant.TASK_PROPERTIES, task); // åˆ¤æ–­æ˜¯å¦å­˜åœ¨ if (scheduler.checkExists(getJobKey(taskId, taskGroup))) &#123; // é˜²æ­¢åˆ›å»ºæ—¶å­˜åœ¨æ•°æ®é—®é¢˜ å…ˆç§»é™¤ï¼Œç„¶ååœ¨æ‰§è¡Œåˆ›å»ºæ“ä½œ scheduler.deleteJob(getJobKey(taskId, taskGroup)); &#125; scheduler.scheduleJob(jobDetail, trigger); // æš‚åœä»»åŠ¡ if (task.getStatus().equals(TaskStatusEnum.PAUSE.getStatus())) &#123; scheduler.pauseJob(ScheduleUtils.getJobKey(taskId, taskGroup)); &#125; &#125; catch (ServiceException | SchedulerException e) &#123; throw new ServiceException(e.getMessage()); &#125; &#125; 3.æ‰§è¡Œï¼Œå¼€å¯è°ƒåº¦å™¨ public void runTask(TaskRunDTO taskRun) &#123; Integer taskId = taskRun.getId(); String taskGroup = taskRun.getTaskGroup(); // æŸ¥è¯¢å®šæ—¶ä»»åŠ¡ Task task = taskMapper.selectById(taskRun.getId()); // è®¾ç½®å‚æ•° JobDataMap dataMap = new JobDataMap(); dataMap.put(ScheduleConstant.TASK_PROPERTIES, task); try &#123; scheduler.triggerJob(ScheduleUtils.getJobKey(taskId, taskGroup), dataMap); &#125; catch (SchedulerException e) &#123; throw new ServiceException(\"æ‰§è¡Œå®šæ—¶ä»»åŠ¡å¼‚å¸¸\"); &#125; &#125; ä¸šåŠ¡å±‚æœåŠ¡ç±»ITaskService public interface ITaskService extends IService&lt;Task> &#123; /** * æŸ¥çœ‹å®šæ—¶ä»»åŠ¡åˆ—è¡¨ * * @param condition æ¡ä»¶ * @return å®šæ—¶ä»»åŠ¡åˆ—è¡¨ */ PageResult&lt;TaskBackVO> listTaskBackVO(ConditionDTO condition); /** * æ·»åŠ å®šæ—¶ä»»åŠ¡ * * @param task å®šæ—¶ä»»åŠ¡ */ void addTask(TaskDTO task); /** * ä¿®æ”¹å®šæ—¶ä»»åŠ¡ * * @param task å®šæ—¶ä»»åŠ¡ä¿¡æ¯ */ void updateTask(TaskDTO task); /** * åˆ é™¤å®šæ—¶ä»»åŠ¡ * * @param taskIdList å®šæ—¶ä»»åŠ¡idé›†åˆ */ void deleteTask(List&lt;Integer> taskIdList); /** * ä¿®æ”¹å®šæ—¶ä»»åŠ¡çŠ¶æ€ * * @param taskStatus å®šæ—¶ä»»åŠ¡çŠ¶æ€ */ void updateTaskStatus(StatusDTO taskStatus); /** * å®šæ—¶ä»»åŠ¡ç«‹å³æ‰§è¡Œä¸€æ¬¡ * * @param taskRun å®šæ—¶ä»»åŠ¡ */ void runTask(TaskRunDTO taskRun); &#125; ä¸šåŠ¡å±‚å®ç°å®ç°ç±»TaskServiceImpl @Service public class TaskServiceImpl extends ServiceImpl&lt;TaskMapper, Task> implements ITaskService &#123; @Autowired private Scheduler scheduler; @Autowired private TaskMapper taskMapper; /** * é¡¹ç›®å¯åŠ¨æ—¶ï¼Œåˆå§‹åŒ–å®šæ—¶å™¨ ä¸»è¦æ˜¯é˜²æ­¢æ‰‹åŠ¨ä¿®æ”¹æ•°æ®åº“å¯¼è‡´æœªåŒæ­¥åˆ°å®šæ—¶ä»»åŠ¡å¤„ç† * æ³¨ï¼šä¸èƒ½æ‰‹åŠ¨ä¿®æ”¹æ•°æ®åº“IDå’Œä»»åŠ¡ç»„åï¼Œå¦åˆ™ä¼šå¯¼è‡´è„æ•°æ® */ @PostConstruct public void init() throws SchedulerException &#123; scheduler.clear(); List&lt;Task> taskList = taskMapper.selectList(null); for (Task task : taskList) &#123; // åˆ›å»ºå®šæ—¶ä»»åŠ¡ ScheduleUtils.createScheduleJob(scheduler, task); &#125; &#125; @Override public PageResult&lt;TaskBackVO> listTaskBackVO(ConditionDTO condition) &#123; // æŸ¥è¯¢å®šæ—¶ä»»åŠ¡æ•°é‡ Long count = taskMapper.countTaskBackVO(condition); if (count == 0) &#123; return new PageResult&lt;>(); &#125; // åˆ†é¡µæŸ¥è¯¢å®šæ—¶ä»»åŠ¡åˆ—è¡¨ List&lt;TaskBackVO> taskBackVOList = taskMapper.selectTaskBackVO(PageUtils.getLimit(), PageUtils.getSize(), condition); taskBackVOList.forEach(item -> &#123; if (StringUtils.isNotEmpty(item.getCronExpression())) &#123; Date nextExecution = CronUtils.getNextExecution(item.getCronExpression()); item.setNextValidTime(nextExecution); &#125; else &#123; item.setNextValidTime(null); &#125; &#125;); return new PageResult&lt;>(taskBackVOList, count); &#125; @Override public void addTask(TaskDTO task) &#123; Assert.isTrue(CronUtils.isValid(task.getCronExpression()), \"Cronè¡¨è¾¾å¼æ— æ•ˆ\"); Task newTask = BeanCopyUtils.copyBean(task, Task.class); // æ–°å¢å®šæ—¶ä»»åŠ¡ int row = taskMapper.insert(newTask); // åˆ›å»ºå®šæ—¶ä»»åŠ¡ if (row > 0) &#123; ScheduleUtils.createScheduleJob(scheduler, newTask); &#125; &#125; @Override public void updateTask(TaskDTO task) &#123; Assert.isTrue(CronUtils.isValid(task.getCronExpression()), \"Cronè¡¨è¾¾å¼æ— æ•ˆ\"); Task existTask = taskMapper.selectById(task.getId()); Task newTask = BeanCopyUtils.copyBean(task, Task.class); // æ›´æ–°å®šæ—¶ä»»åŠ¡ int row = taskMapper.updateById(newTask); if (row > 0) &#123; try &#123; updateSchedulerJob(newTask, existTask.getTaskGroup()); &#125; catch (SchedulerException e) &#123; throw new ServiceException(\"æ›´æ–°å®šæ—¶ä»»åŠ¡å¼‚å¸¸\"); &#125; &#125; &#125; @Override public void deleteTask(List&lt;Integer> taskIdList) &#123; List&lt;Task> taskList = taskMapper.selectList(new LambdaQueryWrapper&lt;Task>().select(Task::getId, Task::getTaskGroup).in(Task::getId, taskIdList)); // åˆ é™¤å®šæ—¶ä»»åŠ¡ int row = taskMapper.delete(new LambdaQueryWrapper&lt;Task>().in(Task::getId, taskIdList)); if (row > 0) &#123; taskList.forEach(task -> &#123; try &#123; scheduler.deleteJob(ScheduleUtils.getJobKey(task.getId(), task.getTaskGroup())); &#125; catch (SchedulerException e) &#123; throw new ServiceException(\"åˆ é™¤å®šæ—¶ä»»åŠ¡å¼‚å¸¸\"); &#125; &#125;); &#125; &#125; @Override public void updateTaskStatus(StatusDTO taskStatus) &#123; Task task = taskMapper.selectById(taskStatus.getId()); // ç›¸åŒä¸ç”¨æ›´æ–° if (task.getStatus().equals(taskStatus.getStatus())) &#123; return; &#125; // æ›´æ–°æ•°æ®åº“ä¸­çš„å®šæ—¶ä»»åŠ¡çŠ¶æ€ Task newTask = Task.builder().id(taskStatus.getId()).status(taskStatus.getStatus()).build(); int row = taskMapper.updateById(newTask); // è·å–å®šæ—¶ä»»åŠ¡çŠ¶æ€ã€idã€ä»»åŠ¡ç»„ Integer status = taskStatus.getStatus(); Integer taskId = task.getId(); String taskGroup = task.getTaskGroup(); if (row > 0) &#123; // æ›´æ–°å®šæ—¶ä»»åŠ¡ try &#123; if (TaskStatusEnum.RUNNING.getStatus().equals(status)) &#123; scheduler.resumeJob(ScheduleUtils.getJobKey(taskId, taskGroup)); &#125; if (TaskStatusEnum.PAUSE.getStatus().equals(status)) &#123; scheduler.pauseJob(ScheduleUtils.getJobKey(taskId, taskGroup)); &#125; &#125; catch (SchedulerException e) &#123; throw new ServiceException(\"æ›´æ–°å®šæ—¶ä»»åŠ¡çŠ¶æ€å¼‚å¸¸\"); &#125; &#125; &#125; @Override public void runTask(TaskRunDTO taskRun) &#123; Integer taskId = taskRun.getId(); String taskGroup = taskRun.getTaskGroup(); // æŸ¥è¯¢å®šæ—¶ä»»åŠ¡ Task task = taskMapper.selectById(taskRun.getId()); // è®¾ç½®å‚æ•° JobDataMap dataMap = new JobDataMap(); dataMap.put(ScheduleConstant.TASK_PROPERTIES, task); try &#123; scheduler.triggerJob(ScheduleUtils.getJobKey(taskId, taskGroup), dataMap); &#125; catch (SchedulerException e) &#123; throw new ServiceException(\"æ‰§è¡Œå®šæ—¶ä»»åŠ¡å¼‚å¸¸\"); &#125; &#125; /** * æ›´æ–°ä»»åŠ¡ * * @param task ä»»åŠ¡å¯¹è±¡ * @param taskGroup ä»»åŠ¡ç»„å */ public void updateSchedulerJob(Task task, String taskGroup) throws SchedulerException &#123; Integer taskId = task.getId(); // åˆ¤æ–­æ˜¯å¦å­˜åœ¨ JobKey jobKey = ScheduleUtils.getJobKey(taskId, taskGroup); if (scheduler.checkExists(jobKey)) &#123; // é˜²æ­¢åˆ›å»ºæ—¶å­˜åœ¨æ•°æ®é—®é¢˜ å…ˆç§»é™¤ï¼Œç„¶ååœ¨æ‰§è¡Œåˆ›å»ºæ“ä½œ scheduler.deleteJob(jobKey); &#125; ScheduleUtils.createScheduleJob(scheduler, task); &#125; &#125; æ¥å£å±‚åˆ›å»ºå®šæ—¶ä»»åŠ¡æ¥å£TaskControllerã€‚ @Api(tags = \"å®šæ—¶ä»»åŠ¡æ¨¡å—\") @RestController public class TaskController &#123; @Autowired private ITaskService taskService; /** * æŸ¥çœ‹å®šæ—¶ä»»åŠ¡åˆ—è¡¨ * * @param condition æ¡ä»¶ * @return &#123;@link TaskBackVO&#125; å®šæ—¶ä»»åŠ¡åˆ—è¡¨ */ @ApiOperation(\"æŸ¥çœ‹å®šæ—¶ä»»åŠ¡åˆ—è¡¨\") @SaCheckPermission(\"monitor:task:list\") @GetMapping(\"/admin/task/list\") public Result&lt;PageResult&lt;TaskBackVO>> listTaskBackVO(ConditionDTO condition) &#123; return Result.success(taskService.listTaskBackVO(condition)); &#125; /** * æ·»åŠ å®šæ—¶ä»»åŠ¡ * * @param task å®šæ—¶ä»»åŠ¡ä¿¡æ¯ * @return &#123;@link Result&lt;>&#125; */ @OptLogger(value = ADD) @ApiOperation(\"æ·»åŠ å®šæ—¶ä»»åŠ¡\") @SaCheckPermission(\"monitor:task:add\") @PostMapping(\"/admin/task/add\") public Result&lt;?> addTask(@Validated @RequestBody TaskDTO task) &#123; taskService.addTask(task); return Result.success(); &#125; /** * ä¿®æ”¹å®šæ—¶ä»»åŠ¡ * * @param task å®šæ—¶ä»»åŠ¡ä¿¡æ¯ * @return &#123;@link Result&lt;>&#125; */ @OptLogger(value = UPDATE) @ApiOperation(\"ä¿®æ”¹å®šæ—¶ä»»åŠ¡\") @SaCheckPermission(value = \"monitor:task:update\") @PutMapping(\"/admin/task/update\") public Result&lt;?> updateTask(@Validated @RequestBody TaskDTO task) &#123; taskService.updateTask(task); return Result.success(); &#125; /** * åˆ é™¤å®šæ—¶ä»»åŠ¡ * * @param taskIdList å®šæ—¶ä»»åŠ¡idé›†åˆ * @return &#123;@link Result&lt;>&#125; */ @OptLogger(value = DELETE) @ApiOperation(\"åˆ é™¤å®šæ—¶ä»»åŠ¡\") @SaCheckPermission(\"monitor:task:delete\") @DeleteMapping(\"/admin/task/delete\") public Result&lt;?> deleteTask(@RequestBody List&lt;Integer> taskIdList) &#123; taskService.deleteTask(taskIdList); return Result.success(); &#125; /** * ä¿®æ”¹å®šæ—¶ä»»åŠ¡çŠ¶æ€ * * @param taskStatus å®šæ—¶ä»»åŠ¡çŠ¶æ€ * @return &#123;@link Result&lt;>&#125; */ @OptLogger(value = UPDATE) @ApiOperation(\"ä¿®æ”¹å®šæ—¶ä»»åŠ¡çŠ¶æ€\") @SaCheckPermission(value = &#123;\"monitor:task:update\", \"monitor:task:status\"&#125;, mode = SaMode.OR) @PutMapping(\"/admin/task/changeStatus\") public Result&lt;?> updateTaskStatus(@Validated @RequestBody StatusDTO taskStatus) &#123; taskService.updateTaskStatus(taskStatus); return Result.success(); &#125; /** * æ‰§è¡Œå®šæ—¶ä»»åŠ¡ * * @param taskRun è¿è¡Œå®šæ—¶ä»»åŠ¡ * @return &#123;@link Result&lt;>&#125; */ @OptLogger(value = UPDATE) @ApiOperation(\"æ‰§è¡Œå®šæ—¶ä»»åŠ¡\") @SaCheckPermission(\"monitor:task:run\") @PutMapping(\"/admin/task/run\") public Result&lt;?> runTask(@RequestBody TaskRunDTO taskRun) &#123; taskService.runTask(taskRun); return Result.success(); &#125; &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"},{"name":"Quartz","slug":"Quartz","permalink":"https://blog.ehzyil.xyz/tags/Quartz/"}],"author":"ehzyil"},{"title":"Gitå¸¸ç”¨æ“ä½œ","slug":"2023/Gitå¸¸ç”¨æ“ä½œ","date":"2023-10-15T18:19:34.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/15/2023/Gitå¸¸ç”¨æ“ä½œ/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/15/2023/Git%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/","excerpt":"","text":"Gitæ‹‰å–è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°ä»¥https://github.com/houqingying/ChatViewer/tree/mainè¯¥ä»“åº“ä¸ºä¾‹ï¼Œæ‹‰å–frontendåˆ†æ”¯çš„ä»£ç åˆ°ChatViewer-frontendæ–‡ä»¶å¤¹ æ­¥éª¤ï¼š 1ã€æ–°å»ºä¸€ä¸ªç©ºæ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºChatViewer-frontend 2ã€åˆå§‹åŒ– git init ehZyiL@DESKTOP-1H567GC MINGW64 /d/Study/Java/Code/ChatViewer/ChatViewer-frontend $ git init Initialized empty Git repository in D:/Study/Java/Code/ChatViewer/ChatViewer-frontend/.git/ 3ã€è‡ªå·±è¦ä¸origin masterå»ºç«‹è¿æ¥ï¼ˆä¸‹åˆ’çº¿ä¸ºè¿œç¨‹ä»“åº“é“¾æ¥ï¼‰ git remote add origin &#103;&#105;&#x74;&#64;&#103;&#x69;&#x74;&#104;&#117;&#x62;&#46;&#99;&#x6f;&#x6d;:XXXX&#x2F;xxx.git è¿œç¨‹ä»“åº“é“¾æ¥åœ¨è¿™é‡Œï¼Œå¦‚ä¸‹å›¾çº¢è‰²æ¡†å†…æ‰€ç¤ºçš„é“¾æ¥ï¼š è¾“å…¥å‘½ä»¤ï¼š 4ã€æŠŠè¿œç¨‹åˆ†æ”¯æ‹‰åˆ°æœ¬åœ° git fetch origin frontendï¼ˆfrontendä¸ºè¿œç¨‹ä»“åº“çš„åˆ†æ”¯åï¼‰ ä¸‹å›¾çš„Branchesç•Œé¢ä¸‹çš„å‡ä¸ºå¯ä½¿ç”¨çš„åˆ†æ”¯å ä¸‹é¢æ‹‰å–è¿œç¨‹çš„frontendåˆ†æ”¯ï¼Œå‘½ä»¤ï¼š ehZyiL@DESKTOP-1H567GC MINGW64 /d/Study/Java/Code/ChatViewer/ChatViewer-frontend (master) $ git remote add origin git@github.com:houqingying/ChatViewer.git ehZyiL@DESKTOP-1H567GC MINGW64 /d/Study/Java/Code/ChatViewer/ChatViewer-frontend (master) $ git fetch origin frontend remote: Enumerating objects: 373, done. remote: Counting objects: 100% (373/373), done. remote: Compressing objects: 100% (331/331), done. remote: Total 373 (delta 26), reused 358 (delta 21), pack-reused 0 Receiving objects: 100% (373/373), 2.66 MiB | 1.04 MiB/s, done. Resolving deltas: 100% (26/26), done. From github.com:houqingying/ChatViewer * branch frontend -> FETCH_HEAD * [new branch] frontend -> origin/frontend 5ã€åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯ git checkout origin&#x2F;frontend(è¿œç¨‹åˆ†æ”¯åç§°) å‘½ä»¤ï¼š ehZyiL@DESKTOP-1H567GC MINGW64 /d/Study/Java/Code/ChatViewer/ChatViewer-frontend (master) $ git checkout origin/frontend Note: switching to 'origin/frontend'. You are in 'detached HEAD' state. You can look around, make experimental changes and commit them, and you can discard any commits you make in this state without impacting any branches by switching back to a branch. If you want to create a new branch to retain commits you create, you may do so (now or later) by using -c with the switch command. Example: git switch -c &lt;new-branch-name> Or undo this operation with: git switch - Turn off this advice by setting config variable advice.detachedHead to false HEAD is now at f299acd Update README.md ehZyiL@DESKTOP-1H567GC MINGW64 /d/Study/Java/Code/ChatViewer/ChatViewer-frontend ((f299acd...)) $ å¯ä»¥çœ‹åˆ°æ–‡ä»¶å¤¹ä¸­å·²æœ‰frontendä»“åº“çš„æ–‡ä»¶ã€‚ è‡³æ­¤ï¼Œgitæ‹‰å–è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°å·²å®Œæˆã€‚ è‹¥éœ€è¦åœ¨æœ¬åœ°åˆ›å»ºåˆ†æ”¯å¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤(ä»¥mainåˆ†æ”¯ä¸ºä¾‹) git checkout -b main(æœ¬åœ°æ–°å»ºåˆ†æ”¯åç§°) origin&#x2F;main(è¿œç¨‹åˆ†æ”¯åç§°) ehZyiL@DESKTOP-1H567GC MINGW64 /d/Study/Java/Code/ChatViewer/ChatViewer-admin (master) $ git fetch origin main remote: Enumerating objects: 148, done. remote: Counting objects: 100% (148/148), done. remote: Compressing objects: 100% (121/121), done. remote: Total 148 (delta 23), reused 132 (delta 17), pack-reused 0 Receiving objects: 100% (148/148), 91.02 KiB | 105.00 KiB/s, done. Resolving deltas: 100% (23/23), done. From github.com:houqingying/ChatViewer * branch main -> FETCH_HEAD * [new branch] main -> origin/main ehZyiL@DESKTOP-1H567GC MINGW64 /d/Study/Java/Code/ChatViewer/ChatViewer-admin (master) $ git checkout -b main origin/main Switched to a new branch 'main' branch 'main' set up to track 'origin/main'. ehZyiL@DESKTOP-1H567GC MINGW64 /d/Study/Java/Code/ChatViewer/ChatViewer-admin (main) $ git branch * main 6ã€æ‹‰å–è¿œç¨‹åˆ†æ”¯ä¸Šçš„æœ€æ–°å†…å®¹åˆ°æœ¬åœ° ä»è¿œç¨‹ä»“åº“ï¼ˆoriginï¼‰çš„ä¸»åˆ†æ”¯ï¼ˆfrontendï¼‰æ‹‰å–æœ€æ–°çš„ä»£ç æ›´æ–°åˆ°æœ¬åœ°ä»“åº“ã€‚ git pull origin frontend(è¿œç¨‹åˆ†æ”¯åç§°) å‘½ä»¤ï¼š git pull origin frontend Gitæäº¤å…¨éƒ¨ä»£ç  git add . git add xxå‘½ä»¤å¯ä»¥å°†xxæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œå¦‚æœæœ‰å¾ˆå¤šæ”¹åŠ¨å¯ä»¥é€šè¿‡ git add -A .æ¥ä¸€æ¬¡æ·»åŠ æ‰€æœ‰æ”¹å˜çš„æ–‡ä»¶ã€‚æ³¨æ„ -A é€‰é¡¹åé¢è¿˜æœ‰ä¸€ä¸ªå¥ç‚¹ã€‚ git add -Aè¡¨ç¤ºæ·»åŠ æ‰€æœ‰å†…å®¹ï¼Œ git add . è¡¨ç¤ºæ·»åŠ æ–°æ–‡ä»¶å’Œç¼–è¾‘è¿‡çš„æ–‡ä»¶ä¸åŒ…æ‹¬åˆ é™¤çš„æ–‡ä»¶; git add -u è¡¨ç¤ºæ·»åŠ ç¼–è¾‘æˆ–è€…åˆ é™¤çš„æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬æ–°æ·»åŠ çš„æ–‡ä»¶ git commit -m â€œæäº¤æ³¨é‡Šâ€ git push origin åˆ†æ”¯åç§°ï¼Œä¸€èˆ¬ä½¿ç”¨ï¼šgit push origin master Gitåˆ é™¤åˆ†æ”¯// åˆ é™¤æœ¬åœ°åˆ†æ”¯ git branch -d localBranchName // åˆ é™¤è¿œç¨‹åˆ†æ”¯ git push origin --delete remoteBranchName Git æ“ä½œâ€”â€”å¦‚ä½•åˆ é™¤æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯ Git å¦‚ä½•é€€å‡ºmergingå¦‚æœä½ æƒ³åœ¨åˆå¹¶æ—¶é€€å‡ºï¼Œä½ å¯ä»¥ä½¿ç”¨ git merge --abort æ¥å–æ¶ˆåˆå¹¶æ“ä½œã€‚è¿™ä¼šä½¿ Git å›åˆ°æœªåˆå¹¶ä¹‹å‰çš„çŠ¶æ€ã€‚å¦‚æœæ‚¨å·²ç»æäº¤äº†åˆå¹¶ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ git reset --hard HEAD æ¥æ’¤é”€åˆå¹¶ã€‚è¿™å°†ä¸¢å¼ƒåˆå¹¶çš„æäº¤ï¼Œå¹¶å›æ»šåˆ°æœªåˆå¹¶ä¹‹å‰çš„çŠ¶æ€ã€‚ ä½¿ç”¨idea æŠŠä¸€ä¸ªgitåˆ†æ”¯çš„éƒ¨åˆ†æäº¤è®°å½•åˆå¹¶åˆ°å¦ä¸€ä¸ªgitåˆ†æ”¯ä¸Š Git cherry-pickåˆå¹¶ç‰¹å®šçš„æäº¤git cherry-pick [&lt;options>] &lt;commit-ish>... å¸¸ç”¨options: --quit é€€å‡ºå½“å‰çš„chery-pickåºåˆ— --continue ç»§ç»­å½“å‰çš„chery-pickåºåˆ— --abort å–æ¶ˆå½“å‰çš„chery-pickåºåˆ—ï¼Œæ¢å¤å½“å‰åˆ†æ”¯ -n, --no-commit ä¸è‡ªåŠ¨æäº¤ -e, --edit ç¼–è¾‘æäº¤ä¿¡æ¯ git cherry-pickçš„ä½¿ç”¨ Git stash æš‚å­˜ä»£ç  å½“æˆ‘ä»¬åœ¨æŸåˆ†æ”¯å¼€å‘åŠŸèƒ½çš„æ—¶å€™ï¼ŒåŠŸèƒ½å¼€å‘åˆ°ä¸€åŠï¼Œä¸šåŠ¡æ–¹çªç„¶ä¼ æ¥ä¸€ä¸ªå™©è€—ï¼Œæœ‰ä¸€ä¸ªbugéœ€è¦ç´§æ€¥å¤„ç†ä¸€ä¸‹ï¼Œä¼˜å…ˆçº§ä¸º0ï¼Œè¿™æ—¶æˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿï¼Ÿï¼Ÿ æäº¤æˆ‘ä»¬çš„ä¿®æ”¹â€“è¿™æ ·ä¼šäº§ç”Ÿä¸€æ¬¡æ— æ„ä¹‰çš„æäº¤ æ”¾å¼ƒæˆ‘ä»¬å†™çš„ä»£ç â€“æˆ‘ä»¬å¹¶ä¸å‚» é‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ ä½¿ç”¨stashå‘½ä»¤å°†ä¿®æ”¹è¿˜æœªæäº¤çš„ä»£ç å­˜å‚¨åˆ°ç¼“å­˜åŒº è½¬è½½git-å‘½ä»¤è¡Œ-ä½¿ç”¨ git stash æš‚å­˜ä»£ç  è§£å†³æ–¹æ¡ˆï¼š //ä½¿ç”¨stashå‘½ä»¤å°†ä¿®æ”¹è¿˜æœªæäº¤çš„ä»£ç å­˜å‚¨åˆ°ç¼“å­˜åŒº git stash //åˆ‡æ¢åˆ°éœ€è¦è§£å†³bugçš„åˆ†æ”¯ git checkout &lt;åˆ†æ”¯å> //ä¿®æ”¹å®Œbugåå›åˆ°å½“å‰å¼€å‘åˆ†æ”¯ï¼Œå–å‡ºç¼“å­˜ä¸­çš„ä»£ç  git stash pop æŸ¥çœ‹ä¿®æ”¹é‚£ä¹ˆæˆ‘ä»¬ç¡®å®šä½ æ“ä½œæˆåŠŸäº†å‘¢ï¼Ÿ git stash show &#x2F;&#x2F;æŸ¥çœ‹åˆšæ‰æš‚å­˜çš„ä¿®æ”¹ æˆ‘ä»¬çš„ä¿®æ”¹å­˜å‚¨åˆ°ä»€ä¹ˆä½ç½®äº†?å½“æˆ‘ä»¬ä½¿ç”¨ git initç»™é¡¹ç›®æ·»åŠ ç‰ˆæœ¬æ§åˆ¶çš„æ—¶å€™ï¼Œä¼šåœ¨é¡¹ç›®è·¯å¾„ä¸‹ç”Ÿæˆä¸€ä¸ª .git éšè—æ–‡ä»¶å¤¹ã€‚.git ä¸­å­˜å‚¨ç€ç‰ˆæœ¬ç®¡ç†çš„æ‰€æœ‰ä¿¡æ¯ã€‚ .git&#x2F;refs&#x2F;stash ä¸­ï¼Œå­˜å‚¨çš„æ˜¯æœ€åä¸€ä¸ª stash å¯¹åº”çš„èŠ‚ç‚¹æŒ‡é’ˆ åœ¨ .git&#x2F;log&#x2F;refs&#x2F;stash ä¸­å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å…¨éƒ¨çš„ stash è®°å½•ä¿¡æ¯ å¤šä¸ª stash çš„æƒ…å†µæˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿå­˜å‚¨å¤šä¸ªstash &#x2F;&#x2F;æäº¤å¤šä¸ªstashï¼Œæˆ‘ä»¬éœ€è¦åŒºåˆ†æ¯æ¬¡æäº¤çš„å†…å®¹ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ç»™æ¯æ¬¡æäº¤èµ·ä¸€ä¸ªåå­—æ¥åŒºåˆ† git stash save &lt;åç§°&gt; å¤šä¸ªstashå–å‡ºæ–¹å¼ git stash pop &#x2F;&#x2F;å–å‡ºæœ€è¿‘ä¸€æ¬¡æš‚å­˜å¹¶åˆ é™¤è®°å½•åˆ—è¡¨ä¸­å¯¹åº”è®°å½• å› ä¸º git stash pop æ˜¯å¼¹å‡ºæ ˆé¡¶çš„ä¸€ä¸ª stash ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€æ¬¡å­˜å‚¨çš„ stashã€‚åœ¨å­˜å‚¨å¤šä¸ªstash æ—¶ï¼Œæƒ³å–å‡ºéæ ˆé¡¶çš„ä¸€ä¸ªçš„æƒ…å†µä¸‹ï¼Œæ˜¯ä¸é€‚ç”¨çš„ã€‚ è¿™ä¸ªæ—¶å€™è¦ä½¿ç”¨ï¼š git stash list &#x2F;&#x2F;æŸ¥çœ‹æš‚å­˜åŒºçš„æ‰€æœ‰æš‚å­˜ä¿®æ”¹ $&gt;git stash list stash@&#123;0&#125;: WIP on book: 51bea1d... fixed images stash@&#123;1&#125;: WIP on master: 9705ae6... changed the browse code to the official repo git stash apply stash@&#123;X&#125; &#x2F;&#x2F;å–å‡ºç›¸åº”çš„æš‚å­˜ git stash drop stash@&#123;X&#125; &#x2F;&#x2F;å°†è®°å½•åˆ—è¡¨ä¸­å–å‡ºçš„å¯¹åº”æš‚å­˜è®°å½•åˆ é™¤ æ¸…ç©ºstashæ ˆ git stash clear Git commitä¹‹åï¼Œæƒ³æ’¤é”€commit åŸæ–‡ å†™å®Œä»£ç åï¼Œæˆ‘ä»¬ä¸€èˆ¬è¿™æ · git add . &#x2F;&#x2F;æ·»åŠ æ‰€æœ‰æ–‡ä»¶ git commit -m â€œæœ¬åŠŸèƒ½å…¨éƒ¨å®Œæˆâ€ æ‰§è¡Œå®Œcommitåï¼Œæƒ³æ’¤å›commitï¼Œæ€ä¹ˆåŠï¼Ÿ ç­”æ¡ˆï¼š git reset --soft HEAD^ è¿™æ ·å°±æˆåŠŸçš„æ’¤é”€äº†ä½ çš„commit æ³¨æ„ï¼Œä»…ä»…æ˜¯æ’¤å›commitæ“ä½œï¼Œæ‚¨å†™çš„ä»£ç ä»ç„¶ä¿ç•™ã€‚ â€“mixed æ„æ€æ˜¯ï¼šä¸åˆ é™¤å·¥ä½œç©ºé—´æ”¹åŠ¨ä»£ç ï¼Œæ’¤é”€commitï¼Œå¹¶ä¸”æ’¤é”€git add . æ“ä½œ è¿™ä¸ªä¸ºé»˜è®¤å‚æ•°,git reset â€“mixed HEAD^ å’Œ git reset HEAD^ æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚ â€“soft ä¸åˆ é™¤å·¥ä½œç©ºé—´æ”¹åŠ¨ä»£ç ï¼Œæ’¤é”€commitï¼Œä¸æ’¤é”€git add . â€“hard åˆ é™¤å·¥ä½œç©ºé—´æ”¹åŠ¨ä»£ç ï¼Œæ’¤é”€commitï¼Œæ’¤é”€git add . æ³¨æ„å®Œæˆè¿™ä¸ªæ“ä½œåï¼Œå°±æ¢å¤åˆ°äº†ä¸Šä¸€æ¬¡çš„commitçŠ¶æ€ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"git","slug":"git","permalink":"https://blog.ehzyil.xyz/tags/git/"}],"author":"ehzyil"},{"title":"Quartz ä½¿ç”¨æ•™ç¨‹","slug":"2023/Quartzä½¿ç”¨æ•™ç¨‹","date":"2023-10-15T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/15/2023/Quartzä½¿ç”¨æ•™ç¨‹/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/15/2023/Quartz%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/","excerpt":"","text":"Quartz ä»‹ç»Quartz æ˜¯ç›®å‰ Java é¢†åŸŸåº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ä»»åŠ¡è°ƒåº¦æ¡†æ¶ä¹‹ä¸€ï¼Œç›®å‰å¾ˆå¤šæµè¡Œçš„åˆ†å¸ƒå¼è°ƒåº¦æ¡†æ¶ï¼Œä¾‹å¦‚ xxl-job éƒ½æ˜¯åŸºäºå®ƒè¡ç”Ÿå‡ºæ¥çš„ï¼Œæ‰€ä»¥äº†è§£å’ŒæŒæ¡ Quartz çš„ä½¿ç”¨ï¼Œå¯¹äºå¹³æ—¶å®Œæˆä¸€äº›éœ€è¦å®šæ—¶è°ƒåº¦çš„å·¥ä½œä¼šæœ‰å¸®åŠ©ã€‚ Quartzç±»ä¼¼äºjava.util.Timerã€‚ä½†æ˜¯ç›¸è¾ƒäºTimerï¼Œ Quartzå¢åŠ äº†å¾ˆå¤šåŠŸèƒ½ï¼š æŒä¹…æ€§ä½œä¸š - å°±æ˜¯ä¿æŒè°ƒåº¦å®šæ—¶çš„çŠ¶æ€; ä½œä¸šç®¡ç† - å¯¹è°ƒåº¦ä½œä¸šè¿›è¡Œæœ‰æ•ˆçš„ç®¡ç†; å®˜æ–¹æ–‡æ¡£ï¼š http://www.quartz-scheduler.org/documentation/ http://www.quartz-scheduler.org/ap å¿«é€Ÿå¼€å§‹æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæœ€ç®€å•çš„ç¤ºä¾‹ï¼Œå…ˆå¿«é€Ÿä¸Šæ‰‹ Quartz æœ€åŸºæœ¬çš„ç”¨æ³•ï¼Œç„¶åå†é€æ­¥è®²è§£ Quartz æ¯ä¸ªæ¨¡å—çš„åŠŸèƒ½ç‚¹ ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ä¾èµ–åœ¨ pom.xml æ–‡ä»¶æ·»åŠ  Quart ä¾èµ–ï¼š &lt;!-- å¼•å…¥ quartz åŸºç¡€ä¾èµ–ï¼šå¯å–å½“å‰æœ€æ–°ç‰ˆæœ¬ --> &lt;dependency> &lt;groupId>org.quartz-scheduler&lt;/groupId> &lt;artifactId>quartz&lt;/artifactId> &lt;version>2.3.2&lt;/version> &lt;/dependency> &lt;!-- å¼•å…¥ quartz æ‰€éœ€çš„æ—¥å¿—ä¾èµ–ï¼šå¯å–å½“å‰æœ€æ–°ç‰ˆæœ¬ --> &lt;dependency> &lt;groupId>org.slf4j&lt;/groupId> &lt;artifactId>slf4j-api&lt;/artifactId> &lt;version>1.7.26&lt;/version> &lt;scope>compile&lt;/scope> &lt;/dependency> &lt;dependency> &lt;groupId>org.slf4j&lt;/groupId> &lt;artifactId>slf4j-simple&lt;/artifactId> &lt;version>1.7.26&lt;/version> &lt;scope>compile&lt;/scope> &lt;/dependency> åœ¨SpringBooté¡¹ç›®ä¸­åªéœ€å¼•å…¥spring-boot-starter-quartzå³å¯ &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-quartz&lt;/artifactId> &lt;/dependency> ç¬¬äºŒæ­¥ï¼šé…ç½®æ–‡ä»¶åœ¨é¡¹ç›®çš„ classpath è·¯å¾„ä¸‹åˆ›å»º Quartz é»˜è®¤çš„ quartz.properties é…ç½®æ–‡ä»¶ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š # è°ƒåº¦ç¨‹åºçš„åç§° org.quartz.scheduler.instanceName = MyScheduler # çº¿ç¨‹æ•°é‡ org.quartz.threadPool.threadCount = 3 # å†…å­˜æ•°æ®åº“ï¼ˆæ¨èåˆšä¸Šæ‰‹æ—¶ä½¿ç”¨ï¼‰ org.quartz.jobStore.class = org.quartz.simpl.RAMJobStore ç¬¬ä¸‰æ­¥ï¼šå®šä¹‰ä»»åŠ¡ç±»å®ç° Job æ¥å£ï¼Œç„¶ååœ¨è¦†ç›–çš„ execute å‡½æ•°å†…å®šä¹‰ä»»åŠ¡é€»è¾‘ï¼Œå¦‚ä¸‹ï¼š package com.ehzyil.quartzStudy.test; import org.quartz.Job; import org.quartz.JobExecutionContext; public class HelloJob implements Job &#123; @Override public void execute(JobExecutionContext context) &#123; System.out.println(\"hello quartz!\"); &#125; &#125; ç¬¬å››æ­¥ï¼šä»»åŠ¡è°ƒåº¦æˆ‘ä»¬ç®€å•çš„ä½¿ç”¨ main() æ–¹æ³•å³å¯è¿è¡Œ Quartz ä»»åŠ¡è°ƒåº¦ç¤ºä¾‹ï¼š package com.ehzyil.quartzStudy.test; import org.quartz.*; import org.quartz.impl.StdSchedulerFactory; public class QuartzTest &#123; public static void main(String[] args) &#123; try &#123; // è·å–é»˜è®¤çš„è°ƒåº¦å™¨å®ä¾‹ Scheduler scheduler = StdSchedulerFactory.getDefaultScheduler(); // æ‰“å¼€è°ƒåº¦å™¨ scheduler.start(); // å®šä¹‰ä¸€ä¸ªç®€å•çš„ä»»åŠ¡ JobDetail job = JobBuilder.newJob(HelloJob.class) .withIdentity(\"job11\", \"group1\") .build(); // å®šä¹‰ä¸€ä¸ªç®€å•çš„è§¦å‘å™¨: æ¯éš” 1 ç§’æ‰§è¡Œ 1 æ¬¡ï¼Œä»»åŠ¡æ°¸ä¸åœæ­¢ SimpleTrigger trigger = TriggerBuilder.newTrigger() .withIdentity(\"trigger1\", \"group1\") .startNow() .withSchedule(SimpleScheduleBuilder .simpleSchedule() .withIntervalInSeconds(1) .repeatForever() ).build(); // å¼€å§‹è°ƒåº¦ä»»åŠ¡ scheduler.scheduleJob(job, trigger); // ç­‰å¾…ä»»åŠ¡æ‰§è¡Œä¸€äº›æ—¶é—´ Thread.sleep(3000); // å…³é—­è°ƒåº¦å™¨ scheduler.shutdown(); &#125; catch (Exception se) &#123; se.printStackTrace(); &#125; &#125; &#125; æœ€åæ§åˆ¶å°ä¼šè¾“å‡ºä»»åŠ¡è¿è¡Œçš„å…¨è¿‡ç¨‹ï¼Œç„¶åå…³é—­è¿›ç¨‹ï¼Œå¦‚ä¸‹ï¼š 21:54:58.178 [main] INFO org.quartz.impl.StdSchedulerFactory - Using default implementation for ThreadExecutor 21:54:58.182 [main] INFO org.quartz.simpl.SimpleThreadPool - Job execution threads will use class loader of thread: main 21:54:58.194 [main] INFO org.quartz.core.SchedulerSignalerImpl - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl 21:54:58.194 [main] INFO org.quartz.core.QuartzScheduler - Quartz Scheduler v.2.3.2 created. 21:54:58.198 [main] INFO org.quartz.simpl.RAMJobStore - RAMJobStore initialized. 21:54:58.198 [main] INFO org.quartz.core.QuartzScheduler - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED' Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally. NOT STARTED. Currently in standby mode. Number of jobs executed: 0 Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads. Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered. 21:54:58.198 [main] INFO org.quartz.impl.StdSchedulerFactory - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties' 21:54:58.198 [main] INFO org.quartz.impl.StdSchedulerFactory - Quartz scheduler version: 2.3.2 21:54:58.198 [main] INFO org.quartz.core.QuartzScheduler - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started. 21:54:58.198 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.core.QuartzSchedulerThread - batch acquisition of 0 triggers 21:54:58.238 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.core.QuartzSchedulerThread - batch acquisition of 1 triggers 21:54:58.238 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.simpl.PropertySettingJobFactory - Producing instance of Job 'group1.job11', class=com.ehzyil.quartzStudy.test.HelloJob 21:54:58.242 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.core.QuartzSchedulerThread - batch acquisition of 1 triggers 21:54:58.242 [DefaultQuartzScheduler_Worker-1] DEBUG org.quartz.core.JobRunShell - Calling execute on job group1.job11 hello phoenix 21:54:59.203 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.simpl.PropertySettingJobFactory - Producing instance of Job 'group1.job11', class=com.ehzyil.quartzStudy.test.HelloJob 21:54:59.204 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.core.QuartzSchedulerThread - batch acquisition of 1 triggers 21:54:59.204 [DefaultQuartzScheduler_Worker-2] DEBUG org.quartz.core.JobRunShell - Calling execute on job group1.job11 hello phoenix 21:55:00.209 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.simpl.PropertySettingJobFactory - Producing instance of Job 'group1.job11', class=com.ehzyil.quartzStudy.test.HelloJob 21:55:00.209 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.core.QuartzSchedulerThread - batch acquisition of 1 triggers 21:55:00.209 [DefaultQuartzScheduler_Worker-3] DEBUG org.quartz.core.JobRunShell - Calling execute on job group1.job11 hello phoenix 21:55:01.213 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.simpl.PropertySettingJobFactory - Producing instance of Job 'group1.job11', class=com.ehzyil.quartzStudy.test.HelloJob 21:55:01.213 [DefaultQuartzScheduler_QuartzSchedulerThread] DEBUG org.quartz.core.QuartzSchedulerThread - batch acquisition of 1 triggers 21:55:01.213 [DefaultQuartzScheduler_Worker-4] DEBUG org.quartz.core.JobRunShell - Calling execute on job group1.job11 hello phoenix 21:55:01.243 [main] INFO org.quartz.core.QuartzScheduler - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutting down. 21:55:01.243 [main] INFO org.quartz.core.QuartzScheduler - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED paused. 21:55:01.243 [main] DEBUG org.quartz.simpl.SimpleThreadPool - Shutting down threadpool... 21:55:01.243 [main] DEBUG org.quartz.simpl.SimpleThreadPool - Shutdown of threadpool complete. 21:55:01.243 [main] INFO org.quartz.core.QuartzScheduler - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutdown complete. å¯ä»¥çœ‹åˆ°ï¼Œåˆ°è¿™é‡Œä¸€ä¸ªæœ€åŸºæœ¬ç®€å•çš„ Quartz ä½¿ç”¨ç¤ºä¾‹åŸºæœ¬å°± OK äº†ï¼Œæ¥ä¸‹æ¥ä»‹ç»æ›´å¤šæ ¸å¿ƒæ¦‚å¿µå’Œæ·±å…¥ä½¿ç”¨çš„åœºæ™¯ã€‚ æ ¸å¿ƒæ¦‚å¿µè§¦å‘å™¨å’Œä½œä¸šåŸºæœ¬æ¦‚å¿µæŒæ¡ Quartz ä¹‹å‰ï¼Œå…ˆæ¥äº†è§£å®ƒæ¡†æ¶çš„ 3 ä¸ªæ ¸å¿ƒç»„ä»¶å’Œæ¦‚å¿µï¼Œå¦‚ä¸‹ï¼š Schdulerï¼šè°ƒåº¦å™¨ï¼Œä¸»è¦ç”¨äºç®¡ç†ä½œä¸šï¼ˆJobDetailï¼‰ï¼Œè§¦å‘å™¨ï¼ˆTriggerï¼‰ JobDetailï¼šä½œä¸šå®ä¾‹ï¼Œå†…éƒ¨åŒ…å«ä½œä¸šè¿è¡Œçš„å…·ä½“é€»è¾‘ Triggerï¼šè§¦å‘å™¨å®ä¾‹ï¼Œå†…éƒ¨åŒ…å«ä½œä¸šæ‰§è¡Œçš„å®è·µè®¡åˆ’ ä¸»è¦å…³ç³»å¦‚ä¸‹ï¼š å·¥ä½œæµç¨‹å¦‚ä¸Šæ‰€ç¤ºï¼Œä½¿ç”¨ Quartz çš„å·¥ä½œæµç¨‹ä¹Ÿå¾ˆç®€å•ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š é¦–å…ˆåŸºäº Job æ¥å£å®šä¹‰ä½ çš„ä½œä¸š JobDetail å®ä¾‹å’Œè§¦å‘å™¨ Trigger å®ä¾‹å¯¹è±¡ å°†å®šä¹‰çš„ä½œä¸šå’Œè§¦å‘å™¨å®ä¾‹å¯¹è±¡é€šè¿‡è°ƒåº¦å™¨ scheduleJobï¼Œå¼€å§‹è°ƒåº¦æ‰§è¡Œ è°ƒåº¦å™¨å¯åŠ¨å·¥ä½œçº¿ç¨‹å¼€å§‹æ‰§è¡Œ JobDetail å®ä¾‹çš„ execute æ–¹æ³•å†…å®¹ ä»»åŠ¡è¿è¡Œæ—¶æ‰€éœ€ä¿¡æ¯é€šè¿‡ï¼ŒJobExecutionContext å¯¹è±¡ä¼ é€’åˆ°å·¥ä½œçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥åœ¨å¤šä¸ªå·¥ä½œçº¿ç¨‹ä¸­è·¨çº¿ç¨‹ä¼ é€’ ç¤ºæ„å›¾ï¼š å”¯ä¸€æ ‡è¯†å…³äºåˆ›å»º JobDetail ä½œä¸šå®ä¾‹å’Œ Trigger è§¦å‘å™¨çš„å‡ ä¸ªæ³¨æ„äº‹é¡¹ï¼š åˆ›å»ºä½œä¸šå’Œè§¦å‘å™¨éƒ½éœ€è¦é€šè¿‡ï¼ˆJobKey å’Œ TriggerKey + Groupï¼‰ç»„åˆåˆ›å»ºå”¯ä¸€æ ‡è¯† ä½ å¯ä»¥é€šè¿‡å”¯ä¸€æ ‡è¯†åœ¨ Schduler ä¸­è·å–ä½œä¸šå¯¹è±¡ï¼Œå¹¶ä¸”ç®¡ç†å’Œç»´æŠ¤ä»–ä»¬ å¼•å…¥ Group æ ‡è¯†çš„ç›®çš„ä¹Ÿæ˜¯äº†æ›´å¥½çš„è®©ä½ ç®¡ç†ä½œä¸šç¯å¢ƒï¼šä¾‹å¦‚ï¼šé€šè¿‡ä¸åŒçš„ Group æ¥åŒºåˆ†ï¼šã€æµ‹è¯•ä½œä¸šï¼Œç”Ÿäº§ä½œä¸šã€‘ç­‰ JobDetail çš„æ›´å¤šç»†èŠ‚é€šè¿‡ç¤ºä¾‹å¯ä»¥çœ‹åˆ°ï¼Œå®šä¹‰å’Œä½¿ç”¨ Job éƒ½éå¸¸ç®€å•ï¼Œä½†æ˜¯å¦‚æœè¦æ·±å…¥ä½¿ç”¨ï¼Œä½ å¯èƒ½éœ€è¦äº†è§£å…³äº Job çš„æ›´å¤šç»†èŠ‚ å…ˆçœ‹çœ‹ Quartz å¯¹äº JobDetail çš„å¤„ç†ç­–ç•¥ï¼š æ¯æ¬¡æ‰§è¡Œä»»åŠ¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ JobDetail å®ä¾‹å¯¹è±¡ï¼Œæ„å‘³æ¯æ¬¡æ‰§è¡Œçš„ JobDetail éƒ½æ˜¯æ–°å¯¹è±¡ï¼ŒJobDetail å¯¹è±¡ä¹Ÿæ˜¯æ— çŠ¶æ€çš„ JobDetail å®ä¾‹å¯¹è±¡ä»»åŠ¡å®Œæˆå ï¼ˆexecute æ–¹æ³•ï¼‰ï¼Œè°ƒåº¦å™¨ Schduler ä¼šå°†ä½œä¸šå®ä¾‹å¯¹è±¡åˆ é™¤ï¼Œç„¶åè¿›è¡Œåƒåœ¾å›æ”¶ JobDetail å®ä¾‹ä¹‹é—´çš„çŠ¶æ€æ•°æ®ï¼Œåªèƒ½é€šè¿‡ JobExecutionContextï¼ˆå®é™…ä¸Šæ˜¯ JobDataMapï¼‰ è¿›è¡Œè·¨ä½œä¸šä¼ é€’ ä¸ºä»€ä¹ˆè®¾è®¡æˆJobDetail + Jobï¼Œä¸ç›´æ¥ä½¿ç”¨Jobï¼Ÿ JobDetail å®šä¹‰çš„æ˜¯ä»»åŠ¡æ•°æ®ï¼Œè€ŒçœŸæ­£çš„æ‰§è¡Œé€»è¾‘æ˜¯åœ¨Jobä¸­ã€‚ è¿™æ˜¯å› ä¸ºä»»åŠ¡æ˜¯æœ‰å¯èƒ½å¹¶å‘æ‰§è¡Œï¼Œå¦‚æœSchedulerç›´æ¥ä½¿ç”¨Jobï¼Œå°±ä¼šå­˜åœ¨å¯¹åŒä¸€ä¸ªJobå®ä¾‹å¹¶å‘è®¿é—®çš„é—®é¢˜ã€‚ è€ŒJobDetail &amp; Job æ–¹å¼ï¼ŒSheduleræ¯æ¬¡æ‰§è¡Œï¼Œéƒ½ä¼šæ ¹æ®JobDetailåˆ›å»ºä¸€ä¸ªæ–°çš„Jobå®ä¾‹ï¼Œè¿™æ ·å°±å¯ä»¥ è§„é¿å¹¶å‘è®¿é—® çš„é—®é¢˜ã€‚ JobDataMapjobDataMap çš„ä½¿ç”¨ä¸»è¦åˆ† 2 æ­¥ï¼š 1ï¼šåœ¨ execute() å‡½æ•°å†…ï¼Œä½¿ç”¨ jobDataMap è·å–æ•°æ® public class HelloJob implements Job &#123; @Override public void execute(JobExecutionContext context) &#123; // é€šè¿‡ JobDataMap å¯¹è±¡ï¼Œå¯ä»¥åœ¨ä½œä¸šçš„æ‰§è¡Œé€»è¾‘ä¸­ï¼Œè·å–å‚æ•° JobDataMap jobDataMap = context.getJobDetail().getJobDataMap(); String name = jobDataMap.getString(\"name\"); System.out.println(\"hello \" + name); &#125; &#125; 2ï¼šjobDataMao æ·»åŠ å‚æ•° // å®šä¹‰ä½œä¸šæ—¶ï¼Œé€šè¿‡ usingJobData å°†å‚æ•°æ”¾å…¥ JobDataMap JobDetail job = JobBuilder.newJob(HelloJob.class) .withIdentity(\"job11\", \"group1\") .usingJobData(\"name\", \"phoenix\") .build(); æœ€åè¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š [main] INFO org.quartz.core.QuartzScheduler - Scheduler MyScheduler_$_NON_CLUSTERED started. hello phoenix [main] INFO org.quartz.core.QuartzScheduler - Scheduler MyScheduler_$_NON_CLUSTERED shutting down. # .... å…³äº JobDataMap çš„ä½¿ç”¨ï¼Œéœ€è¦å…³æ³¨ä»¥ä¸‹çš„æ³¨æ„äº‹é¡¹ï¼š è™½ç„¶ JobDataMap å¯ä»¥ä¼ é€’ä»»æ„ç±»å‹çš„æ•°æ®ï¼Œå¯¹è±¡çš„ååºåˆ—åŒ–åœ¨ç‰ˆæœ¬è¿­ä»£ä¸­å®¹æ˜“é‡åˆ°ç±»ç‰ˆæœ¬æ§åˆ¶çš„é—®é¢˜ å¦‚æœä»é•¿è¿œçš„å®‰å…¨æ€§è€ƒè™‘ï¼Œå°½å¯èƒ½çš„å°† jobDataMap è®¾ç½®ä¸ºåªå…è®¸å­˜æ”¾åŸºæœ¬ç±»å‹å’Œå­—ç¬¦ä¸²ï¼ˆé€šè¿‡ jobStore.useProperties è®¾ç½®ï¼‰ Quartz ä¼šè‡ªåŠ¨é€šè¿‡ Job ç±»çš„ setter æ–¹æ³•å’Œ JobDataMap ä¸»é”®åŒ¹é…ï¼Œå¸®åŠ©ä½ è‡ªåŠ¨æ³¨å…¥å±æ€§åˆ° Job ç±»ä¸­ å¹¶å‘æ€§å’ŒæŒä¹…åŒ–Quartzå®šæ—¶ä»»åŠ¡é»˜è®¤éƒ½æ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œä¸ä¼šç­‰å¾…ä¸Šä¸€æ¬¡ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œåªè¦é—´éš”æ—¶é—´åˆ°å°±ä¼šæ‰§è¡Œ, å¦‚æœå®šæ—¶ä»»æ‰§è¡Œå¤ªé•¿ï¼Œä¼šé•¿æ—¶é—´å ç”¨èµ„æºï¼Œå¯¼è‡´å…¶å®ƒä»»åŠ¡å µå¡ã€‚ Quartz å¯¹äº Job æä¾›å‡ ä¸ªæ³¨é‡Šï¼Œåˆç†çš„ä½¿ç”¨å¯ä»¥æ›´å¥½çš„æ§åˆ¶ Quartz çš„è°ƒåº¦è¡Œä¸ºï¼Œå…·ä½“å¦‚ä¸‹ï¼š @DisallowConcurrentExecutionï¼šæ·»åŠ åˆ° Job ç±»ä¸­ï¼Œå‘Šè¯‰ Job é˜²æ­¢ç›¸åŒå®šä¹‰çš„ä»»åŠ¡å¹¶å‘æ‰§è¡Œï¼Œä¾‹å¦‚ï¼šä»»åŠ¡ A å®ä¾‹æœªå®Œæˆä»»åŠ¡ï¼Œåˆ™ä»»åŠ¡ B å®ä¾‹ä¸ä¼šå¼€å§‹æ‰§è¡Œï¼ˆQuartz é»˜è®¤ç­–ç•¥æ˜¯ä¸ä¼šç­‰å¾…ï¼Œå¯ç”¨æ–°çº¿ç¨‹å¹¶å‘è°ƒåº¦ï¼‰ @PersistJobDataAfterExecutionï¼šæ·»åŠ åˆ° Job ç±»ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ Job ä½œä¸šè¿è¡Œé€»è¾‘ä¸ä¼šå½±å“åˆ° JobDataMap ï¼ˆæ—¢æ¯ä¸ª JobDetail æ‹¿åˆ°çš„éƒ½æ˜¯åˆå§‹åŒ–çš„ JobDataMap å†…å®¹ï¼‰ï¼Œå¼€å¯è¯¥æ³¨è§£åï¼ŒJob çš„ execute() æ–¹æ³•å®Œæˆåï¼Œå¯¹äº JobDataMap çš„æ›´æ–°ï¼Œå°†ä¼šè¢«æŒä¹…åŒ–åˆ° JobDataMap ä¸­ï¼Œä»è€Œä¾›å…¶ä»–çš„ JobDetail ä½¿ç”¨ï¼Œè¿™å¯¹äºä»»åŠ¡ B ä¾èµ–ä»»åŠ¡ A çš„è¿è¡Œç»“æœçš„åœºæ™¯ä¸‹ï¼Œéå¸¸æœ‰ç”¨ï¼Œæ‰€ä»¥å¼ºçƒˆå»ºè®®å’Œ @DisallowConcurrentExecution æ³¨è§£ä¸€èµ·ä½¿ç”¨ï¼Œä¼šè®©ä»»åŠ¡è¿è¡Œç»“æœæ›´åŠ ç¬¦åˆé¢„æœŸ Trigger çš„æ›´å¤šç»†èŠ‚å’Œ Job ç±»ä¼¼ï¼Œè§¦å‘å™¨çš„å®šä¹‰å’Œä½¿ç”¨ä¹Ÿéå¸¸ç®€å•ï¼Œä½†æ˜¯å¦‚æœæƒ³å……åˆ†çš„åˆ©ç”¨å®ƒæ¥å·¥ä½œï¼Œä½ è¿˜éœ€è¦äº†è§£å…³äºè§¦å‘å™¨çš„æ›´å¤šç»†èŠ‚ åœ¨ Quartz ä¸­ Trigger è§¦å‘å™¨æœ‰å¾ˆå¤šç§ç±»å‹ï¼Œä½†æ˜¯ä»–ä»¬éƒ½æœ‰å‡ ä¸ªå…±åŒçš„å±æ€§ï¼Œå¦‚ä¸‹ï¼š startTimeï¼šè§¦å‘å™¨é¦–æ¬¡ç”Ÿæ•ˆçš„æ—¶é—´ endTimeï¼šè§¦å‘å™¨å¤±æ•ˆæ—¶é—´ ä»¥ä¸Šå…±åŒå±æ€§çš„å€¼éƒ½æ˜¯ java.util.Date å¯¹è±¡ å…³äº Trigger çš„å…¶ä»–å‡ ä¸ªæ¦‚å¿µï¼š Priority ä¼˜å…ˆæƒï¼šå½“è°ƒåº¦å™¨é‡åˆ°å¤šä¸ªåŒæ—¶æ‰§è¡Œçš„ Trigger æ—¶å€™ï¼Œä¼šæ ¹æ®ä¼˜å…ˆæƒå¤§å°æ’åºï¼Œç„¶åå…ˆåè°ƒåº¦ Misfire é”™è¿‡è§¦å‘ï¼šTrigger è¾¾åˆ°è§¦å‘æ—¶é—´ï¼Œä½†å› ä¸ºå¤–éƒ¨åŸå› æ— æ³•æ‰§è¡Œï¼ŒTrigger å¼€å§‹è®¡ç®— Misfire æ—¶é—´ å¸¸è§çš„å¤–éƒ¨åŸå› æœ‰å“ªäº›ï¼Ÿä¾‹å¦‚ï¼šè°ƒåº¦ç¨‹åºè¢«å…³é—­ï¼Œçº¿ç¨‹æ± æ— å¯ç”¨å·¥ä½œçº¿ç¨‹ç­‰ Calendar æ—¥å†ï¼ˆä¸æ˜¯ java.util.calendar å¯¹è±¡ï¼‰ï¼šç”¨äºæ’é™¤æ‰§è¡Œæ—¥æœŸéå¸¸æœ‰ç”¨ ä¾‹å¦‚ï¼šå®šä¹‰ä¸€ä¸ªæ¯å¤© 9 ç‚¹æ‰§è¡Œ Trigger ï¼Œä½†æ˜¯æ’é™¤æ‰€æœ‰æ³•å®šèŠ‚å‡æ—¥ ç¤ºä¾‹: Calendar instance = Calendar.getInstance(); Date startTime = instance.getTime(); instance.add(Calendar.MINUTE, 1); Date endTime = instance.getTime(); // 3.æ„å»ºTriggerå®ä¾‹ Trigger trigger = TriggerBuilder.newTrigger() .withIdentity(\"trigger1\", \"group1\") // å¼€å§‹æ—¶é—´ .startAt(startTime) // ç»“æŸæ—¶é—´ .endAt(endTime) .build(); SimpleTriggerSimpleTrigger æ˜¯é€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯çš„è§¦å‘å™¨ï¼Œå®ƒå¯ä»¥æŒ‡å®šç‰¹å®šæ—¶é—´ï¼Œé‡å¤é—´éš”ï¼Œé‡å¤æ¬¡æ•°ç­‰ç®€å•åœºæ™¯ï¼Œå®ƒä¸»è¦è®¾å®šå‚æ•°å¦‚ä¸‹ï¼š å¼€å§‹æ—¶é—´ ç»“æŸæ—¶é—´ é‡å¤æ¬¡æ•° é—´éš”æ—¶é—´ å…·ä½“çš„ API å¯ä»¥å‚è€ƒ Quartz çš„ Java Doc æ–‡æ¡£ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº† misfire å¤„ç†ç­–ç•¥ï¼š æˆ‘ä»¬ä¸Šé¢è¯´è¿‡ Quartz Misfire çš„æ¦‚å¿µï¼Œä»æºç  SimpleScheduleBuilder ç±»ä¸­å¯ä»¥çœ‹åˆ° MISFIRE_INSTRUCTION_SMART_POLICY æ˜¯é»˜è®¤çš„è§¦å‘ç­–ç•¥ï¼Œä½†æ˜¯ä¹Ÿæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨åˆ›å»º Trigger æ—¶å€™è®¾ç½®æˆ‘ä»¬æœŸæœ›çš„é”™è¿‡è§¦å‘ç­–ç•¥ï¼Œå¦‚ä¸‹ï¼š SimpleTrigger trigger = TriggerBuilder.newTrigger() .withIdentity(\"trigger1\", \"group1\") .withSchedule(SimpleScheduleBuilder .simpleSchedule() .withIntervalInSeconds(1) .repeatForever() // misfireInstruction = SimpleTrigger.MISFIRE_INSTRUCTION_FIRE_NOW; .withMisfireHandlingInstructionFireNow() ).build(); åœ¨ SimpleTrigger ç±»ä¸­çš„å¸¸é‡å¯ä»¥çœ‹åˆ°æ‰€æœ‰é”™è¿‡è§¦å‘ï¼ˆmisfireï¼‰å¤„ç†é€»è¾‘ï¼š MISFIRE_INSTRUCTION_FIRE_NOW MISFIRE_INSTRUCTION_RESCHEDULE_NOW_WITH_EXISTING_REPEAT_COUNT MISFIRE_INSTRUCTION_RESCHEDULE_NOW_WITH_REMAINING_REPEAT_COUNT MISFIRE_INSTRUCTION_RESCHEDULE_NEXT_WITH_REMAINING_COUNT MISFIRE_INSTRUCTION_RESCHEDULE_NEXT_WITH_EXISTING_COUNT å…³äº misfire çš„å…·ä½“çš„è¡Œä¸ºï¼Œå¯ä»¥æŸ¥é˜… Quartz çš„ Java Doc æ–‡æ¡£ CronTriggerç›¸æ¯” SimpleTrigger å¯ä»¥æŒ‡å®šæ›´ä¸ºå¤æ‚çš„æ‰§è¡Œè®¡åˆ’ï¼ŒCRON æ˜¯æ¥è‡ª UNIX åŸºäºæ—¶é—´çš„ä»»åŠ¡ç®¡ç†ç³»ç»Ÿï¼Œç›¸å…³å†…å®¹å°±ä¸å†å±•å¼€ï¼Œå¯ä»¥å‚é˜… Cron - (wikipedia.org) æ–‡æ¡£è¿›ä¸€æ­¥äº†è§£ï¼Œ Cron ä¹Ÿæœ‰ç±»ä¼¼ SimpleTrigger çš„ç›¸åŒå±æ€§ï¼Œè®¾ç½®æ•ˆæœå¦‚ä¸‹ï¼š startTimeï¼šè§¦å‘å™¨é¦–æ¬¡ç”Ÿæ•ˆçš„æ—¶é—´ endTimeï¼šè§¦å‘å™¨å¤±æ•ˆæ—¶é—´ çœ‹çœ‹ CronTrigger çš„ä½¿ç”¨ç¤ºä¾‹ï¼š CronTrigger cronTrigger = TriggerBuilder.newTrigger() .withIdentity(\"trigger1\", \"group1\") .withSchedule(CronScheduleBuilder .cronSchedule(\"0 0/2 8-17 * * ?\") .withMisfireHandlingInstructionFireAndProceed() ) .build(); scheduler.scheduleJob(job, cronTrigger); ä¸Šè¿°ä»£ç å®Œæˆä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š åˆ›å»º Cron è¡¨è¾¾å¼ï¼šæ¯å¤©ä¸Šåˆ 8 ç‚¹åˆ°ä¸‹åˆ 5 ç‚¹ä¹‹é—´æ¯éš”ä¸€åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ æŒ‡å®š MISFIRE_INSTRUCTION_FIRE_NOW ä¸º CronTrigger çš„å¤„ç†ç­–ç•¥ é€šè¿‡ Schduler å¯¹ä»»åŠ¡å¼€å§‹è¿›è¡Œè°ƒåº¦ CronTrigger Misfire ç­–ç•¥å®šä¹‰åœ¨ CronTrigger å¸¸é‡ä¸­ï¼Œå¯ä»¥åœ¨ Java Doc æ–‡æ¡£ä¸­æŸ¥çœ‹å…¶å…·ä½“çš„è¡Œä¸º Cron è¡¨è¾¾å¼åœ¨çº¿ç”Ÿæˆï¼Œåè§£æçš„å·¥å…·ï¼šhttp://www.matools.com/cron Linstener ç›‘å¬å™¨JobStore ä½œä¸šå­˜å‚¨é›†ç¾¤æ¨¡å¼é…ç½®é›†ç¾¤æ³¨æ„äº‹é¡¹SpringBooté›†æˆQuartzQuartz æ•´åˆ Springboot éå¸¸æ™®éçš„åœºæ™¯ï¼Œæ•´åˆ Spring å¯ä»¥å¸¦æ¥å¥½å¤„ï¼š æ›´åŠ ç®€æ´çš„é…ç½®ï¼Œå¼€ç®±å³ç”¨ å’Œ Spring çš„ IOC å®¹å™¨èåˆï¼Œä½¿ç”¨æ›´ä¾¿æ· æ·»åŠ ä¾èµ–å¯ä»¥åœ¨ç°æœ‰é¡¹ç›®ä¸Šæ·»åŠ  springboot å®˜æ–¹æä¾›çš„ starter-quartz ä¾èµ–ï¼Œå¦‚ä¸‹ï¼š &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-quartz&lt;/artifactId> &lt;/dependency> å› ä¸ºåé¢éœ€è¦å†™æ¥å£æµ‹è¯•ï¼Œå› æ­¤è¿˜éœ€æ·»åŠ  SpringBootå…³äºwebçš„ä¾èµ– &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-web&lt;/artifactId> &lt;/dependency> å¯åŠ¨ Springboot ä¼šå‘ç°ï¼Œæ— éœ€ä»»ä½•é…ç½®å°±å·²ç»æ•´åˆ Quartz æ¨¡å—äº†ï¼š 2023-10-15 22:02:04.654 INFO 20840 --- [ main] org.quartz.impl.StdSchedulerFactory : Quartz scheduler &#39;quartzScheduler&#39; initialized from an externally provided properties instance. 2023-10-15 22:02:04.654 INFO 20840 --- [ main] org.quartz.impl.StdSchedulerFactory : Quartz scheduler version: 2.3.2 2023-10-15 22:02:04.654 INFO 20840 --- [ main] org.quartz.core.QuartzScheduler : JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@4dc8caa7 2023-10-15 22:02:04.686 INFO 20840 --- [ main] o.s.s.quartz.SchedulerFactoryBean : Starting Quartz Scheduler now 2023-10-15 22:02:04.686 INFO 20840 --- [ main] org.quartz.core.QuartzScheduler : Scheduler quartzScheduler_$_NON_CLUSTERED started. 2023-10-15 22:02:04.694 INFO 20840 --- [ main] c.e.quartzStudy.QuartzStudyApplication : Started QuartzStudyApplication in 0.768 seconds (JVM running for 1.504) ä½¿ç”¨ç¤ºä¾‹ç°åœ¨åŸºäºæ•´åˆæ¨¡å¼å®ç°åˆšæ‰çš„ Demo ç¤ºä¾‹ï¼Œé¦–å…ˆå®šä¹‰ä»»åŠ¡ï¼Œè¿™é‡Œä¸å†æ˜¯å®ç° Job ç±»ï¼š public class HelloJob extends QuartzJobBean &#123; @Override protected void executeInternal(JobExecutionContext context) throws JobExecutionException &#123; JobDataMap jobDataMap = context.getJobDetail().getJobDataMap(); String name = jobDataMap.getString(\"name\"); System.out.println(\"Hello :\" + name); &#125; &#125; è¿™é‡Œå®ç°ç”± Springboot æä¾›çš„ QuartzJobBeanï¼Œå®ç° executerInternal() æ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªç»è¿‡ Spring å®¹å™¨åŒ…è£…åçš„ä»»åŠ¡ç±»ï¼Œå¯ä»¥åœ¨ä»»åŠ¡ç±»ä½¿ç”¨ Spring å®¹å™¨çš„å®ä¾‹ åœ¨ Demo ç¤ºä¾‹é‡Œé¢ï¼Œæˆ‘ä»¬è°ƒåº¦å¯åŠ¨éƒ½æ˜¯åœ¨ Main æ–¹æ³•å¯åŠ¨ï¼Œåœ¨æœ¬åœ°æµ‹è¯•æ²¡æœ‰é—®é¢˜ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒå°±ä¸å»ºè®®äº†ï¼Œå’Œ springboot æ•´åˆåå…³äºä»»åŠ¡æ‰§è¡Œï¼Œç°åœ¨å¯ä»¥æœ‰ 2 ä¸­é€‰é¡¹ï¼š åœ¨æ§åˆ¶å±‚ Controller æä¾›æ¥å£ï¼Œæ‰‹åŠ¨æ¥æ”¶ä»»åŠ¡æŒ‡å®š ç›‘å¬ Spring å®¹å™¨ï¼Œåœ¨å®¹å™¨å¯åŠ¨åï¼Œè‡ªåŠ¨åŠ è½½ä»»åŠ¡ï¼Œå¹¶ä¸”æ³¨å†Œä¸º Bean æ‰‹åŠ¨æ‰§è¡Œæˆ‘ä»¬å…ˆçœ‹çœ‹ç¬¬ä¸€ç§å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬åˆ›å»ºæ§åˆ¶å™¨ï¼Œç„¶åæ¥æ”¶å‚æ•°ï¼Œåˆ›å»ºä»»åŠ¡ï¼Œå¦‚ä¸‹ï¼š @RestController public class HelloController &#123; @Autowired private Scheduler scheduler; @GetMapping(\"/hello\") public void helloJob(String name) throws SchedulerException &#123; // å®šä¹‰ä¸€ä¸ªçš„ä»»åŠ¡ JobDetail job = JobBuilder.newJob(HelloJob.class) .withIdentity(\"job11\", \"group1\") .usingJobData(\"name\", name) .build(); // å®šä¹‰ä¸€ä¸ªç®€å•çš„è§¦å‘å™¨: æ¯éš” 1 ç§’æ‰§è¡Œ 1 æ¬¡ï¼Œä»»åŠ¡æ°¸ä¸åœæ­¢ SimpleTrigger trigger = TriggerBuilder.newTrigger() .withIdentity(\"trigger1\", \"group1\") .withSchedule(SimpleScheduleBuilder .simpleSchedule() .withIntervalInSeconds(1) .repeatForever() ).build(); // å¼€å§‹è°ƒåº¦ scheduler.scheduleJob(job, trigger); &#125; &#125; ç„¶åå¯åŠ¨æœåŠ¡å™¨ï¼Œä½¿ç”¨http-requestè®¿é—®æ¥å£ä¼ å…¥å‚æ•°ï¼š GET http://localhost:8080/hello?name=phoenix ç„¶åæ§åˆ¶å°ä¼šè¾“å‡ºï¼š 2023-10-15 22:15:38.623 INFO 8060 --- [nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring DispatcherServlet 'dispatcherServlet' 2023-10-15 22:15:38.623 INFO 8060 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet : Initializing Servlet 'dispatcherServlet' 2023-10-15 22:15:38.623 INFO 8060 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet : Completed initialization in 0 ms Hello :phoenix Hello :phoenix Hello :phoenix Hello :phoenix .... è‡ªåŠ¨æ‰§è¡Œå°† JobDetail æ³¨å†Œ Beanï¼Œä»»åŠ¡å°±ä¼šéš Spring å¯åŠ¨è‡ªåŠ¨è§¦å‘æ‰§è¡Œï¼Œè¿™å¯¹äºéœ€è¦éšç¨‹åºå¯åŠ¨æ‰§è¡Œçš„ä½œä¸šéå¸¸æœ‰æ•ˆï¼Œé…ç½®å¦‚ä¸‹ï¼š å…ˆåˆ›å»ºä¸€ä¸ªé…ç½®ç±»ï¼š @Configuration public class QuartzConfig &#123; @Bean public JobDetail jobDetail() &#123; JobDetail job = JobBuilder.newJob(HelloJob.class) .withIdentity(\"job11\", \"group1\") .usingJobData(\"name\", \"springboot\") .storeDurably() .build(); return job; &#125; @Bean public Trigger trigger() &#123; SimpleTrigger trigger = TriggerBuilder.newTrigger() .forJob(jobDetail()) .withIdentity(\"trigger1\", \"group1\") .withSchedule(SimpleScheduleBuilder .simpleSchedule() .withIntervalInSeconds(1) .repeatForever() ).build(); return trigger; &#125; &#125; ç„¶ååœ¨ springboot å¯åŠ¨åï¼Œä»»åŠ¡å°±è‡ªåŠ¨æ‰§è¡Œï¼š 2023-10-15 22:16:50.481 INFO 21208 --- [ main] c.e.quartzStudy.QuartzStudyApplication : Started QuartzStudyApplication in 1.349 seconds (JVM running for 2.11) Hello :springboot Hello :springboot Hello :springboot ... å·¥å…·ç±» Folding ScheduleUtils è°ƒåº¦å·¥å…·ç±» public class ScheduleUtils &#123; /** * å¾—åˆ°quartzä»»åŠ¡ç±» * * @param job æ‰§è¡Œè®¡åˆ’ * @return å…·ä½“æ‰§è¡Œä»»åŠ¡ç±» */ private static Class&lt;? extends Job> getQuartzJobClass(QuartzJob job) &#123; boolean isConcurrent = \"0\".equals(job.getConcurrent()); return isConcurrent ? QuartzJobExecution.class : QuartzDisallowConcurrentExecution.class; &#125; /** * æ„å»ºä»»åŠ¡è§¦å‘å¯¹è±¡ */ public static TriggerKey getTriggerKey(Long jobId, String jobGroup) &#123; return TriggerKey.triggerKey(ScheduleConstants.TASK_CLASS_NAME + jobId, jobGroup); &#125; /** * æ„å»ºä»»åŠ¡é”®å¯¹è±¡ */ public static JobKey getJobKey(Long jobId, String jobGroup) &#123; return JobKey.jobKey(ScheduleConstants.TASK_CLASS_NAME + jobId, jobGroup); &#125; /** * åˆ›å»ºå®šæ—¶ä»»åŠ¡ */ public static void createScheduleJob(Scheduler scheduler, QuartzJob job) throws Exception &#123; Class&lt;? extends Job> jobClass = getQuartzJobClass(job); // æ„å»ºjobä¿¡æ¯ Long jobId = job.getJobId(); String jobGroup = job.getJobGroup(); JobDetail jobDetail = JobBuilder.newJob(jobClass).withIdentity(getJobKey(jobId, jobGroup)).build(); // è¡¨è¾¾å¼è°ƒåº¦æ„å»ºå™¨ CronScheduleBuilder cronScheduleBuilder = CronScheduleBuilder.cronSchedule(job.getCronExpression()); cronScheduleBuilder = handleCronScheduleMisfirePolicy(job, cronScheduleBuilder); // æŒ‰æ–°çš„cronExpressionè¡¨è¾¾å¼æ„å»ºä¸€ä¸ªæ–°çš„trigger CronTrigger trigger = TriggerBuilder.newTrigger().withIdentity(getTriggerKey(jobId, jobGroup)) .withSchedule(cronScheduleBuilder).build(); // æ”¾å…¥å‚æ•°ï¼Œè¿è¡Œæ—¶çš„æ–¹æ³•å¯ä»¥è·å– jobDetail.getJobDataMap().put(ScheduleConstants.TASK_PROPERTIES, job); // åˆ¤æ–­æ˜¯å¦å­˜åœ¨ if (scheduler.checkExists(getJobKey(jobId, jobGroup))) &#123; // é˜²æ­¢åˆ›å»ºæ—¶å­˜åœ¨æ•°æ®é—®é¢˜ å…ˆç§»é™¤ï¼Œç„¶ååœ¨æ‰§è¡Œåˆ›å»ºæ“ä½œ scheduler.deleteJob(getJobKey(jobId, jobGroup)); &#125; scheduler.scheduleJob(jobDetail, trigger); // æš‚åœä»»åŠ¡ if (job.getStatus().equals(ScheduleConstants.Status.PAUSE.getValue())) &#123; scheduler.pauseJob(ScheduleUtils.getJobKey(jobId, jobGroup)); &#125; &#125; /** * è®¾ç½®å®šæ—¶ä»»åŠ¡ç­–ç•¥ */ public static CronScheduleBuilder handleCronScheduleMisfirePolicy(QuartzJob job, CronScheduleBuilder cb) throws Exception &#123; switch (job.getMisfirePolicy()) &#123; case ScheduleConstants.MISFIRE_DEFAULT: return cb; case ScheduleConstants.MISFIRE_IGNORE_MISFIRES: return cb.withMisfireHandlingInstructionIgnoreMisfires(); case ScheduleConstants.MISFIRE_FIRE_AND_PROCEED: return cb.withMisfireHandlingInstructionFireAndProceed(); case ScheduleConstants.MISFIRE_DO_NOTHING: return cb.withMisfireHandlingInstructionDoNothing(); default: throw new Exception(\"The task misfire policy '\" + job.getMisfirePolicy() + \"' cannot be used in cron schedule tasks\"); &#125; &#125; &#125; Folding AbstractQuartzJob æŠ½è±¡ä»»åŠ¡ public abstract class AbstractQuartzJob implements Job &#123; private static final Logger log = LoggerFactory.getLogger(AbstractQuartzJob.class); /** * çº¿ç¨‹æœ¬åœ°å˜é‡ */ private static ThreadLocal&lt;Date> threadLocal = new ThreadLocal&lt;>(); @Override public void execute(JobExecutionContext context) throws JobExecutionException &#123; QuartzJob job = new QuartzJob(); BeanUtils.copyBeanProp(job, context.getMergedJobDataMap().get(ScheduleConstants.TASK_PROPERTIES)); try &#123; before(context, job); if (job != null) &#123; doExecute(context, job); &#125; after(context, job, null); &#125; catch (Exception e) &#123; log.error(\"ä»»åŠ¡æ‰§è¡Œå¼‚å¸¸ - ï¼š\", e); after(context, job, e); &#125; &#125; /** * æ‰§è¡Œå‰ * * @param context å·¥ä½œæ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡ * @param job ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ */ protected void before(JobExecutionContext context, QuartzJob job) &#123; threadLocal.set(new Date()); &#125; /** * æ‰§è¡Œå * * @param context å·¥ä½œæ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡ * @param sysJob ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ */ protected void after(JobExecutionContext context, QuartzJob sysJob, Exception e) &#123; &#125; /** * æ‰§è¡Œæ–¹æ³•ï¼Œç”±å­ç±»é‡è½½ * * @param context å·¥ä½œæ‰§è¡Œä¸Šä¸‹æ–‡å¯¹è±¡ * @param job ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡ * @throws Exception æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å¼‚å¸¸ */ protected abstract void doExecute(JobExecutionContext context, QuartzJob job) throws Exception; &#125;è¿™ä¸ªç±»å°†åŸæœ¬ execute æ–¹æ³•æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä¸‹æ”¾åˆ°äº†å­ç±»é‡è½½çš„ doExecute æ–¹æ³•ä¸­åŒæ—¶å‡†å¤‡å®ç°ï¼Œåˆ†äº†å…è®¸å¹¶å‘å’Œä¸å…è®¸å¹¶å‘ï¼Œå·®åˆ«å°±æ˜¯ä¸€ä¸ªæ³¨è§£public class QuartzJobExecution extends AbstractQuartzJob &#123; @Override protected void doExecute(JobExecutionContext context, QuartzJob job) throws Exception &#123; JobInvokeUtil.invokeMethod(job); &#125; &#125; @DisallowConcurrentExecution public class QuartzDisallowConcurrentExecution extends AbstractQuartzJob &#123; @Override protected void doExecute(JobExecutionContext context, QuartzJob job) throws Exception &#123; JobInvokeUtil.invokeMethod(job); &#125; &#125; Folding JobInvokeUtil :æ–¹æ³•è°ƒç”¨ æœ€åç”± é€šè¿‡åå°„ï¼Œè¿›è¡Œå®é™…çš„æ–¹æ³•è°ƒç”¨public class JobInvokeUtil &#123; /** * æ‰§è¡Œæ–¹æ³• * * @param job ç³»ç»Ÿä»»åŠ¡ */ public static void invokeMethod(QuartzJob job) throws Exception &#123; String invokeTarget = job.getInvokeTarget(); String beanName = getBeanName(invokeTarget); String methodName = getMethodName(invokeTarget); List&lt;Object[]> methodParams = getMethodParams(invokeTarget); if (!isValidClassName(beanName)) &#123; Object bean = SpringUtils.getBean(beanName); invokeMethod(bean, methodName, methodParams); &#125; else &#123; Object bean = Class.forName(beanName).newInstance(); invokeMethod(bean, methodName, methodParams); &#125; &#125; /** * è°ƒç”¨ä»»åŠ¡æ–¹æ³• * * @param bean ç›®æ ‡å¯¹è±¡ * @param methodName æ–¹æ³•åç§° * @param methodParams æ–¹æ³•å‚æ•° */ private static void invokeMethod(Object bean, String methodName, List&lt;Object[]> methodParams) throws NoSuchMethodException, SecurityException, IllegalAccessException, IllegalArgumentException, InvocationTargetException &#123; if (StringUtils.isNotNull(methodParams) &amp;&amp; methodParams.size() > 0) &#123; Method method = bean.getClass().getDeclaredMethod(methodName, getMethodParamsType(methodParams)); method.invoke(bean, getMethodParamsValue(methodParams)); &#125; else &#123; Method method = bean.getClass().getDeclaredMethod(methodName); method.invoke(bean); &#125; &#125; /** * æ ¡éªŒæ˜¯å¦ä¸ºä¸ºclassåŒ…å * * @param invokeTarget åç§° * @return trueæ˜¯ falseå¦ */ public static boolean isValidClassName(String invokeTarget) &#123; return StringUtils.countMatches(invokeTarget, \".\") > 1; &#125; /** * è·å–beanåç§° * * @param invokeTarget ç›®æ ‡å­—ç¬¦ä¸² * @return beanåç§° */ public static String getBeanName(String invokeTarget) &#123; String beanName = StringUtils.substringBefore(invokeTarget, \"(\"); return StringUtils.substringBeforeLast(beanName, \".\"); &#125; /** * è·å–beanæ–¹æ³• * * @param invokeTarget ç›®æ ‡å­—ç¬¦ä¸² * @return methodæ–¹æ³• */ public static String getMethodName(String invokeTarget) &#123; String methodName = StringUtils.substringBefore(invokeTarget, \"(\"); return StringUtils.substringAfterLast(methodName, \".\"); &#125; /** * è·å–methodæ–¹æ³•å‚æ•°ç›¸å…³åˆ—è¡¨ * * @param invokeTarget ç›®æ ‡å­—ç¬¦ä¸² * @return methodæ–¹æ³•ç›¸å…³å‚æ•°åˆ—è¡¨ */ public static List&lt;Object[]> getMethodParams(String invokeTarget) &#123; String methodStr = StringUtils.substringBetween(invokeTarget, \"(\", \")\"); if (StringUtils.isEmpty(methodStr)) &#123; return null; &#125; String[] methodParams = methodStr.split(\",\"); List&lt;Object[]> classs = new LinkedList&lt;>(); for (int i = 0; i &lt; methodParams.length; i++) &#123; String str = StringUtils.trimToEmpty(methodParams[i]); // Stringå­—ç¬¦ä¸²ç±»å‹ï¼ŒåŒ…å«' if (StringUtils.contains(str, \"'\")) &#123; classs.add(new Object[]&#123;StringUtils.replace(str, \"'\", \"\"), String.class&#125;); &#125; // booleanå¸ƒå°”ç±»å‹ï¼Œç­‰äºtrueæˆ–è€…false else if (StringUtils.equals(str, \"true\") || StringUtils.equalsIgnoreCase(str, \"false\")) &#123; classs.add(new Object[]&#123;Boolean.valueOf(str), Boolean.class&#125;); &#125; // longé•¿æ•´å½¢ï¼ŒåŒ…å«L else if (StringUtils.containsIgnoreCase(str, \"L\")) &#123; classs.add(new Object[]&#123;Long.valueOf(StringUtils.replaceIgnoreCase(str, \"L\", \"\")), Long.class&#125;); &#125; // doubleæµ®ç‚¹ç±»å‹ï¼ŒåŒ…å«D else if (StringUtils.containsIgnoreCase(str, \"D\")) &#123; classs.add(new Object[]&#123;Double.valueOf(StringUtils.replaceIgnoreCase(str, \"D\", \"\")), Double.class&#125;); &#125; // å…¶ä»–ç±»å‹å½’ç±»ä¸ºæ•´å½¢ else &#123; classs.add(new Object[]&#123;Integer.valueOf(str), Integer.class&#125;); &#125; &#125; return classs; &#125; /** * è·å–å‚æ•°ç±»å‹ * * @param methodParams å‚æ•°ç›¸å…³åˆ—è¡¨ * @return å‚æ•°ç±»å‹åˆ—è¡¨ */ public static Class&lt;?>[] getMethodParamsType(List&lt;Object[]> methodParams) &#123; Class&lt;?>[] classs = new Class&lt;?>[methodParams.size()]; int index = 0; for (Object[] os : methodParams) &#123; classs[index] = (Class&lt;?>) os[1]; index++; &#125; return classs; &#125; /** * è·å–å‚æ•°å€¼ * * @param methodParams å‚æ•°ç›¸å…³åˆ—è¡¨ * @return å‚æ•°å€¼åˆ—è¡¨ */ public static Object[] getMethodParamsValue(List&lt;Object[]> methodParams) &#123; Object[] classs = new Object[methodParams.size()]; int index = 0; for (Object[] os : methodParams) &#123; classs[index] = (Object) os[0]; index++; &#125; return classs; &#125; &#125; Folding cronè¡¨è¾¾å¼å·¥å…·ç±» public class CronUtils &#123; /** * è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ä»£è¡¨ä¸€ä¸ªç»™å®šçš„Cronè¡¨è¾¾å¼çš„æœ‰æ•ˆæ€§ * * @param cronExpression Cronè¡¨è¾¾å¼ * @return boolean è¡¨è¾¾å¼æ˜¯å¦æœ‰æ•ˆ */ public static boolean isValid(String cronExpression) &#123; return CronExpression.isValidExpression(cronExpression); &#125; /** * è¿”å›ä¸‹ä¸€ä¸ªæ‰§è¡Œæ—¶é—´æ ¹æ®ç»™å®šçš„Cronè¡¨è¾¾å¼ * * @param cronExpression Cronè¡¨è¾¾å¼ * @return Date ä¸‹æ¬¡Cronè¡¨è¾¾å¼æ‰§è¡Œæ—¶é—´ */ public static Date getNextExecution(String cronExpression) &#123; try &#123; CronExpression cron = new CronExpression(cronExpression); return cron.getNextValidTimeAfter(new Date(System.currentTimeMillis())); &#125; catch (ParseException e) &#123; throw new IllegalArgumentException(e.getMessage()); &#125; &#125; &#125; å‚è€ƒæ–‡ç«  [1] Quartz ä½¿ç”¨æ•™ç¨‹ [2] ä»»åŠ¡è°ƒåº¦æ¡†æ¶ Quartz ç”¨æ³•æŒ‡å—ã€Œè¶…è¯¦ç»†ã€","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Quartz","slug":"Quartz","permalink":"https://blog.ehzyil.xyz/tags/Quartz/"}],"author":"ehzyil"},{"title":"IntelliJ IDEAåˆ›å»ºJSPé¡¹ç›®","slug":"2023/IntelliJ IDEAåˆ›å»ºJSPé¡¹ç›®","date":"2023-10-12T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/12/2023/IntelliJ IDEAåˆ›å»ºJSPé¡¹ç›®/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/12/2023/IntelliJ%20IDEA%E5%88%9B%E5%BB%BAJSP%E9%A1%B9%E7%9B%AE/","excerpt":"","text":"åˆ›å»ºé¡¹ç›®åœ¨IntelliJ IDEAä¸­åˆ›å»ºjspé¡¹ç›®çš„æ­¥éª¤å¦‚ä¸‹: 1.ç‚¹å‡»â€Create New Projectâ€ 2.é€‰æ‹©â€œJava Enterpriseâ€å¹¶å°†é…ç½®è®¾ç½®ä¸ºç®­å¤´æ‰€æŒ‡å†…å®¹åç‚¹å‡»â€Nextâ€ è¾“å…¥é¡¹ç›®åç§°å¹¶é€‰æ‹©å­˜å‚¨ä½ç½®ï¼Œé€‰æ‹©Web Applicationï¼Œé€‰æ‹©è¦ä½¿ç”¨çš„Webæ¡†æ¶ï¼ˆè‹¥ä¸ºç©ºï¼Œè‡ªè¡Œå»ä¸‹è½½Tomcatå¹¶é…ç½®ï¼‰ï¼Œé€‰æ‹©æ„å»ºç³»ç»Ÿï¼Œé€‰æ‹©JDKç‰ˆæœ¬ 3.è‹¥ä¸é€‰æ‹©å…¶ä»–ä¾èµ–é¡¹é»˜è®¤åªæœ‰â€œServletâ€ä¾èµ–ï¼Œç‚¹å‡»Createåˆ›å»ºé¡¹ç›® 4.åˆ›å»ºåçš„JSPé¡¹ç›®çš„ç»“æ„å¦‚ä¸‹ï¼š â”œâ”€.idea â”‚ â”œâ”€artifacts â”‚ â””â”€libraries â”œâ”€.mvn â”‚ â””â”€wrapper â”œâ”€src â”‚ â”œâ”€main â”‚ â”‚ â”œâ”€java â”‚ â”‚ â”‚ â””â”€com â”‚ â”‚ â”‚ â””â”€example â”‚ â”‚ â”‚ â””â”€practicaltraining â”‚ â”‚ â”œâ”€resources â”‚ â”‚ â””â”€webapp â”‚ â”‚ â””â”€WEB-INF â”‚ â””â”€test â”‚ â”œâ”€java â”‚ â””â”€resources â””â”€target â”œâ”€classes â”‚ â””â”€com â”‚ â””â”€example â”‚ â””â”€practicaltraining â”œâ”€generated-sources â”‚ â””â”€annotations â””â”€practicalTraining-1.0-SNAPSHOT â”œâ”€META-INF â””â”€WEB-INF â””â”€classes â””â”€com â””â”€example â””â”€practicaltraining 5.ç‚¹å‡»â€Runâ€å³å¯è¿è¡Œ,é¡¹ç›®é»˜è®¤åˆ›å»ºçš„æœ‰ä¸€ä¸ªâ€&#x2F;helloServletâ€ã€‚é¡¹ç›®è¿è¡Œåç‚¹å‡»å³å¯å“åº”â€Hello Servletâ€ã€‚ æ›´æ”¹é»˜è®¤è·³è½¬é¡µé¢1.è¿›å…¥src-&gt;main-&gt;webapp-&gt;WEB-INFä¸‹çš„web.xmlæ–‡ä»¶ã€‚ 2.æ›´æ”¹æ·»åŠ &lt;welcome-file-list&gt;å’Œ &lt;welcome-file&gt;æ ‡ç­¾å¹¶ç”¨ &lt;welcome-file&gt;&lt;/welcome-file&gt;åŒ…è£¹å¯åŠ¨åè¦è·³è½¬çš„é¡µé¢åï¼Œè¯¥é¡¹ç›®é»˜è®¤è·³è½¬çš„é¡µé¢ä¸ºlogin.jspã€‚ &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?> &lt;web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd\" version=\"4.0\"> &lt;welcome-file-list> &lt;welcome-file>login.jsp&lt;/welcome-file> &lt;/welcome-file-list> &lt;/web-app>","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"IntelliJ IDEA","slug":"IntelliJ-IDEA","permalink":"https://blog.ehzyil.xyz/tags/IntelliJ-IDEA/"},{"name":"JSP","slug":"JSP","permalink":"https://blog.ehzyil.xyz/tags/JSP/"}],"author":"ehzyil"},{"title":"åˆ·é¢˜","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•/åˆ·é¢˜","date":"2023-10-12T00:00:00.000Z","updated":"2024-01-30T06:30:58.151Z","comments":true,"path":"2023/10/12/æ•°æ®ç»“æ„ä¸ç®—æ³•/åˆ·é¢˜/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/12/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E5%88%B7%E9%A2%98/","excerpt":"","text":"äºŒåˆ†æŸ¥æ‰¾ 69. x çš„å¹³æ–¹æ ¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ 69. x çš„å¹³æ–¹æ ¹ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ç»™ä½ ä¸€ä¸ªéè´Ÿæ•´æ•° x ï¼Œè®¡ç®—å¹¶è¿”å› x çš„ ç®—æœ¯å¹³æ–¹æ ¹ ã€‚ ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œç»“æœåªä¿ç•™ æ•´æ•°éƒ¨åˆ† ï¼Œå°æ•°éƒ¨åˆ†å°†è¢« èˆå» ã€‚ æ³¨æ„ï¼šä¸å…è®¸ä½¿ç”¨ä»»ä½•å†…ç½®æŒ‡æ•°å‡½æ•°å’Œç®—ç¬¦ï¼Œä¾‹å¦‚ pow(x, 0.5) æˆ–è€… x ** 0.5 ã€‚ ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šx &#x3D; 4 è¾“å‡ºï¼š2 ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šx &#x3D; 8 è¾“å‡ºï¼š2 è§£é‡Šï¼š8 çš„ç®—æœ¯å¹³æ–¹æ ¹æ˜¯ 2.82842..., ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œå°æ•°éƒ¨åˆ†å°†è¢«èˆå»ã€‚ æç¤ºï¼š 0 &lt;= x &lt;= 231 - 1 ç­”æ¡ˆï¼š public int mySqrt(int x) &#123; //å¤„ç†ç‰¹æ®Šæƒ…å†µ if (x == 0) &#123; return 0; &#125; if (x == 1) &#123; return 1; &#125; int i = 0, j = x / 2 + 1; //ä½¿ç”¨å¹³è¡¡ç‰ˆäºŒåˆ†æ³•å¯»æ‰¾æ¯” ä¸­é—´æ•°å¹³æ–¹å°çš„ while (1 &lt; j - i) &#123; int mid = (i + j) >>> 1; //æ±‚mçš„å¹³æ–¹æ—¶ä¼šå‡ºç°å¤§äºintå€¼çš„æƒ…å†µï¼Œæ­¤æ—¶éœ€è¦è½¬ä¸ºlongè¿›è¡Œè®¡ç®— if ((long) mid * mid > x) &#123; j = mid; &#125; else &#123; i = mid; &#125; &#125; return i; &#125; E01. äºŒåˆ†æŸ¥æ‰¾-åŠ›æ‰£ 704 é¢˜è¦ç‚¹ï¼šå‡è€Œæ²»ä¹‹ï¼Œå¯ä»¥ç”¨é€’å½’æˆ–éé€’å½’å®ç° ç»™å®šä¸€ä¸ª n ä¸ªå…ƒç´ æœ‰åºçš„ï¼ˆå‡åºï¼‰æ•´å‹æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ target ï¼Œå†™ä¸€ä¸ªå‡½æ•°æœç´¢ nums ä¸­çš„ targetï¼Œå¦‚æœç›®æ ‡å€¼å­˜åœ¨è¿”å›ä¸‹æ ‡ï¼Œå¦åˆ™è¿”å› -1 ä¾‹å¦‚ è¾“å…¥: nums = [-1,0,3,5,9,12], target = 9 è¾“å‡º: 4 è§£é‡Š: 9 å‡ºç°åœ¨ nums ä¸­å¹¶ä¸”ä¸‹æ ‡ä¸º 4 è¾“å…¥: nums = [-1,0,3,5,9,12], target = 2 è¾“å‡º: -1 è§£é‡Š: 2 ä¸å­˜åœ¨ nums ä¸­å› æ­¤è¿”å› -1 å‚è€ƒç­”æ¡ˆï¼šå¯ä»¥ç”¨è®²è¿‡çš„ä»»æ„ä¸€ç§äºŒåˆ†æ±‚è§£ static int binarySearch(int[] a, int target) &#123; int i = 0, j = a.length; while (1 &lt; j - i) &#123; int mid = (i + j) >>> 1; if (a[mid] &lt; target) &#123; i = mid + 1; &#125; else &#123; j = mid - 1; &#125; &#125; return a[i] == target ? i : -1; &#125; E02. æœç´¢æ’å…¥ä½ç½®-åŠ›æ‰£ 35 é¢˜è¦ç‚¹ï¼šç†è§£è°ä»£è¡¨æ’å…¥ä½ç½® ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡å€¼ åœ¨æ•°ç»„ä¸­æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œå¹¶è¿”å›å…¶ç´¢å¼• å¦‚æœç›®æ ‡å€¼ä¸å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œè¿”å›å®ƒå°†ä¼šè¢«æŒ‰é¡ºåºæ’å…¥çš„ä½ç½® ä¾‹å¦‚ è¾“å…¥: nums &#x3D; [1,3,5,6], target &#x3D; 5 è¾“å‡º: 2 è¾“å…¥: nums &#x3D; [1,3,5,6], target &#x3D; 2 è¾“å‡º: 1 è¾“å…¥: nums &#x3D; [1,3,5,6], target &#x3D; 7 è¾“å‡º: 4 å‚è€ƒç­”æ¡ˆ1ï¼šç”¨äºŒåˆ†æŸ¥æ‰¾åŸºç¡€ç‰ˆä»£ç æ”¹å†™ï¼ŒåŸºç¡€ç‰ˆä¸­ï¼Œæ‰¾åˆ°è¿”å› mï¼Œæ²¡æ‰¾åˆ° i ä»£è¡¨æ’å…¥ç‚¹ï¼Œå› æ­¤æœ‰ public int searchInsert(int[] a, int target) &#123; int i = 0, j = a.length - 1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m - 1; &#125; else if (a[m] &lt; target) &#123; i = m + 1; &#125; else &#123; return m; &#125; &#125; return i; // åŸå§‹ return -1 &#125; å‚è€ƒç­”æ¡ˆ2ï¼šç”¨äºŒåˆ†æŸ¥æ‰¾å¹³è¡¡ç‰ˆæ”¹å†™ï¼Œå¹³è¡¡ç‰ˆä¸­ å¦‚æœ target &#x3D;&#x3D; a[i] è¿”å› i è¡¨ç¤ºæ‰¾åˆ° å¦‚æœ target &lt; a[i]ï¼Œä¾‹å¦‚ target &#x3D; 2ï¼Œa[i] &#x3D; 3ï¼Œè¿™æ—¶å°±åº”è¯¥åœ¨ i ä½ç½®æ’å…¥ 2 å¦‚æœ a[i] &lt; targetï¼Œä¾‹å¦‚ a[i] &#x3D; 3ï¼Œtarget &#x3D; 4ï¼Œè¿™æ—¶å°±åº”è¯¥åœ¨ i+1 ä½ç½®æ’å…¥ 4 public static int searchInsert(int[] a, int target) &#123; int i = 0, j = a.length; while (1 &lt; j - i) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m; &#125; else &#123; i = m; &#125; &#125; return (target &lt;= a[i]) ? i : i + 1; // åŸå§‹ (target == a[i]) ? i : -1; &#125; å‚è€ƒç­”æ¡ˆ3ï¼šç”¨ leftmost ç‰ˆæœ¬è§£ï¼Œè¿”å›å€¼å³ä¸ºæ’å…¥ä½ç½®ï¼ˆå¹¶èƒ½å¤„ç†å…ƒç´ é‡å¤çš„æƒ…å†µï¼‰ public int searchInsert(int[] a, int target) &#123; int i = 0, j = a.length - 1; while(i &lt;= j) &#123; int m = (i + j) >>> 1; if(target &lt;= a[m]) &#123; j = m - 1; &#125; else &#123; i = m + 1; &#125; &#125; return i; &#125; E03. æœç´¢å¼€å§‹ç»“æŸä½ç½®-åŠ›æ‰£ 34 é¢˜ç»™ä½ ä¸€ä¸ªæŒ‰ç…§éé€’å‡é¡ºåºæ’åˆ—çš„æ•´æ•°æ•°ç»„ numsï¼Œå’Œä¸€ä¸ªç›®æ ‡å€¼ targetã€‚è¯·ä½ æ‰¾å‡ºç»™å®šç›®æ ‡å€¼åœ¨æ•°ç»„ä¸­çš„å¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚ å¦‚æœæ•°ç»„ä¸­ä¸å­˜åœ¨ç›®æ ‡å€¼ targetï¼Œè¿”å› [-1, -1]ã€‚ ä½ å¿…é¡»è®¾è®¡å¹¶å®ç°æ—¶é—´å¤æ‚åº¦ä¸º O(log n) çš„ç®—æ³•è§£å†³æ­¤é—®é¢˜ ä¾‹å¦‚ è¾“å…¥ï¼šnums &#x3D; [5,7,7,8,8,10], target &#x3D; 8 è¾“å‡ºï¼š[3,4] è¾“å…¥ï¼šnums &#x3D; [5,7,7,8,8,10], target &#x3D; 6 è¾“å‡ºï¼š[-1,-1] è¾“å…¥ï¼šnums &#x3D; [], target &#x3D; 0 è¾“å‡ºï¼š[-1,-1] å‚è€ƒç­”æ¡ˆ public static int left(int[] a, int target) &#123; int i = 0, j = a.length - 1; int candidate = -1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m - 1; &#125; else if (a[m] &lt; target) &#123; i = m + 1; &#125; else &#123; candidate = m; j = m - 1; &#125; &#125; return candidate; &#125; public static int right(int[] a, int target) &#123; int i = 0, j = a.length - 1; int candidate = -1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m - 1; &#125; else if (a[m] &lt; target) &#123; i = m + 1; &#125; else &#123; candidate = m; i = m + 1; &#125; &#125; return candidate; &#125; public static int[] searchRange(int[] nums, int target) &#123; int x = left(nums, target); if(x == -1) &#123; return new int[] &#123;-1, -1&#125;; &#125; else &#123; return new int[] &#123;x, right(nums, target)&#125;; &#125; &#125; é€’å½’ - single recursionE03. äºŒåˆ†æŸ¥æ‰¾class Solution &#123; public static int recursion(int[] a, int target, int i, int j) &#123; //è·³å‡ºé€’å½’æ¡ä»¶ if (i > j) &#123; return -1; &#125; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; return recursion(a, target, i, m - 1); &#125; else if (a[m] &lt; target) &#123; return recursion(a, target, m + 1, j); &#125; else &#123; return m; &#125; &#125; public int search(int[] nums, int target) &#123; return recursion(nums, target, 0, nums.length - 1); &#125; &#125; E04. å†’æ³¡æ’åºpublic static void main(String[] args) &#123; int[] a = &#123;3, 2, 6, 1, 5, 4, 7&#125;; bubble(a, 0, a.length - 1); System.out.println(Arrays.toString(a)); &#125; /** * é€’å½’å†’æ³¡æ’åº * &lt;ul> * &lt;li>å°†æ•°ç»„åˆ’åˆ†æˆä¸¤éƒ¨åˆ† [0 .. j] [j+1 .. a.length-1]&lt;/li> * &lt;li>å·¦è¾¹ [0 .. j] æ˜¯æœªæ’åºéƒ¨åˆ†&lt;/li> * &lt;li>å³è¾¹ [j+1 .. a.length-1] æ˜¯å·²æ’åºéƒ¨åˆ†&lt;/li> * &lt;li>æœªæ’åºåŒºé—´å†…, ç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ æ¯”è¾ƒ, å¦‚æœå‰ä¸€ä¸ªå¤§äºåä¸€ä¸ª, åˆ™äº¤æ¢ä½ç½®&lt;/li> * &lt;/ul> */ private static void bubble(int[] a, int low, int high) &#123; //ç»ˆæ­¢æ¡ä»¶ å·¦å³è¾¹ç•Œç›¸ç­‰ if (low == high) &#123; return; &#125; //æ¯ä¸€è½®æ’åº é‡ç½®jçš„å€¼ int j = low; //forå¾ªç¯ç”¨æ¥æ’åº for (int i = low; i &lt; high; i++) &#123; if (a[i] > a[i + 1]) &#123; //æ»¡è¶³å·¦æ¯”å³å¤§ äº¤æ¢é¡ºåº int temp=a[i]; a[i]=a[i+1]; a[i+1]=temp; //jç”¨æ¥è®°å½•å·²æ’åºçš„å³è¾¹å±Š jå³è¾¹çš„å·²æ’åºå®Œæˆ j=i; &#125; &#125; //é€’å½’è¿›å…¥ä¸‹ä¸€è½® bubble(a,low,j); &#125; low ä¸ high ä¸ºæ’åºèŒƒå›´ j è¡¨ç¤ºçš„æ˜¯æœªæ’åºçš„è¾¹ç•Œï¼Œä¸‹ä¸€æ¬¡é€’å½’æ—¶çš„ high å‘ç”Ÿäº¤æ¢ï¼Œæ„å‘³ç€æœ‰æ— åºæƒ…å†µ æœ€åä¸€æ¬¡äº¤æ¢ï¼ˆä»¥åæ²¡æœ‰æ— åºï¼‰æ—¶ï¼Œå·¦ä¾§ i ä»æ˜¯æ— åºï¼Œå³ä¾§ i+1 å·²ç„¶æœ‰åº E05. æ’å…¥æ’åºç‰ˆæœ¬v1 public static void main(String[] args) &#123; int[] a = &#123;3, 2, 6, 1, 5, 7, 4&#125;; insertion(a, 1); System.out.println(Arrays.toString(a)); &#125; private static void insertion(int[] a, int low) &#123; // ç»“æŸæ¡ä»¶ low æ˜¯å·²æ’åºå’Œæœªæ’åºçš„è¾¹ç•Œï¼Œå½“lowç­‰äºæ•°ç»„é•¿åº¦çš„æ—¶å€™è¯´æ˜å…¨éƒ¨æ’åºå®Œæˆ if (low == a.length) return; // lowæ‰€æŒ‡ä¸‹å‘çš„å€¼ int t = a[low]; // å·²æ’åºåŒºåŸŸæŒ‡é’ˆ int i = low - 1; // é€šè¿‡å¾ªç¯å°†ç¬¦åˆæ¡ä»¶çš„å€¼å³ç§» i>=0æ¥å¤„ç†åªæœ‰ä¸€å¼ ç‰Œçš„æƒ…å†µ å³i=-1 while (i >= 0 &amp;&amp; a[i] > t) &#123; a[i + 1] = a[i]; // ç©ºå‡ºæ’å…¥ä½ç½® i--; &#125; // æ‰¾åˆ°äº†æ’å…¥çš„ä½ç½® // è‹¥i+1==low è¯´æ˜æ²¡æœ‰ç§»åŠ¨ if (i + 1 != low) &#123; a[i + 1] = t; &#125; // é€’å½’ insertion(a, low + 1); &#125; å·²æ’åºåŒºåŸŸï¼š[0 .. i .. low-1] æœªæ’åºåŒºåŸŸï¼š[low .. high] ç‰ˆæœ¬v2 public static void main(String[] args) &#123; int[] a = &#123;3, 2, 6, 1, 5, 7, 4&#125;; insertion(a, 1, a.length - 1); System.out.println(Arrays.toString(a)); &#125; private static void insertion(int[] a, int low, int high) &#123; if (low > high) &#123; return; &#125; int t = a[low]; int i = low - 1; while (i >= 0 &amp;&amp; a[i] > t) &#123; a[i + 1] = a[i]; i--; &#125; if(i + 1 != low) &#123; a[i + 1] = t; &#125; insertion(a, low + 1, high); &#125; ç¬¬ä¸€å—ä»£ç æ˜¯åªè€ƒè™‘ low è¾¹ç•Œçš„æƒ…å†µï¼Œå‚è€ƒä»¥ä¸Šä»£ç ï¼Œç†è§£ low-1 .. high èŒƒå›´å†…çš„å¤„ç†æ–¹æ³• æ‰©å±•ï¼šåˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾ leftmost ç‰ˆæœ¬ï¼Œæ”¹è¿›å¯»æ‰¾æ’å…¥ä½ç½®çš„ä»£ç  ç‰ˆæœ¬v3 å¦ä¸€ç§æ’å…¥æ’åºçš„å®ç°,ç¼ºç‚¹: èµ‹å€¼æ¬¡æ•°è¾ƒå¤šprivate static void insertion2(int[] a, int low) &#123; if (low == a.length) &#123; return; &#125; int i = low - 1; while (i >= 0 &amp;&amp; a[i] > a[i + 1]) &#123; int t = a[i]; a[i] = a[i + 1]; a[i + 1] = t; i--; &#125; insertion(a, low + 1); &#125; E06. çº¦ç‘Ÿå¤«é—®é¢˜[^16]å¾…å®Œæˆï¼ï¼ï¼ é€’å½’ - multi recursionE02. æ±‰è¯ºå¡”[^13]Tower of Hanoiï¼Œæ˜¯ä¸€ä¸ªæºäºå°åº¦å¤è€ä¼ è¯´ï¼šå¤§æ¢µå¤©åˆ›å»ºä¸–ç•Œæ—¶åšäº†ä¸‰æ ¹é‡‘åˆšçŸ³æŸ±ï¼Œåœ¨ä¸€æ ¹æŸ±å­ä»ä¸‹å¾€ä¸ŠæŒ‰å¤§å°é¡ºåºæ‘ç€ 64 ç‰‡é»„é‡‘åœ†ç›˜ï¼Œå¤§æ¢µå¤©å‘½ä»¤å©†ç½—é—¨æŠŠåœ†ç›˜é‡æ–°æ‘†æ”¾åœ¨å¦ä¸€æ ¹æŸ±å­ä¸Šï¼Œå¹¶ä¸”è§„å®š ä¸€æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä¸ªåœ†ç›˜ å°åœ†ç›˜ä¸Šä¸èƒ½æ”¾å¤§åœ†ç›˜ ä¸‹é¢çš„åŠ¨å›¾æ¼”ç¤ºäº†4ç‰‡åœ†ç›˜çš„ç§»åŠ¨æ–¹æ³• ä½¿ç”¨ç¨‹åºä»£ç æ¨¡æ‹Ÿåœ†ç›˜çš„ç§»åŠ¨è¿‡ç¨‹ï¼Œå¹¶ä¼°ç®—å‡ºæ—¶é—´å¤æ‚åº¦ æ€è·¯ å‡è®¾æ¯æ ¹æŸ±å­æ ‡å· aï¼Œbï¼Œcï¼Œæ¯ä¸ªåœ†ç›˜ç”¨ 1ï¼Œ2ï¼Œ3 â€¦ è¡¨ç¤ºå…¶å¤§å°ï¼Œåœ†ç›˜åˆå§‹åœ¨ aï¼Œè¦ç§»åŠ¨åˆ°çš„ç›®æ ‡æ˜¯ c å¦‚æœåªæœ‰ä¸€ä¸ªåœ†ç›˜ï¼Œæ­¤æ—¶æ˜¯æœ€å°é—®é¢˜ï¼Œå¯ä»¥ç›´æ¥æ±‚è§£ ç§»åŠ¨åœ†ç›˜1 $a \\mapsto c$ å¦‚æœæœ‰ä¸¤ä¸ªåœ†ç›˜ï¼Œé‚£ä¹ˆ åœ†ç›˜1 $a \\mapsto b$ åœ†ç›˜2 $a \\mapsto c$ åœ†ç›˜1 $b \\mapsto c$ å¦‚æœæœ‰ä¸‰ä¸ªåœ†ç›˜ï¼Œé‚£ä¹ˆ åœ†ç›˜12 $a \\mapsto b$ åœ†ç›˜3 $a \\mapsto c$ åœ†ç›˜12 $b \\mapsto c$ å¦‚æœæœ‰å››ä¸ªåœ†ç›˜ï¼Œé‚£ä¹ˆ åœ†ç›˜ 123 $a \\mapsto b$ åœ†ç›˜4 $a \\mapsto c$ åœ†ç›˜ 123 $b \\mapsto c$ é¢˜è§£ public class E02HanoiTower &#123; static LinkedList&lt;Integer> a = new LinkedList&lt;>(); static LinkedList&lt;Integer> b = new LinkedList&lt;>(); static LinkedList&lt;Integer> c = new LinkedList&lt;>(); public static void main(String[] args) &#123; StopWatch sw = new StopWatch(); int n = 4; init(n); sw.start(\"n=\"+n); move(n,a,b,c); sw.stop(); print(); System.out.println(sw.prettyPrint()); &#125; /** * &lt;h3>ç§»åŠ¨åœ†ç›˜&lt;/h3> * * @param n åœ†ç›˜ä¸ªæ•° * @param a ç”± * @param b å€Ÿ * @param c è‡³ */ static void move(int n, LinkedList&lt;Integer> a, LinkedList&lt;Integer> b, LinkedList&lt;Integer> c) &#123; //ç»ˆæ­¢æ¡ä»¶ n==0 if (n == 0) return; //å°†n-1ä¸ªä»aå€ŸåŠ©cç§»åŠ¨åˆ°b move(n - 1, a, c, b); //å°†æœ€åä¸€ä¸ªåœ¨açš„ç›˜å­ç§»åŠ¨åˆ°c c.addLast(a.removeLast()); // print(); //å°†n-1ä¸ªä»bå€ŸåŠ©aç§»åŠ¨åˆ°c move(n - 1, b,a, c); &#125; static void init(int n) &#123; for (int i = 1; i &lt;= n; i++) &#123; a.add(i); &#125; &#125; //æ‰“å°åˆ—è¡¨ private static void print() &#123; System.out.println(\"******************************\"); System.out.println(a); System.out.println(b); System.out.println(c); &#125; &#125; E03. æ¨è¾‰ä¸‰è§’[^6] åˆ†æ æŠŠå®ƒæ–œç€çœ‹ 1 1 1 1 2 1 1 3 3 1 1 4 6 4 1 1 8 1 1 6 (n-i-1)*2 1 2 1 4 1 3 3 1 2 1 4 6 4 1 0 è¡Œ $i$ï¼Œåˆ— $j$ï¼Œé‚£ä¹ˆ $[i][j]$ çš„å–å€¼åº”ä¸º $[i-1][j-1] + [i-1][j]$ å½“ $j&#x3D;0$ æˆ– $i&#x3D;j$ æ—¶ï¼Œ$[i][j]$ å–å€¼ä¸º $1$ é¢˜è§£ public static void print(int n) &#123; for (int i = 0; i &lt; n; i++) &#123; //æ‰“å°å­—ç¬¦ä¸² if (i &lt; n - 1) &#123; System.out.printf(\"%\" + 2 * (n - 1 - i) + \"s\", \" \"); &#125; //printSpace((n - i - 1) * 4); for (int j = 0; j &lt; i + 1; j++) &#123; System.out.printf(\"%-4d\", element(i, j)); &#125; //æ¢è¡Œ System.out.println(); &#125; &#125; //é€’å½’å‡½æ•° public static int element(int i, int j) &#123; if (j == 0 || i == j) &#123; return 1; &#125; return element(i - 1, j - 1) + element(i - 1, j); &#125; public static void printSpace(int n) &#123; for (int i = 0; i &lt; n; i++) &#123; System.out.print(\" \"); &#125; &#125; ä¼˜åŒ– ä¼˜åŒ–1æ˜¯ multiple recursionï¼Œå› æ­¤å¾ˆå¤šé€’å½’è°ƒç”¨æ˜¯é‡å¤çš„ï¼Œä¾‹å¦‚recursion(3, 1) åˆ†è§£ä¸ºrecursion(2, 0) + recursion(2, 1)è€Œ recursion(3, 2) åˆ†è§£ä¸ºrecursion(2, 1) + recursion(2, 2)è¿™é‡Œ recursion(2, 1) å°±é‡å¤è°ƒç”¨äº†ï¼Œäº‹å®ä¸Šå®ƒä¼šé‡å¤å¾ˆå¤šæ¬¡ï¼Œå¯ä»¥ç”¨ static AtomicInteger counter &#x3D; new AtomicInteger(0) æ¥æŸ¥çœ‹é€’å½’å‡½æ•°çš„è°ƒç”¨æ€»æ¬¡æ•°äº‹å®ä¸Šï¼Œå¯ä»¥ç”¨ memoization æ¥è¿›è¡Œä¼˜åŒ–ï¼špublic static void print1(int n) &#123; int[][] triangle = new int[n][]; for (int i = 0; i &lt; n; i++) &#123; // æ‰“å°ç©ºæ ¼ triangle[i] = new int[i + 1]; for (int j = 0; j &lt;= i; j++) &#123; System.out.printf(\"%-4d\", element1(triangle, i, j)); &#125; System.out.println(); &#125; &#125; public static int element1(int[][] triangle, int i, int j) &#123; if (triangle[i][j] > 0) &#123; return triangle[i][j]; &#125; if (j == 0 || i == j) &#123; triangle[i][j] = 1; return triangle[i][j]; &#125; triangle[i][j] = element1(triangle, i - 1, j - 1) + element1(triangle, i - 1, j); return triangle[i][j]; &#125;å°†æ•°ç»„ä½œä¸ºé€’å½’å‡½æ•°å†…å¯ä»¥è®¿é—®çš„éå†ï¼Œå¦‚æœ $triangle[i][j]$ å·²ç»æœ‰å€¼ï¼Œè¯´æ˜è¯¥å…ƒç´ å·²ç»è¢«ä¹‹å‰çš„é€’å½’å‡½æ•°è®¡ç®—è¿‡ï¼Œå°±ä¸å¿…é‡å¤è®¡ç®—äº†ä¼˜åŒ–2public static void print2(int n) &#123; int[] row = new int[n]; for (int i = 0; i &lt; n; i++) &#123; // æ‰“å°ç©ºæ ¼ createRow(row, i); for (int j = 0; j &lt;= i; j++) &#123; System.out.printf(\"%-4d\", row[j]); &#125; System.out.println(); &#125; &#125; private static void createRow(int[] row, int i) &#123; if (i == 0) &#123; row[0] = 1; return; &#125; for (int j = i; j > 0; j--) &#123; row[j] = row[j - 1] + row[j]; &#125; &#125;æ³¨æ„ï¼šè¿˜å¯ä»¥é€šè¿‡æ¯ä¸€è¡Œçš„å‰ä¸€é¡¹è®¡ç®—å‡ºä¸‹ä¸€é¡¹ï¼Œä¸å¿…å€ŸåŠ©ä¸Šä¸€è¡Œï¼Œè¿™ä¸æ¨è¾‰ä¸‰è§’çš„å¦ä¸€ä¸ªç‰¹æ€§æœ‰å…³ï¼Œæš‚ä¸å±•å¼€äº† é“¾è¡¨E01. åè½¬å•å‘é“¾è¡¨-åŠ›æ‰£ 206 é¢˜å¯¹åº”åŠ›æ‰£é¢˜ç›® 206. åè½¬é“¾è¡¨ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ è¾“å…¥ï¼šhead &#x3D; [1,2,3,4,5] è¾“å‡ºï¼š[5,4,3,2,1] è¾“å…¥ï¼š[1,2] è¾“å‡ºï¼š[2,1] è¾“å…¥ï¼š[] è¾“å‡ºï¼š[] æ–¹æ³•1 æ„é€ ä¸€ä¸ªæ–°é“¾è¡¨ï¼Œä»æ—§é“¾è¡¨ä¾æ¬¡æ‹¿åˆ°æ¯ä¸ªèŠ‚ç‚¹ï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹æ·»åŠ è‡³æ–°é“¾è¡¨å¤´éƒ¨ï¼Œå®Œæˆåæ–°é“¾è¡¨å³æ˜¯å€’åºçš„ public ListNode reverseList(ListNode o1) &#123; ListNode n1 = null; ListNode p = o1; while (p != null) &#123; //null-> 1->null -> 2,1->null n1 = new ListNode(p.val, n1); p = p.next; &#125; return n1; &#125; è¯„ä»·ï¼šç®€å•ç›´ç™½ï¼Œå°±æ˜¯å¾—æ–°åˆ›å»ºèŠ‚ç‚¹å¯¹è±¡ æ–¹æ³•2 ä¸æ–¹æ³•1 ç±»ä¼¼ï¼Œæ„é€ ä¸€ä¸ªæ–°é“¾è¡¨ï¼Œä»æ—§é“¾è¡¨å¤´éƒ¨ç§»é™¤èŠ‚ç‚¹ï¼Œæ·»åŠ åˆ°æ–°é“¾è¡¨å¤´éƒ¨ï¼Œå®Œæˆåæ–°é“¾è¡¨å³æ˜¯å€’åºçš„ï¼ŒåŒºåˆ«åœ¨äºåŸé¢˜ç›®æœªæä¾›èŠ‚ç‚¹å¤–å±‚çš„å®¹å™¨ç±»ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªï¼Œå¦å¤–ä¸€ä¸ªåŒºåˆ«æ˜¯å¹¶ä¸å»æ„é€ æ–°èŠ‚ç‚¹ static class List &#123; ListNode head; public List(ListNode head) &#123; this.head = head; &#125; public ListNode removeFirst()&#123; ListNode first = head; if (first != null) &#123; head = first.next; &#125; return first; &#125; public void addFirst(ListNode first) &#123; first.next = head; head = first; &#125; &#125; ä»£ç  public ListNode reverseList(ListNode head) &#123; List list1 = new List(head); List list2 = new List(null); ListNode first; while ((first = list1.removeFirst()) != null) &#123; list2.addFirst(first); &#125; return list2.head; &#125; è¯„ä»·ï¼šæ›´åŠ é¢å‘å¯¹è±¡ï¼Œå¦‚æœå®é™…å†™ä»£ç è€Œéåˆ·é¢˜ï¼Œæ›´å¤šä¼šè¿™ä¹ˆåš æ–¹æ³•3 é€’å½’ï¼Œåœ¨å½’æ—¶è®© $5 \\rightarrow 4$ï¼Œ$4 \\rightarrow 3$ â€¦ é¦–å…ˆï¼Œå†™ä¸€ä¸ªé€’å½’æ–¹æ³•ï¼Œè¿”å›å€¼ç”¨æ¥æ‹¿åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ public ListNode reverseList(ListNode p) &#123; if (p == null || p.next == null) &#123; // ä¸è¶³ä¸¤ä¸ªèŠ‚ç‚¹ return p; // æœ€åä¸€ä¸ªèŠ‚ç‚¹ &#125; ListNode last = reverseList(p.next); return last; &#125; æ³¨æ„1ï¼šé€’å½’ç»ˆæ­¢æ¡ä»¶æ˜¯ curr.next &#x3D;&#x3D; nullï¼Œç›®çš„æ˜¯åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹å°±ç»“æŸé€’å½’ï¼Œä¸ä¹‹å‰é€’å½’éå†ä¸ä¸€æ · æ³¨æ„2ï¼šéœ€è¦è€ƒè™‘ç©ºé“¾è¡¨å³ p &#x3D;&#x3D; null çš„æƒ…å†µ å¯ä»¥å…ˆæµ‹è¯•ä¸€ä¸‹ ListNode o5 = new ListNode(5, null); ListNode o4 = new ListNode(4, o5); ListNode o3 = new ListNode(3, o4); ListNode o2 = new ListNode(2, o3); ListNode o1 = new ListNode(1, o2); ListNode n1 = new E01Leetcode206().reverseList(o1); System.out.println(n1); ä¼šæ‰“å° [5] ä¸‹é¢ä¸ºä¼ªç è°ƒç”¨è¿‡ç¨‹ï¼Œå‡è®¾èŠ‚ç‚¹åˆ†åˆ«æ˜¯ $1 \\rightarrow 2 \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow null$ï¼Œå…ˆå¿½ç•¥è¿”å›å€¼ reverseList(ListNode p = 1) &#123; reverseList(ListNode p = 2) &#123; reverseList(ListNode p = 3) &#123; reverseList(ListNode p = 4) &#123; reverseList(ListNode p = 5) &#123; if (p == null || p.next == null) &#123; return p; // è¿”å›5 &#125; &#125; // æ­¤æ—¶pæ˜¯4, p.nextæ˜¯5 &#125; // æ­¤æ—¶pæ˜¯3, p.nextæ˜¯4 &#125; // æ­¤æ—¶pæ˜¯2, p.nextæ˜¯3 &#125; // æ­¤æ—¶pæ˜¯1, p.nextæ˜¯2 &#125; æ¥ä¸‹æ¥ï¼Œä» p &#x3D; 4 å¼€å§‹ï¼Œè¦è®© $5 \\rightarrow 4$ï¼Œ$4 \\rightarrow 3$ â€¦ reverseList(ListNode p = 1) &#123; reverseList(ListNode p = 2) &#123; reverseList(ListNode p = 3) &#123; reverseList(ListNode p = 4) &#123; reverseList(ListNode p = 5) &#123; if (p == null || p.next == null) &#123; return p; // è¿”å›5 &#125; &#125; // æ­¤æ—¶pæ˜¯4, p.nextæ˜¯5, æ­¤æ—¶p.next.next=null,è¦è®©5æŒ‡å‘4,ä»£ç å†™æˆ p.next.next=p // è¿˜è¦æ³¨æ„4è¦æŒ‡å‘ null, å¦åˆ™å°±æ­»é“¾äº†ï¼ˆ4&lt;==>5å³4.next=5ï¼Œ5.next=4ï¼‰ &#125; // æ­¤æ—¶pæ˜¯3, p.nextæ˜¯4,p.next.next=p 4->3 &#125; // æ­¤æ—¶pæ˜¯2, p.nextæ˜¯3 &#125; // æ­¤æ—¶pæ˜¯1, p.nextæ˜¯2 &#125; æœ€ç»ˆä»£ç ä¸ºï¼š ListNode reverseList(ListNode head) &#123; // å¦‚æœé“¾è¡¨ä¸ºç©ºæˆ–åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥è¿”å›åŸé“¾è¡¨ if (head == null || head.next == null) &#123; return head; &#125; // é€’å½’è°ƒç”¨åè½¬é“¾è¡¨æ–¹æ³•ï¼Œå°†å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºå‚æ•°ä¼ å…¥ ListNode last = reverse(head.next); // å°†å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œå®ç°åè½¬ head.next.next = head; // å°†å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹è®¾ä¸ºnullï¼Œæ–­å¼€åŸé“¾è¡¨ä¸åè½¬åé“¾è¡¨çš„è¿æ¥ head.next = null; // è¿”å›åè½¬åçš„é“¾è¡¨å¤´èŠ‚ç‚¹ return last; &#125; Qï¼šä¸ºå•¥ä¸èƒ½åœ¨é€’çš„è¿‡ç¨‹ä¸­å€’åºï¼Ÿ Aï¼šæ¯”å¦‚ $ 1 \\rightarrow 2 \\rightarrow 3 $ å¦‚æœé€’çš„è¿‡ç¨‹ä¸­è®© $2 \\rightarrow 1$ é‚£ä¹ˆæ­¤æ—¶ $2 \\rightarrow 3$ å°±è¢«è¦†ç›–ï¼Œä¸çŸ¥é“æ¥ä¸‹æ¥é€’ç»™è° è€Œå½’çš„æ—¶å€™è®© $3 \\rightarrow 2$ ä¸ä¼šå½±å“ä¸Šä¸€å±‚çš„ $1 \\rightarrow 2$ è¯„ä»·ï¼šå•å‘é“¾è¡¨æ²¡æœ‰ prev æŒ‡é’ˆï¼Œä½†åˆ©ç”¨é€’å½’çš„ç‰¹æ€§ã€è®°ä½äº†ã€‘é“¾è¡¨æ¯æ¬¡è°ƒç”¨æ—¶ç›¸é‚»ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯è° æœªå®ç°çš„æ–¹æ³• æ–¹æ³•4ä»é“¾è¡¨æ¯æ¬¡æ‹¿åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼Œå°†å…¶ä»é“¾è¡¨æ–­å¼€ï¼Œæ’å…¥å¤´éƒ¨ï¼Œç›´è‡³å®ƒä¸º null ç»“æŸè®¾ç½®æŒ‡é’ˆ o1(æ—§å¤´)ã€n1(æ–°å¤´)ã€o2(æ—§è€äºŒ)ï¼Œåˆ†åˆ«æŒ‡å‘ç¬¬ä¸€ï¼Œç¬¬ä¸€ï¼Œç¬¬äºŒèŠ‚ç‚¹$\\frac{n1 \\ o1}{1} \\rightarrow \\frac{o2}{2} \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow null$å°† o2 èŠ‚ç‚¹ä»é“¾è¡¨æ–­å¼€ï¼Œå³ o1 èŠ‚ç‚¹æŒ‡å‘ç¬¬ä¸‰èŠ‚ç‚¹$ \\frac{n1 \\ o1}{1} \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow null$ ï¼Œ$\\frac{o2}{2}$o2 èŠ‚ç‚¹é“¾å…¥é“¾è¡¨å¤´éƒ¨ï¼Œå³$\\frac{o2}{2} \\rightarrow \\frac{n1 \\ o1}{1} \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow null$n1 æŒ‡å‘ o2$\\frac{n1 \\ o2}{2} \\rightarrow \\frac{o1}{1} \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow null$o2 æŒ‡å‘ o1 çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå³$\\frac{n1}{2} \\rightarrow \\frac{o1}{1} \\rightarrow \\frac{o2}{3} \\rightarrow 4 \\rightarrow 5 \\rightarrow null$é‡å¤ä»¥ä¸Š $2\\sim5$ æ­¥ï¼Œç›´åˆ° o2 æŒ‡å‘ nullè¿˜åº”å½“è€ƒè™‘è¾¹ç•Œæ¡ä»¶ï¼Œå³é“¾è¡¨ä¸­ä¸æ»¡ä¸¤ä¸ªå…ƒç´ æ—¶ï¼Œæ— éœ€èµ°ä»¥ä¸Šé€»è¾‘å‚è€ƒç­”æ¡ˆpublic ListNode reverseList(ListNode o1) &#123; if (o1 == null || o1.next == null) &#123; // ä¸è¶³ä¸¤ä¸ªèŠ‚ç‚¹ return o1; &#125; ListNode o2 = o1.next; ListNode n1 = o1; while (o2 != null) &#123; o1.next = o2.next; o2.next = n1; n1 = o2; o2 = o1.next; &#125; return n1; &#125;æ–¹æ³•5è¦ç‚¹ï¼šæŠŠé“¾è¡¨åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œæ€è·¯å°±æ˜¯ä¸æ–­ä»é“¾è¡¨2çš„å¤´ï¼Œå¾€é“¾è¡¨1çš„å¤´æ¬ç§»n1 æŒ‡å‘ nullï¼Œä»£è¡¨æ–°é“¾è¡¨ä¸€å¼€å§‹æ²¡æœ‰å…ƒç´ ï¼Œo1 æŒ‡å‘åŸé“¾è¡¨çš„é¦–èŠ‚ç‚¹$\\frac{n1}{null}$ï¼Œ$\\frac{o1}{1} \\rightarrow 2 \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow null$å¼€å§‹å¾ªç¯ï¼Œo2 æŒ‡å‘åŸé“¾è¡¨æ¬¡èŠ‚ç‚¹$\\frac{n1}{null}$ï¼Œ$\\frac{o1}{1} \\rightarrow \\frac{o2}{2} \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow null$æ¬ç§»$\\frac{o1}{1} \\rightarrow \\frac{n1}{null}$ ï¼Œ $\\frac{o2}{2} \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow null$æŒ‡é’ˆå¤ä½$\\frac{n1}{1} \\rightarrow null$ ï¼Œ $\\frac{o1 \\ o2}{2} \\rightarrow 3 \\rightarrow 4 \\rightarrow 5 \\rightarrow null$é‡å¤ $2\\sim4$ æ­¥å½“ o1 &#x3D; null æ—¶é€€å‡ºå¾ªç¯å‚è€ƒç­”æ¡ˆpublic ListNode reverseList(ListNode o1) &#123; if (o1 == null || o1.next == null) &#123; return o1; &#125; ListNode n1 = null; while (o1 != null) &#123; ListNode o2 = o1.next; o1.next = n1; n1 = o1; o1 = o2; &#125; return n1; &#125;è¯„ä»·ï¼šæœ¬è´¨ä¸Šä¸æ–¹æ³•2 ç›¸åŒï¼Œåªæ˜¯æ–¹æ³•2æ›´ä¸ºé¢å‘å¯¹è±¡é¢˜ä¾‹å¦‚è¾“å…¥ï¼šhead &#x3D; [1,2,6,3,6], val &#x3D; 6 è¾“å‡ºï¼š[1,2,3] è¾“å…¥ï¼šhead &#x3D; [], val &#x3D; 1 è¾“å‡ºï¼š[] è¾“å…¥ï¼šhead &#x3D; [7,7,7,7], val &#x3D; 7 è¾“å‡ºï¼š[] E03. åˆ é™¤å€’æ•°èŠ‚ç‚¹-åŠ›æ‰£ 19 é¢˜ä¾‹å¦‚ è¾“å…¥ï¼šhead &#x3D; [1,2,3,4,5], n &#x3D; 2 è¾“å‡ºï¼š[1,2,3,5] è¾“å…¥ï¼šhead &#x3D; [1], n &#x3D; 1 è¾“å‡ºï¼š[] è¾“å…¥ï¼šhead &#x3D; [1,2], n &#x3D; 1 è¾“å‡ºï¼š[1] å¦å¤–é¢˜ç›®æç¤º é“¾è¡¨è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹ n åªä¼šåœ¨åˆç†èŒƒå›´ è§£æ³•ä¸€ â€‹ å†™ä¸€ä¸ªé€’å½’æ–¹æ³•ï¼Œå¾—åˆ°å€’æ•°çš„æ¬¡åºã€‚ static int recursion(ListNode p, int n) &#123; if (p == null) &#123; return 0; &#125; int nth = recursion(p.next, n); System.out.println(\"nth:\"+nth+\"\\t p:\"+p.toString()); if (nth == n) &#123; p.next = p.next.next; &#125; return nth + 1; &#125; nthæ˜¯å€’æ•°çš„æ¬¡åº pä¸ºå½“å‰èŠ‚ç‚¹ nth:0 p:[5] nth:1 p:[4,5] nth:2 p:[3,4,5] nth:3 p:[2,3,4,5] nth:4 p:[1,2,4,5] å½“nth&#x3D;&#x3D;næ—¶ pä¸ºè¦åˆ é™¤èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªï¼Œåˆ é™¤èŠ‚ç‚¹å³å¯ã€‚ ä½†ä¸Šè¿°ä»£ç æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è‹¥åˆ é™¤çš„æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå®ƒæ²¡æœ‰ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥åŠ ä¸€ä¸ªå“¨å…µæ¥è§£å†³ public ListNode removeNthFromEnd(ListNode head, int n) &#123; ListNode sentinel = new ListNode(-1, head); recursion(sentinel, n); return sentinel.next; &#125; public int recursion(ListNode p, int n) &#123; if (p == null) &#123; return 0; &#125; int nth = recursion(p.next, n); if (nth == n) &#123; p.next = p.next.next; &#125; return nth + 1; &#125; è§£æ³•äºŒ å¿«æ…¢æŒ‡é’ˆï¼Œp1 æŒ‡å‘å¾…åˆ èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªï¼Œp2 å…ˆèµ° n + 1 æ­¥ i=0 p2 s -> 1 -> 2 -> 3 -> 4 -> 5 -> null i=1 p2 s -> 1 -> 2 -> 3 -> 4 -> 5 -> null i=2 p2 s -> 1 -> 2 -> 3 -> 4 -> 5 -> null i=3 ä»æ­¤å¼€å§‹ p1 p2 ä¾æ¬¡å‘å³å¹³ç§», ç›´åˆ° p2 ç§»åŠ¨åˆ°æœ«å°¾ p1 p2 s -> 1 -> 2 -> 3 -> 4 -> 5 -> null p1 p2 s -> 1 -> 2 -> 3 -> 4 -> 5 -> null ä»£ç ï¼š public static ListNode removeNthFromEnd(ListNode head, int n) &#123; ListNode s = new ListNode(-1, head); ListNode p1 = s; ListNode p2 = s; for (int i = 0; i &lt; n + 1; i++) &#123; p2 = p2.next; &#125; while (p2 != null) &#123; p1 = p1.next; p2 = p2.next; &#125; p1.next = p1.next.next; return s.next; &#125; è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œä½¿ç”¨äº†ä¸¤ä¸ªæŒ‡é’ˆp1å’Œp2æ¥å®šä½è¦åˆ é™¤çš„èŠ‚ç‚¹ã€‚é¦–å…ˆï¼Œp2æŒ‡é’ˆå…ˆå‘åç§»åŠ¨n+1æ­¥ï¼Œä½¿å¾—p1å’Œp2ä¹‹é—´çš„è·ç¦»ä¸ºn+1ã€‚ç„¶åï¼ŒåŒæ—¶ç§»åŠ¨p1å’Œp2æŒ‡é’ˆï¼Œç›´åˆ°p2æŒ‡é’ˆåˆ°è¾¾é“¾è¡¨æœ«å°¾ã€‚è¿™æ ·ï¼Œp1æŒ‡é’ˆå°±æŒ‡å‘äº†è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚ æ¥ä¸‹æ¥ï¼Œå°†p1çš„nextæŒ‡é’ˆæŒ‡å‘è¦åˆ é™¤èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå³å®Œæˆäº†åˆ é™¤æ“ä½œã€‚æœ€åï¼Œè¿”å›å¤´èŠ‚ç‚¹çš„nextæŒ‡é’ˆï¼Œå³ä¸ºåˆ é™¤èŠ‚ç‚¹åçš„é“¾è¡¨ã€‚ ç”±äºp2æŒ‡é’ˆå…ˆå‘åç§»åŠ¨äº†n+1æ­¥ï¼Œæ‰€ä»¥p1æŒ‡é’ˆå’Œp2æŒ‡é’ˆä¹‹é—´çš„è·ç¦»ä¸ºn+1ã€‚å› æ­¤ï¼Œå½“p2æŒ‡é’ˆåˆ°è¾¾é“¾è¡¨æœ«å°¾æ—¶ï¼Œp1æŒ‡é’ˆæ­£å¥½æŒ‡å‘è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚è¿™æ ·ï¼Œé€šè¿‡ç§»åŠ¨p1æŒ‡é’ˆçš„nextæŒ‡é’ˆï¼Œå°±å¯ä»¥åˆ é™¤è¦åˆ é™¤çš„èŠ‚ç‚¹ã€‚ E04. æœ‰åºé“¾è¡¨å»é‡-åŠ›æ‰£ 83 é¢˜ä¾‹å¦‚ è¾“å…¥ï¼šhead &#x3D; [1,1,2] è¾“å‡ºï¼š[1,2] è¾“å…¥ï¼šhead &#x3D; [1,1,2,3,3] è¾“å‡ºï¼š[1,2,3] æ³¨æ„ï¼šé‡å¤å…ƒç´ ä¿ç•™ä¸€ä¸ª E05. æœ‰åºé“¾è¡¨å»é‡-åŠ›æ‰£ 82 é¢˜ä¾‹å¦‚ è¾“å…¥ï¼šhead &#x3D; [1,2,3,3,4,4,5] è¾“å‡ºï¼š[1,2,5] è¾“å…¥ï¼šhead &#x3D; [1,1,1,2,3] è¾“å‡ºï¼š[2,3] æ³¨æ„ï¼šé‡å¤å…ƒç´ ä¸€ä¸ªä¸ç•™ E06. åˆå¹¶æœ‰åºé“¾è¡¨-åŠ›æ‰£ 21 é¢˜ä¾‹ è¾“å…¥ï¼šl1 &#x3D; [1,2,4], l2 &#x3D; [1,3,4] è¾“å‡ºï¼š[1,1,2,3,4,4] è¾“å…¥ï¼šl1 &#x3D; [], l2 &#x3D; [] è¾“å‡ºï¼š[] è¾“å…¥ï¼šl1 &#x3D; [], l2 &#x3D; [0] è¾“å‡ºï¼š[0] E07. åˆå¹¶å¤šä¸ªæœ‰åºé“¾è¡¨-åŠ›æ‰£ 23 é¢˜ä¾‹ è¾“å…¥ï¼šlists &#x3D; [[1,4,5],[1,3,4],[2,6]] è¾“å‡ºï¼š[1,1,2,3,4,4,5,6] è§£é‡Šï¼šé“¾è¡¨æ•°ç»„å¦‚ä¸‹ï¼š [ 1-&gt;4-&gt;5, 1-&gt;3-&gt;4, 2-&gt;6 ] å°†å®ƒä»¬åˆå¹¶åˆ°ä¸€ä¸ªæœ‰åºé“¾è¡¨ä¸­å¾—åˆ°ã€‚ 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4-&gt;5-&gt;6 E08. æŸ¥æ‰¾é“¾è¡¨ä¸­é—´èŠ‚ç‚¹-åŠ›æ‰£ 876 é¢˜ä¾‹å¦‚ è¾“å…¥ï¼š[1,2,3,4,5] è¾“å‡ºï¼šæ­¤åˆ—è¡¨ä¸­çš„ç»“ç‚¹ 3 (åºåˆ—åŒ–å½¢å¼ï¼š[3,4,5]) è¾“å…¥ï¼š[1,2,3,4,5,6] è¾“å‡ºï¼šæ­¤åˆ—è¡¨ä¸­çš„ç»“ç‚¹ 4 (åºåˆ—åŒ–å½¢å¼ï¼š[4,5,6]) å¶æ•°èŠ‚ç‚¹æ—¶ï¼Œä¸­é—´ç‚¹æ˜¯é å³çš„é‚£ä¸ª æ•°ç»„E01. åˆå¹¶æœ‰åºæ•°ç»„å°†æ•°ç»„å†…ä¸¤ä¸ªåŒºé—´å†…çš„æœ‰åºå…ƒç´ åˆå¹¶ ä¾‹ [1, 5, 6, 2, 4, 10, 11] å¯ä»¥è§†ä½œä¸¤ä¸ªæœ‰åºåŒºé—´ [1, 5, 6] å’Œ [2, 4, 10, 11] åˆå¹¶åï¼Œç»“æœä»å­˜å‚¨äºåŸæœ‰ç©ºé—´ [1, 2, 4, 5, 6, 10, 11] é˜Ÿåˆ—æ ˆåŒç«¯é˜Ÿåˆ—ä¼˜å…ˆçº§é˜Ÿåˆ—å †äºŒå‰æ ‘","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://blog.ehzyil.xyz/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"Leetcode","slug":"Leetcode","permalink":"https://blog.ehzyil.xyz/tags/Leetcode/"},{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://blog.ehzyil.xyz/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"author":"ehzyil"},{"title":"äºŒåˆ†æŸ¥æ‰¾","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•/äºŒåˆ†æŸ¥æ‰¾","date":"2023-10-11T00:00:00.000Z","updated":"2024-01-30T06:30:58.151Z","comments":true,"path":"2023/10/11/æ•°æ®ç»“æ„ä¸ç®—æ³•/äºŒåˆ†æŸ¥æ‰¾/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/11/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/","excerpt":"","text":"äºŒåˆ†æŸ¥æ‰¾åŸºç¡€ç‰ˆï¼ˆå·¦é—­å³é—­å‹ï¼‰éœ€æ±‚ï¼šåœ¨æœ‰åºæ•°ç»„ $A$ å†…ï¼ŒæŸ¥æ‰¾å€¼ $target$ å¦‚æœæ‰¾åˆ°è¿”å›ç´¢å¼• å¦‚æœæ‰¾ä¸åˆ°è¿”å› $-1$ ç®—æ³•æè¿° å‰æ ç»™å®šä¸€ä¸ªå†…å« $n$ ä¸ªå…ƒç´ çš„æœ‰åºæ•°ç»„ $A$ï¼Œæ»¡è¶³ $A_{0}\\leq A_{1}\\leq A_{2}\\leq \\cdots \\leq A_{n-1}$ï¼Œä¸€ä¸ªå¾…æŸ¥å€¼ $target$ 1 è®¾ç½® $i&#x3D;0$(left)ï¼Œ$j&#x3D;n-1$(right) 2 å¦‚æœ $i \\gt j$ï¼Œç»“æŸæŸ¥æ‰¾ï¼Œæ²¡æ‰¾åˆ° 3 è®¾ç½® $m &#x3D; floor(\\frac {i+j}{2})$ ï¼Œ$m$ ä¸ºä¸­é—´ç´¢å¼•ï¼Œ$floor$ æ˜¯å‘ä¸‹å–æ•´ï¼ˆ$\\leq \\frac {i+j}{2}$ çš„æœ€å°æ•´æ•°ï¼‰ 4 å¦‚æœ $target &lt; A_{m}$ è®¾ç½® $j &#x3D; m - 1$ï¼Œè·³åˆ°ç¬¬2æ­¥ 5 å¦‚æœ $A_{m} &lt; target$ è®¾ç½® $i &#x3D; m + 1$ï¼Œè·³åˆ°ç¬¬2æ­¥ 6 å¦‚æœ $A_{m} &#x3D; target$ï¼Œç»“æŸæŸ¥æ‰¾ï¼Œæ‰¾åˆ°äº† java å®ç° public static int binarySearch(int[] a, int target) &#123; int i = 0, j = a.length - 1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; // åœ¨å·¦è¾¹ j = m - 1; &#125; else if (a[m] &lt; target) &#123; // åœ¨å³è¾¹ i = m + 1; &#125; else &#123; return m; &#125; &#125; return -1; &#125; $i,j$ å¯¹åº”ç€æœç´¢åŒºé—´ $[0,a.length-1]$ï¼ˆæ³¨æ„æ˜¯é—­åˆçš„åŒºé—´ï¼‰ï¼Œ$i&lt;&#x3D;j$ æ„å‘³ç€æœç´¢åŒºé—´å†…è¿˜æœ‰æœªæ¯”è¾ƒçš„å…ƒç´ ï¼Œ$i,j$ æŒ‡å‘çš„å…ƒç´ ä¹Ÿå¯èƒ½æ˜¯æ¯”è¾ƒçš„ç›®æ ‡ æ€è€ƒï¼šå¦‚æœä¸åŠ  $i&#x3D;j$ è¡Œä¸è¡Œï¼Ÿ å›ç­”ï¼šä¸è¡Œï¼Œå› ä¸ºè¿™æ„å‘³ç€ $i,j$ æŒ‡å‘çš„å…ƒç´ ä¼šæ¼è¿‡æ¯”è¾ƒ $m$ å¯¹åº”ç€ä¸­é—´ä½ç½®ï¼Œä¸­é—´ä½ç½®å·¦è¾¹å’Œå³è¾¹çš„å…ƒç´ å¯èƒ½ä¸ç›¸ç­‰ï¼ˆå·®ä¸€ä¸ªï¼‰ï¼Œä¸ä¼šå½±å“ç»“æœ å¦‚æœæŸæ¬¡æœªæ‰¾åˆ°ï¼Œé‚£ä¹ˆç¼©å°åçš„åŒºé—´å†…ä¸åŒ…å« $m$ äºŒåˆ†æŸ¥æ‰¾æ”¹å˜ç‰ˆï¼ˆå·¦é—­å³å¼€ï¼‰å¦ä¸€ç§å†™æ³• public static int binarySearch(int[] a, int target) &#123; int i = 0, j = a.length; while (i &lt; j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; // åœ¨å·¦è¾¹ j = m; &#125; else if (a[m] &lt; target) &#123; // åœ¨å³è¾¹ i = m + 1; &#125; else &#123; return m; &#125; &#125; return -1; &#125; $i,j$ å¯¹åº”ç€æœç´¢åŒºé—´ $[0,a.length)$ï¼ˆæ³¨æ„æ˜¯å·¦é—­å³å¼€çš„åŒºé—´ï¼‰ï¼Œ$i&lt;j$ æ„å‘³ç€æœç´¢åŒºé—´å†…è¿˜æœ‰æœªæ¯”è¾ƒçš„å…ƒç´ ï¼Œ$j$ æŒ‡å‘çš„ä¸€å®šä¸æ˜¯æŸ¥æ‰¾ç›®æ ‡ æ€è€ƒï¼šä¸ºå•¥è¿™æ¬¡ä¸åŠ  $i&#x3D;j$ çš„æ¡ä»¶äº†ï¼Ÿ å›ç­”ï¼šè¿™å› $j$ æŒ‡å‘çš„ä¸æ˜¯æŸ¥æ‰¾ç›®æ ‡ï¼Œå¦‚æœè¿˜åŠ  $i&#x3D;j$ æ¡ä»¶ï¼Œå°±æ„å‘³ç€ $j$ æŒ‡å‘çš„è¿˜ä¼šå†æ¬¡æ¯”è¾ƒï¼Œæ‰¾ä¸åˆ°æ—¶ï¼Œä¼šæ­»å¾ªç¯ å¦‚æœæŸæ¬¡è¦ç¼©å°å³è¾¹ç•Œï¼Œé‚£ä¹ˆ $j&#x3D;m$ï¼Œå› ä¸ºæ­¤æ—¶çš„ $m$ å·²ç»ä¸æ˜¯æŸ¥æ‰¾ç›®æ ‡äº† è‹¥åªæ·»åŠ  $i&#x3D;j$ çš„æ¡ä»¶ä½†ä¸ºä¿®æ”¹ j = m - 1; -&gt; j = m;è¿è¡Œä»¥ä¸‹ä»£ç æ—¶: int search = Solution.binarySearch(new int[]&#123;-1, 0, 3, 5, 9, -1&#125;, 3);//searchä¸º-1 //ç¬¬ä¸€è½®å¾ªç¯ public static int binarySearch(int[] a, int target) &#123; int i = 0, j = a.length; while (i &lt; j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; // åœ¨å·¦è¾¹ j = m - 1; &#125; else if (a[m] &lt; target) &#123; // åœ¨å³è¾¹ i = m + 1; &#125; else &#123; return m; &#125; &#125; return -1; &#125; å¾ªç¯æ¬¡æ•° i j mid target a[m] æ“ä½œ 1 0 6 3 3 0 target &lt; a[m] 1 0 6 3 3 0 target &lt; a[m] 2 0 2 1 3 5 a[m] &lt; target 3 2 2 2 ä¸æ»¡è¶³i &lt; jè¿”å›-1 äºŒåˆ†æŸ¥æ‰¾æ€§èƒ½ä¸‹é¢åˆ†æäºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„æ€§èƒ½ æ—¶é—´å¤æ‚åº¦ æœ€åæƒ…å†µï¼š$O(\\log n)$ æœ€å¥½æƒ…å†µï¼šå¦‚æœå¾…æŸ¥æ‰¾å…ƒç´ æ°å¥½åœ¨æ•°ç»„ä¸­å¤®ï¼Œåªéœ€è¦å¾ªç¯ä¸€æ¬¡ $O(1)$ ç©ºé—´å¤æ‚åº¦ éœ€è¦å¸¸æ•°ä¸ªæŒ‡é’ˆ $i,j,m$ï¼Œå› æ­¤é¢å¤–å ç”¨çš„ç©ºé—´æ˜¯ $O(1)$ äºŒåˆ†æŸ¥æ‰¾å¹³è¡¡ç‰ˆpublic static int binarySearchBalance(int[] a, int target) &#123; int i = 0, j = a.length; //1 &lt; j - i ==> i &lt; j - 1 // å³å½“iä¸ªjä¹‹é—´æœ‰1ä¸ªä»¥ä¸Šå…ƒç´ æ—¶æ»¡è¶³æ¡ä»¶ // å¦åˆ™è·³å‡ºå¾ªç¯ æ­¤æ—¶åªå‰©ä¸‹ä¸€ä¸ªå…ƒç´  while (1 &lt; j - i) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; // right j = m; &#125; else if (a[m] &lt; target) &#123; // left i = m; &#125; else &#123; return m; &#125; &#125; //åˆ¤æ–­å‰©ä¸‹çš„é‚£ä¸ªå…ƒç´ æ˜¯å¦æ˜¯æŸ¥è¯¢å…ƒç´  ä¸æ˜¯åˆ™è¿”å› -1 return a[i] == target ? i : -1; &#125; ä¸Šè¿°ä»£ç ä¸­å¯ä»¥ä¼˜åŒ–çš„æ˜¯å°†ç›®æ ‡å…ƒç´ å°äºä¸­é—´å…ƒç´ çš„æƒ…å†µå’Œç›®æ ‡å…ƒç´ å¤§äºä¸­é—´å…ƒç´ çš„æƒ…å†µåˆå¹¶ä¸ºä¸€ä¸ªæ¡ä»¶ã€‚åœ¨é™¤äº†ç›®æ ‡å…ƒç´ å°äºä¸­é—´å…ƒç´ çš„æƒ…å†µå¤–ï¼Œéƒ½å°†iæ›´æ–°ä¸ºmã€‚ æ€è·¯æ˜¯ï¼Œå¦‚æœç›®æ ‡å…ƒç´ ä¸å°äºä¸­é—´å…ƒç´ ï¼Œé‚£ä¹ˆå®ƒè¦ä¹ˆç­‰äºä¸­é—´å…ƒç´ ï¼Œè¦ä¹ˆå¤§äºä¸­é—´å…ƒç´ ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæ›´æ–°iä¸ºmä»ç„¶å¯ä»¥ä¿æŒç›®æ ‡å…ƒç´ åœ¨æœç´¢èŒƒå›´å†…ã€‚ä¼˜åŒ–åï¼š public static int binarySearchBalance(int[] a, int target) &#123; int i = 0, j = a.length; while (1 &lt; j - i) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m; &#125; else &#123; i = m; &#125; &#125; return (a[i] == target) ? i : -1; &#125; æ€æƒ³ï¼š å·¦é—­å³å¼€çš„åŒºé—´ï¼Œ$i$ æŒ‡å‘çš„å¯èƒ½æ˜¯ç›®æ ‡ï¼Œè€Œ $j$ æŒ‡å‘çš„ä¸æ˜¯ç›®æ ‡ ä¸å¥¢æœ›å¾ªç¯å†…é€šè¿‡ $m$ æ‰¾å‡ºç›®æ ‡, ç¼©å°åŒºé—´ç›´è‡³å‰© 1 ä¸ª, å‰©ä¸‹çš„è¿™ä¸ªå¯èƒ½å°±æ˜¯è¦æ‰¾çš„ï¼ˆé€šè¿‡ $i$ï¼‰ $j - i &gt; 1$ çš„å«ä¹‰æ˜¯ï¼Œåœ¨èŒƒå›´å†…å¾…æ¯”è¾ƒçš„å…ƒç´ ä¸ªæ•° &gt; 1 æ”¹å˜ $i$ è¾¹ç•Œæ—¶ï¼Œå®ƒæŒ‡å‘çš„å¯èƒ½æ˜¯ç›®æ ‡ï¼Œå› æ­¤ä¸èƒ½ $m+1$ å¾ªç¯å†…çš„å¹³å‡æ¯”è¾ƒæ¬¡æ•°å‡å°‘äº† æ—¶é—´å¤æ‚åº¦ $\\Theta(log(n))$ äºŒåˆ†æŸ¥æ‰¾ Java ç‰ˆprivate static int binarySearch0(int[] a, int fromIndex, int toIndex, int key) &#123; int low = fromIndex; int high = toIndex - 1; while (low &lt;= high) &#123; int mid = (low + high) >>> 1; int midVal = a[mid]; if (midVal &lt; key) low = mid + 1; else if (midVal > key) high = mid - 1; else return mid; // key found &#125; return -(low + 1); // key not found. &#125; ä¾‹å¦‚ $[1,3,5,6]$ è¦æ’å…¥ $2$ é‚£ä¹ˆå°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªä½ç½®ï¼Œè¿™ä¸ªä½ç½®å·¦ä¾§å…ƒç´ éƒ½æ¯”å®ƒå° ç­‰å¾ªç¯ç»“æŸï¼Œè‹¥æ²¡æ‰¾åˆ°ï¼Œlow å·¦ä¾§å…ƒç´ è‚¯å®šéƒ½æ¯” target å°ï¼Œå› æ­¤ low å³æ’å…¥ç‚¹ æ’å…¥ç‚¹å–è´Ÿæ˜¯ä¸ºäº†ä¸æ‰¾åˆ°æƒ…å†µåŒºåˆ† -1 æ˜¯ä¸ºäº†æŠŠç´¢å¼• 0 ä½ç½®çš„æ’å…¥ç‚¹ä¸æ‰¾åˆ°çš„æƒ…å†µè¿›è¡ŒåŒºåˆ† è‹¥æœªæ‰¾åˆ° å¯ä»¥è·å–æ’å…¥å…ƒç´ çš„ä½ç½®(ä¸æ˜¯ç´¢å¼•)å³ä¸º-result+1 Leftmost ä¸ Rightmostæœ‰æ—¶æˆ‘ä»¬å¸Œæœ›è¿”å›çš„æ˜¯æœ€å·¦ä¾§çš„é‡å¤å…ƒç´ ï¼Œå¦‚æœç”¨ Basic äºŒåˆ†æŸ¥æ‰¾ å¯¹äºæ•°ç»„ $[1, 2, 3, 4, 4, 5, 6, 7]$ï¼ŒæŸ¥æ‰¾å…ƒç´ 4ï¼Œç»“æœæ˜¯ç´¢å¼•3 å¯¹äºæ•°ç»„ $[1, 2, 4, 4, 4, 5, 6, 7]$ï¼ŒæŸ¥æ‰¾å…ƒç´ 4ï¼Œç»“æœä¹Ÿæ˜¯ç´¢å¼•3ï¼Œå¹¶ä¸æ˜¯æœ€å·¦ä¾§çš„å…ƒç´  public static int binarySearchLeftmost1(int[] a, int target) &#123; int i = 0, j = a.length - 1; int candidate = -1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m - 1; &#125; else if (a[m] &lt; target) &#123; i = m + 1; &#125; else &#123; candidate = m; // è®°å½•å€™é€‰ä½ç½® j = m - 1; // ç»§ç»­å‘å·¦ &#125; &#125; return candidate; &#125; å¦‚æœå¸Œæœ›è¿”å›çš„æ˜¯æœ€å³ä¾§å…ƒç´  public static int binarySearchRightmost1(int[] a, int target) &#123; int i = 0, j = a.length - 1; int candidate = -1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m - 1; &#125; else if (a[m] &lt; target) &#123; i = m + 1; &#125; else &#123; candidate = m; // è®°å½•å€™é€‰ä½ç½® i = m + 1; // ç»§ç»­å‘å³ &#125; &#125; return candidate; &#125; åº”ç”¨ å¯¹äº Leftmost ä¸ Rightmostï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªæ¯” -1 æ›´æœ‰ç”¨çš„å€¼ Leftmost æ”¹ä¸º public static int binarySearchLeftmost(int[] a, int target) &#123; int i = 0, j = a.length - 1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt;= a[m]) &#123; j = m - 1; &#125; else &#123; i = m + 1; &#125; &#125; return i; &#125; leftmost è¿”å›å€¼çš„å¦ä¸€å±‚å«ä¹‰ï¼š$\\lt target$ çš„å…ƒç´ ä¸ªæ•° å°äºç­‰äºä¸­é—´å€¼ï¼Œéƒ½è¦å‘å·¦æ‰¾ Rightmost æ”¹ä¸º public static int binarySearchRightmost(int[] a, int target) &#123; int i = 0, j = a.length - 1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m - 1; &#125; else &#123; i = m + 1; &#125; &#125; return i - 1; &#125; å¤§äºç­‰äºä¸­é—´å€¼ï¼Œéƒ½è¦å‘å³æ‰¾ å‡ ä¸ªåè¯ èŒƒå›´æŸ¥è¯¢ï¼š æŸ¥è¯¢ $x \\lt 4$ï¼Œ$0 .. leftmost(4) - 1$ æŸ¥è¯¢ $x \\leq 4$ï¼Œ$0 .. rightmost(4)$ æŸ¥è¯¢ $4 \\lt x$ï¼Œ$rightmost(4) + 1 .. \\infty $ æŸ¥è¯¢ $4 \\leq x$ï¼Œ $leftmost(4) .. \\infty$ æŸ¥è¯¢ $4 \\leq x \\leq 7$ï¼Œ$leftmost(4) .. rightmost(7)$ æŸ¥è¯¢ $4 \\lt x \\lt 7$ï¼Œ$rightmost(4)+1 .. leftmost(7)-1$ æ±‚æ’åï¼š$leftmost(target) + 1$ $target$ å¯ä»¥ä¸å­˜åœ¨ï¼Œå¦‚ï¼š$leftmost(5)+1 &#x3D; 6$ $target$ ä¹Ÿå¯ä»¥å­˜åœ¨ï¼Œå¦‚ï¼š$leftmost(4)+1 &#x3D; 3$ æ±‚å‰ä»»ï¼ˆpredecessorï¼‰ï¼š$leftmost(target) - 1$ $leftmost(3) - 1 &#x3D; 1$ï¼Œå‰ä»» $a_1 &#x3D; 2$ $leftmost(4) - 1 &#x3D; 1$ï¼Œå‰ä»» $a_1 &#x3D; 2$ æ±‚åä»»ï¼ˆsuccessorï¼‰ï¼š$rightmost(target)+1$ $rightmost(5) + 1 &#x3D; 5$ï¼Œåä»» $a_5 &#x3D; 7$ $rightmost(4) + 1 &#x3D; 5$ï¼Œåä»» $a_5 &#x3D; 7$ æ±‚æœ€è¿‘é‚»å±…ï¼š å‰ä»»å’Œåä»»è·ç¦»æ›´è¿‘è€… å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š æŸ¥çœ‹ä»£ç  public class BinarySearch &#123; /** * &lt;h3>äºŒåˆ†æŸ¥æ‰¾åŸºç¡€ç‰ˆ&lt;/h3> * * &lt;ol> * &lt;li>i, j, m æŒ‡é’ˆéƒ½å¯èƒ½æ˜¯æŸ¥æ‰¾ç›®æ ‡&lt;/li> * &lt;li>å› ä¸º 1. i > j æ—¶è¡¨ç¤ºåŒºåŸŸå†…æ²¡æœ‰è¦æ‰¾çš„äº†&lt;/li> * &lt;li>æ¯æ¬¡æ”¹å˜ i, j è¾¹ç•Œæ—¶, m å·²ç»æ¯”è¾ƒè¿‡ä¸æ˜¯ç›®æ ‡, å› æ­¤åˆ†åˆ« m+1 m-1&lt;/li> * &lt;li>å‘å·¦æŸ¥æ‰¾, æ¯”è¾ƒæ¬¡æ•°å°‘, å‘å³æŸ¥æ‰¾, æ¯”è¾ƒæ¬¡æ•°å¤š&lt;/li> * &lt;/ol> * * @param a å¾…æŸ¥æ‰¾çš„å‡åºæ•°ç»„ * @param target å¾…æŸ¥æ‰¾çš„ç›®æ ‡å€¼ * @return &lt;p>æ‰¾åˆ°åˆ™è¿”å›ç´¢å¼•&lt;/p> * &lt;p>æ‰¾ä¸åˆ°è¿”å› -1&lt;/p> */ public static int binarySearchBasic(int[] a, int target) &#123; int i = 0, j = a.length - 1; // è®¾ç½®æŒ‡é’ˆå’Œåˆå€¼ // L æ¬¡ å…ƒç´ åœ¨æœ€å·¦è¾¹ L æ¬¡ï¼Œ å…ƒç´ åœ¨æœ€å³è¾¹ 2*L æ¬¡ while (i &lt;= j) &#123; // i~j èŒƒå›´å†…æœ‰ä¸œè¥¿ int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; // ç›®æ ‡åœ¨å·¦è¾¹ j = m - 1; &#125; else if (a[m] &lt; target) &#123; // ç›®æ ‡åœ¨å³è¾¹ i = m + 1; &#125; else &#123; // æ‰¾åˆ°äº† return m; &#125; &#125; return -1; &#125; /* 1 [2,3,4,5] 5 å³ä¾§æ²¡æ‰¾åˆ°æ›´å·® int i = 0, j = a.length - 1; 2 return -1; 1 å…ƒç´ ä¸ªæ•° å¾ªç¯æ¬¡æ•° 4-7 3 floor(log_2(4)) = 2+1 8-15 4 floor(log_2(8)) = 3+1 16-31 5 floor(log_2(16)) = 4+1 32-63 6 floor(log_2(32)) = 5+1 ... ... å¾ªç¯æ¬¡æ•°L = floor(log_2(n)) + 1 i &lt;= j L+1 int m = (i + j) >>> 1; L target &lt; a[m] L a[m] &lt; target L i = m + 1; L (floor(log_2(n)) + 1) * 5 + 4 (3) * 5 + 4 = 19*t (10 + 1) * 5 + 4 = 59*t */ /* é—®é¢˜1: ä¸ºä»€ä¹ˆæ˜¯ i&lt;=j æ„å‘³ç€åŒºé—´å†…æœ‰æœªæ¯”è¾ƒçš„å…ƒç´ , è€Œä¸æ˜¯ i&lt;j ? i==j æ„å‘³ç€ i,j å®ƒä»¬æŒ‡å‘çš„å…ƒç´ ä¹Ÿä¼šå‚ä¸æ¯”è¾ƒ i&lt;j åªæ„å‘³ç€ m æŒ‡å‘çš„å…ƒç´ å‚ä¸æ¯”è¾ƒ é—®é¢˜2: (i + j) / 2 æœ‰æ²¡æœ‰é—®é¢˜? é—®é¢˜3: éƒ½å†™æˆå°äºå·æœ‰å•¥å¥½å¤„? */ /** * &lt;h3>äºŒåˆ†æŸ¥æ‰¾æ”¹åŠ¨ç‰ˆ&lt;/h3> * * &lt;ol> * &lt;li>i, m æŒ‡é’ˆå¯èƒ½æ˜¯æŸ¥æ‰¾ç›®æ ‡&lt;/li> * &lt;li>j æŒ‡é’ˆä¸å¯èƒ½æ˜¯æŸ¥æ‰¾ç›®æ ‡&lt;/li> * &lt;li>å› ä¸º 1. 2. i >= j æ—¶è¡¨ç¤ºåŒºåŸŸå†…æ²¡æœ‰è¦æ‰¾çš„äº†&lt;/li> * &lt;li>æ”¹å˜ i è¾¹ç•Œæ—¶, m å·²ç»æ¯”è¾ƒè¿‡ä¸æ˜¯ç›®æ ‡, å› æ­¤éœ€è¦ i=m+1&lt;/li> * &lt;li>æ”¹å˜ j è¾¹ç•Œæ—¶, m å·²ç»æ¯”è¾ƒè¿‡ä¸æ˜¯ç›®æ ‡, åŒæ—¶å› ä¸º 2. æ‰€ä»¥ j=m&lt;/li> * &lt;/ol> * * @param a å¾…æŸ¥æ‰¾çš„å‡åºæ•°ç»„ * @param target å¾…æŸ¥æ‰¾çš„ç›®æ ‡å€¼ * @return &lt;p>æ‰¾åˆ°åˆ™è¿”å›ç´¢å¼•&lt;/p> * &lt;p>æ‰¾ä¸åˆ°è¿”å› -1&lt;/p> */ public static int binarySearchAlternative(int[] a, int target) &#123; int i = 0, j = a.length; // ç¬¬ä¸€å¤„ while (i &lt; j) &#123; // ç¬¬äºŒå¤„ int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m; // ç¬¬ä¸‰å¤„ &#125; else if (a[m] &lt; target) &#123; i = m + 1; &#125; else &#123; return m; &#125; &#125; return -1; &#125; /** * &lt;h3>äºŒåˆ†æŸ¥æ‰¾å¹³è¡¡ç‰ˆ&lt;/h3> * * &lt;ol> * &lt;li>ä¸å¥¢æœ›å¾ªç¯å†…é€šè¿‡ m æ‰¾å‡ºç›®æ ‡, ç¼©å°åŒºé—´ç›´è‡³å‰© 1 ä¸ª, å‰©ä¸‹çš„è¿™ä¸ªå¯èƒ½å°±æ˜¯è¦æ‰¾çš„(é€šè¿‡ i)&lt;/li> * &lt;li>i æŒ‡é’ˆå¯èƒ½æ˜¯æŸ¥æ‰¾ç›®æ ‡&lt;/li> * &lt;li>j æŒ‡é’ˆä¸å¯èƒ½æ˜¯æŸ¥æ‰¾ç›®æ ‡&lt;/li> * &lt;li>å› ä¸º 1. 2. 3. å½“åŒºåŸŸå†…è¿˜å‰©ä¸€ä¸ªå…ƒç´ æ—¶, è¡¨ç¤ºä¸º j - i == 1&lt;/li> * &lt;li>æ”¹å˜ i è¾¹ç•Œæ—¶, m å¯èƒ½å°±æ˜¯ç›®æ ‡, åŒæ—¶å› ä¸º 2. æ‰€ä»¥æœ‰ i=m&lt;/li> * &lt;li>æ”¹å˜ j è¾¹ç•Œæ—¶, m å·²ç»æ¯”è¾ƒè¿‡ä¸æ˜¯ç›®æ ‡, åŒæ—¶å› ä¸º 3. æ‰€ä»¥æœ‰ j=m&lt;/li> * &lt;li>ä¸‰åˆ†æ”¯æ”¹ä¸ºäºŒåˆ†æ”¯, å¾ªç¯å†…æ¯”è¾ƒæ¬¡æ•°å‡å°‘&lt;/li> * &lt;/ol> * * @param a å¾…æŸ¥æ‰¾çš„å‡åºæ•°ç»„ * @param target å¾…æŸ¥æ‰¾çš„ç›®æ ‡å€¼ * @return &lt;p>æ‰¾åˆ°åˆ™è¿”å›ç´¢å¼•&lt;/p> * &lt;p>æ‰¾ä¸åˆ°è¿”å› -1&lt;/p> */ public static int binarySearchBalance(int[] a, int target) &#123; int i = 0, j = a.length; while (1 &lt; j - i) &#123; // èŒƒå›´å†…å¾…æŸ¥æ‰¾çš„å…ƒç´ ä¸ªæ•° > 1 æ—¶ int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; // ç›®æ ‡åœ¨å·¦è¾¹ j = m; &#125; else &#123; // ç›®æ ‡åœ¨ m æˆ–å³è¾¹ i = m; &#125; &#125; return (target == a[i]) ? i : -1; &#125; /** * &lt;h3>äºŒåˆ†æŸ¥æ‰¾ Leftmost &lt;/h3> * * @param a å¾…æŸ¥æ‰¾çš„å‡åºæ•°ç»„ * @param target å¾…æŸ¥æ‰¾çš„ç›®æ ‡å€¼ * @return &lt;p>æ‰¾åˆ°åˆ™è¿”å›æœ€é å·¦ç´¢å¼•&lt;/p> * &lt;p>æ‰¾ä¸åˆ°è¿”å› -1&lt;/p> */ public static int binarySearchLeftmost1(int[] a, int target) &#123; int i = 0, j = a.length - 1; int candidate = -1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m - 1; &#125; else if (a[m] &lt; target) &#123; i = m + 1; &#125; else &#123; // è®°å½•å€™é€‰ä½ç½® candidate = m; j = m - 1; &#125; &#125; return candidate; &#125; /** * &lt;h3>äºŒåˆ†æŸ¥æ‰¾ Rightmost &lt;/h3> * * @param a å¾…æŸ¥æ‰¾çš„å‡åºæ•°ç»„ * @param target å¾…æŸ¥æ‰¾çš„ç›®æ ‡å€¼ * @return &lt;p>æ‰¾åˆ°åˆ™è¿”å›æœ€é å³ç´¢å¼•&lt;/p> * &lt;p>æ‰¾ä¸åˆ°è¿”å› -1&lt;/p> */ public static int binarySearchRightmost1(int[] a, int target) &#123; int i = 0, j = a.length - 1; int candidate = -1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m - 1; &#125; else if (a[m] &lt; target) &#123; i = m + 1; &#125; else &#123; candidate = m; i = m + 1; &#125; &#125; return candidate; &#125; /** * &lt;h3>äºŒåˆ†æŸ¥æ‰¾ Leftmost &lt;/h3> * * @param a å¾…æŸ¥æ‰¾çš„å‡åºæ•°ç»„ * @param target å¾…æŸ¥æ‰¾çš„ç›®æ ‡å€¼ * @return &lt;p>è¿”å› &amp;ge; target çš„æœ€é å·¦ç´¢å¼•&lt;/p> */ public static int binarySearchLeftmost2(int[] a, int target) &#123; int i = 0, j = a.length - 1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt;= a[m]) &#123; j = m - 1; &#125; else &#123; i = m + 1; &#125; &#125; return i; &#125; /** * &lt;h3>äºŒåˆ†æŸ¥æ‰¾ Rightmost &lt;/h3> * * @param a å¾…æŸ¥æ‰¾çš„å‡åºæ•°ç»„ * @param target å¾…æŸ¥æ‰¾çš„ç›®æ ‡å€¼ * @return &lt;p>è¿”å› &amp;le; target çš„æœ€é å³ç´¢å¼•&lt;/p> */ public static int binarySearchRightmost2(int[] a, int target) &#123; int i = 0, j = a.length - 1; while (i &lt;= j) &#123; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; j = m - 1; &#125; else &#123; i = m + 1; &#125; &#125; return i - 1; &#125; é»‘é©¬ç¨‹åºå‘˜Javaé«˜çº§ç¨‹åºå‘˜å¿…å­¦çš„æ•°æ®ç»“æ„ä¸ç®—æ³•","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://blog.ehzyil.xyz/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://blog.ehzyil.xyz/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"author":"ehzyil"},{"title":"åŸºç¡€æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•/åŸºç¡€æ•°æ®ç»“æ„","date":"2023-10-11T00:00:00.000Z","updated":"2024-01-30T06:30:58.155Z","comments":true,"path":"2023/10/11/æ•°æ®ç»“æ„ä¸ç®—æ³•/åŸºç¡€æ•°æ®ç»“æ„/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/11/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/","excerpt":"","text":"åŸºç¡€æ•°æ®ç»“æ„ æ•°ç»„æ¦‚è¿°å®šä¹‰ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæ•°ç»„æ˜¯ç”±ä¸€ç»„å…ƒç´ ï¼ˆå€¼æˆ–å˜é‡ï¼‰ç»„æˆçš„æ•°æ®ç»“æ„ï¼Œæ¯ä¸ªå…ƒç´ æœ‰è‡³å°‘ä¸€ä¸ªç´¢å¼•æˆ–é”®æ¥æ ‡è¯† In computer science, an array is a data structure consisting of a collection of elements (values or variables), each identified by at least one array index or key å› ä¸ºæ•°ç»„å†…çš„å…ƒç´ æ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œæ‰€ä»¥æ•°ç»„ä¸­å…ƒç´ çš„åœ°å€ï¼Œå¯ä»¥é€šè¿‡å…¶ç´¢å¼•è®¡ç®—å‡ºæ¥ï¼Œä¾‹å¦‚ï¼š int[] array = &#123;1,2,3,4,5&#125; çŸ¥é“äº†æ•°ç»„çš„æ•°æ®èµ·å§‹åœ°å€ $BaseAddress$ï¼Œå°±å¯ä»¥ç”±å…¬å¼ $BaseAddress + i * size$ è®¡ç®—å‡ºç´¢å¼• $i$ å…ƒç´ çš„åœ°å€ $i$ å³ç´¢å¼•ï¼Œåœ¨ Javaã€C ç­‰è¯­è¨€éƒ½æ˜¯ä» 0 å¼€å§‹ $size$ æ˜¯æ¯ä¸ªå…ƒç´ å ç”¨å­—èŠ‚ï¼Œä¾‹å¦‚ $int$ å  $4$ï¼Œ$double$ å  $8$ å°æµ‹è¯• byte[] array = &#123;1,2,3,4,5&#125; å·²çŸ¥ array çš„æ•°æ®çš„èµ·å§‹åœ°å€æ˜¯ 0x7138f94c8ï¼Œé‚£ä¹ˆå…ƒç´  3 çš„åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ ç­”ï¼š å…ƒç´ 3çš„åœ°å€å¯ä»¥é€šè¿‡æ•°ç»„çš„èµ·å§‹åœ°å€åŠ ä¸Šå…ƒç´ 3çš„ç´¢å¼•ä¹˜ä»¥å…ƒç´ çš„å¤§å°æ¥è®¡ç®—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…ƒç´ 3çš„ç´¢å¼•æ˜¯2ï¼ˆæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼‰ï¼Œå…ƒç´ çš„å¤§å°æ˜¯1å­—èŠ‚ï¼ˆbyteç±»å‹çš„å¤§å°ä¸º1å­—èŠ‚ï¼‰ã€‚ 0x7138f94c8 + 2 * 1 &#x3D; 0x7138f94ca ç©ºé—´å ç”¨ Java ä¸­æ•°ç»„ç»“æ„ä¸º 8 å­—èŠ‚ markword 4 å­—èŠ‚ class æŒ‡é’ˆï¼ˆå‹ç¼© class æŒ‡é’ˆçš„æƒ…å†µï¼‰ 4 å­—èŠ‚ æ•°ç»„å¤§å°ï¼ˆå†³å®šäº†æ•°ç»„æœ€å¤§å®¹é‡æ˜¯ $2^{32}$ï¼‰ æ•°ç»„å…ƒç´  + å¯¹é½å­—èŠ‚ï¼ˆjava ä¸­æ‰€æœ‰å¯¹è±¡å¤§å°éƒ½æ˜¯ 8 å­—èŠ‚çš„æ•´æ•°å€[^12]ï¼Œä¸è¶³çš„è¦ç”¨å¯¹é½å­—èŠ‚è¡¥è¶³ï¼‰ ä¾‹å¦‚ int[] array = &#123;1, 2, 3, 4, 5&#125;; çš„å¤§å°ä¸º 40 ä¸ªå­—èŠ‚ï¼Œç»„æˆå¦‚ä¸‹ 8 + 4 + 4 + 5*4 + 4(alignment) éšæœºè®¿é—®æ€§èƒ½ å³æ ¹æ®ç´¢å¼•æŸ¥æ‰¾å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ åŠ¨æ€æ•°ç»„java ç‰ˆæœ¬ public class DynamicArray implements Iterable&lt;Integer> &#123; private int size = 0; // é€»è¾‘å¤§å° private int capacity = 8; // å®¹é‡ private int[] array = &#123;&#125;; /** * å‘æœ€åä½ç½® [size] æ·»åŠ å…ƒç´  * * @param element å¾…æ·»åŠ å…ƒç´  */ public void addLast(int element) &#123; add(size, element); &#125; /** * å‘ [0 .. size] ä½ç½®æ·»åŠ å…ƒç´  * * @param index ç´¢å¼•ä½ç½® * @param element å¾…æ·»åŠ å…ƒç´  */ public void add(int index, int element) &#123; checkAndGrow(); // æ·»åŠ é€»è¾‘ if (index >= 0 &amp;&amp; index &lt; size) &#123; // å‘åæŒªåŠ¨, ç©ºå‡ºå¾…æ’å…¥ä½ç½® System.arraycopy(array, index, array, index + 1, size - index); &#125; array[index] = element; size++; &#125; private void checkAndGrow() &#123; // å®¹é‡æ£€æŸ¥ if (size == 0) &#123; array = new int[capacity]; &#125; else if (size == capacity) &#123; // è¿›è¡Œæ‰©å®¹, 1.5 1.618 2 capacity += capacity >> 1; int[] newArray = new int[capacity]; System.arraycopy(array, 0, newArray, 0, size); array = newArray; &#125; &#125; /** * ä» [0 .. size) èŒƒå›´åˆ é™¤å…ƒç´  * * @param index ç´¢å¼•ä½ç½® * @return è¢«åˆ é™¤å…ƒç´  */ public int remove(int index) &#123; // [0..size) int removed = array[index]; if (index &lt; size - 1) &#123; // å‘å‰æŒªåŠ¨ System.arraycopy(array, index + 1, array, index, size - index - 1); &#125; size--; return removed; &#125; /** * æŸ¥è¯¢å…ƒç´  * * @param index ç´¢å¼•ä½ç½®, åœ¨ [0..size) åŒºé—´å†… * @return è¯¥ç´¢å¼•ä½ç½®çš„å…ƒç´  */ public int get(int index) &#123; return array[index]; &#125; /** * éå†æ–¹æ³•1 * * @param consumer éå†è¦æ‰§è¡Œçš„æ“ä½œ, å…¥å‚: æ¯ä¸ªå…ƒç´  */ public void foreach(Consumer&lt;Integer> consumer) &#123; for (int i = 0; i &lt; size; i++) &#123; // æä¾› array[i] // è¿”å› void consumer.accept(array[i]); &#125; &#125; /** * éå†æ–¹æ³•2 - è¿­ä»£å™¨éå† */ @Override public Iterator&lt;Integer> iterator() &#123; return new Iterator&lt;Integer>() &#123; int i = 0; @Override public boolean hasNext() &#123; // æœ‰æ²¡æœ‰ä¸‹ä¸€ä¸ªå…ƒç´  return i &lt; size; &#125; @Override public Integer next() &#123; // è¿”å›å½“å‰å…ƒç´ ,å¹¶ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´  return array[i++]; &#125; &#125;; &#125; /** * éå†æ–¹æ³•3 - stream éå† * * @return stream æµ */ public IntStream stream() &#123; return IntStream.of(Arrays.copyOfRange(array, 0, size)); &#125; &#125; è¿™äº›æ–¹æ³•å®ç°ï¼Œéƒ½ç®€åŒ–äº† index çš„æœ‰æ•ˆæ€§åˆ¤æ–­ï¼Œå‡è®¾è¾“å…¥çš„ index éƒ½æ˜¯åˆæ³•çš„ æ’å…¥æˆ–åˆ é™¤æ€§èƒ½ å¤´éƒ¨ä½ç½®ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ ä¸­é—´ä½ç½®ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$ å°¾éƒ¨ä½ç½®ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼ˆå‡æ‘Šæ¥è¯´ï¼‰ äºŒç»´æ•°ç»„int[][] array = &#123; &#123;11, 12, 13, 14, 15&#125;, &#123;21, 22, 23, 24, 25&#125;, &#123;31, 32, 33, 34, 35&#125;, &#125;; å†…å­˜å›¾å¦‚ä¸‹ äºŒç»´æ•°ç»„å  32 ä¸ªå­—èŠ‚ï¼Œå…¶ä¸­ array[0]ï¼Œarray[1]ï¼Œarray[2] ä¸‰ä¸ªå…ƒç´ åˆ†åˆ«ä¿å­˜äº†æŒ‡å‘ä¸‰ä¸ªä¸€ç»´æ•°ç»„çš„å¼•ç”¨ ä¸‰ä¸ªä¸€ç»´æ•°ç»„å„å  40 ä¸ªå­—èŠ‚ å®ƒä»¬åœ¨å†…å±‚å¸ƒå±€ä¸Šæ˜¯è¿ç»­çš„ æ›´ä¸€èˆ¬çš„ï¼Œå¯¹ä¸€ä¸ªäºŒç»´æ•°ç»„ $Array[m][n]$ $m$ æ˜¯å¤–å±‚æ•°ç»„çš„é•¿åº¦ï¼Œå¯ä»¥çœ‹ä½œ row è¡Œ $n$ æ˜¯å†…å±‚æ•°ç»„çš„é•¿åº¦ï¼Œå¯ä»¥çœ‹ä½œ column åˆ— å½“è®¿é—® $Array[i][j]$ï¼Œ$0\\leq i \\lt m, 0\\leq j \\lt n$æ—¶ï¼Œå°±ç›¸å½“äº å…ˆæ‰¾åˆ°ç¬¬ $i$ ä¸ªå†…å±‚æ•°ç»„ï¼ˆè¡Œï¼‰ å†æ‰¾åˆ°æ­¤å†…å±‚æ•°ç»„ä¸­ç¬¬ $j$ ä¸ªå…ƒç´ ï¼ˆåˆ—ï¼‰ å°æµ‹è¯• Java ç¯å¢ƒä¸‹ï¼ˆä¸è€ƒè™‘ç±»æŒ‡é’ˆå’Œå¼•ç”¨å‹ç¼©ï¼Œæ­¤ä¸ºé»˜è®¤æƒ…å†µï¼‰ï¼Œæœ‰ä¸‹é¢çš„äºŒç»´æ•°ç»„ byte[][] array = &#123; &#123;11, 12, 13, 14, 15&#125;, &#123;21, 22, 23, 24, 25&#125;, &#123;31, 32, 33, 34, 35&#125;, &#125;; å·²çŸ¥ array å¯¹è±¡èµ·å§‹åœ°å€æ˜¯ 0x1000ï¼Œé‚£ä¹ˆ 23 è¿™ä¸ªå…ƒç´ çš„åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¸å¤ªç†è§£å¯¹é½å­—èŠ‚ï¼ï¼ï¼ï¼‰ ç­”ï¼š èµ·å§‹åœ°å€ 0x1000 å¤–å±‚æ•°ç»„å¤§å°ï¼š16å­—èŠ‚å¯¹è±¡å¤´ + 3å…ƒç´  * æ¯ä¸ªå¼•ç”¨4å­—èŠ‚ + 4 å¯¹é½å­—èŠ‚ &#x3D; 32 &#x3D; 0x20 ç¬¬ä¸€ä¸ªå†…å±‚æ•°ç»„å¤§å°ï¼š16å­—èŠ‚å¯¹è±¡å¤´ + 5å…ƒç´  * æ¯ä¸ªbyte1å­—èŠ‚ + 3 å¯¹é½å­—èŠ‚ &#x3D; 24 &#x3D; 0x18 ç¬¬äºŒä¸ªå†…å±‚æ•°ç»„ï¼Œ16å­—èŠ‚å¯¹è±¡å¤´ &#x3D; 0x10ï¼Œå¾…æŸ¥æ‰¾å…ƒç´ ç´¢å¼•ä¸º 2 æœ€åç»“æœ &#x3D; 0x1000 + 0x20 + 0x18 + 0x10 + 2*1 &#x3D; 0x104a å±€éƒ¨æ€§åŸç†è¿™é‡Œåªè®¨è®ºç©ºé—´å±€éƒ¨æ€§ cpu è¯»å–å†…å­˜ï¼ˆé€Ÿåº¦æ…¢ï¼‰æ•°æ®åï¼Œä¼šå°†å…¶æ”¾å…¥é«˜é€Ÿç¼“å­˜ï¼ˆé€Ÿåº¦å¿«ï¼‰å½“ä¸­ï¼Œå¦‚æœåæ¥çš„è®¡ç®—å†ç”¨åˆ°æ­¤æ•°æ®ï¼Œåœ¨ç¼“å­˜ä¸­èƒ½è¯»åˆ°çš„è¯ï¼Œå°±ä¸å¿…è¯»å†…å­˜äº† ç¼“å­˜çš„æœ€å°å­˜å‚¨å•ä½æ˜¯ç¼“å­˜è¡Œï¼ˆcache lineï¼‰ï¼Œä¸€èˆ¬æ˜¯ 64 bytesï¼Œä¸€æ¬¡è¯»çš„æ•°æ®å°‘äº†ä¸åˆ’ç®—å•Šï¼Œå› æ­¤æœ€å°‘è¯» 64 bytes å¡«æ»¡ä¸€ä¸ªç¼“å­˜è¡Œï¼Œå› æ­¤è¯»å…¥æŸä¸ªæ•°æ®æ—¶ä¹Ÿä¼šè¯»å–å…¶ä¸´è¿‘çš„æ•°æ®ï¼Œè¿™å°±æ˜¯æ‰€è°“ç©ºé—´å±€éƒ¨æ€§ å¯¹æ•ˆç‡çš„å½±å“ æ¯”è¾ƒä¸‹é¢ ij å’Œ ji ä¸¤ä¸ªæ–¹æ³•çš„æ‰§è¡Œæ•ˆç‡ int rows = 1000000; int columns = 14; int[][] a = new int[rows][columns]; StopWatch sw = new StopWatch(); sw.start(\"ij\"); ij(a, rows, columns); sw.stop(); sw.start(\"ji\"); ji(a, rows, columns); sw.stop(); System.out.println(sw.prettyPrint()); ij æ–¹æ³• public static void ij(int[][] a, int rows, int columns) &#123; long sum = 0L; for (int i = 0; i &lt; rows; i++) &#123; for (int j = 0; j &lt; columns; j++) &#123; sum += a[i][j]; &#125; &#125; System.out.println(sum); &#125; ji æ–¹æ³• public static void ji(int[][] a, int rows, int columns) &#123; long sum = 0L; for (int j = 0; j &lt; columns; j++) &#123; for (int i = 0; i &lt; rows; i++) &#123; sum += a[i][j]; &#125; &#125; System.out.println(sum); &#125; æ‰§è¡Œç»“æœ 0 0 StopWatch &#39;&#39;: running time &#x3D; 96283300 ns --------------------------------------------- ns % Task name --------------------------------------------- 016196200 017% ij 080087100 083% ji å¯ä»¥çœ‹åˆ° ij çš„æ•ˆç‡æ¯” ji å¿«å¾ˆå¤šï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ ç¼“å­˜æ˜¯æœ‰é™çš„ï¼Œå½“æ–°æ•°æ®æ¥äº†åï¼Œä¸€äº›æ—§çš„ç¼“å­˜è¡Œæ•°æ®å°±ä¼šè¢«è¦†ç›– å¦‚æœä¸èƒ½å……åˆ†åˆ©ç”¨ç¼“å­˜çš„æ•°æ®ï¼Œå°±ä¼šé€ æˆæ•ˆç‡ä½ä¸‹ ä»¥ ji æ‰§è¡Œä¸ºä¾‹ï¼Œç¬¬ä¸€æ¬¡å†…å¾ªç¯è¦è¯»å…¥ $[0,0]$ è¿™æ¡æ•°æ®ï¼Œç”±äºå±€éƒ¨æ€§åŸç†ï¼Œè¯»å…¥ $[0,0]$ çš„åŒæ—¶ä¹Ÿè¯»å…¥äº† $[0,1] â€¦ [0,13]$ï¼Œå¦‚å›¾æ‰€ç¤º ä½†å¾ˆé—æ†¾ï¼Œç¬¬äºŒæ¬¡å†…å¾ªç¯è¦çš„æ˜¯ $[1,0]$ è¿™æ¡æ•°æ®ï¼Œç¼“å­˜ä¸­æ²¡æœ‰ï¼Œäºæ˜¯å†è¯»å…¥äº†ä¸‹å›¾çš„æ•°æ® è¿™æ˜¾ç„¶æ˜¯ä¸€ç§æµªè´¹ï¼Œå› ä¸º $[0,1] â€¦ [0,13]$ åŒ…æ‹¬ $[1,1] â€¦ [1,13]$ è¿™äº›æ•°æ®è™½ç„¶è¯»å…¥äº†ç¼“å­˜ï¼Œå´æ²¡æœ‰åŠæ—¶ç”¨ä¸Šï¼Œè€Œç¼“å­˜çš„å¤§å°æ˜¯æœ‰é™çš„ï¼Œç­‰æ‰§è¡Œåˆ°ç¬¬ä¹æ¬¡å†…å¾ªç¯æ—¶ ç¼“å­˜çš„ç¬¬ä¸€è¡Œæ•°æ®å·²ç»è¢«æ–°çš„æ•°æ® $[8,0] â€¦ [8,13]$ è¦†ç›–æ‰äº†ï¼Œä»¥åå¦‚æœå†æƒ³è¯»ï¼Œæ¯”å¦‚ $[0,1]$ï¼Œåˆå¾—åˆ°å†…å­˜å»è¯»äº† åŒç†å¯ä»¥åˆ†æ ij å‡½æ•°åˆ™èƒ½å……åˆ†åˆ©ç”¨å±€éƒ¨æ€§åŸç†åŠ è½½åˆ°çš„ç¼“å­˜æ•°æ® ä¸¾ä¸€åä¸‰ I&#x2F;O è¯»å†™æ—¶åŒæ ·å¯ä»¥ä½“ç°å±€éƒ¨æ€§åŸç† æ•°ç»„å¯ä»¥å……åˆ†åˆ©ç”¨å±€éƒ¨æ€§åŸç†ï¼Œé‚£ä¹ˆé“¾è¡¨å‘¢ï¼Ÿ ç­”ï¼šé“¾è¡¨ä¸è¡Œï¼Œå› ä¸ºé“¾è¡¨çš„å…ƒç´ å¹¶éç›¸é‚»å­˜å‚¨ é“¾è¡¨æ¦‚è¿°å®šä¹‰ åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œé“¾è¡¨æ˜¯æ•°æ®å…ƒç´ çš„çº¿æ€§é›†åˆï¼Œå…¶æ¯ä¸ªå…ƒç´ éƒ½æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå…ƒç´ å­˜å‚¨ä¸Šå¹¶ä¸è¿ç»­ In computer science, a linked list is a linear collection of data elements whose order is not given by their physical placement in memory. Instead, each element points to the next. å¯ä»¥åˆ†ç±»ä¸º[^5] å•å‘é“¾è¡¨ï¼Œæ¯ä¸ªå…ƒç´ åªçŸ¥é“å…¶ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¯è° åŒå‘é“¾è¡¨ï¼Œæ¯ä¸ªå…ƒç´ çŸ¥é“å…¶ä¸Šä¸€ä¸ªå…ƒç´ å’Œä¸‹ä¸€ä¸ªå…ƒç´  å¾ªç¯é“¾è¡¨ï¼Œé€šå¸¸çš„é“¾è¡¨å°¾èŠ‚ç‚¹ tail æŒ‡å‘çš„éƒ½æ˜¯ nullï¼Œè€Œå¾ªç¯é“¾è¡¨çš„ tail æŒ‡å‘çš„æ˜¯å¤´èŠ‚ç‚¹ head é“¾è¡¨å†…è¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„èŠ‚ç‚¹ç§°ä¸ºå“¨å…µï¼ˆSentinelï¼‰èŠ‚ç‚¹ï¼Œä¹Ÿå«åšå“‘å…ƒï¼ˆ Dummyï¼‰èŠ‚ç‚¹ï¼Œå®ƒä¸å­˜å‚¨æ•°æ®ï¼Œé€šå¸¸ç”¨ä½œå¤´å°¾ï¼Œç”¨æ¥ç®€åŒ–è¾¹ç•Œåˆ¤æ–­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º éšæœºè®¿é—®æ€§èƒ½ æ ¹æ® index æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n)$ æ’å…¥æˆ–åˆ é™¤æ€§èƒ½ èµ·å§‹ä½ç½®ï¼š$O(1)$ ç»“æŸä½ç½®ï¼šå¦‚æœå·²çŸ¥ tail å°¾èŠ‚ç‚¹æ˜¯ $O(1)$ï¼Œä¸çŸ¥é“ tail å°¾èŠ‚ç‚¹æ˜¯ $O(n)$ ä¸­é—´ä½ç½®ï¼šæ ¹æ® index æŸ¥æ‰¾æ—¶é—´ + $O(1)$ å•å‘é“¾è¡¨æ ¹æ®å•å‘é“¾è¡¨çš„å®šä¹‰ï¼Œé¦–å…ˆå®šä¹‰ä¸€ä¸ªå­˜å‚¨ value å’Œ next æŒ‡é’ˆçš„ç±» Nodeï¼Œå’Œä¸€ä¸ªæè¿°å¤´éƒ¨èŠ‚ç‚¹çš„å¼•ç”¨ public class SinglyLinkedList &#123; private Node head; // å¤´éƒ¨èŠ‚ç‚¹ private static class Node &#123; // èŠ‚ç‚¹ç±» int value; Node next; public Node(int value, Node next) &#123; this.value = value; this.next = next; &#125; &#125; &#125; Node å®šä¹‰ä¸ºå†…éƒ¨ç±»ï¼Œæ˜¯ä¸ºäº†å¯¹å¤–éšè—å®ç°ç»†èŠ‚ï¼Œæ²¡å¿…è¦è®©ç±»çš„ä½¿ç”¨è€…å…³å¿ƒ Node ç»“æ„ å®šä¹‰ä¸º static å†…éƒ¨ç±»ï¼Œæ˜¯å› ä¸º Node ä¸éœ€è¦ä¸ SinglyLinkedList å®ä¾‹ç›¸å…³ï¼Œå¤šä¸ª SinglyLinkedListå®ä¾‹èƒ½å…±ç”¨ Node ç±»å®šä¹‰ å¤´éƒ¨æ·»åŠ  public class SinglyLinkedList &#123; // ... public void addFirst(int value) &#123; this.head = new Node(value, this.head); &#125; &#125; å¦‚æœ this.head &#x3D;&#x3D; nullï¼Œæ–°å¢èŠ‚ç‚¹æŒ‡å‘ nullï¼Œå¹¶ä½œä¸ºæ–°çš„ this.head å¦‚æœ this.head !&#x3D; nullï¼Œæ–°å¢èŠ‚ç‚¹æŒ‡å‘åŸæ¥çš„ this.headï¼Œå¹¶ä½œä¸ºæ–°çš„ this.head æ³¨æ„èµ‹å€¼æ“ä½œæ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦ while éå† public class SinglyLinkedList &#123; // ... public void loop() &#123; Node curr = this.head; while (curr != null) &#123; // åšä¸€äº›äº‹ System.out.println(curr.value); curr = curr.next; &#125; &#125; &#125; for éå† public class SinglyLinkedList &#123; // ... public void loop() &#123; for (Node curr = this.head; curr != null; curr = curr.next) &#123; // åšä¸€äº›äº‹ System.out.println(curr.value); &#125; &#125; &#125; ä»¥ä¸Šä¸¤ç§éå†éƒ½å¯ä»¥æŠŠè¦åšçš„äº‹ä»¥ Consumer å‡½æ•°çš„æ–¹å¼ä¼ é€’è¿›æ¥ Consumer çš„è§„åˆ™æ˜¯ä¸€ä¸ªå‚æ•°ï¼Œæ— è¿”å›å€¼ï¼Œå› æ­¤åƒ System.out::println æ–¹æ³•ç­‰éƒ½æ˜¯ Consumer è°ƒç”¨ Consumer æ—¶ï¼Œå°†å½“å‰èŠ‚ç‚¹ curr.value ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒ xxx.traverse(System.out::println); public void traverse(Consumer&lt;Integer> consumer) &#123; Node p = head; while (p != null) &#123; consumer.accept(p.value); p = p.next; &#125; &#125; è¿­ä»£å™¨éå† public class SinglyLinkedList implements Iterable&lt;Integer> &#123; // ... private class NodeIterator implements Iterator&lt;Integer> &#123; Node curr = head; public boolean hasNext() &#123; return curr != null; &#125; public Integer next() &#123; int value = curr.value; curr = curr.next; return value; &#125; &#125; public Iterator&lt;Integer> iterator() &#123; return new NodeIterator(); &#125; &#125; hasNext ç”¨æ¥åˆ¤æ–­æ˜¯å¦è¿˜æœ‰å¿…è¦è°ƒç”¨ next next åšä¸¤ä»¶äº‹ è¿”å›å½“å‰èŠ‚ç‚¹çš„ value æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ NodeIterator è¦å®šä¹‰ä¸ºé static å†…éƒ¨ç±»ï¼Œæ˜¯å› ä¸ºå®ƒä¸ SinglyLinkedList å®ä¾‹ç›¸å…³ï¼Œæ˜¯å¯¹æŸä¸ª SinglyLinkedList å®ä¾‹çš„è¿­ä»£ é€’å½’éå† public class SinglyLinkedList implements Iterable&lt;Integer> &#123; // ... public void loop() &#123; recursion(this.head); &#125; private void recursion(Node curr) &#123; if (curr == null) &#123; return; &#125; // å‰é¢åšäº›äº‹ recursion(curr.next); // åé¢åšäº›äº‹ &#125; &#125; å°¾éƒ¨æ·»åŠ  public class SinglyLinkedList &#123; // ... private Node findLast() &#123; if (this.head == null) &#123; return null; &#125; Node curr; for (curr = this.head; curr.next != null; ) &#123; curr = curr.next; &#125; return curr; &#125; public void addLast(int value) &#123; Node last = findLast(); if (last == null) &#123; addFirst(value); return; &#125; last.next = new Node(value, null); &#125; &#125; æ³¨æ„ï¼Œæ‰¾æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œç»ˆæ­¢æ¡ä»¶æ˜¯ curr.next &#x3D;&#x3D; null åˆ†æˆä¸¤ä¸ªæ–¹æ³•æ˜¯ä¸ºäº†ä»£ç æ¸…æ™°ï¼Œè€Œä¸” findLast() ä¹‹åè¿˜èƒ½å¤ç”¨ å°¾éƒ¨æ·»åŠ å¤šä¸ª public class SinglyLinkedList &#123; // ... public void addLast(int first, int... rest) &#123; Node sublist = new Node(first, null); Node curr = sublist; for (int value : rest) &#123; //ä»…æ˜¯éå† curr.next = new Node(value, null); curr = curr.next; &#125; Node last = findLast(); if (last == null) &#123; this.head = sublist; return; &#125; last.next = sublist; &#125; &#125; å…ˆä¸²æˆä¸€ä¸² sublist å†ä½œä¸ºä¸€ä¸ªæ•´ä½“æ·»åŠ  æ ¹æ®ç´¢å¼•è·å– public class SinglyLinkedList &#123; // ... private Node findNode(int index) &#123; int i = 0; for (Node curr = this.head; curr != null; curr = curr.next, i++) &#123; if (index == i) &#123; return curr; &#125; &#125; return null; &#125; private IllegalArgumentException illegalIndex(int index) &#123; return new IllegalArgumentException(String.format(\"index [%d] ä¸åˆæ³•%n\", index)); &#125; public int get(int index) &#123; Node node = findNode(index); if (node != null) &#123; return node.value; &#125; throw illegalIndex(index); &#125; &#125; åŒæ ·ï¼Œåˆ†æ–¹æ³•å¯ä»¥å®ç°å¤ç”¨ æ’å…¥ public class SinglyLinkedList &#123; // ... public void insert(int index, int value) &#123; if (index == 0) &#123; addFirst(value); return; &#125; Node prev = findNode(index - 1); // æ‰¾åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ if (prev == null) &#123; // æ‰¾ä¸åˆ° throw illegalIndex(index); &#125; prev.next = new Node(value, prev.next); &#125; &#125; æ’å…¥åŒ…æ‹¬ä¸‹é¢çš„åˆ é™¤ï¼Œéƒ½å¿…é¡»æ‰¾åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ åˆ é™¤ public class SinglyLinkedList &#123; // ... public void remove(int index) &#123; if (index == 0) &#123; if (this.head != null) &#123; this.head = this.head.next; return; &#125; else &#123; throw illegalIndex(index); &#125; &#125; Node prev = findNode(index - 1); Node curr; if (prev != null &amp;&amp; (curr = prev.next) != null) &#123; prev.next = curr.next; &#125; else &#123; throw illegalIndex(index); &#125; &#125; &#125; ç¬¬ä¸€ä¸ª if å—å¯¹åº”ç€ removeFirst æƒ…å†µ æœ€åä¸€ä¸ª if å—å¯¹åº”ç€è‡³å°‘å¾—ä¸¤ä¸ªèŠ‚ç‚¹çš„æƒ…å†µ ä¸ä»…ä»…åˆ¤æ–­ä¸Šä¸€ä¸ªèŠ‚ç‚¹éç©ºï¼Œè¿˜è¦ä¿è¯å½“å‰èŠ‚ç‚¹éç©º å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š æŸ¥çœ‹ä»£ç  public class SinglyLinkedList implements Iterable&lt;Integer&gt; &#123; private Node head; &#x2F;** * æ ¹æ®ç´¢å¼•ç§»é™¤èŠ‚ç‚¹ * * @param index *&#x2F; public void remove(int index) &#123; if (index &#x3D;&#x3D; 0) &#123; if (head &#x3D;&#x3D; null) &#123; this.head.next &#x3D; head.next; &#125; else &#123; throw illegalIndex(index); &#125; &#125; Node prev &#x3D; findNode(index - 1); Node curr; if (prev !&#x3D; null &amp;&amp; (curr &#x3D; prev.next) !&#x3D; null) &#123; prev.next &#x3D; curr.next; &#125; else &#123; throw illegalIndex(index); &#125; &#125; &#x2F;** * æ ¹æ®ç´¢å¼•æ’å…¥èŠ‚ç‚¹ * * @param index * @param value *&#x2F; public void insert(int index, int value) &#123; &#x2F;&#x2F;ä¸ºç©º if (head &#x3D;&#x3D; null) &#123; addLast(value); return; &#125; Node prev &#x3D; findNode(index - 1); &#x2F;&#x2F; æ‰¾åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ if (prev &#x3D;&#x3D; null) &#123; &#x2F;&#x2F; æ‰¾ä¸åˆ° throw illegalIndex(index); &#125; prev.next &#x3D; new Node(value, prev.next); &#125; &#x2F;** * æ ¹æ®ç´¢å¼•æŸ¥è¯¢èŠ‚ç‚¹ * * @param index * @return æŸ¥æ‰¾åˆ°çš„èŠ‚ç‚¹ *&#x2F; public Node findNode(int index) &#123; int count &#x3D; 0; for (Node curr &#x3D; head; curr !&#x3D; null; curr &#x3D; curr.next, count++) &#123; if (index &#x3D;&#x3D; count) &#123; return curr; &#125; &#125; return null; &#125; &#x2F;** * æ ¹æ®ç´¢å¼•è·å–èŠ‚ç‚¹çš„å€¼ * * @param index * @return *&#x2F; public int get(int index) &#123; Node node &#x3D; findNode(index); if (node !&#x3D; null) &#123; return node.value; &#125; throw illegalIndex(index); &#125; private IllegalArgumentException illegalIndex(int index) &#123; return new IllegalArgumentException(String.format(&quot;index [%d] ä¸åˆæ³•%n&quot;, index)); &#125; &#x2F;** * æ‰¾åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ * * @return *&#x2F; private Node findLast() &#123; if (this.head &#x3D;&#x3D; null) return null; Node curr; for (curr &#x3D; this.head; curr.next !&#x3D; null; curr &#x3D; curr.next) ; return curr; &#125; &#x2F;** * å°¾éƒ¨æ·»åŠ å¤šä¸ª *&#x2F; public void addLast(int first, int... rest) &#123; Node sublist &#x3D; new Node(first, null); Node curr &#x3D; sublist; for (int i : rest) &#123; curr.next &#x3D; new Node(i, null); curr &#x3D; curr.next; &#125; Node last &#x3D; findLast(); if (last &#x3D;&#x3D; null) &#123; this.head &#x3D; sublist; return; &#125; last.next &#x3D; sublist; &#125; &#x2F;** * åœ¨é“¾è¡¨æœ«å°¾æ·»åŠ å…ƒç´  * * @param value *&#x2F; public void addLast(int value) &#123; Node last &#x3D; findLast(); &#x2F;&#x2F;é“¾è¡¨ä¸ºç©º åœ¨å¤´æ’å…¥ if (last &#x3D;&#x3D; null) &#123; addFirst(value); return; &#125; last.next &#x3D; new Node(value, null); &#125; &#x2F;** * å¤´éƒ¨æ·»åŠ  * * @param value *&#x2F; public void addFirst(int value) &#123; this.head &#x3D; new Node(value, head); &#125; &#x2F;** * while å¾ªç¯éå† *&#x2F; public void loopWithWhile() &#123; Node curr &#x3D; this.head; while (curr !&#x3D; null) &#123; System.out.println(curr.value); curr &#x3D; curr.next; &#125; &#125; &#x2F;** * for å¾ªç¯éå† *&#x2F; public void loopWithFor() &#123; for (Node curr &#x3D; this.head; curr !&#x3D; null; curr &#x3D; curr.next) System.out.println(curr.value); &#125; &#x2F;** * Consumer&lt;T&gt; å¾ªç¯éå† *&#x2F; public void traverse(Consumer&lt;Integer&gt; consumer) &#123; Node p &#x3D; head; while (p !&#x3D; null) &#123; consumer.accept(p.value); p &#x3D; p.next; &#125; &#125; @Override public Iterator&lt;Integer&gt; iterator() &#123; return new NodeIterator(); &#125; &#x2F;** * é€’å½’éå† *&#x2F; public void loop() &#123; recursion(this.head); &#125; private void recursion(Node curr) &#123; if (curr &#x3D;&#x3D; null) return; &#x2F;&#x2F;æ­£åº &#x2F;&#x2F; System.out.println(curr.value); recursion(curr.next); &#x2F;&#x2F;é€†åº System.out.println(curr.value); &#125; static class Node &#123; int value; Node next; public Node(int value, Node next) &#123; this.value &#x3D; value; this.next &#x3D; next; &#125; &#125; private class NodeIterator implements Iterator&lt;Integer&gt; &#123; Node p &#x3D; head; @Override public boolean hasNext() &#123; return p !&#x3D; null; &#125; @Override public Integer next() &#123; int value &#x3D; p.value; p &#x3D; p.next; return value; &#125; &#125; &#125; å•å‘é“¾è¡¨ï¼ˆå¸¦å“¨å…µï¼‰è§‚å¯Ÿä¹‹å‰å•å‘é“¾è¡¨çš„å®ç°ï¼Œå‘ç°æ¯ä¸ªæ–¹æ³•å†…å‡ ä¹éƒ½æœ‰åˆ¤æ–­æ˜¯ä¸æ˜¯ head è¿™æ ·çš„ä»£ç ï¼Œèƒ½ä¸èƒ½ç®€åŒ–å‘¢ï¼Ÿ ç”¨ä¸€ä¸ªä¸å‚ä¸æ•°æ®å­˜å‚¨çš„ç‰¹æ®Š Node ä½œä¸ºå“¨å…µï¼Œå®ƒä¸€èˆ¬è¢«ç§°ä¸ºå“¨å…µæˆ–å“‘å…ƒï¼Œæ‹¥æœ‰å“¨å…µèŠ‚ç‚¹çš„é“¾è¡¨ç§°ä¸ºå¸¦å¤´é“¾è¡¨ public class SinglyLinkedListSentinel &#123; // ... private Node head = new Node(Integer.MIN_VALUE, null); &#125; å…·ä½“å­˜ä»€ä¹ˆå€¼æ— æ‰€è°“ï¼Œå› ä¸ºä¸ä¼šç”¨åˆ°å®ƒçš„å€¼ åŠ å…¥å“¨å…µèŠ‚ç‚¹åï¼Œä»£ç ä¼šå˜å¾—æ¯”è¾ƒç®€å•ï¼Œå…ˆçœ‹å‡ ä¸ªå·¥å…·æ–¹æ³• public class SinglyLinkedListSentinel &#123; // ... // æ ¹æ®ç´¢å¼•è·å–èŠ‚ç‚¹ private Node findNode(int index) &#123; int i = -1; for (Node curr = this.head; curr != null; curr = curr.next, i++) &#123; if (i == index) &#123; return curr; &#125; &#125; return null; &#125; // è·å–æœ€åä¸€ä¸ªèŠ‚ç‚¹ private Node findLast() &#123; Node curr; for (curr = this.head; curr.next != null; ) &#123; curr = curr.next; &#125; return curr; &#125; &#125; findNode ä¸ä¹‹å‰ç±»ä¼¼ï¼Œåªæ˜¯ i åˆå§‹å€¼è®¾ç½®ä¸º -1 å¯¹åº”å“¨å…µï¼Œå®é™…ä¼ å…¥çš„ index ä¹Ÿæ˜¯ $[-1, \\infty)$ findLast ç»ä¸ä¼šè¿”å› null äº†ï¼Œå°±ç®—æ²¡æœ‰å…¶å®ƒèŠ‚ç‚¹ï¼Œä¹Ÿä¼šè¿”å›å“¨å…µä½œä¸ºæœ€åä¸€ä¸ªèŠ‚ç‚¹ è¿™æ ·ï¼Œä»£ç ç®€åŒ–ä¸º public class SinglyLinkedListSentinel &#123; // ... public void addLast(int value) &#123; Node last = findLast(); /* æ”¹åŠ¨å‰ if (last == null) &#123; this.head = new Node(value, null); return; &#125; */ last.next = new Node(value, null); &#125; public void insert(int index, int value) &#123; /* æ”¹åŠ¨å‰ if (index == 0) &#123; this.head = new Node(value, this.head); return; &#125; */ // index ä¼ å…¥ 0 æ—¶ï¼Œè¿”å›çš„æ˜¯å“¨å…µ Node prev = findNode(index - 1); if (prev != null) &#123; prev.next = new Node(value, prev.next); &#125; else &#123; throw illegalIndex(index); &#125; &#125; public void remove(int index) &#123; /* æ”¹åŠ¨å‰ if (index == 0) &#123; if (this.head != null) &#123; this.head = this.head.next; return; &#125; else &#123; throw illegalIndex(index); &#125; &#125; */ // index ä¼ å…¥ 0 æ—¶ï¼Œè¿”å›çš„æ˜¯å“¨å…µ Node prev = findNode(index - 1); Node curr; if (prev != null &amp;&amp; (curr = prev.next) != null) &#123; prev.next = curr.next; &#125; else &#123; throw illegalIndex(index); &#125; &#125; public void addFirst(int value) &#123; /* æ”¹åŠ¨å‰ this.head = new Node(value, this.head); */ this.head.next = new Node(value, this.head.next); // ä¹Ÿå¯ä»¥è§†ä¸º insert çš„ç‰¹ä¾‹, å³ insert(0, value); &#125; &#125; å¯¹äºåˆ é™¤ï¼Œå‰é¢è¯´äº†ã€æœ€åä¸€ä¸ª if å—å¯¹åº”ç€è‡³å°‘å¾—ä¸¤ä¸ªèŠ‚ç‚¹çš„æƒ…å†µã€‘ï¼Œç°åœ¨æœ‰äº†å“¨å…µï¼Œå°±å‡‘è¶³äº†ä¸¤ä¸ªèŠ‚ç‚¹ å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š æŸ¥çœ‹ä»£ç  public class SinglyLinkedListSentinel &#123; static class Node &#123; int value; Node next; public Node(int value, Node next) &#123; this.value &#x3D; value; this.next &#x3D; next; &#125; &#125; &#x2F;&#x2F;å“¨å…µèŠ‚ç‚¹ private Node head &#x3D; new Node(Integer.MIN_VALUE, null); &#x2F;** * æ ¹æ®ç´¢å¼•è·å–èŠ‚ç‚¹ * countå½“ä¸å¸¦å“¨å…µå› ä¸ºæœ‰å¤´ç»“ç‚¹æ‰€ä»¥ä»0å¼€å§‹ï¼Œå¸¦äº†å“¨å…µï¼Œåˆå§‹å€¼è®¾ç½®ä¸º -1 å¯¹åº”å“¨å…µ * @param index * @return æŸ¥æ‰¾åˆ°çš„èŠ‚ç‚¹ *&#x2F; public Node findNode(int index) &#123; int count &#x3D; -1; for (Node curr &#x3D; head; curr !&#x3D; null; curr &#x3D; curr.next, count++) &#123; if (index &#x3D;&#x3D; count) &#123; return curr; &#125; &#125; return null; &#125; &#x2F;** * åœ¨é“¾è¡¨æœ«å°¾æ·»åŠ å…ƒç´  * * @param value *&#x2F; public void addLast(int value) &#123; &#x2F;&#x2F;æ‰¾åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ Node last &#x3D; findLast(); &#x2F;&#x2F;æ·»åŠ èŠ‚ç‚¹ last.next &#x3D; new Node(value, null); &#125; &#x2F;&#x2F; è·å–æœ€åä¸€ä¸ªèŠ‚ç‚¹ ä¸ç”¨å†åˆ¤æ–­å¤´ç»“ç‚¹ä¸ºç©ºçš„æƒ…å†µ private Node findLast() &#123; Node curr; for (curr &#x3D; this.head; curr.next !&#x3D; null; ) &#123; curr &#x3D; curr.next; &#125; return curr; &#125; &#x2F;** * å°¾éƒ¨æ·»åŠ å¤šä¸ª *&#x2F; public void addLast(int first, int... rest) &#123; Node sublist &#x3D; new Node(first, null); Node curr &#x3D; sublist; for (int i : rest) &#123; curr.next &#x3D; new Node(i, null); curr &#x3D; curr.next; &#125; Node last &#x3D; findLast(); last.next &#x3D; sublist; &#125; &#x2F;** * å¤´éƒ¨æ·»åŠ  * * @param value *&#x2F; public void addFirst(int value) &#123; &#x2F;* æ”¹åŠ¨å‰ this.head &#x3D; new Node(value, this.head); *&#x2F; this.head.next &#x3D; new Node(value, this.head.next); &#x2F;&#x2F; ä¹Ÿå¯ä»¥è§†ä¸º insert çš„ç‰¹ä¾‹, å³ insert(0, value); &#125; &#x2F;** * ç´¢å¼•è¶Šç•Œå¼‚å¸¸ * @param index * @return *&#x2F; private IllegalArgumentException illegalIndex(int index) &#123; return new IllegalArgumentException(String.format(&quot;index [%d] ä¸åˆæ³•%n&quot;, index)); &#125; &#x2F;** * æ ¹æ®ç´¢å¼•è·å–èŠ‚ç‚¹çš„å€¼ * * @param index * @return *&#x2F; public int get(int index) &#123; Node node &#x3D; findNode(index); if (node !&#x3D; null) &#123; return node.value; &#125; throw illegalIndex(index); &#125; &#x2F;** * æ ¹æ®ç´¢å¼•æ’å…¥èŠ‚ç‚¹ * * @param index * @param value *&#x2F; public void insert(int index, int value) &#123; &#x2F;&#x2F; index ä¼ å…¥ 0 æ—¶ï¼Œè¿”å›çš„æ˜¯å“¨å…µ Node prev &#x3D; findNode(index - 1); &#x2F;&#x2F; æ‰¾åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹ if (prev !&#x3D;null) &#123; prev.next &#x3D; new Node(value, prev.next); &#125;else &#123; throw illegalIndex(index); &#125; &#125; &#x2F;** * æ ¹æ®ç´¢å¼•ç§»é™¤ * @param index *&#x2F; public void remove(int index) &#123; Node prev &#x3D; findNode(index - 1); Node curr; if (prev !&#x3D; null &amp;&amp; (curr &#x3D; prev.next) !&#x3D; null) &#123; prev.next &#x3D; curr.next; &#125; else &#123; throw illegalIndex(index); &#125; &#125; public void traverse(Consumer&lt;Integer&gt; consumer) &#123; Node p &#x3D; head.next; while (p !&#x3D; null) &#123; consumer.accept(p.value); p &#x3D; p.next; &#125; &#125; &#125; åŒå‘é“¾è¡¨ï¼ˆå¸¦å“¨å…µï¼‰å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š æŸ¥çœ‹ä»£ç  public class DoublyLinkedListSentinel implements Iterable&lt;Integer> &#123; private final Node head; private final Node tail; public DoublyLinkedListSentinel() &#123; this.head = new Node(null, 666, null); this.tail = new Node(null, 888, null); head.next = tail; tail.prev = head; &#125; @Override public Iterator&lt;Integer> iterator() &#123; return new Iterator&lt;Integer>() &#123; Node p = head.next; @Override public boolean hasNext() &#123; return p != tail; &#125; @Override public Integer next() &#123; int value = p.value; p = p.next; return value; &#125; &#125;; &#125; public void addFirst(int value) &#123; insert(0, value); &#125; private Node findNode(int index) &#123; int i = -1;//ä»å¤´èŠ‚ç‚¹å¼€å§‹ Node curr; for (curr = head; curr != tail; curr = curr.next, i++) &#123; if (i == index) &#123; return curr; &#125; &#125; return null; &#125; private void insert(int index, int value) &#123; //æ‰¾åˆ°è¦æ’å…¥çš„å‰ä¸€ä¸ªä½ç½® Node prev = findNode(index - 1); if (prev == null) &#123; throw illegalIndex(index); &#125; Node next = prev.next; //æ’å…¥ Node added=new Node(prev,value,next); //é‡æ–°æŒ‡å‘ prev.next=added; next.prev=added; &#125; public void removeFirst() &#123; remove(0); &#125; private void remove(int index) &#123; //æ‰¾åˆ°è¦åˆ é™¤çš„å‰ä¸€ä¸ªä½ç½® Node prev = findNode(index - 1); if (prev == null) &#123; throw illegalIndex(index); &#125; //éœ€è¦ç”¨å®ƒæŒ‡å‘åˆ é™¤åçš„ä¸‹ä¸€ä¸ª Node removed = prev.next; if (removed == tail) &#123; throw illegalIndex(index); &#125; Node next = removed.next; prev.next=next; next.prev=prev; &#125; public void addLast(int value) &#123; Node prev = tail.prev; //å•å‘æŒ‡å‘ Node added = new Node(prev, value, tail); //æ·»åŠ çš„å‰ä¸€ä¸ªå’Œtail æŒ‡å‘ prev.next = added; tail.prev = added; &#125; public void removeLast() &#123; Node removed = tail.prev; Node prev = removed.prev; if (prev == null) &#123; throw illegalIndex(0); &#125; //ç§»é™¤ removed é‡æ–°æŒ‡å‘ prev.next = tail; tail.prev = prev; &#125; /** * å‚æ•°å¼‚å¸¸ * * @param index * @return */ private IllegalArgumentException illegalIndex(int index) &#123; return new IllegalArgumentException( String.format(\"index [%d] ä¸åˆæ³•%n\", index)); &#125; static class Node &#123; Node prev; int value; Node next; public Node(Node prev, int value, Node next) &#123; this.prev = prev; this.value = value; this.next = next; &#125; &#125; &#125; ç¯å½¢é“¾è¡¨ï¼ˆå¸¦å“¨å…µï¼‰åŒå‘ç¯å½¢é“¾è¡¨å¸¦å“¨å…µï¼Œè¿™æ—¶å“¨å…µæ—¢ä½œä¸ºå¤´ï¼Œä¹Ÿä½œä¸ºå°¾ å‚è€ƒå®ç°ï¼š æŸ¥çœ‹ä»£ç  public class CircularLinkedList implements Iterable&lt;Integer> &#123; private final Node sentinel = new Node(null, -1, null); // å“¨å…µ public CircularLinkedList() &#123; //ä¸€ä¸ªå“¨å…µ å“¨å…µæŒ‡å‘è‡ªå·± sentinel.next = sentinel; sentinel.prev = sentinel; &#125; public static void main(String[] args) &#123; CircularLinkedList list = new CircularLinkedList(); list.addFirst(1); list.addLast(2); list.addLast(3); list.addLast(4); Node nodeByValue = list.findNodeByValue(2); list.removeByValue(5); Iterator&lt;Integer> iterator = list.iterator(); while (iterator.hasNext()) &#123; System.out.println(iterator.next()); &#125; &#125; /** * æ·»åŠ åˆ°ç¬¬ä¸€ä¸ª * * @param value å¾…æ·»åŠ å€¼ */ public void addFirst(int value) &#123; Node next = sentinel.next; Node added = new Node(sentinel, value, next); sentinel.next = added; next.prev = added; &#125; /** * æ·»åŠ åˆ°æœ€åä¸€ä¸ª * * @param value å¾…æ·»åŠ å€¼ */ public void addLast(int value) &#123; Node prev = sentinel.prev; Node added = new Node(prev, value, sentinel); prev.next = added; sentinel.prev = added; &#125; /** * åˆ é™¤ç¬¬ä¸€ä¸ª */ public void removeFirst() &#123; Node removed = sentinel.next; if (removed == sentinel) &#123; throw new IllegalArgumentException(\"éæ³•\"); &#125; Node a = sentinel; Node b = removed.next; a.next = b; b.prev = a; &#125; /** * åˆ é™¤æœ€åä¸€ä¸ª */ public void removeLast() &#123; Node removed = sentinel.prev; if (removed == sentinel) &#123; throw new IllegalArgumentException(\"éæ³•\"); &#125; Node a = removed.prev; Node b = sentinel; a.next = b; b.prev = a; &#125; /** * æ ¹æ®å€¼åˆ é™¤èŠ‚ç‚¹ * &lt;p>å‡å®š value åœ¨é“¾è¡¨ä¸­ä½œä¸º key, æœ‰å”¯ä¸€æ€§&lt;/p> * * @param value å¾…åˆ é™¤å€¼ */ public void removeByValue(int value) &#123; Node removed = findNodeByValue(value); if (removed!=null)&#123; Node prev = removed.prev; Node next = removed.next; prev.next=next; next.prev=prev; &#125; throw new IllegalArgumentException(value+\"ä¸å­˜åœ¨ï¼\"); &#125; private Node findNodeByValue(int value) &#123; for (Node p = sentinel.next; p != sentinel; p = p.next) &#123; if (p.value == value) &#123; return p; &#125; &#125; return null; &#125; @Override public Iterator&lt;Integer> iterator() &#123; return new Iterator&lt;Integer>() &#123; Node p = sentinel.next; @Override public boolean hasNext() &#123; return p != sentinel; &#125; @Override public Integer next() &#123; int value = p.value; p = p.next; return value; &#125; &#125;; &#125; static class Node &#123; Node prev; // ä¸Šä¸€ä¸ªèŠ‚ç‚¹æŒ‡é’ˆ int value; // å€¼ Node next; // ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡é’ˆ public Node(Node prev, int value, Node next) &#123; this.prev = prev; this.value = value; this.next = next; &#125; &#125; &#125; 2.3 é€’å½’æ¦‚è¿°å®šä¹‰ è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œé€’å½’æ˜¯ä¸€ç§è§£å†³è®¡ç®—é—®é¢˜çš„æ–¹æ³•ï¼Œå…¶ä¸­è§£å†³æ–¹æ¡ˆå–å†³äºåŒä¸€ç±»é—®é¢˜çš„æ›´å°å­é›† In computer science, recursion is a method of solving a computational problem where the solution depends on solutions to smaller instances of the same problem. æ¯”å¦‚å•é“¾è¡¨é€’å½’éå†çš„ä¾‹å­ï¼š void f(Node node) &#123; if(node == null) &#123; return; &#125; println(\"before:\" + node.value) f(node.next); println(\"after:\" + node.value) &#125; è¯´æ˜ï¼š è‡ªå·±è°ƒç”¨è‡ªå·±ï¼Œå¦‚æœè¯´æ¯ä¸ªå‡½æ•°å¯¹åº”ç€ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œè‡ªå·±è°ƒç”¨è‡ªå·±æ„å‘³ç€è§£å†³æ–¹æ¡ˆæ˜¯ä¸€æ ·çš„ï¼ˆæœ‰è§„å¾‹çš„ï¼‰ æ¯æ¬¡è°ƒç”¨ï¼Œå‡½æ•°å¤„ç†çš„æ•°æ®ä¼šè¾ƒä¸Šæ¬¡ç¼©å‡ï¼ˆå­é›†ï¼‰ï¼Œè€Œä¸”æœ€åä¼šç¼©å‡è‡³æ— éœ€ç»§ç»­é€’å½’ å†…å±‚å‡½æ•°è°ƒç”¨ï¼ˆå­é›†å¤„ç†ï¼‰å®Œæˆï¼Œå¤–å±‚å‡½æ•°æ‰èƒ½ç®—è°ƒç”¨å®Œæˆ åŸç† å‡è®¾é“¾è¡¨ä¸­æœ‰ 3 ä¸ªèŠ‚ç‚¹ï¼Œvalue åˆ†åˆ«ä¸º 1ï¼Œ2ï¼Œ3ï¼Œä»¥ä¸Šä»£ç çš„æ‰§è¡Œæµç¨‹å°±ç±»ä¼¼äºä¸‹é¢çš„ä¼ªç  // 1 -> 2 -> 3 -> null f(1) void f(Node node = 1) &#123; println(\"before:\" + node.value) // 1 void f(Node node = 2) &#123; println(\"before:\" + node.value) // 2 void f(Node node = 3) &#123; println(\"before:\" + node.value) // 3 void f(Node node = null) &#123; if(node == null) &#123; return; &#125; &#125; println(\"after:\" + node.value) // 3 &#125; println(\"after:\" + node.value) // 2 &#125; println(\"after:\" + node.value) // 1 &#125; æ€è·¯ ç¡®å®šèƒ½å¦ä½¿ç”¨é€’å½’æ±‚è§£ æ¨å¯¼å‡ºé€’æ¨å…³ç³»ï¼Œå³çˆ¶é—®é¢˜ä¸å­é—®é¢˜çš„å…³ç³»ï¼Œä»¥åŠé€’å½’çš„ç»“æŸæ¡ä»¶ ä¾‹å¦‚ä¹‹å‰éå†é“¾è¡¨çš„é€’æ¨å…³ç³»ä¸º$$f(n) &#x3D;\\begin{cases}åœæ­¢&amp; n &#x3D; null \\f(n.next) &amp; n \\neq null\\end{cases}$$ æ·±å…¥åˆ°æœ€é‡Œå±‚å«åšé€’ ä»æœ€é‡Œå±‚å‡ºæ¥å«åšå½’ åœ¨é€’çš„è¿‡ç¨‹ä¸­ï¼Œå¤–å±‚å‡½æ•°å†…çš„å±€éƒ¨å˜é‡ï¼ˆä»¥åŠæ–¹æ³•å‚æ•°ï¼‰å¹¶æœªæ¶ˆå¤±ï¼Œå½’çš„æ—¶å€™è¿˜å¯ä»¥ç”¨åˆ° å•è·¯é€’å½’ Single RecursionE01. é˜¶ä¹˜ ç”¨é€’å½’æ–¹æ³•æ±‚é˜¶ä¹˜ é˜¶ä¹˜çš„å®šä¹‰ $n!&#x3D; 1â‹…2â‹…3â‹¯(n-2)â‹…(n-1)â‹…n$ï¼Œå…¶ä¸­ $n$ ä¸ºè‡ªç„¶æ•°ï¼Œå½“ç„¶ $0! &#x3D; 1$ é€’æ¨å…³ç³» $$f(n) &#x3D;\\begin{cases}1 &amp; n &#x3D; 1\\n * f(n-1) &amp; n &gt; 1\\end{cases}$$ ä»£ç  private static int f(int n) &#123; if (n == 1) &#123; return 1; &#125; return n * f(n - 1); &#125; æ‹†è§£ä¼ªç å¦‚ä¸‹ï¼Œå‡è®¾ n åˆå§‹å€¼ä¸º 3 f(int n = 3) &#123; // è§£å†³ä¸äº†,é€’ return 3 * f(int n = 2) &#123; // è§£å†³ä¸äº†,ç»§ç»­é€’ return 2 * f(int n = 1) &#123; if (n == 1) &#123; // å¯ä»¥è§£å†³, å¼€å§‹å½’ return 1; &#125; &#125; &#125; &#125; E02. åå‘æ‰“å°å­—ç¬¦ä¸² ç”¨é€’å½’åå‘æ‰“å°å­—ç¬¦ä¸²ï¼Œn ä¸ºå­—ç¬¦åœ¨æ•´ä¸ªå­—ç¬¦ä¸² str ä¸­çš„ç´¢å¼•ä½ç½® é€’ï¼šn ä» 0 å¼€å§‹ï¼Œæ¯æ¬¡ n + 1ï¼Œä¸€ç›´é€’åˆ° n &#x3D;&#x3D; str.length() - 1 å½’ï¼šä» n &#x3D;&#x3D; str.length() å¼€å§‹å½’ï¼Œä»å½’æ‰“å°ï¼Œè‡ªç„¶æ˜¯é€†åºçš„ é€’æ¨å…³ç³»$$f(n) &#x3D;\\begin{cases}åœæ­¢ &amp; n &#x3D; str.length() \\f(n+1) &amp; 0 \\leq n \\leq str.length() - 1\\end{cases}$$ä»£ç ä¸º public static void reversePrint(String str, int index) &#123; if (index == str.length()) &#123; return; &#125; reversePrint(str, index + 1); System.out.println(str.charAt(index)); &#125; æ‹†è§£ä¼ªç å¦‚ä¸‹ï¼Œå‡è®¾å­—ç¬¦ä¸²ä¸º â€œabcâ€ void reversePrint(String str, int index = 0) &#123; void reversePrint(String str, int index = 1) &#123; void reversePrint(String str, int index = 2) &#123; void reversePrint(String str, int index = 3) &#123; if (index == str.length()) &#123; return; // å¼€å§‹å½’ &#125; &#125; System.out.println(str.charAt(index)); // æ‰“å° c &#125; System.out.println(str.charAt(index)); // æ‰“å° b &#125; System.out.println(str.charAt(index)); // æ‰“å° a &#125; å¤šè·¯é€’å½’ Multi RecursionE01. æ–æ³¢é‚£å¥‘æ•°åˆ— ä¹‹å‰çš„ä¾‹å­æ˜¯æ¯ä¸ªé€’å½’å‡½æ•°åªåŒ…å«ä¸€ä¸ªè‡ªèº«çš„è°ƒç”¨ï¼Œè¿™ç§°ä¹‹ä¸º single recursion å¦‚æœæ¯ä¸ªé€’å½’å‡½æ•°ä¾‹åŒ…å«å¤šä¸ªè‡ªèº«è°ƒç”¨ï¼Œç§°ä¹‹ä¸º multi recursion é€’æ¨å…³ç³»$$f(n) &#x3D;\\begin{cases}0 &amp; n&#x3D;0 \\1 &amp; n&#x3D;1 \\f(n-1) + f(n-2) &amp; n&gt;1\\end{cases}$$ ä¸‹é¢çš„è¡¨æ ¼åˆ—å‡ºäº†æ•°åˆ—çš„å‰å‡ é¡¹ F0 F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12 F13 0 1 1 2 3 5 8 13 21 34 55 89 144 233 å®ç° public static int f(int n) &#123; if (n == 0) &#123; return 0; &#125; if (n == 1) &#123; return 1; &#125; return f(n - 1) + f(n - 2); &#125; æ‰§è¡Œæµç¨‹ ç»¿è‰²ä»£è¡¨æ­£åœ¨æ‰§è¡Œï¼ˆå¯¹åº”é€’ï¼‰ï¼Œç°è‰²ä»£è¡¨æ‰§è¡Œç»“æŸï¼ˆå¯¹åº”å½’ï¼‰ é€’ä¸åˆ°å¤´ï¼Œä¸èƒ½å½’ï¼Œå¯¹åº”ç€æ·±åº¦ä¼˜å…ˆæœç´¢ æ—¶é—´å¤æ‚åº¦ é€’å½’çš„æ¬¡æ•°ä¹Ÿç¬¦åˆæ–æ³¢é‚£å¥‘è§„å¾‹ï¼Œ$2 * f(n+1)-1$ æ—¶é—´å¤æ‚åº¦æ¨å¯¼è¿‡ç¨‹ æ–æ³¢é‚£å¥‘é€šé¡¹å…¬å¼ $f(n) &#x3D; \\frac{1}{\\sqrt{5}}*({\\frac{1+\\sqrt{5}}{2}}^n - {\\frac{1-\\sqrt{5}}{2}}^n)$ ç®€åŒ–ä¸ºï¼š$f(n) &#x3D; \\frac{1}{2.236}*({1.618}^n - {(-0.618)}^n)$ å¸¦å…¥é€’å½’æ¬¡æ•°å…¬å¼ $2\\frac{1}{2.236}({1.618}^{n+1} - {(-0.618)}^{n+1})-1$ æ—¶é—´å¤æ‚åº¦ä¸º $\\Theta(1.618^n)$ æ›´å¤š Fibonacci å‚è€ƒ[^8][^9][^10] ä»¥ä¸Šæ—¶é—´å¤æ‚åº¦åˆ†æï¼Œæœªè€ƒè™‘å¤§æ•°ç›¸åŠ çš„å› ç´  å˜ä½“1 - å…”å­é—®é¢˜[^8] ç¬¬ä¸€ä¸ªæœˆï¼Œæœ‰ä¸€å¯¹æœªæˆç†Ÿçš„å…”å­ï¼ˆé»‘è‰²ï¼Œæ³¨æ„å›¾ä¸­ä¸ªå¤´è¾ƒå°ï¼‰ ç¬¬äºŒä¸ªæœˆï¼Œå®ƒä»¬æˆç†Ÿ ç¬¬ä¸‰ä¸ªæœˆï¼Œå®ƒä»¬èƒ½äº§ä¸‹ä¸€å¯¹æ–°çš„å°å…”å­ï¼ˆè“è‰²ï¼‰ æ‰€æœ‰å…”å­éµå¾ªç›¸åŒè§„å¾‹ï¼Œæ±‚ç¬¬ $n$ ä¸ªæœˆçš„å…”å­æ•° åˆ†æ å…”å­é—®é¢˜å¦‚ä½•ä¸æ–æ³¢é‚£å¥‘è”ç³»èµ·æ¥å‘¢ï¼Ÿè®¾ç¬¬ n ä¸ªæœˆå…”å­æ•°ä¸º $f(n)$ $f(n)$ &#x3D; ä¸Šä¸ªæœˆå…”å­æ•° + æ–°ç”Ÿçš„å°å…”å­æ•° è€Œã€æ–°ç”Ÿçš„å°å…”å­æ•°ã€‘å®é™…å°±æ˜¯ã€ä¸Šä¸ªæœˆæˆç†Ÿçš„å…”å­æ•°ã€‘ å› ä¸ºéœ€è¦ä¸€ä¸ªæœˆå…”å­å°±æˆç†Ÿï¼Œæ‰€ä»¥ã€ä¸Šä¸ªæœˆæˆç†Ÿçš„å…”å­æ•°ã€‘ä¹Ÿå°±æ˜¯ã€ä¸Šä¸Šä¸ªæœˆçš„å…”å­æ•°ã€‘ ä¸Šä¸ªæœˆå…”å­æ•°ï¼Œå³ $f(n-1)$ ä¸Šä¸Šä¸ªæœˆçš„å…”å­æ•°ï¼Œå³ $f(n-2)$ å› æ­¤æœ¬è´¨è¿˜æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œåªæ˜¯ä»å…¶ç¬¬ä¸€é¡¹å¼€å§‹ å˜ä½“2 - é’è›™çˆ¬æ¥¼æ¢¯ æ¥¼æ¢¯æœ‰ $n$ é˜¶ é’è›™è¦çˆ¬åˆ°æ¥¼é¡¶ï¼Œå¯ä»¥ä¸€æ¬¡è·³ä¸€é˜¶ï¼Œä¹Ÿå¯ä»¥ä¸€æ¬¡è·³ä¸¤é˜¶ åªèƒ½å‘ä¸Šè·³ï¼Œé—®æœ‰å¤šå°‘ç§è·³æ³• åˆ†æ n è·³æ³• è§„å¾‹ 1 (1) æš‚æ—¶çœ‹ä¸å‡º 2 (1,1) (2) æš‚æ—¶çœ‹ä¸å‡º 3 (1,1,1) (1,2) (2,1) æš‚æ—¶çœ‹ä¸å‡º 4 (1,1,1,1) (1,2,1) (2,1,1)(1,1,2) (2,2) æœ€åä¸€è·³ï¼Œè·³ä¸€ä¸ªå°é˜¶çš„ï¼ŒåŸºäºf(3)æœ€åä¸€è·³ï¼Œè·³ä¸¤ä¸ªå°é˜¶çš„ï¼ŒåŸºäºf(2) 5 â€¦ â€¦ å› æ­¤æœ¬è´¨ä¸Šè¿˜æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œåªæ˜¯ä»å…¶ç¬¬äºŒé¡¹å¼€å§‹ å¯¹åº” leetcode é¢˜ç›® 70. çˆ¬æ¥¼æ¢¯ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰ å®ç°(Leetcode è¿è¡Œä¼šè¶…æ—¶ å¾…ä¼˜åŒ–) class Solution &#123; public int climbStairs(int n) &#123; if(n==1) return 1; if(n==2) return 2; if(n==3) return 3; return climbStairs(n-1)+climbStairs(n-2); &#125; &#125; é€’å½’ä¼˜åŒ–-è®°å¿†æ³•ä¸Šè¿°ä»£ç å­˜åœ¨å¾ˆå¤šé‡å¤çš„è®¡ç®—ï¼Œä¾‹å¦‚æ±‚ $f(5)$ é€’å½’åˆ†è§£è¿‡ç¨‹ å¯ä»¥çœ‹åˆ°ï¼ˆé¢œè‰²ç›¸åŒçš„æ˜¯é‡å¤çš„ï¼‰ï¼š $f(3)$ é‡å¤äº† 2 æ¬¡ $f(2)$ é‡å¤äº† 3 æ¬¡ $f(1)$ é‡å¤äº† 5 æ¬¡ $f(0)$ é‡å¤äº† 3 æ¬¡ éšç€ $n$ çš„å¢å¤§ï¼Œé‡å¤æ¬¡æ•°éå¸¸å¯è§‚ï¼Œå¦‚ä½•ä¼˜åŒ–å‘¢ï¼Ÿ Memoization è®°å¿†æ³•ï¼ˆä¹Ÿç§°å¤‡å¿˜å½•ï¼‰æ˜¯ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œé€šè¿‡å­˜å‚¨å‡½æ•°è°ƒç”¨ç»“æœï¼ˆé€šå¸¸æ¯”è¾ƒæ˜‚è´µï¼‰ï¼Œå½“å†æ¬¡å‡ºç°ç›¸åŒçš„è¾“å…¥ï¼ˆå­é—®é¢˜ï¼‰æ—¶ï¼Œå°±èƒ½å®ç°åŠ é€Ÿæ•ˆæœï¼Œæ”¹è¿›åçš„ä»£ç  public static void main(String[] args) &#123; int n = 13; int[] cache = new int[n + 1]; Arrays.fill(cache, -1); cache[0] = 0; cache[1] = 1; System.out.println(f(cache, n)); &#125; public static int f(int[] cache, int n) &#123; if (cache[n] != -1) &#123; return cache[n]; &#125; cache[n] = f(cache, n - 1) + f(cache, n - 2); return cache[n]; &#125; ä¼˜åŒ–åçš„å›¾ç¤ºï¼Œåªè¦ç»“æœè¢«ç¼“å­˜ï¼Œå°±ä¸ä¼šæ‰§è¡Œå…¶å­é—®é¢˜ æ”¹è¿›åçš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ è¯·è‡ªè¡ŒéªŒè¯æ”¹è¿›åçš„æ•ˆæœ è¯·è‡ªè¡Œåˆ†ææ”¹è¿›åçš„ç©ºé—´å¤æ‚åº¦ æ³¨æ„ è®°å¿†æ³•æ˜¯åŠ¨æ€è§„åˆ’çš„ä¸€ç§æƒ…å†µï¼Œå¼ºè°ƒçš„æ˜¯è‡ªé¡¶å‘ä¸‹çš„è§£å†³ è®°å¿†æ³•çš„æœ¬è´¨æ˜¯ç©ºé—´æ¢æ—¶é—´ é€’å½’ä¼˜åŒ–-å°¾é€’å½’çˆ†æ ˆ ç”¨é€’å½’åš $n + (n-1) + (n-2) â€¦ + 1$ public static long sum(long n) &#123; if (n == 1) &#123; return 1; &#125; return n + sum(n - 1); &#125; åœ¨æˆ‘çš„æœºå™¨ä¸Š $n &#x3D; 12000$ æ—¶ï¼Œçˆ†æ ˆäº† Exception in thread &quot;main&quot; java.lang.StackOverflowError at Test.sum(Test.java:10) at Test.sum(Test.java:10) at Test.sum(Test.java:10) at Test.sum(Test.java:10) at Test.sum(Test.java:10) ... ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ æ¯æ¬¡æ–¹æ³•è°ƒç”¨æ˜¯éœ€è¦æ¶ˆè€—ä¸€å®šçš„æ ˆå†…å­˜çš„ï¼Œè¿™äº›å†…å­˜ç”¨æ¥å­˜å‚¨æ–¹æ³•å‚æ•°ã€æ–¹æ³•å†…å±€éƒ¨å˜é‡ã€è¿”å›åœ°å€ç­‰ç­‰ æ–¹æ³•è°ƒç”¨å ç”¨çš„å†…å­˜éœ€è¦ç­‰åˆ°æ–¹æ³•ç»“æŸæ—¶æ‰ä¼šé‡Šæ”¾ è€Œé€’å½’è°ƒç”¨æˆ‘ä»¬ä¹‹å‰è®²è¿‡ï¼Œä¸åˆ°æœ€æ·±ä¸ä¼šå›å¤´ï¼Œæœ€å†…å±‚æ–¹æ³•æ²¡å®Œæˆä¹‹å‰ï¼Œå¤–å±‚æ–¹æ³•éƒ½ç»“æŸä¸äº† ä¾‹å¦‚ï¼Œ$sum(3)$ è¿™ä¸ªæ–¹æ³•å†…æœ‰ä¸ªéœ€è¦æ‰§è¡Œ $3 + sum(2)$ï¼Œ$sum(2)$ æ²¡è¿”å›å‰ï¼ŒåŠ å·å‰é¢çš„ $3$ ä¸èƒ½é‡Šæ”¾ çœ‹ä¸‹é¢ä¼ªç  long sum(long n = 3) &#123; return 3 + long sum(long n = 2) &#123; return 2 + long sum(long n = 1) &#123; return 1; &#125; &#125; &#125; å°¾è°ƒç”¨ å¦‚æœå‡½æ•°çš„æœ€åä¸€æ­¥æ˜¯è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆç§°ä¸ºå°¾è°ƒç”¨ï¼Œä¾‹å¦‚ function a() &#123; return b() &#125; ä¸‹é¢ä¸‰æ®µä»£ç ä¸èƒ½å«åšå°¾è°ƒç”¨ function a() &#123; const c = b() return c &#125; å› ä¸ºæœ€åä¸€æ­¥å¹¶éè°ƒç”¨å‡½æ•° function a() &#123; return b() + 1 &#125; æœ€åä¸€æ­¥æ‰§è¡Œçš„æ˜¯åŠ æ³• function a(x) &#123; return b() + x &#125; æœ€åä¸€æ­¥æ‰§è¡Œçš„æ˜¯åŠ æ³• ä¸€äº›è¯­è¨€[^11]çš„ç¼–è¯‘å™¨èƒ½å¤Ÿå¯¹å°¾è°ƒç”¨åšä¼˜åŒ–ï¼Œä¾‹å¦‚ function a() &#123; // åšå‰é¢çš„äº‹ return b() &#125; function b() &#123; // åšå‰é¢çš„äº‹ return c() &#125; function c() &#123; return 1000 &#125; a() æ²¡ä¼˜åŒ–ä¹‹å‰çš„ä¼ªç  function a() &#123; return function b() &#123; return function c() &#123; return 1000 &#125; &#125; &#125; ä¼˜åŒ–åä¼ªç å¦‚ä¸‹ a() b() c() ä¸ºä½•å°¾é€’å½’æ‰èƒ½ä¼˜åŒ–ï¼Ÿ è°ƒç”¨ a æ—¶ a è¿”å›æ—¶å‘ç°ï¼šæ²¡ä»€ä¹ˆå¯ç•™ç»™ b çš„ï¼Œå°†æ¥è¿”å›çš„ç»“æœ b æä¾›å°±å¯ä»¥äº†ï¼Œç”¨ä¸ç€æˆ‘ a äº†ï¼Œæˆ‘çš„å†…å­˜å°±å¯ä»¥é‡Šæ”¾ è°ƒç”¨ b æ—¶ b è¿”å›æ—¶å‘ç°ï¼šæ²¡ä»€ä¹ˆå¯ç•™ç»™ c çš„ï¼Œå°†æ¥è¿”å›çš„ç»“æœ c æä¾›å°±å¯ä»¥äº†ï¼Œç”¨ä¸ç€æˆ‘ b äº†ï¼Œæˆ‘çš„å†…å­˜å°±å¯ä»¥é‡Šæ”¾ å¦‚æœè°ƒç”¨ a æ—¶ ä¸æ˜¯å°¾è°ƒç”¨ï¼Œä¾‹å¦‚ return b() + 1ï¼Œé‚£ä¹ˆ a å°±ä¸èƒ½æå‰ç»“æŸï¼Œå› ä¸ºå®ƒè¿˜å¾—åˆ©ç”¨ b çš„ç»“æœåšåŠ æ³• å°¾é€’å½’ å°¾é€’å½’æ˜¯å°¾è°ƒç”¨çš„ä¸€ç§ç‰¹ä¾‹ï¼Œä¹Ÿå°±æ˜¯æœ€åä¸€æ­¥æ‰§è¡Œçš„æ˜¯åŒä¸€ä¸ªå‡½æ•° å°¾é€’å½’é¿å…çˆ†æ ˆ å®‰è£… Scala Scala å…¥é—¨ object Main &#123; def main(args: Array[String]): Unit = &#123; println(\"Hello Scala\") &#125; &#125; Scala æ˜¯ java çš„è¿‘äº²ï¼Œjava ä¸­çš„ç±»éƒ½å¯ä»¥æ‹¿æ¥é‡ç”¨ ç±»å‹æ˜¯æ”¾åœ¨å˜é‡åé¢çš„ Unit è¡¨ç¤ºæ— è¿”å›å€¼ï¼Œç±»ä¼¼äº void ä¸éœ€è¦ä»¥åˆ†å·ä½œä¸ºç»“å°¾ï¼Œå½“ç„¶åŠ ä¸Šä¹Ÿå¯¹ è¿˜æ˜¯å…ˆå†™ä¸€ä¸ªä¼šçˆ†æ ˆçš„å‡½æ•° def sum(n: Long): Long = &#123; if (n == 1) &#123; return 1 &#125; return n + sum(n - 1) &#125; Scala æœ€åä¸€è¡Œä»£ç è‹¥ä½œä¸ºè¿”å›å€¼ï¼Œå¯ä»¥çœç•¥ return ä¸å‡ºæ‰€æ–™ï¼Œåœ¨ $n &#x3D; 11000$ æ—¶ï¼Œè¿˜æ˜¯å‡ºäº†å¼‚å¸¸ println(sum(11000)) Exception in thread \"main\" java.lang.StackOverflowError at Main$.sum(Main.scala:25) at Main$.sum(Main.scala:25) at Main$.sum(Main.scala:25) at Main$.sum(Main.scala:25) ... è¿™æ˜¯å› ä¸ºä»¥ä¸Šä»£ç ï¼Œè¿˜ä¸æ˜¯å°¾è°ƒç”¨ï¼Œè¦æƒ³æˆä¸ºå°¾è°ƒç”¨ï¼Œé‚£ä¹ˆï¼š æœ€åä¸€è¡Œä»£ç ï¼Œå¿…é¡»æ˜¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ å†…å±‚å‡½æ•°å¿…é¡»æ‘†è„±ä¸å¤–å±‚å‡½æ•°çš„å…³ç³»ï¼Œå†…å±‚å‡½æ•°æ‰§è¡Œåä¸ä¾èµ–äºå¤–å±‚çš„å˜é‡æˆ–å¸¸é‡ def sum(n: Long): Long = &#123; if (n == 1) &#123; return 1 &#125; return n + sum(n - 1) // ä¾èµ–äºå¤–å±‚å‡½æ•°çš„ n å˜é‡ &#125; å¦‚ä½•è®©å®ƒæ‰§è¡Œåå°±æ‘†è„±å¯¹ n çš„ä¾èµ–å‘¢ï¼Ÿ ä¸èƒ½ç­‰é€’å½’å›æ¥å†åšåŠ æ³•ï¼Œé‚£æ ·å°±å¿…é¡»ä¿ç•™å¤–å±‚çš„ n æŠŠ n å½“åšå†…å±‚å‡½æ•°çš„ä¸€ä¸ªå‚æ•°ä¼ è¿›å»ï¼Œè¿™æ—¶ n å°±å±äºå†…å±‚å‡½æ•°äº† ä¼ å‚æ—¶å°±å®Œæˆç´¯åŠ , ä¸å¿…ç­‰å›æ¥æ—¶ç´¯åŠ  sum(n - 1, n + ç´¯åŠ å™¨) æ”¹å†™åä»£ç å¦‚ä¸‹ @tailrec def sum(n: Long, accumulator: Long): Long = &#123; if (n == 1) &#123; return 1 + accumulator &#125; return sum(n - 1, n + accumulator) &#125; accumulator ä½œä¸ºç´¯åŠ å™¨ @tailrec æ³¨è§£æ˜¯ scala æä¾›çš„ï¼Œç”¨æ¥æ£€æŸ¥æ–¹æ³•æ˜¯å¦ç¬¦åˆå°¾é€’å½’ è¿™å› sum(10000000, 0) ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œæ‰“å° 50000005000000 æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼Œä»¥ä¼ªç è¡¨ç¤º $sum(4, 0)$ // é¦–æ¬¡è°ƒç”¨ def sum(n = 4, accumulator = 0): Long = &#123; return sum(4 - 1, 4 + accumulator) &#125; // æ¥ä¸‹æ¥è°ƒç”¨å†…å±‚ sum, ä¼ å‚æ—¶å°±å®Œæˆäº†ç´¯åŠ , ä¸å¿…ç­‰å›æ¥æ—¶ç´¯åŠ ï¼Œå½“å†…å±‚ sum è°ƒç”¨åï¼Œå¤–å±‚ sum ç©ºé—´æ²¡å¿…è¦ä¿ç•™ def sum(n = 3, accumulator = 4): Long = &#123; return sum(3 - 1, 3 + accumulator) &#125; // ç»§ç»­è°ƒç”¨å†…å±‚ sum def sum(n = 2, accumulator = 7): Long = &#123; return sum(2 - 1, 2 + accumulator) &#125; // ç»§ç»­è°ƒç”¨å†…å±‚ sum, è¿™æ˜¯æœ€åçš„ sum è°ƒç”¨å®Œå°±è¿”å›æœ€åç»“æœ 10, å‰é¢æ‰€æœ‰å…¶å®ƒ sum çš„ç©ºé—´æ—©å·²é‡Šæ”¾ def sum(n = 1, accumulator = 9): Long = &#123; if (1 == 1) &#123; return 1 + accumulator &#125; &#125; æœ¬è´¨ä¸Šï¼Œå°¾é€’å½’ä¼˜åŒ–æ˜¯å°†å‡½æ•°çš„é€’å½’è°ƒç”¨ï¼Œå˜æˆäº†å‡½æ•°çš„å¾ªç¯è°ƒç”¨ æ”¹å¾ªç¯é¿å…çˆ†æ ˆ public static void main(String[] args) &#123; long n = 100000000; long sum = 0; for (long i = n; i >= 1; i--) &#123; sum += i; &#125; System.out.println(sum); &#125; é€’å½’æ—¶é—´å¤æ‚åº¦-Master theorem[^14]è‹¥æœ‰é€’å½’å¼$$T(n) &#x3D; aT(\\frac{n}{b}) + f(n)$$å…¶ä¸­ $T(n)$ æ˜¯é—®é¢˜çš„è¿è¡Œæ—¶é—´ï¼Œ$n$ æ˜¯æ•°æ®è§„æ¨¡ $a$ æ˜¯å­é—®é¢˜ä¸ªæ•° $T(\\frac{n}{b})$ æ˜¯å­é—®é¢˜è¿è¡Œæ—¶é—´ï¼Œæ¯ä¸ªå­é—®é¢˜è¢«æ‹†æˆåŸé—®é¢˜æ•°æ®è§„æ¨¡çš„ $\\frac{n}{b}$ $f(n)$ æ˜¯é™¤é€’å½’å¤–æ‰§è¡Œçš„è®¡ç®— ä»¤ $x &#x3D; \\log_{b}{a}$ï¼Œå³ $x &#x3D; \\log_{å­é—®é¢˜ç¼©å°å€æ•°}{å­é—®é¢˜ä¸ªæ•°}$ é‚£ä¹ˆ$$T(n) &#x3D;\\begin{cases}\\Theta(n^x) &amp; f(n) &#x3D; O(n^c) å¹¶ä¸” c \\lt x\\\\Theta(n^x\\log{n}) &amp; f(n) &#x3D; \\Theta(n^x)\\\\Theta(n^c) &amp; f(n) &#x3D; \\Omega(n^c) å¹¶ä¸” c \\gt x\\end{cases}$$ ä¾‹1 $T(n) &#x3D; 2T(\\frac{n}{2}) + n^4$ æ­¤æ—¶ $x &#x3D; 1 &lt; 4$ï¼Œç”±åè€…å†³å®šæ•´ä¸ªæ—¶é—´å¤æ‚åº¦ $\\Theta(n^4)$ å¦‚æœè§‰å¾—å¯¹æ•°ä¸å¥½ç®—ï¼Œå¯ä»¥æ¢ä¸ºæ±‚ã€$b$ çš„å‡ æ¬¡æ–¹èƒ½ç­‰äº $a$ã€‘ ä¾‹2 $T(n) &#x3D; T(\\frac{7n}{10}) + n$ $a&#x3D;1, b&#x3D;\\frac{10}{7}, x&#x3D;0, c&#x3D;1$ æ­¤æ—¶ $x &#x3D; 0 &lt; 1$ï¼Œç”±åè€…å†³å®šæ•´ä¸ªæ—¶é—´å¤æ‚åº¦ $\\Theta(n)$ ä¾‹3 $T(n) &#x3D; 16T(\\frac{n}{4}) + n^2$ $a&#x3D;16, b&#x3D;4, x&#x3D;2, c&#x3D;2$ æ­¤æ—¶ $x&#x3D;2 &#x3D; c$ï¼Œæ—¶é—´å¤æ‚åº¦ $\\Theta(n^2 \\log{n})$ ä¾‹4 $T(n)&#x3D;7T(\\frac{n}{3}) + n^2$ $a&#x3D;7, b&#x3D;3, x&#x3D;1.?, c&#x3D;2$ æ­¤æ—¶ $x &#x3D; \\log_{3}{7} &lt; 2$ï¼Œç”±åè€…å†³å®šæ•´ä¸ªæ—¶é—´å¤æ‚åº¦ $\\Theta(n^2)$ ä¾‹5 $T(n) &#x3D; 7T(\\frac{n}{2}) + n^2$ $a&#x3D;7, b&#x3D;2, x&#x3D;2.?, c&#x3D;2$ æ­¤æ—¶ $x &#x3D; log_2{7} &gt; 2$ï¼Œç”±å‰è€…å†³å®šæ•´ä¸ªæ—¶é—´å¤æ‚åº¦ $\\Theta(n^{\\log_2{7}})$ ä¾‹6 $T(n) &#x3D; 2T(\\frac{n}{4}) + \\sqrt{n}$ $a&#x3D;2, b&#x3D;4, x &#x3D; 0.5, c&#x3D;0.5$ æ­¤æ—¶ $x &#x3D; 0.5 &#x3D; c$ï¼Œæ—¶é—´å¤æ‚åº¦ $\\Theta(\\sqrt{n}\\ \\log{n})$ ä¾‹7. äºŒåˆ†æŸ¥æ‰¾é€’å½’ int f(int[] a, int target, int i, int j) &#123; if (i > j) &#123; return -1; &#125; int m = (i + j) >>> 1; if (target &lt; a[m]) &#123; return f(a, target, i, m - 1); &#125; else if (a[m] &lt; target) &#123; return f(a, target, m + 1, j); &#125; else &#123; return m; &#125; &#125; å­é—®é¢˜ä¸ªæ•° $a &#x3D; 1$ å­é—®é¢˜æ•°æ®è§„æ¨¡ç¼©å°å€æ•° $b &#x3D; 2$ é™¤é€’å½’å¤–æ‰§è¡Œçš„è®¡ç®—æ˜¯å¸¸æ•°çº§ $c&#x3D;0$ $T(n) &#x3D; T(\\frac{n}{2}) + n^0$ æ­¤æ—¶ $x&#x3D;0 &#x3D; c$ï¼Œæ—¶é—´å¤æ‚åº¦ $\\Theta(\\log{n})$ ä¾‹8. å½’å¹¶æ’åºé€’å½’ void split(B[], i, j, A[]) &#123; if (j - i &lt;= 1) return; m = (i + j) / 2; // é€’å½’ split(A, i, m, B); split(A, m, j, B); // åˆå¹¶ merge(B, i, m, j, A); &#125; å­é—®é¢˜ä¸ªæ•° $a&#x3D;2$ å­é—®é¢˜æ•°æ®è§„æ¨¡ç¼©å°å€æ•° $b&#x3D;2$ é™¤é€’å½’å¤–ï¼Œä¸»è¦æ—¶é—´èŠ±åœ¨åˆå¹¶ä¸Šï¼Œå®ƒå¯ä»¥ç”¨ $f(n) &#x3D; n$ è¡¨ç¤º $T(n) &#x3D; 2T(\\frac{n}{2}) + n$ æ­¤æ—¶ $x&#x3D;1&#x3D;c$ï¼Œæ—¶é—´å¤æ‚åº¦ $\\Theta(n\\log{n})$ ä¾‹9. å¿«é€Ÿæ’åºé€’å½’ algorithm quicksort(A, lo, hi) is if lo >= hi || lo &lt; 0 then return // åˆ†åŒº p := partition(A, lo, hi) // é€’å½’ quicksort(A, lo, p - 1) quicksort(A, p + 1, hi) å­é—®é¢˜ä¸ªæ•° $a&#x3D;2$ å­é—®é¢˜æ•°æ®è§„æ¨¡ç¼©å°å€æ•° å¦‚æœåˆ†åŒºåˆ†çš„å¥½ï¼Œ$b&#x3D;2$ å¦‚æœåˆ†åŒºæ²¡åˆ†å¥½ï¼Œä¾‹å¦‚åˆ†åŒº1 çš„æ•°æ®æ˜¯ 0ï¼Œåˆ†åŒº 2 çš„æ•°æ®æ˜¯ $n-1$ é™¤é€’å½’å¤–ï¼Œä¸»è¦æ—¶é—´èŠ±åœ¨åˆ†åŒºä¸Šï¼Œå®ƒå¯ä»¥ç”¨ $f(n) &#x3D; n$ è¡¨ç¤º æƒ…å†µ1 - åˆ†åŒºåˆ†çš„å¥½ $T(n) &#x3D; 2T(\\frac{n}{2}) + n$ æ­¤æ—¶ $x&#x3D;1&#x3D;c$ï¼Œæ—¶é—´å¤æ‚åº¦ $\\Theta(n\\log{n})$ æƒ…å†µ2 - åˆ†åŒºæ²¡åˆ†å¥½ $T(n) &#x3D; T(n-1) + T(1) + n$ æ­¤æ—¶ä¸èƒ½ç”¨ä¸»å®šç†æ±‚è§£ é€’å½’æ—¶é—´å¤æ‚åº¦-å±•å¼€æ±‚è§£åƒä¸‹é¢çš„é€’å½’å¼ï¼Œéƒ½ä¸èƒ½ç”¨ä¸»å®šç†æ±‚è§£ ä¾‹1 - é€’å½’æ±‚å’Œ long sum(long n) &#123; if (n == 1) &#123; return 1; &#125; return n + sum(n - 1); &#125; $T(n) &#x3D; T(n-1) + c$ï¼Œ$T(1) &#x3D; c$ ä¸‹é¢ä¸ºå±•å¼€è¿‡ç¨‹ $T(n) &#x3D; T(n-2) + c + c$ $T(n) &#x3D; T(n-3) + c + c + c$ â€¦ $T(n) &#x3D; T(n-(n-1)) + (n-1)c$ å…¶ä¸­ $T(n-(n-1))$ å³ $T(1)$ å¸¦å…¥æ±‚å¾— $T(n) &#x3D; c + (n-1)c &#x3D; nc$ æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ ä¾‹2 - é€’å½’å†’æ³¡æ’åº void bubble(int[] a, int high) &#123; if(0 == high) &#123; return; &#125; for (int i = 0; i &lt; high; i++) &#123; if (a[i] > a[i + 1]) &#123; swap(a, i, i + 1); &#125; &#125; bubble(a, high - 1); &#125; $T(n) &#x3D; T(n-1) + n$ï¼Œ$T(1) &#x3D; c$ ä¸‹é¢ä¸ºå±•å¼€è¿‡ç¨‹ $T(n) &#x3D; T(n-2) + (n-1) + n$ $T(n) &#x3D; T(n-3) + (n-2) + (n-1) + n$ â€¦ $T(n) &#x3D; T(1) + 2 + â€¦ + n &#x3D; T(1) + (n-1)\\frac{2+n}{2} &#x3D; c + \\frac{n^2}{2} + \\frac{n}{2} -1$ æ—¶é—´å¤æ‚åº¦ $O(n^2)$ æ³¨ï¼š ç­‰å·®æ•°åˆ—æ±‚å’Œä¸º $ä¸ªæ•°*\\frac{\\verté¦–é¡¹-æœ«é¡¹\\vert}{2}$ ä¾‹3 - é€’å½’å¿«æ’ å¿«é€Ÿæ’åºåˆ†åŒºæ²¡åˆ†å¥½çš„æç«¯æƒ…å†µ $T(n) &#x3D; T(n-1) + T(1) + n$ï¼Œ$T(1) &#x3D; c$ $T(n) &#x3D; T(n-1) + c + n$ ä¸‹é¢ä¸ºå±•å¼€è¿‡ç¨‹ $T(n) &#x3D; T(n-2) + c + (n-1) + c + n$ $T(n) &#x3D; T(n-3) + c + (n-2) + c + (n-1) + c + n$ â€¦ $T(n) &#x3D; T(n-(n-1)) + (n-1)c + 2+â€¦+n &#x3D; \\frac{n^2}{2} + \\frac{2cn+n}{2} -1$ æ—¶é—´å¤æ‚åº¦ $O(n^2)$ ä¸ä¼šæ¨å¯¼çš„åŒå­¦å¯ä»¥è¿›å…¥ https://www.wolframalpha.com/ ä¾‹1 è¾“å…¥ f(n) &#x3D; f(n - 1) + c, f(1) &#x3D; c ä¾‹2 è¾“å…¥ f(n) &#x3D; f(n - 1) + n, f(1) &#x3D; c ä¾‹3 è¾“å…¥ f(n) &#x3D; f(n - 1) + n + c, f(1) &#x3D; c é™„å½•å‚è€ƒæ–‡ç« [^1]: â€œDefinition of ALGORITHMâ€. Merriam-Webster Online Dictionary. Archived from the original on February 14, 2020. Retrieved November 14, 2019.[^2]: Introduction to Algorithm ä¸­æ–‡è¯‘ä½œã€Šç®—æ³•å¯¼è®ºã€‹[^3]: ä¸»è¦å‚è€ƒæ–‡æ¡£ https://en.wikipedia.org/wiki/Binary_search_algorithm[^4]: å›¾ç‰‡åŠæ¦‚å¿µå‡æ‘˜è‡ª Introduction to Algorithm 4thï¼Œ3.1èŠ‚ï¼Œ3.2 èŠ‚[^5]: å›¾ç‰‡å¼•ç”¨è‡ª wikipedia linkedlist æ¡ç›®ï¼Œhttps://en.wikipedia.org/wiki/Linked_list [^6]: ä¹Ÿç§°ä¸º Pascalâ€™s triangle https://en.wikipedia.org/wiki/Pascal%27s_triangle [^7]: é€’å½’æ±‚è§£æ–æ³¢é‚£å¥‘æ•°åˆ—çš„æ—¶é—´å¤æ‚åº¦â€”â€”å‡ ç§ç®€æ´è¯æ˜ - çŸ¥ä¹ (zhihu.com)[^8]: Fibonacci ä»‹ç»ï¼šhttps://en.wikipedia.org/wiki/Fibonacci_number[^9]: å‡ ç§è®¡ç®—Fibonacciæ•°åˆ—ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒ - çŸ¥ä¹ (zhihu.com)[^10]: å‡ ç§æ–æ³¢é‚£å¥‘æ•°åˆ—ç®—æ³•æ¯”è¾ƒ Fast Fibonacci algorithms (nayuki.io) [^11]: æˆ‘çŸ¥é“çš„æœ‰ C++ï¼ŒScala[^12]: jdk ç‰ˆæœ¬æœ‰å…³ï¼Œ64 ä½ jdkï¼ŒæŒ‰ 8 å­—èŠ‚å¯¹é½[^13]: æ±‰è¯ºå¡”å›¾ç‰‡èµ„æ–™å‡æ¥è‡ª https://en.wikipedia.org/wiki/Tower_of_Hanoi[^14]: ä¸ä¸»å®šç†ç±»ä¼¼çš„è¿˜æœ‰ Akraâ€“Bazzi methodï¼Œhttps://en.wikipedia.org/wiki/Akra%E2%80%93Bazzi_method [^15]: é¾Ÿå…”èµ›è·‘åŠ¨ç”»æ¥è‡ªäº Floydâ€™s Hare and Tortoise Algorithm Demo - One Step! Code (onestepcode.com) [^16]: Josephus problem ä¸»è¦å‚è€ƒ https://en.wikipedia.org/wiki/Josephus_problem","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://blog.ehzyil.xyz/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://blog.ehzyil.xyz/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"author":"ehzyil"},{"title":"æ ‡ç­¾æ’ä»¶","slug":"2023/æ ‡ç­¾æ’ä»¶","date":"2023-10-10T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/10/2023/æ ‡ç­¾æ’ä»¶/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/10/2023/%E6%A0%87%E7%AD%BE%E6%8F%92%E4%BB%B6/","excerpt":"","text":"noteblockæ¼”ç¤ºæ•ˆæœå¯ä»¥åœ¨åŒºå—ä¸­æ”¾ç½®ä¸€äº›å¤æ‚çš„ç»“æ„ï¼Œæ”¯æŒåµŒå¥—ã€‚ æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰Windows 10ä¸æ˜¯ç‚ºæ‰€æœ‰äººè¨­è¨ˆ,è€Œæ˜¯ç‚ºæ¯å€‹äººè¨­è¨ˆåµŒå¥—æµ‹è¯•ï¼š è¯·åå’Œæ”¾å®½ï¼Œæˆ‘æ­£åœ¨å¸®ä½ æå®šä¸€åˆ‡â€¦ Folding æµ‹è¯•ï¼š ç‚¹å‡»æŸ¥çœ‹æ›´å¤š ä¸è¦è¯´æˆ‘ä»¬æ²¡æœ‰è­¦å‘Šè¿‡ä½ æˆ‘ä»¬éƒ½æœ‰ä¸é¡ºåˆ©çš„æ—¶å€™ &#123;% noteblock::æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰ %&#125; Windows 10ä¸æ˜¯ç‚ºæ‰€æœ‰äººè¨­è¨ˆ,è€Œæ˜¯ç‚ºæ¯å€‹äººè¨­è¨ˆ &#123;% noteblock done %&#125; åµŒå¥—æµ‹è¯•ï¼š è¯·åå’Œæ”¾å®½ï¼Œæˆ‘æ­£åœ¨å¸®ä½ æå®šä¸€åˆ‡... &#123;% endnoteblock %&#125; &#123;% folding yellow::Folding æµ‹è¯•ï¼š ç‚¹å‡»æŸ¥çœ‹æ›´å¤š %&#125; &#123;% note warning::ä¸è¦è¯´æˆ‘ä»¬æ²¡æœ‰è­¦å‘Šè¿‡ä½  %&#125; &#123;% noteblock bug red %&#125; æˆ‘ä»¬éƒ½æœ‰ä¸é¡ºåˆ©çš„æ—¶å€™ &#123;% endnoteblock %&#125; &#123;% endfolding %&#125; &#123;% endnoteblock %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°&#123;% checkbox çº¯æ–‡æœ¬æµ‹è¯• %&#125; &#123;% checkbox checked::æ”¯æŒç®€å•çš„ [markdown](https:&#x2F;&#x2F;guides.github.com&#x2F;features&#x2F;mastering-markdown&#x2F;) è¯­æ³• %&#125; &#123;% checkbox red::æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125; &#123;% checkbox green checked::ç»¿è‰² + é»˜è®¤é€‰ä¸­ %&#125; &#123;% checkbox yellow checked::é»„è‰² + é»˜è®¤é€‰ä¸­ %&#125; &#123;% checkbox cyan checked::é’è‰² + é»˜è®¤é€‰ä¸­ %&#125; &#123;% checkbox blue checked::è“è‰² + é»˜è®¤é€‰ä¸­ %&#125; &#123;% checkbox plus green checked::å¢åŠ  %&#125; &#123;% checkbox minus yellow checked::å‡å°‘ %&#125; &#123;% checkbox times red checked::å‰ %&#125; checkbox&#123;% checkbox æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰::æ–‡æœ¬ï¼ˆæ”¯æŒç®€å•mdï¼‰ %&#125; æ¼”ç¤ºæ•ˆæœ çº¯æ–‡æœ¬æµ‹è¯• æ”¯æŒç®€å•çš„ markdown è¯­æ³• æ”¯æŒè‡ªå®šä¹‰é¢œè‰² ç»¿è‰² + é»˜è®¤é€‰ä¸­ é»„è‰² + é»˜è®¤é€‰ä¸­ é’è‰² + é»˜è®¤é€‰ä¸­ è“è‰² + é»˜è®¤é€‰ä¸­ å¢åŠ  å‡å°‘ å‰ ä¸Šè¿°ç¤ºä¾‹çš„æºç &#123;% checkbox çº¯æ–‡æœ¬æµ‹è¯• %&#125; &#123;% checkbox checked::æ”¯æŒç®€å•çš„ [markdown](https:&#x2F;&#x2F;guides.github.com&#x2F;features&#x2F;mastering-markdown&#x2F;) è¯­æ³• %&#125; &#123;% checkbox red::æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125; &#123;% checkbox green checked::ç»¿è‰² + é»˜è®¤é€‰ä¸­ %&#125; &#123;% checkbox yellow checked::é»„è‰² + é»˜è®¤é€‰ä¸­ %&#125; &#123;% checkbox cyan checked::é’è‰² + é»˜è®¤é€‰ä¸­ %&#125; &#123;% checkbox blue checked::è“è‰² + é»˜è®¤é€‰ä¸­ %&#125; &#123;% checkbox plus green checked::å¢åŠ  %&#125; &#123;% checkbox minus yellow checked::å‡å°‘ %&#125; &#123;% checkbox times red checked::å‰ %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°é¢œè‰²red, yellow, green, cyan, blue æ ·å¼plus, minus, times é€‰ä¸­çŠ¶æ€checked timeline&#123;% timeline æ—¶é—´çº¿æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰ %&#125; &#123;% timenode æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ %&#125; æ­£æ–‡å†…å®¹ &#123;% endtimenode %&#125; &#123;% timenode æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ %&#125; æ­£æ–‡å†…å®¹ &#123;% endtimenode %&#125; &#123;% endtimeline %&#125; 2020-07-24 2.6.6 -&gt; 3.0 å¦‚æœæœ‰ hexo-lazyload-image æ’ä»¶ï¼Œéœ€è¦åˆ é™¤å¹¶é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œè®¾ç½® lazyload.isSPA: trueã€‚2.x ç‰ˆæœ¬çš„ css å’Œ js ä¸é€‚ç”¨äº 3.x ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨äº† use_cdn: true åˆ™éœ€è¦åˆ é™¤ã€‚2.x ç‰ˆæœ¬çš„ fancybox æ ‡ç­¾åœ¨ 3.x ç‰ˆæœ¬ä¸­è¢«é‡å‘½åä¸º gallery ã€‚2.x ç‰ˆæœ¬çš„ç½®é¡¶ top: true æ”¹ä¸ºäº† pin: trueï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äº layout: page çš„é¡µé¢ã€‚å¦‚æœä½¿ç”¨äº† hexo-offline æ’ä»¶ï¼Œå»ºè®®å¸è½½ï¼Œ3.0 ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† pjax æœåŠ¡ã€‚ 2020-05-15 2.6.3 -&gt; 2.6.6 ä¸éœ€è¦é¢å¤–å¤„ç†ã€‚ 2020-04-20 2.6.2 -&gt; 2.6.3 å…¨å±€æœç´¢ seotitle å¹¶æ›¿æ¢ä¸º seo_titleã€‚group ç»„ä»¶çš„ç´¢å¼•è§„åˆ™æœ‰å˜ï¼Œä½¿ç”¨ group ç»„ä»¶çš„æ–‡ç« å†…ï¼Œgroup: group_name å¯¹åº”çš„ç»„ä»¶åå¿…é¡»æ˜¯ group_nameã€‚group ç»„ä»¶çš„åˆ—è¡¨åä¼˜å…ˆæ˜¾ç¤ºæ–‡ç« çš„ short_title å…¶æ¬¡æ˜¯ titleã€‚ linkæœ€åæ›´æ–°äº 5.0 ç‰ˆæœ¬&#123;% link æ ‡é¢˜::é“¾æ¥::å›¾ç‰‡é“¾æ¥ï¼ˆå¯é€‰ï¼‰ %&#125; å¦‚ä½•å‚ä¸é¡¹ç›®https://volantis.js.org/contributors/ siteç½‘ç«™å¡ç‰‡å¯ä»¥æ˜¾ç¤ºç½‘ç«™æˆªå›¾ã€logoã€æ ‡é¢˜ã€æè¿°ï¼Œä½¿ç”¨æ–¹æ³•å’Œ å‹é“¾æ ‡ç­¾ ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æ•°æ®æ–‡ä»¶åç§°ä¸º sites.ymlï¼Œå¯ä»¥å’Œå‹é“¾æ•°æ®æ··ç”¨ï¼Œé€šè¿‡åˆ†ç»„è¿‡æ»¤å®ç°ä¸ä¸€æ ·çš„æ•ˆæœã€‚ æœ€åæ›´æ–°äº 5.0 ç‰ˆæœ¬&#123;% sites [ç­›é€‰æ–¹å¼]:[ç»„å] %&#125; æ¼”ç¤ºæ•ˆæœvolantis_developervolantis_developerxaoxuuhttps://github.com/xaoxuuMHuiGhttps://github.com/MHuiGinksshttps://github.com/inkssColsrchhttps://github.com/ColsrchDrew233https://github.com/Drew233Linhk1606https://github.com/Linhk1606W4J1ehttps://github.com/W4J1e community_builderxaoxuuhttps://github.com/xaoxuuMHuiGhttps://github.com/MHuiGColsrchhttps://github.com/Colsrchpennduhttps://github.com/penndu ä¸Šè¿°ç¤ºä¾‹çš„æºç &#123;% sites only:community_team %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°æ•°æ®æŒ‰ç»„ç­›é€‰æ”¯æŒåˆ†ç»„ï¼ˆç™½åå•æ¨¡å¼å’Œé»‘åå•æ¨¡å¼ï¼‰æ˜¾ç¤º: &#x2F;&#x2F; æ˜¾ç¤º communtiy_team &#123;% sites only:communtiy_team %&#125; &#x2F;&#x2F; é™¤äº† communtiy_team åˆ«çš„éƒ½æ˜¾ç¤º &#123;% sites not:community_team %&#125; &#x2F;&#x2F; å¤šä¸ªåˆ†ç»„ä½¿ç”¨ &#96;,&#96; åˆ†éš” &#123;% sites only:communtiy_team, communtiy_builder %&#125; å‹é“¾æ ‡ç­¾æ‚¨å¯ä»¥åœ¨ä»»ä½•ä½ç½®æ’å…¥å‹é“¾ï¼Œæ”¯æŒé™æ€æ•°æ®å’ŒåŠ¨æ€æ•°æ®ï¼Œé™æ€æ•°æ®éœ€è¦å†™åœ¨æ•°æ®æ–‡ä»¶ä¸­ï¼š æ ‡é¢˜å’Œæè¿°éƒ½æ”¯æŒ md æ ¼å¼ï¼Œéœ€è¦å†™åœ¨å¼•å·ä¸­ã€‚å¦‚æœæŒ‡å®šäº† api å’Œ repo å­—æ®µï¼Œåˆ™ä» issues ä¸­å–ç¬¬ä¸€ä¸ª json ä»£ç å—æ•°æ®ä½œä¸ºå‹é“¾ã€‚ &#123;% friends %&#125; æ•°æ®æŒ‰ç»„ç­›é€‰å‹é“¾æ”¯æŒåˆ†ç»„ï¼ˆç™½åå•æ¨¡å¼å’Œé»‘åå•æ¨¡å¼ï¼‰æ˜¾ç¤ºï¼š &#x2F;&#x2F; æ˜¾ç¤º volantis_developer &#123;% friends only:volantis_developer %&#125; &#x2F;&#x2F; æ˜¾ç¤º volantis_developer å’Œ community_builder &#123;% friends only:volantis_developer,community_builder %&#125; &#x2F;&#x2F; é™¤äº† community_builder åˆ«çš„éƒ½æ˜¾ç¤º &#123;% friends not:community_builder %&#125; &#x2F;&#x2F; æ˜¾ç¤º volantis_developer volantis_developervolantis_developerxaoxuuMHuiG &#x2F;&#x2F; æ˜¾ç¤º volantis_developer å’Œ community_builder volantis_developervolantis_developerxaoxuuMHuiGxaoxuuMHuiGColsrch &#x2F;&#x2F; é™¤äº† community_builder åˆ«çš„éƒ½æ˜¾ç¤º volantis_developervolantis_developerxaoxuuMHuiG tabæ­¤æ’ä»¶ç§»æ¤è‡ª NexT #tabs æœ€åæ›´æ–°äº 2.1 ç‰ˆæœ¬&#123;% tabs é¡µé¢å†…ä¸é‡å¤çš„ID %&#125; &lt;!-- tab æ ç›®1 --&gt; å†…å®¹ &lt;!-- endtab --&gt; &lt;!-- tab æ ç›®2 --&gt; å†…å®¹ &lt;!-- endtab --&gt; &#123;% endtabs %&#125; æ ç›®1æ ç›®2ã€‚ã€‚ã€‚ï¼ï¼ï¼ ä¸Šè¿°ç¤ºä¾‹çš„æºç &#123;% tabs tab-id %&#125; &lt;!-- tab æ ç›®1 --&gt; ã€‚ã€‚ã€‚ &lt;!-- endtab --&gt; &lt;!-- tab æ ç›®2 --&gt; ï¼ï¼ï¼ &lt;!-- endtab --&gt; &#123;% endtabs %&#125; foldingæœ€åæ›´æ–°äº 5.0 ç‰ˆæœ¬&#123;% folding å‚æ•°ï¼ˆå¯é€‰ï¼‰::æ ‡é¢˜ %&#125; ![](https:&#x2F;&#x2F;gcore.jsdelivr.net&#x2F;gh&#x2F;volantis-x&#x2F;cdn-wallpaper&#x2F;abstract&#x2F;41F215B9-261F-48B4-80B5-4E86E165259E.jpeg) &#123;% endfolding %&#125; æ¼”ç¤ºæ•ˆæœ æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚ æŸ¥çœ‹ä»£ç æµ‹è¯• æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• hahahehe æŸ¥çœ‹åµŒå¥—æµ‹è¯• æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 hahaha ä¸Šè¿°ç¤ºä¾‹çš„æºç &#123;% folding æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• %&#125; ![](https:&#x2F;&#x2F;gcore.jsdelivr.net&#x2F;gh&#x2F;volantis-x&#x2F;cdn-wallpaper&#x2F;abstract&#x2F;41F215B9-261F-48B4-80B5-4E86E165259E.jpeg) &#123;% endfolding %&#125; &#123;% folding cyan open::æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† %&#125; è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚ &#123;% endfolding %&#125; &#123;% folding green::æŸ¥çœ‹ä»£ç æµ‹è¯• %&#125; &#123;% endfolding %&#125; &#123;% folding yellow::æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• %&#125; - haha - hehe &#123;% endfolding %&#125; &#123;% folding red::æŸ¥çœ‹åµŒå¥—æµ‹è¯• %&#125; &#123;% folding blue::æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 %&#125; &#123;% folding æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 %&#125; hahaha &lt;span&gt;&lt;img src&#x3D;&#39;https:&#x2F;&#x2F;gcore.jsdelivr.net&#x2F;gh&#x2F;volantis-x&#x2F;cdn-emoji&#x2F;tieba&#x2F;%E6%BB%91%E7%A8%BD.png&#39; style&#x3D;&#39;height:24px&#39;&gt;&lt;&#x2F;span&gt; &#123;% endfolding %&#125; &#123;% endfolding %&#125; &#123;% endfolding %&#125; å¯ä»¥æ”¯æŒçš„å‚æ•°å‚æ•°ä½ç½®å¯ä»¥å¡«å†™é¢œè‰²å’ŒçŠ¶æ€ï¼Œå¤šä¸ªå‚æ•°ç”¨ç©ºæ ¼éš”å¼€ã€‚ é¢œè‰²blue, cyan, green, yellow, red çŠ¶æ€çŠ¶æ€å¡«å†™ open ä»£è¡¨é»˜è®¤æ‰“å¼€ã€‚ From æ ‡ç­¾æ’ä»¶","categories":[],"tags":[{"name":"æ ‡ç­¾æ’ä»¶","slug":"æ ‡ç­¾æ’ä»¶","permalink":"https://blog.ehzyil.xyz/tags/%E6%A0%87%E7%AD%BE%E6%8F%92%E4%BB%B6/"}],"author":"ehzyil"},{"title":"Java ä¸­å¸¸ç”¨çš„æ—¥æœŸç±»","slug":"2023/Java ä¸­å¸¸ç”¨çš„æ—¥æœŸç±»","date":"2023-10-09T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/09/2023/Java ä¸­å¸¸ç”¨çš„æ—¥æœŸç±»/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/09/2023/Java%20%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E6%97%A5%E6%9C%9F%E7%B1%BB/","excerpt":"","text":"Java ä¸­å¸¸ç”¨çš„æ—¥æœŸç±»ä¸€ã€ java.util.Date**System.currentTimeMillis()**ï¼šè¿”å›å½“å‰æ—¶é—´ä¸æ ¼æ—å¨æ²»æ—¶é—´ 1970-01-01 00:00:00 ï¼ˆåŒ—äº¬æ—¶é—´ï¼š1970-01-01 08:00:00ï¼‰ä¹‹é—´ä»¥æ¯«ç§’ä¸ºå•ä½çš„æ—¶é—´å·®ã€‚æ­¤æ–¹æ³•é€‚ç”¨äºè®¡ç®—æ—¶é—´å·® // 1687936118101 æ—¶é—´æˆ³ Long time = System.currentTimeMillis(); System.currentTimeMillis() æ–¹æ³•çš„è¿”å›ç±»å‹æ˜¯ Long ç±»å‹ã€‚ä¸€èˆ¬ç”¨äºè·å–æŸä¸ªæ–¹æ³•æˆ–å…¶å®ƒçš„æ‰§è¡Œæ—¶é—´å·®ã€‚å³ï¼šåœ¨å¼€å§‹å‰è·å–ä¸€æ¬¡ï¼Œåœ¨ç»“æŸæ—¶è·å–ä¸€æ¬¡ï¼Œç»“æŸæ—¶é—´å‡å»å¼€å§‹æ—¶é—´ï¼Œå¾—åˆ°æ‰§è¡Œæ—¶é—´ã€‚å¦‚ï¼š Long startTime = System.currentTimeMillis(); for (int i = 0; i &lt; 10000; i++) &#123; System.out.print(\"*\"); &#125; Long endTime = System.currentTimeMillis(); Long result = endTime - startTime; System.out.println(\"ç”¨æ—¶ï¼š\"+result); æ—¶é—´æˆ³ä¸ java.util.Date ç±»äº’ç›¸è½¬æ¢ï¼š // æ—¶é—´æˆ³è½¬æ¢ä¸º Date ç±»å‹ Date date = new Date(time); System.out.println(date); // Date ç±»å‹è½¬æ¢ä¸ºæ—¶é—´æˆ³ Long time = new Date().getTime(); System.out.println(time); ä¸€èˆ¬ java.util.Date ç±»ä¸ java.text.SimpleDateFormat ç±»ä¸€èµ·ç”¨ï¼Œç”¨äºæ ¼å¼åŒ–æ—¥æœŸã€‚ å¦‚ï¼šå°†æ—¥æœŸä¸å­—ç¬¦ä¸²äº’è½¬ï¼š // æ ¼å¼åŒ–æ—¶é—´ SimpleDateFormat sdf=new SimpleDateFormat(\"yyyy-MM-dd HHæ—¶mmåˆ†ssç§’\"); System.out.println(sdf.format(new Date())); // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ—¥æœŸï¼š String pattern= \"yyyy-MM-dd HH:mm:ss\"; String time = \"2022-07-18 22:53:22\"; SimpleDateFormat simpleDateFormat=new SimpleDateFormat(pattern); try &#123; Date date=simpleDateFormat.parse(time); System.out.println(date); &#125; catch (Exception e) &#123; throw new RuntimeException(\"æ—¥æœŸæ ¼å¼åŒ–é”™è¯¯ï¼ï¼ï¼Œæ—¥æœŸä¸ºï¼š\" + time); &#125; æ³¨æ„ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ—¥æœŸæ—¶ patternè¦å¯¹åº”ã€‚ äºŒ. java.sql.Datejava.sql.Date æ˜¯ java.util.Date ç±»çš„å­ç±»ï¼›æ˜¯é’ˆå¯¹ SQL è¯­å¥ä½¿ç”¨çš„ï¼Œå®ƒåªåŒ…å«æ—¥æœŸè€Œæ²¡æœ‰æ—¶é—´éƒ¨åˆ†ï¼Œä¸€èˆ¬åœ¨è¯»å†™æ•°æ®åº“çš„æ—¶å€™ç”¨ï¼ŒPreparedStament#setDate() æ–¹æ³•çš„å‚æ•°å’Œ ResultSet#getDate() æ–¹æ³•çš„éƒ½æ˜¯ java.sql.Dateã€‚ Date date=new Date(0L); System.out.println(date); //1970-01-01 java.util.Date ä¸ java.sql.Date äº’ç›¸è½¬æ¢ï¼š java.util.Date utilDate=new java.util.Date(); System.out.println(utilDate); //Wed Jun 28 15:45:45 CST 2023 java.sql.Date sqldate=new Date(utilDate.getTime()); System.out.println(sqldate); //2023-06-28 ä¸‰. java.util.Calendarjava.util.Calendarï¼šæ—¥å†ç±»ï¼Œæ˜¯ä¸ªæŠ½è±¡ç±» Calendar å®ä¾‹åŒ–çš„æ–¹æ³•ï¼š åˆ›å»ºå…¶å­ç±» GregorianCalendar çš„å¯¹è±¡ è°ƒç”¨å…¶é™æ€æ–¹æ³• getInstance() ä»ä¸‹åˆ—æ–¹æ³•å¯ä»¥å¾—å‡ºä¸¤ç§å®ä¾‹åŒ–æ–¹æ³•ä¸€æ · Calendar calendar&#x3D;Calendar.getInstance(); System.out.println(calendar.getClass()); &#x2F;&#x2F;class java.util.GregorianCalendar Calendar GregorianCalendar&#x3D;new GregorianCalendar(); System.out.println(calendar.getClass()&#x3D;&#x3D;GregorianCalendar.getClass()); &#x2F;&#x2F;true å¸¸ç”¨çš„æ–¹æ³•ï¼š get(int field)ï¼šè·å–æŸä¸ªæ—¶é—´set()ï¼šè®¾ç½®æŸä¸ªæ—¶é—´add()ï¼šåœ¨æŸä¸ªæ—¶é—´ä¸Šï¼ŒåŠ ä¸ŠæŸä¸ªæ—¶é—´getTime()ï¼šå°† Calendar ç±»è½¬æ¢ä¸º Date ç±»setTime()ï¼šå°† Date ç±»è½¬æ¢ä¸º Calendar ç±»field å–å€¼æœ‰ï¼š DAY_OF_MONTHï¼šè¿™ä¸ªæœˆçš„ç¬¬å‡ å¤©DAY_OF_YEARï¼šè¿™å¹´çš„ç¬¬å‡ å¤©â€¦æ³¨æ„ï¼š è·å–æœˆä»½æ—¶ï¼šä¸€æœˆæ˜¯ 0ï¼ŒäºŒæœˆæ˜¯1ï¼Œâ€¦è·å–æ˜ŸæœŸæ—¶ï¼šå‘¨æ—¥æ˜¯1ï¼Œå‘¨ä¸€æ˜¯2ï¼Œâ€¦ getTime() æ–¹æ³• æºç  public final Date getTime() &#123; return new Date(getTimeInMillis()); &#125; Calendar calendar = Calendar.getInstance(); System.out.println(calendar.getTime()); //Wed Jun 28 16:04:30 CST 2023 public int get(int field)æ–¹æ³• Calendar calendar=Calendar.getInstance(); System.out.println(calendar.getTime()); //Wed Jun 28 15:59:38 CST 2023 calendar.set(Calendar.DAY_OF_MONTH, 5); //å°†å½“å‰æ—¶é—´è®¾ç½®æˆæŸä¸ªæ—¶é—´ System.out.println(calendar.get(Calendar.DAY_OF_MONTH)); //1 System.out.println(calendar.getTime()); //Thu Jun 01 15:59:38 CST 2023 set(int field, int value)æ–¹æ³• Calendar calendar=Calendar.getInstance(); System.out.println(calendar.getTime()); calendar.set(Calendar.DAY_OF_MONTH, 1); //å°†å½“å‰æ—¶é—´è®¾ç½®æˆæŸä¸ªæ—¶é—´ System.out.println(calendar.get(Calendar.DAY_OF_MONTH)); System.out.println(calendar.getTime()); add(int field, int amount)æ–¹æ³• Calendar calendar = Calendar.getInstance(); System.out.println(calendar.getTime()); //Wed Jun 28 16:04:30 CST 2023 // ç»™å½“å‰æ—¶é—´åŠ ä¸Š 5 å¤© calendar.add(Calendar.DAY_OF_MONTH, +5); System.out.println(calendar.getTime()); //Mon Jul 03 16:04:30 CST 2023 // ç»™å½“å‰æ—¶é—´åŠ ä¸Š 2 æœˆ calendar.add(Calendar.MONTH, 2); System.out.println(calendar.getTime()); //Sun Sep 03 16:04:30 CST 2023 // ç»™å½“å‰æ—¶é—´å‡å» 3 å¤© calendar.add(Calendar.DAY_OF_MONTH, -3); System.out.println(calendar.getTime()); //Thu Aug 31 16:04:30 CST 2023 setTime(Date date) æ–¹æ³• æºç  public final void setTime(Date date) &#123; setTimeInMillis(date.getTime()); &#125; å››ã€java.time APIjava.time API èƒŒæ™¯java.util.Dateã€java.util.Calendar é¢ä¸´çš„é—®é¢˜ï¼š 1.å¯å˜æ€§ï¼šåƒæ—¥æœŸã€æ—¶é—´è¿™æ ·çš„ç±»åº”è¯¥æ˜¯ä¸å¯å˜çš„ 2.åç§»æ€§ï¼šDate ä¸­çš„å¹´ä»½æ˜¯ä» 1900 å¹´å¼€å§‹çš„ï¼›æœˆä»½æ˜¯ä» 0 å¼€å§‹çš„ 3.æ ¼å¼åŒ–ï¼šæ ¼å¼åŒ–åªå¯¹ Date æœ‰ç”¨ï¼Œè€Œå¯¹ Calendar åˆ™ä¸è¡Œ 4.çº¿ç¨‹å®‰å…¨ï¼šå®ƒä»¬éƒ½ä¸æ˜¯çº¿ç¨‹å®‰å…¨ java.time ä¸­åŒ…å«äº†ï¼š LocalDateï¼šæœ¬åœ°æ—¥æœŸã€‚yyyy-MM-dd æ ¼å¼çš„æ—¥æœŸã€‚å¯ä»¥å­˜å‚¨ç”Ÿæ—¥ã€çºªå¿µæ—¥ç­‰ LocalTimeï¼šæœ¬åœ°æ—¶é—´ã€‚ä»£è¡¨çš„æ˜¯æ—¶é—´ï¼Œä¸æ˜¯æ—¥æœŸ LocalDateTimeï¼šæœ¬åœ°æ—¥æœŸæ—¶é—´ ZonedDateTimeï¼šæ—¶åŒº Durationï¼šæŒç»­æ—¶é—´ å¤§å¤§åœ°ç®€åŒ–äº†å¯¹æ—¥æœŸã€æ—¶é—´çš„æ“ä½œ java.time API ä¸­å¸¸ç”¨çš„ API now()ï¼šè·å–å½“å‰æ—¶é—´ã€æ—¥æœŸ of()ï¼šè·å–æŒ‡å®šçš„æ—¥æœŸã€æ—¶é—´ getXxx()ï¼šè·å–å€¼ withXxx()ï¼šè®¾ç½®å€¼ plusXxx()ï¼šåŠ  minusXxx()ï¼šå‡ now() è·å–å½“å‰æ—¥æœŸ LocalDate localDate = LocalDate.now(); LocalTime localTime = LocalTime.now(); LocalDateTime localDateTime = LocalDateTime.now(); System.out.println(localDate);//2023-06-28 System.out.println(localTime);//16:17:21.720 System.out.println(localDateTime);//2023-06-28T16:17:21.720 localDateï¼šè¡¨ç¤ºå½“å‰çš„æ—¥æœŸlocalTimeï¼šè¡¨ç¤ºå½“å‰çš„æ—¶é—´localDateTimeï¼šè¡¨ç¤ºå½“å‰çš„æ—¥æœŸæ—¶é—´ of() æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„æ—¥æœŸ //ç»™å‡ºæ—¶é—´å‚æ•°ï¼Œè¡¨ç¤ºå‡ºæ—¥æœŸå’Œæ—¶é—´ å†ç”ŸæˆlocalDateTimeå¯¹è±¡è¿”å› public static LocalDateTime of(int year, Month month, int dayOfMonth, int hour, int minute) &#123; LocalDate date = LocalDate.of(year, month, dayOfMonth); LocalTime time = LocalTime.of(hour, minute); return new LocalDateTime(date, time); &#125; LocalDateTime localDateTime = LocalDateTime.of(2035,10,1,10,00); System.out.println(localDateTime); //2035-10-01T10:00 getXxx() withXxx() æ¯æ¬¡ä¿®æ”¹ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œéƒ¨åˆ†æºç å¦‚ä¸‹ã€‚ private LocalDateTime with(LocalDate newDate, LocalTime newTime) &#123; ... return new LocalDateTime(newDate, newTime); &#125; LocalDateTime localDateTime = LocalDateTime.now(); System.out.println(localDateTime); //2023-06-28T16:35:38.764 LocalDateTime dayOfMonth = localDateTime.withDayOfMonth(25); System.out.println(dayOfMonth); //2023-06-25T16:35:38.764 plusXxx() è¯¥æ–¹æ³•æ¯æ¬¡è°ƒç”¨è¿”å›æ—¶è°ƒç”¨withXxx()æ–¹æ³•ï¼Œå› æ­¤æ¯æ¬¡ä¿®æ”¹ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªæ–°å¯¹è±¡ã€‚ LocalDateTime localDateTime = LocalDateTime.now(); System.out.println(localDateTime); //2023-06-28T16:38:55.066 LocalDateTime localDateTime1 = localDateTime.plusDays(2); System.out.println(localDateTime1); //2023-06-30T16:38:55.066 LocalDateTime localDateTime2 = localDateTime.plusMonths(-1); System.out.println(localDateTime2); //2023-05-28T16:38:55.066 minusXxx() è°ƒç”¨plusXxx()æŠŠä¼ å…¥çš„å€¼å–åã€‚ public LocalDateTime minusDays(long days) &#123; return (days == Long.MIN_VALUE ? plusDays(Long.MAX_VALUE).plusDays(1) : plusDays(-days)); &#125; äº”ã€java.time.format.DateTimeFormatterjava.time.format.DateTimeFormatterï¼šæ ¼å¼åŒ–ã€è§£ææ—¥æœŸæˆ–æ—¶é—´ï¼ˆç±»ä¼¼äºï¼šSimpleDateFormatï¼‰ æ­¤ç±»æä¾›äº†ä¸‰ç§æ ¼å¼åŒ–æ–¹æ³•ï¼š é¢„å®šä¹‰çš„æ ‡å‡†æ ¼å¼ï¼šISO_LOCAL_DATE_TIMEâ€¦ æœ¬åœ°åŒ–ç›¸å…³çš„æ ¼å¼ï¼š è‡ªå®šä¹‰æ ¼å¼ï¼šofPattern(â€œyyyy-MM-dd HH:mm:ssâ€) LocalDateTime localDateTime = LocalDateTime.now(); System.out.println(localDateTime); //2023-06-28T16:50:06.649 DateTimeFormatter dtf=DateTimeFormatter.ofPattern(\"yyyy/MM/dd HH:mm:ss\"); System.out.println(dtf.format(localDateTime)); //2023/06/28 16:50:06 å…­ã€java.time.InstantInstantï¼šæ—¶é—´çº¿ä¸Šçš„ä¸€ä¸ªç¬æ—¶ç‚¹ã€‚ åœ¨UNIXä¸­ï¼Œè¿™ä¸ªæ•°ä»1970å¹´å¼€å§‹ï¼Œä»¥ç§’ä¸ºçš„å•ä½ï¼›åŒæ ·çš„ï¼Œåœ¨Javaä¸­ï¼Œä¹Ÿæ˜¯ä»1970å¹´å¼€å§‹ï¼Œä½†ä»¥æ¯«ç§’ä¸ºå•ä½ã€‚java.timeåŒ…é€šè¿‡å€¼ç±»å‹Instantæä¾›æœºå™¨è§†å›¾ï¼Œä¸æä¾›å¤„ç†äººç±»æ„ä¹‰ä¸Šçš„æ—¶é—´å•ä½ã€‚ Instantè¡¨ç¤ºæ—¶é—´çº¿ä¸Šçš„ä¸€ç‚¹ï¼Œè€Œä¸éœ€è¦ä»»ä½•ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œæ—¶åŒºã€‚æ¦‚å¿µä¸Šè®²ï¼Œ å®ƒåªæ˜¯ç®€å•çš„è¡¨ç¤ºè‡ª1970å¹´1æœˆ1æ—¥0æ—¶0åˆ†0ç§’ï¼ˆ UTCï¼‰å¼€å§‹çš„ç§’æ•°ã€‚ å› ä¸ºjava.timeåŒ…æ˜¯åŸºäºçº³ç§’è®¡ç®—çš„ï¼Œæ‰€ä»¥Instantçš„ç²¾åº¦å¯ä»¥è¾¾åˆ°çº³ç§’çº§ã€‚ æ–¹æ³• æè¿° now() é™æ€æ–¹æ³•ï¼Œ è¿”å›é»˜è®¤UTCæ—¶åŒºçš„Instantç±»çš„å¯¹è±¡ ofEpochMilli(long epochMilli) é™æ€æ–¹æ³•ï¼Œè¿”å›åœ¨ 1970-01-01 00:00:00åŸºç¡€ä¸ŠåŠ ä¸ŠæŒ‡å®šæ¯«ç§’æ•°ä¹‹åçš„Instant ç±»çš„å¯¹è±¡ atOffset(ZoneOffset offset) ç»“åˆå³æ—¶çš„åç§»æ¥åˆ›å»ºä¸€ä¸ª OffsetDateTime toEpochMilli() è¿”å›1970-01-01 00:00:00åˆ°å½“å‰æ—¶é—´çš„æ¯«ç§’æ•°ï¼Œ å³ä¸ºæ—¶é—´æˆ³ //now():è·å–æœ¬åˆå­åˆçº¿å¯¹åº”çš„æ ‡å‡†æ—¶é—´ï¼Œæ‰€ä»¥å’Œæˆ‘ä»¬å½“å‰çš„æ—¶é—´çº¦æœ‰8ä¸ªå°æ—¶çš„æ—¶å·®ã€‚ Instant now = Instant.now(); System.out.println(now);//2023-06-28T09:52:51.124Z //æ·»åŠ æ—¶é—´çš„åç§»é‡ OffsetDateTime offsetDateTime = now.atOffset(ZoneOffset.ofHours(8)); System.out.println(offsetDateTime);//2023-06-28T17:52:51.124+08:00 //toEpochMilli():è·å–è‡ª1970å¹´1æœˆ1æ—¥0æ—¶0åˆ†0ç§’ï¼ˆUTCï¼‰å¼€å§‹çš„æ¯«ç§’æ•° ---> Dateç±»çš„getTime() long milli = now.toEpochMilli(); System.out.println(milli);//1687945971124 //ofEpochMilli():é€šè¿‡ç»™å®šçš„æ¯«ç§’æ•°ï¼Œè·å–Instantå®ä¾‹ -->Date(long millis) Instant instant = Instant.ofEpochMilli(System.currentTimeMillis()); System.out.println(instant);//2023-06-28T09:52:51.131Z ä¸ƒã€java.time.temporal.TemporalJavaçš„Temporalç±»æ˜¯Java 8å¼•å…¥çš„æ—¥æœŸå’Œæ—¶é—´APIçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç”¨äºå¤„ç†å„ç§æ—¥æœŸå’Œæ—¶é—´å¯¹è±¡ã€‚ä¸‹é¢æ˜¯Temporalç±»çš„ä¸€äº›å¸¸ç”¨æ–¹æ³•ä»¥åŠå¯¹åº”çš„ä¾‹å­ï¼š of(TemporalField field, long value)ï¼šä½¿ç”¨æŒ‡å®šçš„å­—æ®µå’Œå€¼åˆ›å»ºä¸€ä¸ªTemporalå¯¹è±¡ã€‚ LocalDate date = LocalDate.of(2023, 6, 28); get(TemporalField field)ï¼šè·å–æŒ‡å®šå­—æ®µçš„å€¼ã€‚ int year = LocalDate.now().get(ChronoField.YEAR); with(TemporalField field, long newValue)ï¼šå°†æŒ‡å®šå­—æ®µçš„å€¼è®¾ç½®ä¸ºæ–°å€¼ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Temporalå¯¹è±¡ã€‚ LocalDate newDate = LocalDate.now().with(ChronoField.MONTH_OF_YEAR, 7); plus(TemporalAmount amountToAdd)ï¼šåœ¨å½“å‰Temporalå¯¹è±¡ä¸Šæ·»åŠ æŒ‡å®šçš„æ—¶é—´é‡ã€‚ LocalDateTime dateTime = LocalDateTime.now().plus(Duration.ofHours(2)); minus(TemporalAmount amountToSubtract)ï¼šåœ¨å½“å‰Temporalå¯¹è±¡ä¸Šå‡å»æŒ‡å®šçš„æ—¶é—´é‡ã€‚ LocalTime newTime = LocalTime.now().minus(Duration.ofMinutes(30)); isSupported(TemporalUnit unit)ï¼šæ£€æŸ¥æŒ‡å®šçš„æ—¶é—´å•ä½æ˜¯å¦æ”¯æŒã€‚ boolean isSupported = LocalDateTime.now().isSupported(ChronoUnit.DAYS); until(Temporal endExclusive, TemporalUnit unit)ï¼šè®¡ç®—å½“å‰Temporalå¯¹è±¡ä¸æŒ‡å®šTemporalå¯¹è±¡ä¹‹é—´çš„æ—¶é—´é—´éš”ã€‚ long daysBetween = LocalDate.of(2023, 12, 31).until(LocalDate.now(), ChronoUnit.DAYS); format(DateTimeFormatter formatter)ï¼šä½¿ç”¨æŒ‡å®šçš„æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–å™¨å°†Temporalå¯¹è±¡æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚ String formattedDate = LocalDate.now().format(DateTimeFormatter.ofPattern(\"dd-MM-yyyy\")); è¿™äº›åªæ˜¯Temporalç±»çš„ä¸€äº›å¸¸ç”¨æ–¹æ³•å’Œç¤ºä¾‹ã€‚Temporalç±»è¿˜æœ‰å…¶ä»–æ–¹æ³•ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚è¿›è¡ŒæŸ¥é˜…å’Œä½¿ç”¨ã€‚ æ¡ˆä¾‹åœ¨ Java 8 ä¸­è·å–å¹´ã€æœˆã€æ—¥ä¿¡æ¯//åœ¨ Java 8 ä¸­è·å–å¹´ã€æœˆã€æ—¥ä¿¡æ¯ LocalDateTime localDateTime = LocalDateTime.now(); System.out.println(localDateTime); //2023-06-28T16:56:25.874 int year = localDateTime.getYear(); System.out.println(year); //2023 Month month = localDateTime.getMonth(); System.out.println(month); //JUNE int day = localDateTime.getDayOfMonth(); System.out.println(day); //28 //æŸæ—¥æœŸ ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤© int dayOfYear = localDateTime.getDayOfYear(); System.out.println(dayOfYear); //179 åœ¨ Java 8 ä¸­å¤„ç†ç‰¹å®šæ—¥æœŸLocalDateTime dateTime = LocalDateTime.of(2023, 6, 28, 16, 0, 0); // 2023-06-28T16:00 System.out.println(dateTime); åœ¨ Java 8 ä¸­åˆ¤æ–­ä¸¤ä¸ªæ—¥æœŸæ˜¯å¦ç›¸ç­‰LocalDate localDate=LocalDate.now(); LocalDate nowDate=LocalDate.of(2023,6,28); System.out.println(localDate.equals(nowDate)); //true åœ¨ Java 8 ä¸­æ£€æŸ¥åƒç”Ÿæ—¥è¿™ç§å‘¨æœŸæ€§äº‹ä»¶LocalDate now = LocalDate.now(); LocalDate dateOfBirth = LocalDate.of(2001, 2, 17); MonthDay birthday = MonthDay.of(dateOfBirth.getMonth(), dateOfBirth.getDayOfMonth()); MonthDay currentMonthDay = MonthDay.from(now); if (currentMonthDay.equals(birthday)) &#123; System.out.println(\"Happy Birthday\"); &#125; else &#123; System.out.println(\"Sorry, today is not your birthday\"); &#125; //Sorry, today is not your birthday å¦‚ä½•è®¡ç®—ä¸€å‘¨åçš„æ—¥æœŸLocalDate æ—¥æœŸä¸åŒ…å«æ—¶é—´ä¿¡æ¯ï¼Œå®ƒçš„ plus() æ–¹æ³•ç”¨æ¥å¢åŠ å¤©ã€å‘¨ã€æœˆï¼ŒChronoUnit ç±»å£°æ˜äº†è¿™äº›æ—¶é—´å•ä½ã€‚ç”±äº LocalDate ä¹Ÿæ˜¯ä¸å˜ç±»å‹ï¼Œè¿”å›åä¸€å®šè¦ç”¨å˜é‡èµ‹å€¼ã€‚minus() æ–¹æ³•ç”¨æ¥å‡å»å¤©ã€å‘¨ã€æœˆç­‰ //1.8ä¹‹å‰çš„æ–¹æ³• //ä¸€å‘¨åçš„æ—¥æœŸ SimpleDateFormat formatDate = new SimpleDateFormat(\"yyyy-MM-dd\"); Calendar ca = Calendar.getInstance(); ca.add(Calendar.DATE, 7); Date d = ca.getTime(); String after0 = formatDate.format(d); System.out.println(\"ä¸€å‘¨åæ—¥æœŸï¼š\" + after0); //1.8ä¹‹åçš„æ–¹æ³• //ä¸€å‘¨åçš„æ—¥æœŸ LocalDate localDate = LocalDate.now(); //æ–¹æ³•1 LocalDate after = localDate.plus(1, ChronoUnit.WEEKS); //æ–¹æ³•2 LocalDate after2 = localDate.plusWeeks(1); System.out.println(\"ä¸€å‘¨åæ—¥æœŸï¼š\" + after); /** * ä¸€å‘¨åæ—¥æœŸï¼š2023-07-07 * ä¸€å‘¨åæ—¥æœŸï¼š2023-07-07 */ å¦‚ä½•ç”¨ Java åˆ¤æ–­æ—¥æœŸæˆ–æ—¶é—´æ˜¯æ—©äºè¿˜æ˜¯æ™šäºå¦ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´//æ—¥æœŸçš„æ¯”è¾ƒ LocalDate localDate=LocalDate.now(); System.out.println(localDate);//2023-06-28 LocalDate dateTime = LocalDate.of(2023, 6, 29); boolean before = dateTime.isBefore(localDate); System.out.println(before); boolean after = dateTime.isAfter(localDate); System.out.println(after); //æ—¶é—´çš„æ¯”è¾ƒ LocalTime localTime=LocalTime.now(); System.out.println(localTime);//17:13:12.341 LocalTime time = LocalTime.of(19, 00, 00); boolean timeAfter = localTime.isAfter(time); System.out.println(timeAfter); boolean timeBefore = localTime.isBefore(time); System.out.println(timeBefore); å¦‚ä½•è¡¨ç¤ºä¿¡ç”¨å¡åˆ°æœŸè¿™ç±»å›ºå®šæ—¥æœŸYearMonth currentYearMonth = YearMonth.now(); System.out.printf(\"Days in month year %s has %d days %n\", currentYearMonth, currentYearMonth.lengthOfMonth()); //Days in month year 2023-06 has 30 days //è¿”å›åˆ°æœŸæ—¥æœŸ YearMonth creditCardExpiry = YearMonth.of(2023, Month.OCTOBER); System.out.printf(\"Your credit card expires on %s %n\", creditCardExpiry); //Your credit card expires on 2023-10 //è¿”å›æœˆåº•çš„æœ¬åœ°æ—¥æœŸ System.out.println(currentYearMonth.atEndOfMonth()); //2023-06-30 //è·å–æœ‰å¤šå°‘æœˆä»½ System.out.println(currentYearMonth.lengthOfMonth()); //30 è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°å’Œæœˆæ•°1.8ä¹‹å‰ //ç®—ä¸¤ä¸ªæ—¥æœŸé—´éš”å¤šå°‘å¤©ï¼Œè®¡ç®—é—´éš”å¤šå°‘å¹´ï¼Œå¤šå°‘æœˆæ–¹æ³•ç±»ä¼¼ String dates1 = \"2023-12-23\"; String dates2 = \"2023-02-26\"; SimpleDateFormat format = new SimpleDateFormat(\"yyyy-MM-dd\"); Date date1 = format.parse(dates1); Date date2 = format.parse(dates2); int day = (int) ((date1.getTime() - date2.getTime()) / (1000 * 3600 * 24)); System.out.println(dates1 + \"å’Œ\" + dates2 + \"ç›¸å·®\" + day + \"å¤©\"); //2023-12-23å’Œ2023-02-26ç›¸å·®300å¤© 1.8ä¹‹å ç”¨ java.time.Period ç±»æ¥åšè®¡ç®— LocalDate now = LocalDate.now(); LocalDate date = LocalDate.of(2025, Month.JUNE, 5); //è®¡ç®—ä¸¤æ—¥æœŸé—´ç›¸å·®å¤šå°‘å¤© long day = Math.abs(now.toEpochDay() - date.toEpochDay()); System.out.println(now + \"å’Œ\" + date + \"ç›¸å·®\" + day + \"å¤©\"); System.out.println(\"====================\"); Period period = Period.between(now, date); //è‹¥ç¬¬ä¸€ä¸ªæ—¥æœŸæ™šäºç¬¬äºŒä¸ªæ—¥æœŸ åˆ™è¿”å›æ—©æ—¥æœŸè·è¾ƒæ™šæ—¥æœŸçš„å¤©æ•° //è¿™é‡Œperiod.getDays()å¾—åˆ°çš„å¤©æ˜¯æŠ›å»å¹´æœˆä»¥å¤–çš„å¤©æ•°ï¼Œå¹¶ä¸æ˜¯æ€»å¤©æ•° //æœˆæ˜¯æŠ›å»å¹´ä»¥å¤–çš„æœˆæ•° System.out.printf(\"ç¦»ä¸‹ä¸ªæ—¶é—´è¿˜æœ‰ %så¹´,%sæœˆ,%så¤©\", period.getYears() ,period.getMonths(),period.getDays()); è®¡ç®—ä¸¤æ—¥æœŸé—´ç›¸å·®çš„æœˆä»½ ChronoUnit.MONTHS.between(temporal1, temporal2)æœ¬è´¨ä¸Šæ˜¯è°ƒç”¨Temporalçš„utilæ–¹æ³•ã€‚ Temporal temporal1 = LocalDate.parse(\"2023-06-10\", DateTimeFormatter.ofPattern(\"yyyy-MM-dd\")); Temporal temporal2 = LocalDate.now(); //æ–¹æ³•è¿”å›ä¸ºç›¸å·®æœˆä»½ long monthsDifference = ChronoUnit.MONTHS.between(temporal1, temporal2); //æœˆä»½å·®è½¬ä¸ºæ­£æ•° monthsDifference = Math.abs(monthsDifference); if (monthsDifference == 0) &#123; System.out.println(\"å½“æœˆä¸ºå®½å¸¦æœ€åä¸€ä¸ªæœˆ\"); &#125; else if (monthsDifference == 1) &#123; System.out.println(\"ä¸‹æœˆä¸ºå®½å¸¦æœ€åä¸€ä¸ªæœˆ\"); &#125; else &#123; System.out.println(\"å®½å¸¦è¿˜æœ‰æ›´å¤šæ—¶é—´\"); &#125; å¯ä»¥è®¡ç®—ä¸¤æ—¥æœŸé—´ç›¸å·®çš„å¤©æ•°ï¼Œä½†è¦æ³¨æ„ä¸¤æ—¥æœŸ Temporal temporal1 = LocalDate.parse(\"2023-06-10\", DateTimeFormatter.ofPattern(\"yyyy-MM-dd\")); Temporal temporal2 = LocalDate.now(); long daysDifference = ChronoUnit.DAYS.between(temporal1, temporal2); daysDifference = Math.abs(daysDifference); System.out.println(daysDifference); //18 è·å–æŒ‡å®šæ—¥æœŸJava 8 ä¹‹å‰: public void getDay() &#123; SimpleDateFormat format = new SimpleDateFormat(\"yyyy-MM-dd\"); //è·å–å½“å‰æœˆç¬¬ä¸€å¤©ï¼š Calendar c = Calendar.getInstance(); c.set(Calendar.DAY_OF_MONTH, 1); String first = format.format(c.getTime()); System.out.println(\"first day:\" + first); //è·å–å½“å‰æœˆæœ€åä¸€å¤© Calendar ca = Calendar.getInstance(); ca.set(Calendar.DAY_OF_MONTH, ca.getActualMaximum(Calendar.DAY_OF_MONTH)); String last = format.format(ca.getTime()); System.out.println(\"last day:\" + last); //å½“å¹´æœ€åä¸€å¤© Calendar currCal = Calendar.getInstance(); Calendar calendar = Calendar.getInstance(); calendar.clear(); calendar.set(Calendar.YEAR, currCal.get(Calendar.YEAR)); calendar.roll(Calendar.DAY_OF_YEAR, -1); Date time = calendar.getTime(); System.out.println(\"last day:\" + format.format(time)); &#125; Java 8 ä¹‹å: LocalDate today = LocalDate.now(); //è·å–å½“å‰æœˆç¬¬ä¸€å¤©ï¼š LocalDate firstDayOfThisMonth = today.with(TemporalAdjusters.firstDayOfMonth()); // å–æœ¬æœˆæœ€åä¸€å¤© LocalDate lastDayOfThisMonth = today.with(TemporalAdjusters.lastDayOfMonth()); //ä¸‹ä¸€ä¸ªæœˆçš„ç¬¬ä¸€å¤© LocalDate firstDayOfNextMonth = today.with(TemporalAdjusters.firstDayOfNextMonth()); //å–ä¸‹ä¸€å¤©ï¼š LocalDate nextDay = lastDayOfThisMonth.plusDays(1); LocalDate nextDay1 = lastDayOfThisMonth.plus(1,ChronoUnit.DAYS); //å½“å¹´çš„ç¬¬ä¸€å¤© LocalDate firstDayOfYear = today.with(TemporalAdjusters.firstDayOfYear()); //å½“å¹´æœ€åä¸€å¤© LocalDate lastday = today.with(TemporalAdjusters.lastDayOfYear()); //ä¸‹ä¸€å¹´çš„ç¬¬ä¸€å¤© LocalDate firstDayOfNextYear = today.with(TemporalAdjusters.firstDayOfNextYear()); //2021å¹´æœ€åä¸€ä¸ªå‘¨æ—¥ï¼Œå¦‚æœç”¨Calendaræ˜¯ä¸å¾—çƒ¦æ­»ã€‚ LocalDate lastMondayOf2021 = LocalDate.parse(\"2024-6-30\").with(TemporalAdjusters.lastInMonth(DayOfWeek.SUNDAY)); è·å–æŒ‡å®šæ—¥æœŸçš„0ç‚¹ä»¥åŠ24ç‚¹// è¿”å›æ—¶é—´æ ¼å¼å¦‚ï¼š2020-02-17 00:00:00 public static String getStartOfDay(Date time) &#123; Calendar calendar = Calendar.getInstance(); calendar.setTime(time); calendar.set(Calendar.HOUR_OF_DAY, 0); calendar.set(Calendar.MINUTE, 0); calendar.set(Calendar.SECOND, 0); calendar.set(Calendar.MILLISECOND, 0); return new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\").format(calendar.getTime()); &#125; // è¿”å›æ—¶é—´æ ¼å¼å¦‚ï¼š2020-02-19 23:59:59 public static String getEndOfDay(Date time) &#123; Calendar calendar = Calendar.getInstance(); calendar.setTime(time); calendar.set(Calendar.HOUR_OF_DAY, 23); calendar.set(Calendar.MINUTE, 59); calendar.set(Calendar.SECOND, 59); calendar.set(Calendar.MILLISECOND, 999); return new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\").format(calendar.getTime()); &#125; // è·å–30å¤©ä»¥å‰çš„æ—¶é—´ï¼ŒåŒæ ·æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ public static String getThirtyDaysAgo(Date time) &#123; Calendar calendar = Calendar.getInstance(); calendar.setTime(time); calendar.add(calendar.DATE, -30); calendar.set(Calendar.HOUR_OF_DAY, 0); calendar.set(Calendar.MINUTE, 0); calendar.set(Calendar.SECOND, 0); calendar.set(Calendar.MILLISECOND, 0); return new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\").format(calendar.getTime()); &#125; // è·å¾—æŸå¤©æœ€å¤§æ—¶é—´ 2020-02-19 23:59:59 public static Date getEndOfDay(Date date) &#123; LocalDateTime localDateTime = LocalDateTime.ofInstant(Instant.ofEpochMilli(date.getTime()), ZoneId.systemDefault());; LocalDateTime endOfDay = localDateTime.with(LocalTime.MAX); return Date.from(endOfDay.atZone(ZoneId.systemDefault()).toInstant()); &#125; // è·å¾—æŸå¤©æœ€å°æ—¶é—´ 2020-02-17 00:00:00 public static Date getStartOfDay(Date date) &#123; LocalDateTime localDateTime = LocalDateTime.ofInstant(Instant.ofEpochMilli(date.getTime()), ZoneId.systemDefault()); LocalDateTime startOfDay = localDateTime.with(LocalTime.MIN); return Date.from(startOfDay.atZone(ZoneId.systemDefault()).toInstant()); &#125; Date now &#x3D; new Date(); &#x2F;&#x2F;è·å–å½“å‰æ—¶é—´ SimpleDateFormat sdf &#x3D; new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); String nowStr &#x3D; sdf.format(now)+&quot; 00:00:00&quot;; &#x2F;&#x2F;å¾—åˆ°ä»Šå¤©å‡Œæ™¨æ—¶é—´ Calendar calendar &#x3D; Calendar.getInstance(); calendar.setTime(now); calendar.add(Calendar.DAY_OF_MONTH, +1);&#x2F;&#x2F;+1ä»Šå¤©çš„æ—¶é—´åŠ ä¸€å¤© String tomorrow &#x3D; sdf.format(calendar.getTime())+&quot; 00:00:00&quot;; &#x2F;&#x2F;å¾—åˆ°æ˜å¤©å‡Œæ™¨çš„æ—¶é—´","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"}],"author":"ehzyil"},{"title":"Java8ç‰¹æ€§","slug":"2023/Java8ç‰¹æ€§","date":"2023-10-09T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/09/2023/Java8ç‰¹æ€§/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/09/2023/Java8%E7%89%B9%E6%80%A7/","excerpt":"","text":"functional interface å‡½æ•°å¼æ¥å£å‡½æ•°å¼æ¥å£ä»‹ç»å®šä¹‰ï¼šä¹Ÿç§° SAM æ¥å£ï¼Œå³ Single Abstract Method interfacesï¼Œæœ‰ä¸”åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä½†å¯ä»¥æœ‰å¤šä¸ªéæŠ½è±¡æ–¹æ³•çš„æ¥å£ã€‚ åœ¨ java 8 ä¸­ä¸“é—¨æœ‰ä¸€ä¸ªåŒ…æ”¾å‡½æ•°å¼æ¥å£java.util.functionï¼Œè¯¥åŒ…ä¸‹çš„æ‰€æœ‰æ¥å£éƒ½æœ‰ @FunctionalInterface æ³¨è§£ï¼Œæä¾›å‡½æ•°å¼ç¼–ç¨‹ã€‚ åœ¨å…¶ä»–åŒ…ä¸­ä¹Ÿæœ‰å‡½æ•°å¼æ¥å£ï¼Œå…¶ä¸­ä¸€äº›æ²¡æœ‰@FunctionalInterface æ³¨è§£ï¼Œä½†æ˜¯åªè¦ç¬¦åˆå‡½æ•°å¼æ¥å£çš„å®šä¹‰å°±æ˜¯å‡½æ•°å¼æ¥å£ï¼Œä¸æ˜¯å¦æœ‰@FunctionalInterfaceæ³¨è§£æ— å…³ï¼Œæ³¨è§£åªæ˜¯åœ¨ç¼–è¯‘æ—¶èµ·åˆ°å¼ºåˆ¶è§„èŒƒå®šä¹‰çš„ä½œç”¨ã€‚å…¶åœ¨ Lambda è¡¨è¾¾å¼ä¸­æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚ Javaå†…ç½®çš„å‡½æ•°å¼æ¥å£ä»‹ç»åŠä½¿ç”¨ä¸¾ä¾‹ å‡½æ•°å¼æ¥å£ å‚æ•°ç±»å‹ è¿”å›ç±»å‹ ç”¨é€” Consumer æ¶ˆè´¹å‹æ¥å£ T void å¯¹ç±»å‹ä¸ºTçš„å¯¹è±¡åº”ç”¨æ“ä½œï¼ŒåŒ…å«æ–¹æ³•ï¼švoid accept(T t) Supplier ä¾›ç»™å‹æ¥å£ æ—  T è¿”å›ç±»å‹ä¸ºTçš„å¯¹è±¡ï¼ŒåŒ…å«æ–¹æ³•ï¼šT get() Functionå‡½æ•°å‹æ¥å£ T R å¯¹ç±»å‹ä¸ºTçš„å¯¹è±¡åº”ç”¨æ“ä½œï¼Œå¹¶è¿”å›ç»“æœã€‚ç»“æœæ˜¯Rç±»å‹çš„å¯¹è±¡ã€‚åŒ…å«æ–¹æ³•ï¼šR apply(T t) Predicateæ–­å®šå‹æ¥å£ T boolean ç¡®å®šç±»å‹ä¸ºTçš„å¯¹è±¡æ˜¯å¦æ»¡è¶³æŸçº¦æŸï¼Œå¹¶è¿”å›boolean å€¼ã€‚åŒ…å«æ–¹æ³•ï¼šboolean test(T t) BiFunction T, U R å¯¹ç±»å‹ä¸ºT,Uå‚æ•°åº”ç”¨æ“ä½œï¼Œè¿”å›Rç±»å‹çš„ç»“æœã€‚åŒ…å«æ–¹æ³•ä¸ºï¼šRapply(T t,U u); UnaryOperator(Functionå­æ¥å£) T T å¯¹ç±»å‹ä¸ºTçš„å¯¹è±¡è¿›è¡Œä¸€å…ƒè¿ç®—ï¼Œå¹¶è¿”å›Tç±»å‹çš„ç»“æœã€‚åŒ…å«æ–¹æ³•ä¸ºï¼šTapply(T t); BinaryOperator(BiFunctionå­æ¥å£) T,T T å¯¹ç±»å‹ä¸ºTçš„å¯¹è±¡è¿›è¡ŒäºŒå…ƒè¿ç®—ï¼Œå¹¶è¿”å›Tç±»å‹çš„ç»“æœã€‚åŒ…å«æ–¹æ³•ä¸ºï¼šTapply(T t1,T t2); BiConsumer T,U void å¯¹ç±»å‹ä¸ºT,Uå‚æ•°åº”ç”¨æ“ä½œã€‚åŒ…å«æ–¹æ³•ä¸ºï¼švoidaccept(Tt,Uu) BiPredicate T,U boolean åŒ…å«æ–¹æ³•ä¸ºï¼šbooleantest(Tt,Uu) ToIntFunction T int è®¡ç®—intå€¼çš„å‡½æ•° ToLongFunction T long è®¡ç®—longå€¼çš„å‡½æ•° ToDoubleFunction T double è®¡ç®—doubleå€¼çš„å‡½æ•° IntFunction int R å‚æ•°ä¸ºintç±»å‹çš„å‡½æ•° LongFunction long R å‚æ•°ä¸ºlongç±»å‹çš„å‡½æ•° DoubleFunction double R å‚æ•°ä¸ºdoubleç±»å‹çš„å‡½æ•° æ¶ˆè´¹å‹æ¥å£ä½¿ç”¨ä¸¾ä¾‹ //æ¶ˆè´¹å‹æ¥å£ä½¿ç”¨ä¸¾ä¾‹ public void happyTime(double money, Consumer&lt;Double> consumer) &#123; consumer.accept(money); &#125; @org.junit.jupiter.api.Test public void test() &#123; //1. ä»¥å‰çš„å†™æ³• happyTime(1234, new Consumer&lt;Double>() &#123; @Override public void accept(Double money) &#123; System.out.println(\"çªç„¶æƒ³å›ä¸€è¶Ÿæˆéƒ½äº†ï¼Œæœºç¥¨èŠ±è´¹\" + money); &#125; &#125;); System.out.println(\"------------------------\"); //2. Lambdaè¡¨è¾¾å¼ï¼Œå°†ä¹‹å‰çš„6è¡Œä»£ç å‹ç¼©åˆ°äº†1è¡Œ happyTime(648, money -> System.out.println(\"å­¦ä¹ å¤ªç´¯äº†ï¼Œå¥–åŠ±è‡ªå·±ä¸€å‘åè¿ï¼ŒèŠ±è´¹\" + money)); &#125; /** * çªç„¶æƒ³å›ä¸€è¶Ÿæˆéƒ½äº†ï¼Œæœºç¥¨èŠ±è´¹1234.0 * ------------------------ * å­¦ä¹ å¤ªç´¯äº†ï¼Œå¥–åŠ±è‡ªå·±ä¸€å‘åè¿ï¼ŒèŠ±è´¹648.0 */ æ ¹æ®ç»™å®šçš„è§„åˆ™ï¼Œè¿‡æ»¤é›†åˆä¸­çš„å­—ç¬¦ä¸²ã€‚æ­¤è§„åˆ™ç”±Predicateçš„æ–¹æ³•å†³å®š //æ ¹æ®ç»™å®šçš„è§„åˆ™ï¼Œè¿‡æ»¤é›†åˆä¸­çš„å­—ç¬¦ä¸²ã€‚æ­¤è§„åˆ™ç”±Predicateçš„æ–¹æ³•å†³å®š public List&lt;String> filterString(List&lt;String> strings, Predicate&lt;String> predicate) &#123; ArrayList&lt;String> res = new ArrayList&lt;>(); for (String string : strings) &#123; if (predicate.test(string)) res.add(string); &#125; return res; &#125; @org.junit.jupiter.api.Test public void test2() &#123; List&lt;String> strings = Arrays.asList(\"ä¸œäº¬\", \"è¥¿äº¬\", \"å—äº¬\", \"åŒ—äº¬\", \"å¤©æ´¥\", \"ä¸­äº¬\"); //1. ä»¥å‰çš„å†™æ³• List&lt;String> list = filterString(strings, new Predicate&lt;String>() &#123; @Override public boolean test(String s) &#123; return s.contains(\"äº¬\"); &#125; &#125;); System.out.println(list); System.out.println(\"------------------------\"); //2. ç°åœ¨çš„å†™æ³•ï¼Œå‡½æ•°å¼æ¥å£ List&lt;String> list1 = filterString(strings, s -> s.contains(\"äº¬\")); System.out.println(list1); &#125; Lambdaè¡¨è¾¾å¼ Lambdaæ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠLambdaè¡¨è¾¾å¼ç†è§£ä¸ºæ˜¯ä¸€æ®µå¯ä»¥ä¼ é€’çš„ä»£ç ï¼ˆå°†ä»£ç åƒæ•°æ®ä¸€æ ·è¿›è¡Œä¼ é€’ï¼‰ã€‚ ä½¿ç”¨å®ƒå¯ä»¥å†™å‡ºæ›´ç®€æ´ã€æ›´çµæ´»çš„ä»£ç ã€‚ä½œä¸ºä¸€ç§æ›´ç´§å‡‘çš„ä»£ç é£æ ¼ï¼Œæ˜¯Javaçš„è¯­è¨€è¡¨è¾¾èƒ½åŠ›å¾—åˆ°äº†æå‡ Lambdaè¡¨è¾¾å¼ä½¿ç”¨ä¸¾ä¾‹ ä¸¾ä¾‹ä¸€ @Test public void test01()&#123; &#x2F;&#x2F;1. ä»¥å‰çš„å†™æ³• Runnable runnable01 &#x3D; new Runnable() &#123; @Override public void run() &#123; System.out.println(&quot;ä½  çš„ åŸ å¸‚ å¥½ åƒ ä¸ æ¬¢ è¿ æˆ‘&quot;); &#125; &#125;; runnable01.run(); System.out.println(&quot;------------------------&quot;); &#x2F;&#x2F;2. Lambdaè¡¨è¾¾å¼ Runnable runnable02 &#x3D; () -&gt; System.out.println(&quot;æ‰€ ä»¥ æˆ‘ åª å¥½ è½¬ èº« ç¦» å¼€ äº†&quot;); runnable02.run(); &#125; ä¸¾ä¾‹äºŒ @Test public void test02()&#123; &#x2F;&#x2F;1. ä»¥å‰çš„å†™æ³• Comparator&lt;Integer&gt; comparator01 &#x3D; new Comparator&lt;Integer&gt;() &#123; @Override public int compare(Integer o1, Integer o2) &#123; return o1.compareTo(o2); &#125; &#125;; System.out.println(comparator01.compare(95, 27)); System.out.println(&quot;------------------------&quot;); &#x2F;&#x2F;2. Lambdaè¡¨è¾¾å¼ Comparator&lt;Integer&gt; comparator02 &#x3D; (o1,o2) -&gt; o1.compareTo(o2); System.out.println(comparator02.compare(12, 21)); System.out.println(&quot;------------------------&quot;); &#x2F;&#x2F;3. æ–¹æ³•å¼•ç”¨ Comparator&lt;Integer&gt; comparator03 &#x3D; Integer::compareTo; System.out.println(comparator03.compare(20, 77)); &#125; Lambdaè¡¨è¾¾å¼è¯­æ³•çš„ä½¿ç”¨ ä¸¾ä¾‹ï¼š (o1,o2) -&gt; Integer.compare(o1,o2); æ ¼å¼ï¼š -&gt;ï¼šlambdaæ“ä½œç¬¦æˆ–ç®­å¤´æ“ä½œç¬¦ -&gt;å·¦è¾¹ï¼šlambdaå½¢å‚åˆ—è¡¨ï¼ˆå…¶å®å°±æ˜¯æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•çš„å½¢å‚åˆ—è¡¨ï¼‰ -&gt;å³è¾¹ï¼šlambdaä½“ï¼ˆå…¶å®å°±æ˜¯é‡å†™çš„æŠ½è±¡æ–¹æ³•çš„æ–¹æ³•ä½“ï¼‰ Lambdaè¡¨è¾¾å¼çš„ä½¿ç”¨ï¼šï¼ˆåˆ†ä¸º6ç§æƒ…å†µä»‹ç»ï¼‰ è¯­æ³•æ ¼å¼ä¸€ï¼šæ— å‚æ— è¿”å›å€¼ @Test public void test01()&#123; &#x2F;&#x2F;1. ä»¥å‰çš„å†™æ³• Runnable runnable01 &#x3D; new Runnable() &#123; @Override public void run() &#123; System.out.println(&quot;ä½  çš„ åŸ å¸‚ å¥½ åƒ ä¸ æ¬¢ è¿ æˆ‘&quot;); &#125; &#125;; runnable01.run(); System.out.println(&quot;-------------------------&quot;); &#x2F;&#x2F;2. Lambdaè¡¨è¾¾å¼ Runnable runnable02 &#x3D; () -&gt; System.out.println(&quot;æ‰€ ä»¥ æˆ‘ åª å¥½ è½¬ èº« ç¦» å¼€ äº†&quot;); runnable02.run(); &#125; è¯­æ³•æ ¼å¼äºŒï¼šLambdaéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›å€¼ @Test public void test03()&#123; &#x2F;&#x2F;1. ä»¥å‰çš„å†™æ³• Consumer&lt;String&gt; consumer01 &#x3D; new Consumer&lt;String&gt;() &#123; @Override public void accept(String s) &#123; System.out.println(s); &#125; &#125;; consumer01.accept(&quot;å…¶å®æˆ‘å­˜è¿‡ä½ ç…§ç‰‡ ä¹Ÿç ”ç©¶è¿‡ä½ çš„æ˜Ÿåº§&quot;); System.out.println(&quot;-------------------------&quot;); &#x2F;&#x2F;2. Lambdaè¡¨è¾¾å¼ Consumer&lt;String&gt; consumer02 &#x3D; (String s) -&gt; &#123;System.out.println(s);&#125;; consumer02.accept(&quot;ä½ å–œæ¬¢çš„æ­Œæˆ‘ä¹Ÿä¼šå»å¬ ä½ å–œæ¬¢çš„äº‹ç‰©æˆ‘ä¹Ÿä¼šæƒ³å»äº†è§£&quot;); &#125; è¯­æ³•æ ¼å¼ä¸‰ï¼š æ•°æ®ç±»å‹å¯ä»¥çœç•¥ï¼Œå› ä¸ºå¯ç”±ç±»å‹æ¨æ–­å¾—å‡º @Test public void test04()&#123; &#x2F;&#x2F;1. ä»¥å‰çš„å†™æ³• Consumer&lt;String&gt; consumer01 &#x3D; new Consumer&lt;String&gt;() &#123; @Override public void accept(String s) &#123; System.out.println(s); &#125; &#125;; consumer01.accept(&quot;æˆ‘è¿œæ¯”è¡¨é¢ä¸Šæ›´å–œæ¬¢ä½ &quot;); System.out.println(&quot;-------------------------&quot;); &#x2F;&#x2F;2. Lambdaè¡¨è¾¾å¼ Consumer&lt;String&gt; consumer02 &#x3D; (s) -&gt; &#123;System.out.println(s);&#125;; consumer02.accept(&quot;ä½†æˆ‘æ²¡æœ‰è¯´&quot;); &#125; è¯­æ³•æ ¼å¼å››ï¼š Lambdaè‹¥åªéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œå‚æ•°çš„å°æ‹¬å·å¯ä»¥çœç•¥ @Test public void test04()&#123; &#x2F;&#x2F;1. ä»¥å‰çš„å†™æ³• Consumer&lt;String&gt; consumer01 &#x3D; new Consumer&lt;String&gt;() &#123; @Override public void accept(String s) &#123; System.out.println(s); &#125; &#125;; consumer01.accept(&quot;æˆ‘è¿œæ¯”è¡¨é¢ä¸Šæ›´å–œæ¬¢ä½ &quot;); System.out.println(&quot;-------------------------&quot;); &#x2F;&#x2F;2. Lambdaè¡¨è¾¾å¼ Consumer&lt;String&gt; consumer02 &#x3D; s -&gt; &#123;System.out.println(s);&#125;; consumer02.accept(&quot;ä½†æˆ‘æ²¡æœ‰è¯´&quot;); &#125; è¯­æ³•æ ¼å¼äº”ï¼š Lambdaéœ€è¦ä¸¤ä¸ªæˆ–ä»¥ä¸Šå‚æ•°ï¼Œå¤šæ¡æ‰§è¡Œè¯­å¥ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼ @Test public void test02() &#123; &#x2F;&#x2F;1. ä»¥å‰çš„å†™æ³• Comparator&lt;Integer&gt; comparator01 &#x3D; new Comparator&lt;Integer&gt;() &#123; @Override public int compare(Integer o1, Integer o2) &#123; System.out.println(o1); System.out.println(o2); return o1.compareTo(o2); &#125; &#125;; System.out.println(comparator01.compare(95, 27)); System.out.println(&quot;-------------------------&quot;); &#x2F;&#x2F;2. Lambdaè¡¨è¾¾å¼ Comparator&lt;Integer&gt; comparator02 &#x3D; (o1, o2) -&gt; &#123; System.out.println(o1); System.out.println(o2); return o1.compareTo(o2); &#125;; System.out.println(comparator02.compare(12, 21)); &#125; è¯­æ³•æ ¼å¼å…­ï¼š å½“Lambdaä½“åªæœ‰ä¸€æ¡è¯­å¥æ—¶ï¼Œreturnä¸{}è‹¥æœ‰ï¼Œåˆ™éƒ½å¯ä»¥çœç•¥ public void test02() &#123; &#x2F;&#x2F;1. ä»¥å‰çš„å†™æ³• Comparator&lt;Integer&gt; comparator01 &#x3D; new Comparator&lt;Integer&gt;() &#123; @Override public int compare(Integer o1, Integer o2) &#123; return o1.compareTo(o2); &#125; &#125;; System.out.println(comparator01.compare(95, 27)); System.out.println(&quot;-------------------------&quot;); &#x2F;&#x2F;2. Lambdaè¡¨è¾¾å¼ Comparator&lt;Integer&gt; comparator02 &#x3D; (o1, o2) -&gt; o1.compareTo(o2); System.out.println(comparator02.compare(12, 21)); &#125; æ–¹æ³•å¼•ç”¨å’Œæ„é€ å™¨å¼•ç”¨ å½“è¦ä¼ é€’ç»™Lambdaä½“çš„æ“ä½œï¼Œå·²ç»æœ‰å®ç°çš„æ–¹æ³•äº†ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨ æ–¹æ³•å¼•ç”¨å¯ä»¥çœ‹åšä¼šLambdaè¡¨è¾¾å¼çš„æ·±å±‚æ¬¡è¡¨è¾¾ï¼Œæ¢å¥è¯è¯´ï¼Œæ–¹æ³•å¼•ç”¨å°±æ˜¯Lambdaè¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯å‡½æ•°å¼æ¥å£çš„ä¸€ä¸ªå®ä¾‹ï¼Œé€šè¿‡æ–¹æ³•çš„åå­—æ¥æŒ‡å‘ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯Lambdaè¡¨è¾¾å¼çš„ä¸€ä¸ªè¯­æ³•ç³– è¦æ±‚ï¼šå®ç°æ¥å£çš„æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ï¼Œå¿…é¡»ä¸æ–¹æ³•å¼•ç”¨çš„æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ä¿æŒä¸€è‡´ æ–¹æ³•å¼•ç”¨çš„ä½¿ç”¨æƒ…å†µ æ–¹æ³•å¼•ç”¨çš„ä½¿ç”¨ ä½¿ç”¨æƒ…å¢ƒï¼šå½“è¦ä¼ é€’ç»™Lambdaä½“çš„æ“ä½œï¼Œå·²ç»æœ‰å®ç°çš„æ–¹æ³•äº†ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼ æ–¹æ³•å¼•ç”¨ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯Lambdaè¡¨è¾¾å¼ï¼Œè€ŒLambdaè¡¨è¾¾å¼ä½œä¸ºå‡½æ•°å¼æ¥å£çš„å®ä¾‹ã€‚æ‰€ä»¥æ–¹æ³•å¼•ç”¨ï¼Œä¹Ÿæ˜¯å‡½æ•°å¼æ¥å£çš„å®ä¾‹ã€‚ ä½¿ç”¨æ ¼å¼ï¼š ç±»(æˆ–å¯¹è±¡) :: æ–¹æ³•å å…·ä½“åˆ†ä¸ºå¦‚ä¸‹çš„ä¸‰ç§æƒ…å†µï¼š å¯¹è±¡::å®ä¾‹æ–¹æ³•å ç±»::é™æ€æ–¹æ³•å ç±»::å®ä¾‹æ–¹æ³•å æ–¹æ³•å¼•ç”¨ä½¿ç”¨çš„è¦æ±‚ï¼šè¦æ±‚æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ä¸æ–¹æ³•å¼•ç”¨çš„æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ç›¸åŒï¼ï¼ˆé’ˆå¯¹äºæƒ…å†µ1å’Œæƒ…å†µ2ï¼‰ å…ˆå†™ä¸€ä¸ªå®ä½“ç±» @Data public class Student &#123; private String name; private Integer id; &#125; æƒ…å†µä¸€ï¼šå¯¹è±¡::å®ä¾‹æ–¹æ³•åï¼ŒæŠ½è±¡æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ä¸æ–¹æ³•å¼•ç”¨çš„æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ç›¸åŒ //æƒ…å†µä¸€ï¼šå¯¹è±¡::å®ä¾‹æ–¹æ³•åï¼ŒæŠ½è±¡æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ä¸æ–¹æ³•å¼•ç”¨çš„æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ç›¸åŒ //Consumerä¸­çš„void accept(T t) //PrintStreamä¸­çš„void println(T t) //å½¢å‚åˆ—è¡¨å‡ä¸º(T t)ï¼Œè¿”å›å€¼å‡ä¸ºvoidï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨ @org.junit.jupiter.api.Test public void test03() &#123; //1. Lambda Consumer&lt;String> consumer01 = s -> System.out.println(s); consumer01.accept(\"å¥¹çš„æ‰‹åªæœ‰æˆ‘çš„æ‰‹å››åˆ†ä¹‹ä¸‰é‚£éº¼å¤§\"); System.out.println(\"-----------------------------\"); //2. æ–¹æ³•å¼•ç”¨ PrintStream printStream = System.out; Consumer&lt;String> consumer02 = printStream::println; consumer02.accept(\"\\\"å¯æˆ‘é‚„æ˜¯æ²’èƒ½æŠ“ä½\\\"\"); System.out.println(\"-----------------------------\"); //3. ä½†è²Œä¼¼ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ Consumer&lt;String> consumer03 = System.out::println; consumer03.accept(\"\\\"èŠ±è½ä¸‹çš„æ—¶å€™æ²¡æ­» é£æ¡èµ·èŠ± åˆä¸¢ä¸‹ èŠ±æ‰æ­»äº†\\\"\"); &#125; /** * å¥¹çš„æ‰‹åªæœ‰æˆ‘çš„æ‰‹å››åˆ†ä¹‹ä¸‰é‚£éº¼å¤§ * ----------------------------- * \"å¯æˆ‘é‚„æ˜¯æ²’èƒ½æŠ“ä½\" * ----------------------------- * \"èŠ±è½ä¸‹çš„æ—¶å€™æ²¡æ­» é£æ¡èµ·èŠ± åˆä¸¢ä¸‹ èŠ±æ‰æ­»äº†\" */ æƒ…å†µäºŒï¼šç±» :: é™æ€æ–¹æ³• //æƒ…å†µäºŒï¼šç±» :: é™æ€æ–¹æ³• //Comparatorä¸­çš„int compare(T t1,T t2) //Integerä¸­çš„int compare(T t1,T t2) //å½¢å‚åˆ—è¡¨å‡ä¸º`(T t1,T t2)`ï¼Œè¿”å›å€¼å‡ä¸º`int`ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨ @org.junit.jupiter.api.Test public void test04() &#123; //1. Lambda Comparator&lt;Integer> comparator01 = (o1, o2) -> Integer.compare(01, 02); System.out.println(comparator01.compare(20, 30)); System.out.println(\"----------------------------\"); //2. æ–¹æ³•å¼•ç”¨ Comparator&lt;Integer> comparator02 = Integer::compare; System.out.println(comparator02.compare(64, 30)); &#125; /** * -1 * ---------------------------- * 1 */ //Functionä¸­çš„R apply(T t) //Mathä¸­çš„Long round(Double d) //è¿”å›å€¼å’Œå‚æ•°åˆ—è¡¨ä¸ºæ³›å‹ï¼Œä¹Ÿå¯ä»¥åŒ¹é…ä¸Šï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨ @org.junit.jupiter.api.Test public void test05() &#123; //1. Lambda Function&lt;Double, Long> function01 = aDouble -> Math.round(aDouble); System.out.println(function01.apply(3.1415926)); System.out.println(\"----------------------------\"); //2. æ–¹æ³•å¼•ç”¨ Function&lt;Double, Long> function02 = Math::round; System.out.println(function02.apply(0.876)); &#125; /** * 3 * ---------------------------- * 1 */ æƒ…å†µä¸‰ï¼šç±» :: å®ä¾‹æ–¹æ³• //æƒ…å†µä¸‰ï¼šç±» :: å®ä¾‹æ–¹æ³• // Comparatorä¸­çš„int comapre(T t1,T t2) // Stringä¸­çš„int t1.compareTo(t2) @org.junit.jupiter.api.Test public void test06() &#123; //1. Lambda Comparator&lt;Integer> comparator01 = (o1, o2) -> o1.compareTo(o2); System.out.println(comparator01.compare(94, 21)); System.out.println(\"---------------------------\"); //2. æ–¹æ³•å¼•ç”¨ Comparator&lt;Integer> comparator02 = Integer::compareTo; System.out.println(comparator02.compare(43, 96)); &#125; //BiPredicateä¸­çš„boolean test(T t1, T t2); //Stringä¸­çš„boolean t1.equals(t2) @org.junit.jupiter.api.Test public void test10() &#123; //1. Lambda BiPredicate&lt;String, String> biPredicate01 = (o1, o2) -> o1.equals(o2); System.out.println(biPredicate01.test(\"Kyle\", \"Kyle\")); System.out.println(\"----------------------------------\"); //2. æ–¹æ³•å¼•ç”¨ BiPredicate&lt;String, String> biPredicate02 = String::equals; System.out.println(biPredicate02.test(\"Viole\", \"Violet\")); &#125; /** * true * ---------------------------------- * false */ // Functionä¸­çš„R apply(T t) // Employeeä¸­çš„String toString(); @org.junit.jupiter.api.Test public void test7() &#123; Student student = new Student(\"Kyle\", 9527); //1. Lambda Function&lt;Student, String> function01 = stu -> stu.toString(); System.out.println(function01.apply(student)); System.out.println(\"------------------------------\"); //2. æ–¹æ³•å¼•ç”¨ Function&lt;Student, String> function02 = Student::toString; System.out.println(function02.apply(student)); &#125; /** * Student(name=Kyle, id=9527) * ------------------------------ * Student(name=Kyle, id=9527) */ æ„é€ å™¨å¼•ç”¨å’Œæ•°ç»„å¼•ç”¨çš„ä½¿ç”¨ ä¸å‡½æ•°å¼æ¥å£ç›¸ç»“åˆï¼Œè‡ªåŠ¨ä¸å‡½æ•°å¼æ¥å£ä¸­æ–¹æ³•å…¼å®¹ã€‚ å¯ä»¥æŠŠæ„é€ å™¨å¼•ç”¨èµ‹å€¼ç»™å®šä¹‰çš„æ–¹æ³•ï¼Œè¦æ±‚æ„é€ å™¨å‚æ•°åˆ—è¡¨è¦ä¸æ¥å£ä¸­æŠ½è±¡æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸€è‡´ï¼ä¸”æ–¹æ³•çš„è¿”å›å€¼å³ä¸ºæ„é€ å™¨å¯¹åº”ç±»çš„å¯¹è±¡ã€‚ 1.æ„é€ å™¨å¼•ç”¨ å’Œæ–¹æ³•å¼•ç”¨ç±»ä¼¼ï¼Œå‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•çš„å½¢å‚åˆ—è¡¨å’Œæ„é€ å™¨çš„å½¢å‚åˆ—è¡¨ä¸€è‡´ã€‚ æŠ½è±¡æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å³ä¸ºæ„é€ å™¨æ‰€å±çš„ç±»çš„ç±»å‹ @org.junit.jupiter.api.Test public void test8() &#123; &#x2F;&#x2F;1. Lambda BiFunction&lt;String, Integer, Student&gt; biFunction01 &#x3D; (string, integer) -&gt; new Student(string, integer); System.out.println(biFunction01.apply(&quot;Kyle&quot;, 9527)); System.out.println(&quot;------------------------------&quot;); &#x2F;&#x2F;2. æ–¹æ³•å¼•ç”¨ BiFunction&lt;String, Integer, Student&gt; biFunction02 &#x3D; Student::new; System.out.println(biFunction02.apply(&quot;Lucy&quot;, 9421)); &#125; &#x2F;** * Student(name&#x3D;Kyle, id&#x3D;9527) * ------------------------------ * Student(name&#x3D;Lucy, id&#x3D;9421) *&#x2F; 2.æ•°ç»„å¼•ç”¨ å¯ä»¥æŠŠæ•°ç»„çœ‹åšæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼Œåˆ™å†™æ³•ä¸æ„é€ å™¨å¼•ç”¨ä¸€è‡´ @org.junit.jupiter.api.Test public void test9() &#123; &#x2F;&#x2F;1. Lambda åˆ›å»ºä¸€ä¸ªæŒ‡å®šé•¿åº¦çš„stringæ•°ç»„ Function&lt;Integer, String[]&gt; function01 &#x3D; integer -&gt; new String[integer]; System.out.println(Arrays.toString(function01.apply(5))); System.out.println(&quot;-----------------------------&quot;); &#x2F;&#x2F;2. æ•°ç»„å¼•ç”¨ Function&lt;Integer, String[]&gt; function02 &#x3D; String[]::new; System.out.println(Arrays.toString(function02.apply(7))); &#125; &#x2F;** * [null, null, null, null, null] * ----------------------------- * [null, null, null, null, null, null, null] *&#x2F; Stream APIStream APIæ¦‚è¿° Java8ä¸­æœ‰ä¸¤ä¸ªæœ€ä¸ºé‡è¦çš„æ”¹å˜ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯Lambdaè¡¨è¾¾å¼ï¼Œå¦å¤–ä¸€ä¸ªåˆ™æ˜¯Stream API Stream API(java.util.stream)æŠŠçœŸæ­£çš„å‡½æ•°å¼ç¼–ç¨‹é£æ ¼å¼•å…¥åˆ°Javaä¸­ï¼Œè¿™æ˜¯ç›®å‰ä¸ºæ­¢å¯¹Javaç±»åº“æœ€å¥½çš„è¡¥å……ï¼Œå› ä¸ºStream APIå¯ä»¥æå¤§åœ°æé«˜ç¨‹åºå‘˜ç”Ÿäº§åŠ›ï¼Œè®©ç¨‹åºå‘˜å†™å‡ºé«˜æ•ˆã€ç®€æ´çš„ä»£ç  Streamæ˜¯Java8 ä¸­å¤„ç†é›†åˆçš„å…³é”®æŠ½è±¡æ¦‚å¿µï¼Œå®ƒå¯ä»¥æŒ‡å®šä½ å¸Œæœ›å¯¹é›†åˆè¿›è¡Œçš„æ“ä½œï¼Œå¯ä»¥æ‰§è¡Œéå¸¸å¤æ‚çš„æŸ¥æ‰¾ã€è¿‡æ»¤å’Œæ˜ å°„æ•°æ®ç­‰æ“ä½œã€‚ ä½¿ç”¨Stream API å¯¹é›†åˆæ•°æ®è¿›è¡Œæ“ä½œï¼Œå°±ç±»ä¼¼äºä½¿ç”¨SQL æ‰§è¡Œçš„æ•°æ®åº“æŸ¥è¯¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Stream API æ¥å¹¶è¡Œæ‰§è¡Œæ“ä½œã€‚ç®€è¨€ä¹‹ï¼ŒStream API æä¾›äº†ä¸€ç§é«˜æ•ˆä¸”æ˜“äºä½¿ç”¨çš„å¤„ç†æ•°æ®çš„æ–¹å¼ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Stream API å®é™…å¼€å‘ä¸­ï¼Œé¡¹ç›®ä¸­å¤šæ•°æ•°æ®æºéƒ½æ˜¯æ¥è‡ªMySQLã€Oracle ç­‰ã€‚ä½†ç°åœ¨æ•°æ®æºå¯ä»¥æ›´å¤šäº†ï¼Œæœ‰MongDBã€Redisç­‰ï¼Œè€Œè¿™äº›NoSQLçš„æ•°æ®å°±éœ€è¦Javaå±‚é¢å»å¤„ç†ã€‚æˆ‘å°±æ˜¯å­¦å®ŒRediså†æ¥è¡¥ç¥¨çš„.. Stream å’ŒCollection é›†åˆçš„åŒºåˆ«ï¼šCollection æ˜¯ä¸€ç§é™æ€çš„å†…å­˜æ•°æ®ç»“æ„ï¼Œè€ŒStream æ˜¯æœ‰å…³è®¡ç®—çš„ã€‚å‰è€…æ˜¯ä¸»è¦é¢å‘å†…å­˜ï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œåè€…ä¸»è¦æ˜¯é¢å‘CPUï¼Œé€šè¿‡CPU å®ç°è®¡ç®—ï¼ˆè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¸€æ—¦æ‰§è¡Œç»ˆæ­¢æ“ä½œä¹‹åï¼ŒStream å°±ä¸èƒ½è¢«å†æ¬¡ä½¿ç”¨ï¼Œå¾—é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„æµæ‰è¡Œï¼‰ å°ç»“ Stream å…³æ³¨çš„æ˜¯å¯¹æ•°æ®çš„è¿ç®—ï¼Œä¸CPU æ‰“äº¤é“ï¼›é›†åˆå…³æ³¨çš„æ˜¯æ•°æ®çš„å­˜å‚¨ï¼Œä¸å†…å­˜æ‰“äº¤é“ Stream è‡ªå·±ä¸ä¼šå­˜å‚¨æ•°æ®ï¼›Stream ä¸ä¼šæ”¹å˜æºå¯¹è±¡ï¼Œç›¸åï¼Œä»–ä»¬ä¼šè¿”å›ä¸€ä¸ªæŒæœ‰ç»“æœçš„æ–°StreamStream æ“ä½œæ˜¯å»¶è¿Ÿæ‰§è¡Œçš„ï¼Œè¿™æ„å‘³ç€ä»–ä»¬ä¼šç­‰åˆ°éœ€è¦ç»“æœçš„æ—¶å€™æ‰æ‰§è¡Œ Stream æ‰§è¡Œæµç¨‹ Streamå®ä¾‹åŒ– ä¸€ç³»åˆ—ä¸­é—´æ“ä½œï¼ˆè¿‡æ»¤ã€æ˜ å°„ã€..ï¼‰ ç»ˆæ­¢æ“ä½œ è¯´æ˜ ä¸€ç³»åˆ—ä¸­é—´æ“ä½œé“¾ï¼Œå¯¹æ•°æ®æºçš„æ•°æ®è¿›è¡Œå¤„ç† ä¸€æ—¦æ‰§è¡Œç»ˆæ­¢æ“ä½œï¼Œå°±æ‰§è¡Œä¸­é—´æ“ä½œé“¾ï¼Œå¹¶äº§ç”Ÿç»“æœï¼Œä¹‹åï¼Œä¸ä¼šå†è¢«ä½¿ç”¨ Streamçš„å®ä¾‹åŒ–å…ˆæ–°å»ºä¸¤ä¸ªç±» public class Employee &#123; private int id; private String name; private int age; private double salary; public int getId() &#123; return id; &#125; public void setId(int id) &#123; this.id = id; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public int getAge() &#123; return age; &#125; public void setAge(int age) &#123; this.age = age; &#125; public double getSalary() &#123; return salary; &#125; public void setSalary(double salary) &#123; this.salary = salary; &#125; public Employee() &#123; System.out.println(\"Employee().....\"); &#125; public Employee(int id) &#123; this.id = id; System.out.println(\"Employee(int id).....\"); &#125; public Employee(int id, String name) &#123; this.id = id; this.name = name; &#125; public Employee(int id, String name, int age, double salary) &#123; this.id = id; this.name = name; this.age = age; this.salary = salary; &#125; @Override public String toString() &#123; return \"Employee&#123;\" + \"id=\" + id + \", name='\" + name + '\\'' + \", age=\" + age + \", salary=\" + salary + '&#125;'; &#125; @Override public boolean equals(Object o) &#123; if (this == o) return true; if (o == null || getClass() != o.getClass()) return false; Employee employee = (Employee) o; if (id != employee.id) return false; if (age != employee.age) return false; if (Double.compare(employee.salary, salary) != 0) return false; return name != null ? name.equals(employee.name) : employee.name == null; &#125; @Override public int hashCode() &#123; int result; long temp; result = id; result = 31 * result + (name != null ? name.hashCode() : 0); result = 31 * result + age; temp = Double.doubleToLongBits(salary); result = 31 * result + (int) (temp ^ (temp >>> 32)); return result; &#125; &#125; /** * æä¾›ç”¨äºæµ‹è¯•çš„æ•°æ® */ public class EmployeeData &#123; public static List&lt;Employee> getEmployees() &#123; List&lt;Employee> list = new ArrayList&lt;>(); list.add(new Employee(1001, \"é©¬åŒ–è…¾\", 34, 6000.38)); list.add(new Employee(1002, \"é©¬äº‘\", 12, 9876.12)); list.add(new Employee(1003, \"åˆ˜å¼ºä¸œ\", 33, 3000.82)); list.add(new Employee(1004, \"é›·å†›\", 26, 7657.37)); list.add(new Employee(1005, \"æå½¦å®\", 65, 5555.32)); list.add(new Employee(1006, \"æ¯”å°”ç›–èŒ¨\", 42, 9500.43)); list.add(new Employee(1007, \"ä»»æ­£é\", 26, 4333.32)); list.add(new Employee(1008, \"æ‰å…‹ä¼¯æ ¼\", 35, 2500.32)); return list; &#125; &#125; åˆ›å»ºStreamæ–¹å¼ä¸€ï¼šé€šè¿‡é›†åˆ @org.junit.jupiter.api.Test public void test() &#123; List&lt;Employee> employees= EmployeeData.getEmployees(); //default Stream&lt;E> stream() è¿”å›ä¸€ä¸ªé¡ºåºæµ Stream&lt;Employee> stream = employees.stream(); //default Stream&lt;E> parallelStream è¿”å›ä¸€ä¸ªå¹¶è¡Œæµ Stream&lt;Employee> employeeStream=employees.parallelStream(); &#125; åˆ›å»ºStreamæ–¹å¼äºŒï¼šé€šè¿‡æ•°ç»„ @org.junit.jupiter.api.Test public void test2() &#123; int[] arr = new int[]&#123;1, 3, 5, 7, 9, 2, 4, 6, 8&#125;; //è°ƒç”¨Arraysçš„static &lt;T> Stream&lt;T> stream(T[] array) è¿”å›ä¸€ä¸ªæµ IntStream stream=Arrays.stream(arr); Employee kyle=new Employee(9527,\"Kyle\"); Employee lucy=new Employee(9527,\"Lucy\"); Employee[] employees=&#123;kyle,lucy&#125;; Stream&lt;Employee> stream1=Arrays.stream(employees); &#125; - åˆ›å»ºStreamæ–¹å¼ä¸‰ï¼šé€šè¿‡Streamçš„of() @org.junit.jupiter.api.Test public void test03() &#123; Stream&lt;Integer> stream=Stream.of(9,4,2,8,2,5,2,7); &#125; åˆ›å»ºStreamæ–¹å¼å››ï¼šåˆ›å»ºæ— é™æµ å¦‚æœä¸ç”¨limité™åˆ¶è¾“å‡ºï¼Œåˆ™ä¼šä¸€ç›´è¾“å‡ºä¸‹å»ï¼ŒforEachå°±ç›¸å½“äºæ˜¯ç»ˆæ­¢æ“ä½œ @org.junit.jupiter.api.Test public void test04() &#123; // è¿­ä»£ // éå†å‰10ä¸ªæ•° // public static&lt;T> Stream&lt;T> iterate(final T seed, final UnaryOperator&lt;T> f) Stream.iterate(0,t->t+1).limit(10).forEach(System.out::println); // ç”Ÿæˆ // 10ä¸ªéšæœºæ•° // public static&lt;T> Stream&lt;T> generate(Supplier&lt;T> s) Stream.generate(Math::random).limit(10).forEach(System.out::println); &#125; Streamçš„ä¸­é—´æ“ä½œï¼šç­›é€‰ä¸åˆ‡ç‰‡ å¤šä¸ªä¸­é—´æ“ä½œå¯ä»¥è¿æ¥èµ·æ¥å½¢æˆä¸€ä¸ªæµæ°´çº¿ï¼Œé™¤éæµæ°´çº¿ä¸Šè§¦å‘ç»ˆæ­¢æ“ä½œï¼Œå¦åˆ™ä¸­é—´æ“ä½œä¸ä¼šæ‰§è¡Œä»»ä½•çš„å¤„ç†ï¼Œè€Œåœ¨ç»ˆæ­¢æ“ä½œæ—¶ä¸€æ¬¡æ€§å…¨éƒ¨å¤„ç†ï¼Œç§°ä¸ºæƒ°æ€§æ±‚å€¼ æ–¹æ³• æè¿° filter(Predicate p) æ¥æ”¶Lambda ï¼Œä»æµä¸­æ’é™¤æŸäº›å…ƒç´  distinct() ç­›é€‰ï¼Œé€šè¿‡æµæ‰€ç”Ÿæˆå…ƒç´ çš„hashCode() å’Œequals() å»é™¤é‡å¤å…ƒç´  limit(long maxSize) æˆªæ–­æµï¼Œä½¿å…¶å…ƒç´ ä¸è¶…è¿‡ç»™å®šæ•°é‡ skip(long n) è·³è¿‡å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ‰”æ‰äº†å‰n ä¸ªå…ƒç´ çš„æµã€‚è‹¥æµä¸­å…ƒç´ ä¸è¶³n ä¸ªï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæµã€‚ä¸limit(n)äº’è¡¥ @org.junit.jupiter.api.Test public void test05() &#123; List&lt;Employee> employees = EmployeeData.getEmployees(); //1. filter æŸ¥è¯¢å·¥èµ„å¤§äº7000çš„å‘˜å·¥ä¿¡æ¯ employees.stream().filter(employee -> employee.getSalary()>7000).forEach(System.out::println); System.out.println(\"----------------------------\"); //2. limit(n)â€”â€”æˆªæ–­æµï¼Œä½¿å…¶å…ƒç´ ä¸è¶…è¿‡ç»™å®šæ•°é‡ã€‚åªè¾“å‡º3æ¡å‘˜å·¥ä¿¡æ¯ employees.stream().limit(3).forEach(System.out::println); System.out.println(\"----------------------------\"); //3. skip(n) â€”â€” è·³è¿‡å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ‰”æ‰äº†å‰ n ä¸ªå…ƒç´ çš„æµã€‚è‹¥æµä¸­å…ƒç´ ä¸è¶³ n ä¸ªï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæµã€‚ä¸ limit(n) äº’è¡¥ employees.stream().skip(3).forEach(System.out::println); System.out.println(\"----------------------------\"); //4. distinct()â€”â€”ç­›é€‰ï¼Œé€šè¿‡æµæ‰€ç”Ÿæˆå…ƒç´ çš„ hashCode() å’Œ equals() å»é™¤é‡å¤å…ƒç´  employees.add(new Employee(9527, \"Kyle\", 20, 9999)); employees.add(new Employee(9527, \"Kyle\", 20, 9999)); employees.add(new Employee(9527, \"Kyle\", 20, 9999)); employees.add(new Employee(9527, \"Kyle\", 20, 9999)); employees.add(new Employee(9527, \"Kyle\", 20, 9999)); employees.stream().distinct().forEach(System.out::println); &#125; /** * Employee&#123;id=1002, name='é©¬äº‘', age=12, salary=9876.12&#125; * Employee&#123;id=1004, name='é›·å†›', age=26, salary=7657.37&#125; * Employee&#123;id=1006, name='æ¯”å°”ç›–èŒ¨', age=42, salary=9500.43&#125; * ---------------------------- * Employee&#123;id=1001, name='é©¬åŒ–è…¾', age=34, salary=6000.38&#125; * Employee&#123;id=1002, name='é©¬äº‘', age=12, salary=9876.12&#125; * Employee&#123;id=1003, name='åˆ˜å¼ºä¸œ', age=33, salary=3000.82&#125; * ---------------------------- * Employee&#123;id=1004, name='é›·å†›', age=26, salary=7657.37&#125; * Employee&#123;id=1005, name='æå½¦å®', age=65, salary=5555.32&#125; * Employee&#123;id=1006, name='æ¯”å°”ç›–èŒ¨', age=42, salary=9500.43&#125; * Employee&#123;id=1007, name='ä»»æ­£é', age=26, salary=4333.32&#125; * Employee&#123;id=1008, name='æ‰å…‹ä¼¯æ ¼', age=35, salary=2500.32&#125; * ---------------------------- * Employee&#123;id=1001, name='é©¬åŒ–è…¾', age=34, salary=6000.38&#125; * Employee&#123;id=1002, name='é©¬äº‘', age=12, salary=9876.12&#125; * Employee&#123;id=1003, name='åˆ˜å¼ºä¸œ', age=33, salary=3000.82&#125; * Employee&#123;id=1004, name='é›·å†›', age=26, salary=7657.37&#125; * Employee&#123;id=1005, name='æå½¦å®', age=65, salary=5555.32&#125; * Employee&#123;id=1006, name='æ¯”å°”ç›–èŒ¨', age=42, salary=9500.43&#125; * Employee&#123;id=1007, name='ä»»æ­£é', age=26, salary=4333.32&#125; * Employee&#123;id=1008, name='æ‰å…‹ä¼¯æ ¼', age=35, salary=2500.32&#125; * Employee&#123;id=9527, name='Kyle', age=20, salary=9999.0&#125; * */ Streamçš„ä¸­é—´æ“ä½œ:æ˜ å°„ æ–¹æ³• æè¿° map(Function f) æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ ã€‚ mapToDouble(ToDoubleFunction f) æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„DoubleStreamã€‚ mapToInt(ToIntFunction f) æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„IntStreamã€‚ mapToLong(ToLongFunction f) æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„LongStreamã€‚ flatMap(Function f) æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå°†æµä¸­çš„æ¯ä¸ªå€¼éƒ½æ¢æˆå¦ä¸€ä¸ªæµï¼Œç„¶åæŠŠæ‰€æœ‰æµè¿æ¥æˆä¸€ä¸ªæµ @org.junit.jupiter.api.Test public void test06() &#123; List&lt;String> strings = Arrays.asList(\"aa\", \"bb\", \"cc\", \"dd\"); List&lt;Employee> employees = EmployeeData.getEmployees(); //map(Function f)â€”â€”æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå°†å…ƒç´ è½¬æ¢æˆå…¶ä»–å½¢å¼æˆ–æå–ä¿¡æ¯ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ ã€‚ // ç»ƒä¹ ï¼šå°†å­—ç¬¦ä¸²è½¬ä¸ºå¤§å†™å¹¶è¾“å‡º strings.stream().map(String::toUpperCase).forEach(System.out::println);//æ–¹æ³•å¼•ç”¨ System.out.println(\"--------------------------\"); strings.stream().map(s -> s.toUpperCase()).forEach(System.out::println);//lambda System.out.println(\"--------------------------\"); // ç»ƒä¹ ï¼šè·å–å‘˜å·¥å§“åé•¿åº¦å¤§äº3çš„å‘˜å·¥çš„å§“åã€‚ employees.stream().map(Employee::getName).filter(name->name.length()>3).forEach(System.out::println); System.out.println(\"--------------------------\"); // ç»ƒä¹ ï¼šå°†å­—ç¬¦ä¸²ä¸­çš„å¤šä¸ªå­—ç¬¦æ„æˆçš„é›†åˆè½¬æ¢ä¸ºå¯¹åº”çš„Streamå®ä¾‹ strings.stream().map(Test::formStringToStream).forEach(characterStream -> characterStream.forEach(System.out::println)); // ä½¿ç”¨flatMap(Function f)è¾¾åˆ°åŒæ ·çš„æ•ˆæœ strings.stream().flatMap(Test::formStringToStream).forEach(System.out::println); &#125; /** *AA * BB * CC * DD * -------------------------- * AA * BB * CC * DD * -------------------------- * æ¯”å°”ç›–èŒ¨ * æ‰å…‹ä¼¯æ ¼ * -------------------------- * a * a * b * b * c * c * d * d * a * a * b * b * c * c * d * d * */ public static Stream&lt;Character> formStringToStream(String str) &#123; ArrayList&lt;Character> list = new ArrayList&lt;>(); for (char c : str.toCharArray()) &#123; list.add(c); &#125; return list.stream(); &#125; Streamçš„ä¸­é—´æ“ä½œ:æ’åº æ–¹æ³• æè¿° sorted() äº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå…¶ä¸­æŒ‰è‡ªç„¶é¡ºåºæ’åº sorted(Comparator com) äº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå…¶ä¸­æŒ‰æ¯”è¾ƒå™¨é¡ºåºæ’åº @org.junit.jupiter.api.Test public void test10() &#123; List&lt;Integer> nums = Arrays.asList(13, 54, 97, 52, 43, 64, 27); List&lt;Employee> employees = EmployeeData.getEmployees(); //è‡ªç„¶æ’åº nums.stream().sorted().forEach(System.out::println); //å®šåˆ¶æ’åºï¼Œå…ˆæŒ‰ç…§å¹´é¾„å‡åºæ’ï¼Œå†æŒ‰ç…§å·¥èµ„é™åºæ’ employees.stream().sorted((o1, o2) -> &#123; int result = Integer.compare(o1.getAge(), o2.getAge()); if (result != 0) &#123; return result; &#125; else &#123; return -Double.compare(o1.getSalary(), o2.getSalary()); &#125; &#125;).forEach(System.out::println); &#125; /** * 13 * 27 * 43 * 52 * 54 * 64 * 97 * Employee&#123;id=1002, name='é©¬äº‘', age=12, salary=9876.12&#125; * Employee&#123;id=1004, name='é›·å†›', age=26, salary=7657.37&#125; * Employee&#123;id=1007, name='ä»»æ­£é', age=26, salary=4333.32&#125; * Employee&#123;id=1003, name='åˆ˜å¼ºä¸œ', age=33, salary=3000.82&#125; * Employee&#123;id=1001, name='é©¬åŒ–è…¾', age=34, salary=6000.38&#125; * Employee&#123;id=1008, name='æ‰å…‹ä¼¯æ ¼', age=35, salary=2500.32&#125; * Employee&#123;id=1006, name='æ¯”å°”ç›–èŒ¨', age=42, salary=9500.43&#125; * Employee&#123;id=1005, name='æå½¦å®', age=65, salary=5555.32&#125; * */ Streamçš„ä¸­é—´æ“ä½œ:åŒ¹é…ä¸æŸ¥æ‰¾ ç»ˆç«¯æ“ä½œä¼šä»æµçš„æµæ°´çº¿ç”Ÿæˆç»“æœã€‚å…¶ç»“æœå¯ä»¥æ˜¯ä»»ä½•ä¸æ˜¯æµçš„å€¼ï¼Œä¾‹å¦‚ï¼šListã€Integerï¼Œç”šè‡³æ˜¯void ã€‚ æµè¿›è¡Œäº†ç»ˆæ­¢æ“ä½œåï¼Œä¸èƒ½å†æ¬¡ä½¿ç”¨ã€‚ æ–¹æ³• æè¿° allMatch(Predicate p) æ£€æŸ¥æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´  anyMatch(Predicate p) æ£€æŸ¥æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´  noneMatch(Predicate p) æ£€æŸ¥æ˜¯å¦æ²¡æœ‰åŒ¹é…æ‰€æœ‰å…ƒç´  findFirst() è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´  findAny() è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´  count() è¿”å›æµä¸­å…ƒç´ æ€»æ•° max(Comparator c) è¿”å›æµä¸­æœ€å¤§å€¼ min(Comparator c) è¿”å›æµä¸­æœ€å°å€¼ forEach(Consumer c) å†…éƒ¨è¿­ä»£(ä½¿ç”¨Collection æ¥å£éœ€è¦ç”¨æˆ·å»åšè¿­ä»£ï¼Œç§°ä¸ºå¤–éƒ¨è¿­ä»£ã€‚ç›¸åï¼ŒStream API ä½¿ç”¨å†…éƒ¨è¿­ä»£â€”â€”å®ƒå¸®ä½ æŠŠè¿­ä»£åšäº†) @org.junit.jupiter.api.Test public void test7() &#123; List&lt;Employee> employees = EmployeeData.getEmployees(); // allMatch(Predicate p)â€”â€”æ£€æŸ¥æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ ã€‚ // ç»ƒä¹ ï¼šæ˜¯å¦æ‰€æœ‰çš„å‘˜å·¥çš„å·¥èµ„æ˜¯å¦éƒ½å¤§äº5000 System.out.println(\"æ˜¯å¦æ‰€æœ‰çš„å‘˜å·¥çš„å·¥èµ„æ˜¯å¦éƒ½å¤§äº5000ï¼š\" + employees.stream().allMatch(employee -> employee.getSalary() > 5000)); // anyMatch(Predicate p)â€”â€”æ£€æŸ¥æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ ã€‚ // ç»ƒä¹ ï¼šæ˜¯å¦å­˜åœ¨å‘˜å·¥å¹´é¾„å°äº15 System.out.println(\"æ˜¯å¦å­˜åœ¨å‘˜å·¥å¹´é¾„å°äº15ï¼š\" + employees.stream().allMatch(employee -> employee.getAge() &lt; 15)); // noneMatch(Predicate p)â€”â€”æ£€æŸ¥æ˜¯å¦æ²¡æœ‰åŒ¹é…çš„å…ƒç´ ã€‚ // ç»ƒä¹ ï¼šæ˜¯å¦ä¸å­˜åœ¨å‘˜å·¥å§“â€œé©¬â€ System.out.println(\"æ˜¯å¦ä¸å­˜åœ¨å‘˜å·¥å§“é©¬ï¼š\" + employees.stream().noneMatch(employee -> employee.getName().startsWith(\"é©¬\"))); //findFirstâ€”â€”è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´  System.out.println(\"è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š\" + employees.stream().findFirst()); //findAnyâ€”â€”è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´  System.out.println(\"è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ \" + employees.stream().findAny()); //countâ€”â€”è¿”å›æµä¸­å…ƒç´ çš„æ€»ä¸ªæ•° System.out.println(\"è¿”å›å…ƒç´ æ€»æ•°ï¼š\" + employees.stream().count()); //max(Comparator c)â€”â€”è¿”å›æµä¸­æœ€å¤§å€¼ System.out.println(\"è¿”å›æœ€é«˜å·¥èµ„ï¼š\" + employees.stream().map(Employee::getSalary).max(Double::compare)); //min(Comparator c)â€”â€”è¿”å›æµä¸­æœ€å°å€¼ System.out.println(\"è¿”å›æœ€å°å¹´é¾„ï¼š\" + employees.stream().map(Employee::getAge).min(Integer::compare)); //forEach(Consumer c)â€”â€”å†…éƒ¨è¿­ä»£ employees.stream().forEach(System.out::println); System.out.println(\"-------------\"); ////ä½¿ç”¨é›†åˆçš„éå†æ“ä½œ employees.forEach(System.out::println); &#125; /** * æ˜¯å¦æ‰€æœ‰çš„å‘˜å·¥çš„å·¥èµ„æ˜¯å¦éƒ½å¤§äº5000ï¼šfalse * æ˜¯å¦å­˜åœ¨å‘˜å·¥å¹´é¾„å°äº15ï¼šfalse * æ˜¯å¦ä¸å­˜åœ¨å‘˜å·¥å§“é©¬ï¼šfalse * è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ï¼šOptional[Employee&#123;id=1001, name='é©¬åŒ–è…¾', age=34, salary=6000.38&#125;] * è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ Optional[Employee&#123;id=1001, name='é©¬åŒ–è…¾', age=34, salary=6000.38&#125;] * è¿”å›å…ƒç´ æ€»æ•°ï¼š8 * è¿”å›æœ€é«˜å·¥èµ„ï¼šOptional[9876.12] * è¿”å›æœ€å°å¹´é¾„ï¼šOptional[12] * Employee&#123;id=1001, name='é©¬åŒ–è…¾', age=34, salary=6000.38&#125; * Employee&#123;id=1002, name='é©¬äº‘', age=12, salary=9876.12&#125; * Employee&#123;id=1003, name='åˆ˜å¼ºä¸œ', age=33, salary=3000.82&#125; * Employee&#123;id=1004, name='é›·å†›', age=26, salary=7657.37&#125; * Employee&#123;id=1005, name='æå½¦å®', age=65, salary=5555.32&#125; * Employee&#123;id=1006, name='æ¯”å°”ç›–èŒ¨', age=42, salary=9500.43&#125; * Employee&#123;id=1007, name='ä»»æ­£é', age=26, salary=4333.32&#125; * Employee&#123;id=1008, name='æ‰å…‹ä¼¯æ ¼', age=35, salary=2500.32&#125; * ------------- * Employee&#123;id=1001, name='é©¬åŒ–è…¾', age=34, salary=6000.38&#125; * Employee&#123;id=1002, name='é©¬äº‘', age=12, salary=9876.12&#125; * Employee&#123;id=1003, name='åˆ˜å¼ºä¸œ', age=33, salary=3000.82&#125; * Employee&#123;id=1004, name='é›·å†›', age=26, salary=7657.37&#125; * Employee&#123;id=1005, name='æå½¦å®', age=65, salary=5555.32&#125; * Employee&#123;id=1006, name='æ¯”å°”ç›–èŒ¨', age=42, salary=9500.43&#125; * Employee&#123;id=1007, name='ä»»æ­£é', age=26, salary=4333.32&#125; * Employee&#123;id=1008, name='æ‰å…‹ä¼¯æ ¼', age=35, salary=2500.32&#125; * * Process finished with exit code 0 */ Streamçš„ç»ˆæ­¢æ“ä½œ:å½’çº¦ æ–¹æ³• æè¿° reduce(T iden, BinaryOperator b) å¯ä»¥å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚è¿”å›T reduce(BinaryOperator b) å¯ä»¥å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚è¿”å›Optional @org.junit.jupiter.api.Test public void test8() &#123; List&lt;Integer> nums = Arrays.asList(13, 32, 23, 31, 94, 20, 77, 21, 17); List&lt;Employee> employees = EmployeeData.getEmployees(); // reduce(T identity, BinaryOperator)â€”â€”å¯ä»¥å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚è¿”å› T // ç»ƒä¹ 1ï¼šè®¡ç®—1-10çš„è‡ªç„¶æ•°çš„å’Œ System.out.println(nums.stream().reduce(0,Integer::sum)); //reduce(BinaryOperator) â€”â€”å¯ä»¥å°†æµä¸­å…ƒç´ åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼ã€‚è¿”å› Optional&lt;T> // ç»ƒä¹ 2ï¼šè®¡ç®—å…¬å¸æ‰€æœ‰å‘˜å·¥å·¥èµ„æ€»å’Œ System.out.println(employees.stream().map(Employee::getSalary).reduce((o1,o2)->o1+o2)); // åˆ«çš„å†™æ³•ï¼Œè®¡ç®—å¹´é¾„æ€»å’Œ System.out.println(employees.stream().map(Employee::getAge).reduce(0,Integer::sum)); &#125; /** * 328 * Optional[48424.08] * 273 */ Streamçš„ç»ˆæ­¢æ“ä½œ:æ”¶é›† æ–¹æ³• æè¿° collect(Collector c) å°†æµè½¬æ¢ä¸ºå…¶ä»–å½¢å¼ã€‚æ¥æ”¶ä¸€ä¸ªCollectoræ¥å£çš„å®ç°ï¼Œç”¨äºç»™Streamä¸­å…ƒç´ åšæ±‡æ€»çš„æ–¹æ³• @org.junit.jupiter.api.Test public void test9() &#123; // collect(Collector c)â€”â€”å°†æµè½¬æ¢ä¸ºå…¶ä»–å½¢å¼ã€‚æ¥æ”¶ä¸€ä¸ª Collectoræ¥å£çš„å®ç°ï¼Œç”¨äºç»™Streamä¸­å…ƒç´ åšæ±‡æ€»çš„æ–¹æ³• // ç»ƒä¹ 1ï¼šæŸ¥æ‰¾å·¥èµ„å¤§äº6000çš„å‘˜å·¥ï¼Œç»“æœè¿”å›ä¸ºä¸€ä¸ªList List&lt;Employee> employees = EmployeeData.getEmployees(); List&lt;Employee> collect = employees.stream().filter(employee -> employee.getSalary() > 6000).collect(Collectors.toList()); collect.forEach(System.out::println); System.out.println(\"--------------------\"); // ç»ƒä¹ 2ï¼šæŸ¥æ‰¾å¹´é¾„å¤§äº20çš„å‘˜å·¥ï¼Œç»“æœè¿”å›ä¸ºä¸€ä¸ªList List&lt;Employee> collect1 = employees.stream().filter(employee -> employee.getAge() > 20).collect(Collectors.toList()); collect1.forEach(System.out::println); &#125; /** * Employee&#123;id=1001, name='é©¬åŒ–è…¾', age=34, salary=6000.38&#125; * Employee&#123;id=1002, name='é©¬äº‘', age=12, salary=9876.12&#125; * Employee&#123;id=1004, name='é›·å†›', age=26, salary=7657.37&#125; * Employee&#123;id=1006, name='æ¯”å°”ç›–èŒ¨', age=42, salary=9500.43&#125; * -------------------- * Employee&#123;id=1001, name='é©¬åŒ–è…¾', age=34, salary=6000.38&#125; * Employee&#123;id=1003, name='åˆ˜å¼ºä¸œ', age=33, salary=3000.82&#125; * Employee&#123;id=1004, name='é›·å†›', age=26, salary=7657.37&#125; * Employee&#123;id=1005, name='æå½¦å®', age=65, salary=5555.32&#125; * Employee&#123;id=1006, name='æ¯”å°”ç›–èŒ¨', age=42, salary=9500.43&#125; * Employee&#123;id=1007, name='ä»»æ­£é', age=26, salary=4333.32&#125; * Employee&#123;id=1008, name='æ‰å…‹ä¼¯æ ¼', age=35, salary=2500.32&#125; * * Process finished with exit code 0 */ Optionalç±»ç®€ä»‹ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè‡­åæ˜­è‘—çš„ç©ºæŒ‡é’ˆå¼‚å¸¸æ˜¯å¯¼è‡´Javaåº”ç”¨ç¨‹åºå¤±è´¥çš„æœ€å¸¸è§åŸå› ã€‚ä»¥å‰ï¼Œä¸ºäº†è§£å†³ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼ŒGoogleå…¬å¸è‘—åçš„Guavaé¡¹ç›®å¼•å…¥äº†Optionalç±»ï¼ŒGuavaé€šè¿‡ä½¿ç”¨æ£€æŸ¥ç©ºå€¼çš„æ–¹å¼æ¥é˜²æ­¢ä»£ç æ±¡æŸ“ï¼Œå®ƒé¼“åŠ±ç¨‹åºå‘˜å†™æ›´å¹²å‡€çš„ä»£ç ã€‚å—åˆ°Google Guavaçš„å¯å‘ï¼ŒOptionalç±»å·²ç»æˆä¸ºJava 8ç±»åº“çš„ä¸€éƒ¨åˆ†ã€‚ Optional ç±»(java.util.Optional) æ˜¯ä¸€ä¸ªå®¹å™¨ç±»ï¼Œå®ƒå¯ä»¥ä¿å­˜ç±»å‹Tçš„å€¼ï¼Œä»£è¡¨è¿™ä¸ªå€¼å­˜åœ¨ã€‚æˆ–è€…ä»…ä»…ä¿å­˜nullï¼Œè¡¨ç¤ºè¿™ä¸ªå€¼ä¸å­˜åœ¨ã€‚åŸæ¥ç”¨null è¡¨ç¤ºä¸€ä¸ªå€¼ä¸å­˜åœ¨ï¼Œç°åœ¨Optional å¯ä»¥æ›´å¥½çš„è¡¨è¾¾è¿™ä¸ªæ¦‚å¿µã€‚å¹¶ä¸”å¯ä»¥é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ Optionalç±»çš„Javadocæè¿°å¦‚ä¸‹ï¼šè¿™æ˜¯ä¸€ä¸ªå¯ä»¥ä¸ºnullçš„å®¹å™¨å¯¹è±¡ã€‚å¦‚æœå€¼å­˜åœ¨åˆ™isPresent()æ–¹æ³•ä¼šè¿”å›trueï¼Œè°ƒç”¨get()æ–¹æ³•ä¼šè¿”å›è¯¥å¯¹è±¡ã€‚ Optionalæä¾›å¾ˆå¤šæœ‰ç”¨çš„æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨æ˜¾å¼è¿›è¡Œç©ºå€¼æ£€æµ‹ã€‚ åˆ›å»ºOptionalç±»å¯¹è±¡çš„æ–¹æ³•ï¼š Optional.of(T t): åˆ›å»ºä¸€ä¸ªOptional å®ä¾‹ï¼Œtå¿…é¡»éç©ºï¼› Optional.empty() : åˆ›å»ºä¸€ä¸ªç©ºçš„Optional å®ä¾‹ Optional.ofNullable(T t)ï¼štå¯ä»¥ä¸ºnull åˆ¤æ–­Optionalå®¹å™¨ä¸­æ˜¯å¦åŒ…å«å¯¹è±¡ï¼š boolean isPresent() : åˆ¤æ–­æ˜¯å¦åŒ…å«å¯¹è±¡ void ifPresent(Consumer&lt;? super T&gt; consumer) ï¼šå¦‚æœæœ‰å€¼ï¼Œå°±æ‰§è¡ŒConsumeræ¥å£çš„å®ç°ä»£ç ï¼Œå¹¶ä¸”è¯¥å€¼ä¼šä½œä¸ºå‚æ•°ä¼ ç»™å®ƒã€‚ è·å–Optionalå®¹å™¨çš„å¯¹è±¡ï¼š T get(): å¦‚æœè°ƒç”¨å¯¹è±¡åŒ…å«å€¼ï¼Œè¿”å›è¯¥å€¼ï¼Œå¦åˆ™æŠ›å¼‚å¸¸ T orElse(T other) ï¼šå¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™è¿”å›æŒ‡å®šçš„otherå¯¹è±¡ã€‚ T orElseGet(Supplier&lt;? extends T&gt; other) ï¼šå¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™è¿”å›ç”±Supplieræ¥å£å®ç°æä¾›çš„å¯¹è±¡ã€‚ T orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier) ï¼šå¦‚æœæœ‰å€¼åˆ™å°†å…¶è¿”å›ï¼Œå¦åˆ™æŠ›å‡ºç”±Supplieræ¥å£å®ç°æä¾›çš„å¼‚å¸¸ã€‚ ä½¿ç”¨ä¸¾ä¾‹Boyç±» public class Boy &#123; private Girl girl; public Boy() &#123; &#125; public Boy(Girl girl) &#123; this.girl = girl; &#125; public Girl getGirl() &#123; return girl; &#125; public void setGirl(Girl girl) &#123; this.girl = girl; &#125; @Override public String toString() &#123; return \"Boy&#123;\" + \"girl=\" + girl + '&#125;'; &#125; &#125; Grilç±» public class Girl &#123; private String name; public Girl() &#123; &#125; public Girl(String name) &#123; this.name = name; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; @Override public String toString() &#123; return \"Girl&#123;\" + \"name='\" + name + '\\'' + '&#125;'; &#125; &#125; æµ‹è¯•ç±» @Test public void test()&#123; Girl girl = new Girl(); // girl = null; // of(T t):ä¿è¯tæ˜¯éç©ºçš„ Optional&lt;Girl> optionalGirl = Optional.of(girl); &#125; @Test public void test25()&#123; Girl girl = new Girl(); // girl = null; // ofNullable(T t)ï¼štå¯ä»¥ä¸ºnull Optional&lt;Girl> optionalGirl = Optional.ofNullable(girl); System.out.println(optionalGirl); // orElse(T t1):å¦‚æœå•å‰çš„Optionalå†…éƒ¨å°è£…çš„tæ˜¯éç©ºçš„ï¼Œåˆ™è¿”å›å†…éƒ¨çš„t. // å¦‚æœå†…éƒ¨çš„tæ˜¯ç©ºçš„ï¼Œåˆ™è¿”å›orElse()æ–¹æ³•ä¸­çš„å‚æ•°t1. Girl girl1 = optionalGirl.orElse(new Girl(\"\")); System.out.println(girl1); &#125;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"}],"author":"ehzyil"},{"title":"Linux å®‰è£… dockeré‡åˆ°ç‰ˆæœ¬é—®é¢˜","slug":"2023/Linux å®‰è£… dockeré‡åˆ°ç‰ˆæœ¬é—®é¢˜","date":"2023-10-09T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/10/09/2023/Linux å®‰è£… dockeré‡åˆ°ç‰ˆæœ¬é—®é¢˜/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/09/2023/Linux%20%E5%AE%89%E8%A3%85%20docker%E9%81%87%E5%88%B0%E7%89%88%E6%9C%AC%E9%97%AE%E9%A2%98/","excerpt":"","text":"linux å®‰è£… dockeré‡åˆ°ç‰ˆæœ¬é—®é¢˜å°è®° å®éªŒç¯å¢ƒ Centos 7 linux å°ç‰ˆæœ¬æ›´æ–°docker å¯¹ linux ç‰ˆæœ¬æœ‰è¦æ±‚(æ¬¡è¦ç‰ˆæœ¬ &gt;300 å·¦å³). ç‰ˆæœ¬è¿‡ä½ä¼šå¯¼è‡´ä¸€ç³»åˆ—: æ¯”å¦‚ç«¯å£æ˜ å°„äº†,ä½†èŒƒå›´ä¸é€šçš„æƒ…å†µ æ‰¾å‡ºç³»ç»Ÿä¸Šæ­£åœ¨è¿è¡Œçš„Linuxå†…æ ¸ç‰ˆæœ¬$ uname -srm Linux 3.10.0-327.el7.x86_64 x86_64 Linux 3.10.0-327.el7.x86_64 x86_64 3 - å†…æ ¸ç‰ˆæœ¬. 10 - ä¸»ä¿®è®¢ç‰ˆæœ¬. 0-957 - æ¬¡è¦ä¿®è®¢ç‰ˆæœ¬. æŸ¥è¯¢å¯å‡çº§æœ€æ–°ç‰ˆæœ¬[root@localhost ~]# yum list kernel å·²åŠ è½½æ’ä»¶ï¼šfastestmirror, langpacks Loading mirror speeds from cached hostfile * base: mirrors.aliyun.com * extras: mirrors.aliyun.com * updates: mirrors.aliyun.com å·²å®‰è£…çš„è½¯ä»¶åŒ… kernel.x86_64 3.10.0-327.el7 @anaconda å¯å®‰è£…çš„è½¯ä»¶åŒ… kernel.x86_64 3.10.0-1160.92.1.el7 updates ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯ä»¥å‡çº§åˆ° 3.10.0-1160.92.1.el7, äºæ˜¯æ‰§è¡Œå‘½ä»¤ yum update -y kernel è¿›è¡Œå°ç‰ˆæœ¬å‡çº§ é‡å¯ç³»ç»Ÿå‘½ä»¤ sudo init 6 é‡å¯ç³»ç»Ÿå, åœ¨æŸ¥çœ‹ linux å†…æ ¸ç‰ˆæœ¬ [root@localhost uname -srm Linux 3.10.0-1160.92.1.el7.x86_64 x86_64 å¸è½½å¹¶é‡æ–°å®‰è£…Dockerï¼Œé—®é¢˜è§£å†³ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://blog.ehzyil.xyz/tags/Docker/"},{"name":"Linux","slug":"Linux","permalink":"https://blog.ehzyil.xyz/tags/Linux/"}],"author":"ehzyil"},{"title":"Yauaaï¼šå¦ä¸€ä¸ª UserAgent åˆ†æå™¨","slug":"2023/Yauaaï¼šå¦ä¸€ä¸ª UserAgent åˆ†æå™¨çš„ä½¿ç”¨","date":"2023-10-09T00:00:00.000Z","updated":"2024-01-30T06:30:58.131Z","comments":true,"path":"2023/10/09/2023/Yauaaï¼šå¦ä¸€ä¸ª UserAgent åˆ†æå™¨çš„ä½¿ç”¨/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/09/2023/Yauaa%EF%BC%9A%E5%8F%A6%E4%B8%80%E4%B8%AA%20UserAgent%20%E5%88%86%E6%9E%90%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8/","excerpt":"","text":"Yauaaè‡ªè¿°Yauaa: Yet Another UserAgent Analyzer è¿™æ˜¯ä¸€ä¸ª java åº“ï¼Œå°è¯•è§£æå’Œåˆ†æç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²ï¼ˆä»¥åŠç”¨æˆ·ä»£ç†å®¢æˆ·ç«¯æç¤ºå¯ç”¨æ—¶ï¼‰å¹¶æå–å°½å¯èƒ½å¤šçš„ç›¸å…³å±æ€§ã€‚å¯ä¸ Javaã€Scalaã€Kotlin é…åˆä½¿ç”¨ï¼Œå¹¶ä¸ºå¤šç§å¤„ç†ç³»ç»Ÿæä¾›ç°æˆçš„ UDFã€‚å®Œæ•´çš„æ–‡æ¡£å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°https://yauaa.basjes.nl ä½¿ç”¨Yauaaç¬¬ä¸€æ­¥ æ·»åŠ Yauaaä¾èµ– å¦‚æœä½¿ç”¨åŸºäº Maven çš„é¡¹ç›®ï¼Œåªéœ€å°†æ­¤ä¾èµ–é¡¹æ·»åŠ åˆ°Maven çš„é¡¹ç›®ä¸­å³å¯ã€‚ &lt;dependency&gt; &lt;groupId&gt;nl.basjes.parse.useragent&lt;&#x2F;groupId&gt; &lt;artifactId&gt;yauaa&lt;&#x2F;artifactId&gt; &lt;version&gt;7.22.0&lt;&#x2F;version&gt; &lt;&#x2F;dependency&gt; ç¬¬äºŒæ­¥ åˆ›å»ºåˆ›å»ºä¸€ä¸ªå·¥å…·ç±» UserAgentAnalyzer. public class UserAgentUtils &#123; private static final UserAgentAnalyzer USER_AGENT_ANALYZER; static &#123; USER_AGENT_ANALYZER = UserAgentAnalyzer .newBuilder() .hideMatcherLoadStats() .withField(UserAgent.OPERATING_SYSTEM_NAME_VERSION_MAJOR) .withField(UserAgent.AGENT_NAME_VERSION) .build(); &#125; /** * ä»User-Agentè§£æå®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨ç‰ˆæœ¬ */ public static Map&lt;String, String> parseOsAndBrowser(String userAgent) &#123; UserAgent agent = USER_AGENT_ANALYZER.parse(userAgent); String os = agent.getValue(UserAgent.OPERATING_SYSTEM_NAME_VERSION_MAJOR); String browser = agent.getValue(UserAgent.AGENT_NAME_VERSION); Map&lt;String, String> map = new HashMap&lt;>(2); map.put(\"os\", os); map.put(\"browser\", browser); return map; &#125; &#125; ç¬¬ä¸‰æ­¥ä½¿ç”¨ å¯¹äºæ¯ä¸ªUserAgentï¼ˆæˆ–ä¸€ç»„è¯·æ±‚æ ‡å¤´ï¼‰ï¼Œæ‚¨å¯ä»¥è°ƒç”¨è¯¥parseæ–¹æ³•æ¥è·å¾—æ‰€éœ€çš„ç»“æœï¼š UserAgent agent = uaa.parse(\"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.11) Gecko/20071127 Firefox/2.0.0.11\"); for (String fieldName: agent.getAvailableFieldNamesSorted()) &#123; System.out.println(fieldName + \" = \" + agent.getValue(fieldName)); &#125; è¯·æ³¨æ„ï¼Œå¹¶éæ‰€æœ‰å­—æ®µåœ¨æ¯æ¬¡è§£æåéƒ½å¯ç”¨ã€‚å› æ­¤ï¼Œè¯·å‡†å¤‡å¥½æ¥æ”¶nullæˆ–Unknownå…¶ä»–å­—æ®µç‰¹å®šçš„é»˜è®¤å€¼ String userAgent = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.77 Safari/537.36\"; Map&lt;String, String> userAgentMap = userAgentUtils.parseOsAndBrowser(userAgent); System.err.println(userAgentMap); String os = userAgentMap.get(\"os\"); String browser = userAgentMap.get(\"browser\"); System.err.println(os); System.err.println(browser); åœ¨å·¥å…·ç±»ä¸­ åªè·å–äº†æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨çš„åç§°ç‰ˆæœ¬(å¦‚æœ‰å…¶ä»–éœ€è¦å¯è‡ªè¡Œæ·»åŠ ï¼Œè¯¦è§package nl.basjes.parse.useragent;)","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://blog.ehzyil.xyz/categories/%E5%B7%A5%E5%85%B7/"}],"tags":[{"name":"Yauaa","slug":"Yauaa","permalink":"https://blog.ehzyil.xyz/tags/Yauaa/"}],"author":"ehzyil"},{"title":"nodeçš„å¸è½½ä¸å®‰è£…","slug":"2023/nodeçš„å¸è½½ä¸å®‰è£…","date":"2023-10-09T00:00:00.000Z","updated":"2024-01-30T06:30:58.143Z","comments":true,"path":"2023/10/09/2023/nodeçš„å¸è½½ä¸å®‰è£…/","link":"","permalink":"https://blog.ehzyil.xyz/2023/10/09/2023/node%E7%9A%84%E5%8D%B8%E8%BD%BD%E4%B8%8E%E5%AE%89%E8%A3%85/","excerpt":"","text":"ä¸€ã€node.jså¸è½½1ã€æ‰“å¼€cmd è¾“å…¥ä¸‹åˆ—å‘½ä»¤ æŸ¥çœ‹npmåŒ…è·¯å¾„ #æŸ¥çœ‹å…¨å±€å®‰è£…ä½ç½® npm root -g å¾—åˆ°npmçš„æ–‡ä»¶è·¯å¾„ ä¸‹é¢çš„å‘½ä»¤ï¼Œå¯ä»¥ç”¨äºæŸ¥çœ‹æœ¬æœºçš„npmç¼“å­˜çš„ä½ç½®ï¼š npm config get cache 2ã€åˆ é™¤C:\\Users\\ç”¨æˆ·å\\AppData\\Roamingç›®å½•ä¸‹çš„npmå’Œnpm-cacheï¼› 3ã€åœ¨æ§åˆ¶é¢æ¿ä¸­æ‰¾åˆ°Node.jsçš„å¸è½½ç¨‹åºï¼Œè¿è¡Œå¸è½½ç¨‹åºã€‚ äºŒã€å®‰è£…1ã€è¿›å…¥node.jså„ç‰ˆæœ¬ä¸‹è½½é“¾æ¥ æ‰¾åˆ°è¦å®‰è£…çš„ç‰ˆæœ¬ï¼Œä¸‹è½½è¿›è¡Œå®‰è£… 2ã€æŸ¥çœ‹node.jså®‰è£…ç‰ˆæœ¬å’Œnpmç‰ˆæœ¬ ehZyiL@DESKTOP-1H567GC MINGW64 ~&#x2F;Desktop $ node -v v18.16.0 ehZyiL@DESKTOP-1H567GC MINGW64 ~&#x2F;Desktop $ npm -v 9.5.1 cmdè¿›å…¥å‘½ä»¤è¡Œç•Œé¢ï¼Œè¾“å…¥node -v æ˜¾ç¤ºnodeç‰ˆæœ¬ï¼Œè¾“å…¥npm -væ˜¾ç¤ºnpmç‰ˆæœ¬ï¼Œå¦‚æœéƒ½èƒ½æ˜¾ç¤ºåˆ™å®‰è£…æˆåŠŸã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"è½¯ä»¶","slug":"è½¯ä»¶","permalink":"https://blog.ehzyil.xyz/tags/%E8%BD%AF%E4%BB%B6/"},{"name":"node.js","slug":"node-js","permalink":"https://blog.ehzyil.xyz/tags/node-js/"}],"author":"ehzyil"},{"title":"Spring Security","slug":"2023/Spring Security","date":"2023-09-16T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/09/16/2023/Spring Security/","link":"","permalink":"https://blog.ehzyil.xyz/2023/09/16/2023/Spring%20Security/","excerpt":"","text":"Spring Security1.è®¤è¯è®¤è¯åŸç†SpringSecurityçš„åŸç†å…¶å®å°±æ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨é“¾ï¼Œå†…éƒ¨åŒ…å«äº†æä¾›å„ç§åŠŸèƒ½çš„è¿‡æ»¤å™¨ã€‚ä¾‹å¦‚å¿«é€Ÿå…¥é—¨æ¡ˆä¾‹é‡Œé¢ä½¿ç”¨åˆ°çš„ä¸‰ç§è¿‡æ»¤å™¨ï¼Œå¦‚ä¸‹å›¾ ç›‘å¬å™¨ -&gt; è¿‡æ»¤å™¨é“¾ -&gt; dispatcherservlet(å‰ç½®æ‹¦æˆªå™¨ -&gt; mapperHandle -&gt; åç½®æ‹¦æˆªå™¨ -&gt; æœ€ç»ˆæ‹¦æˆªå™¨) ä¸‹é¢ä»‹ç»è¿‡æ»¤å™¨é“¾ä¸­ä¸»è¦çš„å‡ ä¸ªè¿‡æ»¤å™¨åŠå…¶ä½œç”¨ï¼š SecurityContextPersistenceFilter è¿™ä¸ªFilteræ˜¯æ•´ä¸ªæ‹¦æˆªè¿‡ç¨‹çš„å…¥å£å’Œå‡ºå£ï¼ˆä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªæ‹¦æˆªå™¨ï¼‰ï¼Œä¼šåœ¨è¯·æ±‚å¼€å§‹æ—¶ä»é…ç½®å¥½çš„ SecurityContextRepository ä¸­è·å– SecurityContextï¼Œç„¶åæŠŠå®ƒè®¾ç½®ç»™ SecurityContextHolderã€‚åœ¨è¯·æ±‚å®Œæˆåå°† SecurityContextHolder æŒæœ‰çš„ SecurityContext å†ä¿å­˜åˆ°é…ç½®å¥½çš„ SecurityContextRepositoryï¼ŒåŒæ—¶æ¸…é™¤ securityContextHolder æ‰€æŒæœ‰çš„ SecurityContextï¼› UsernamePasswordAuthenticationFilter ç”¨äºå¤„ç†æ¥è‡ªè¡¨å•æäº¤çš„è®¤è¯ã€‚è¯¥è¡¨å•å¿…é¡»æä¾›å¯¹åº”çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå…¶å†…éƒ¨è¿˜æœ‰ç™»å½•æˆåŠŸæˆ–å¤±è´¥åè¿›è¡Œå¤„ç†çš„ AuthenticationSuccessHandler å’Œ AuthenticationFailureHandlerï¼Œè¿™äº›éƒ½å¯ä»¥æ ¹æ®éœ€æ±‚åšç›¸å…³æ”¹å˜ï¼› ExceptionTranslationFilter èƒ½å¤Ÿæ•è·æ¥è‡ª FilterChain æ‰€æœ‰çš„å¼‚å¸¸ï¼Œå¹¶è¿›è¡Œå¤„ç†ã€‚ä½†æ˜¯å®ƒåªä¼šå¤„ç†ä¸¤ç±»å¼‚å¸¸ï¼šAuthenticationException å’Œ AccessDeniedExceptionï¼Œå…¶å®ƒçš„å¼‚å¸¸å®ƒä¼šç»§ç»­æŠ›å‡ºã€‚ FilterSecurityInterceptor æ˜¯ç”¨äºä¿æŠ¤webèµ„æºçš„ï¼Œä½¿ç”¨AccessDecisionManagerå¯¹å½“å‰ç”¨æˆ·è¿›è¡Œæˆæƒè®¿é—®ï¼Œå‰é¢å·²ç»è¯¦ç»†ä»‹ç»è¿‡äº†ï¼› è®¤è¯æµç¨‹Spring Securityçš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š ç”¨æˆ·æäº¤ç”¨æˆ·åã€å¯†ç è¢«SecurityFilterChainä¸­çš„UsernamePasswordAuthenticationFilterè¿‡æ»¤å™¨è·å–åˆ°ï¼Œå°è£…ä¸ºè¯·æ±‚Authenticationï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯UsernamePasswordAuthenticationTokenè¿™ä¸ªå®ç°ç±»ã€‚ ç„¶åè¿‡æ»¤å™¨å°†Authenticationæäº¤è‡³è®¤è¯ç®¡ç†å™¨ï¼ˆAuthenticationManagerï¼‰è¿›è¡Œè®¤è¯ è®¤è¯æˆåŠŸåï¼ŒAuthenticationManagerèº«ä»½ç®¡ç†å™¨è¿”å›ä¸€ä¸ªè¢«å¡«å……æ»¡äº†ä¿¡æ¯çš„ï¼ˆåŒ…æ‹¬ä¸Šé¢æåˆ°çš„æƒé™ä¿¡æ¯ï¼Œèº«ä»½ä¿¡æ¯ï¼Œç»†èŠ‚ä¿¡æ¯ï¼Œä½†å¯†ç é€šå¸¸ä¼šè¢«ç§»é™¤ï¼‰Authenticationå®ä¾‹ã€‚ SecurityContextHolderAuthenticationï¼Œå®‰å…¨ä¸Šä¸‹æ–‡å®¹å™¨å°†ç¬¬3æ­¥å¡«å……äº†ä¿¡æ¯çš„é€š è¿‡SecurityContextHolder.getContext().setAuthentication(â€¦)æ–¹æ³•ï¼Œè®¾ç½®åˆ°å…¶ä¸­ã€‚ å¯ä»¥çœ‹å‡ºAuthenticationManageræ¥å£ï¼ˆè®¤è¯ç®¡ç†å™¨ï¼‰æ˜¯è®¤è¯ç›¸å…³çš„æ ¸å¿ƒæ¥å£ï¼Œä¹Ÿæ˜¯å‘èµ·è®¤è¯çš„å‡ºå‘ç‚¹ï¼Œå®ƒçš„å®ç°ç±»ä¸ºProviderManagerã€‚è€ŒSpring Securityæ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼Œå› æ­¤ProviderManagerç»´æŠ¤ç€ä¸€ä¸ªListåˆ—è¡¨ï¼Œå­˜æ”¾å¤šç§è®¤è¯æ–¹å¼ï¼Œæœ€ç»ˆå®é™…çš„è®¤è¯å·¥ä½œæ˜¯ç”±AuthenticationProviderå®Œæˆçš„ã€‚å’±ä»¬çŸ¥é“webè¡¨å•çš„å¯¹åº”çš„AuthenticationProviderå®ç°ç±»ä¸ºDaoAuthenticationProviderï¼Œå®ƒçš„å†…éƒ¨åˆç»´æŠ¤ç€ä¸€ä¸ªUserDetailsServiceè´Ÿè´£UserDetailsçš„è·å–ã€‚æœ€ç»ˆAuthenticationProviderå°†UserDetailså¡«å……è‡³Authenticationã€‚ å®è·µè‡ªå®šä¹‰securityçš„æ€è·¯ã€ç™»å½•ã€‘ â‘ ã€è‡ªå®šä¹‰ç™»å½•æ¥å£ã€‚ç”¨äºè°ƒç”¨ProviderManagerçš„æ–¹æ³•è¿›è¡Œè®¤è¯ å¦‚æœè®¤è¯é€šè¿‡ç”Ÿæˆjwtï¼Œç„¶åæŠŠç”¨æˆ·ä¿¡æ¯å­˜å…¥redisä¸­ â‘¡ã€è‡ªå®šä¹‰UserDetailsServiceæ¥å£çš„å®ç°ç±»ã€‚åœ¨è¿™ä¸ªå®ç°ç±»ä¸­å»æŸ¥è¯¢æ•°æ®åº“ ã€æ ¡éªŒã€‘ â‘ ã€å®šä¹‰Jwtè®¤è¯è¿‡æ»¤å™¨ã€‚ç”¨äºè·å–tokenï¼Œç„¶åè§£ætokenè·å–å…¶ä¸­çš„useridï¼Œè¿˜éœ€è¦ä»redisä¸­è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åå­˜å…¥SecurityContextHolder è‡ªå®šä¹‰securityçš„æ­å»ºç¬¬ä¸€æ­¥:æ–°å»ºMavené¡¹ç›®å¼•å…¥ä»¥ä¸‹ä¾èµ– &lt;parent> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-parent&lt;/artifactId> &lt;version>2.5.0&lt;/version> &lt;/parent> &lt;dependencies> &lt;!--è¿˜è¦å¼•å…¥è¿™ä¸ªï¼Œä¸ç„¶åé¢javax.servletä¾èµ–æ‰¾ä¸åˆ°--> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-web&lt;/artifactId> &lt;/dependency> &lt;!--springbootæ•´åˆspringsecurity--> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-security&lt;/artifactId> &lt;/dependency> &lt;!--redisä¾èµ–--> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-data-redis&lt;/artifactId> &lt;/dependency> &lt;!--fastjsonä¾èµ–--> &lt;dependency> &lt;groupId>com.alibaba&lt;/groupId> &lt;artifactId>fastjson&lt;/artifactId> &lt;version>1.2.33&lt;/version> &lt;/dependency> &lt;!--jwtä¾èµ–--> &lt;dependency> &lt;groupId>io.jsonwebtoken&lt;/groupId> &lt;artifactId>jjwt&lt;/artifactId> &lt;version>0.9.0&lt;/version> &lt;/dependency> &lt;!--å¼•å…¥Lombokä¾èµ–ï¼Œæ–¹ä¾¿å®ä½“ç±»å¼€å‘--> &lt;dependency> &lt;groupId>org.projectlombok&lt;/groupId> &lt;artifactId>lombok&lt;/artifactId> &lt;/dependency> &lt;/dependencies> ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä»¥ä¸‹ç±» å¯åŠ¨ç±» @SpringBootApplication @MapperScan(\"com.ehzyil.mapper\") public class SecurityApplication &#123; public static void main(String[] args) &#123; ConfigurableApplicationContext run = SpringApplication.run(SecurityApplication.class); System.out.println(run); &#125; &#125; æµ‹è¯•æ¥å£ @RestController public class HelloController &#123; @RequestMapping(\"/hello\") public String hello()&#123; return \"æ¬¢è¿ï¼Œå¼€å§‹ä½ æ–°çš„å­¦ä¹ æ—…ç¨‹å§\"; &#125; &#125; utils.FastJsonRedisSerializer package com.ehzyil.utils; import com.alibaba.fastjson.JSON; import com.alibaba.fastjson.parser.ParserConfig; import com.alibaba.fastjson.serializer.SerializerFeature; import com.fasterxml.jackson.databind.JavaType; import com.fasterxml.jackson.databind.type.TypeFactory; import org.springframework.data.redis.serializer.RedisSerializer; import org.springframework.data.redis.serializer.SerializationException; import java.nio.charset.Charset; /** * Redisä½¿ç”¨FastJsonåºåˆ—åŒ– * * @param &lt;T> */ public class FastJsonRedisSerializer&lt;T> implements RedisSerializer&lt;T> &#123; public static final Charset DEFAULT_CHARSET = Charset.forName(\"UTF-8\"); static &#123; ParserConfig.getGlobalInstance().setAutoTypeSupport(true); &#125; private Class&lt;T> clazz; public FastJsonRedisSerializer(Class&lt;T> clazz) &#123; super(); this.clazz = clazz; &#125; @Override public byte[] serialize(T t) throws SerializationException &#123; if (t == null) &#123; return new byte[0]; &#125; return JSON.toJSONString(t, SerializerFeature.WriteClassName).getBytes(DEFAULT_CHARSET); &#125; @Override public T deserialize(byte[] bytes) throws SerializationException &#123; if (bytes == null || bytes.length &lt;= 0) &#123; return null; &#125; String str = new String(bytes, DEFAULT_CHARSET); return JSON.parseObject(str, clazz); &#125; protected JavaType getJavaType(Class&lt;?> clazz) &#123; return TypeFactory.defaultInstance().constructType(clazz); &#125; &#125; JwtUtil package com.ehzyil.utils; import io.jsonwebtoken.Claims; import io.jsonwebtoken.JwtBuilder; import io.jsonwebtoken.Jwts; import io.jsonwebtoken.SignatureAlgorithm; import javax.crypto.SecretKey; import javax.crypto.spec.SecretKeySpec; import java.util.Base64; import java.util.Date; import java.util.UUID; &#x2F;&#x2F;JWTå·¥å…·ç±» public class JwtUtil &#123; &#x2F;&#x2F;æœ‰æ•ˆæœŸä¸º public static final Long JWT_TTL &#x3D; 60 * 60 * 1000L;&#x2F;&#x2F; 60 * 60 *1000 ä¸€ä¸ªå°æ—¶ &#x2F;&#x2F;è®¾ç½®ç§˜é’¥æ˜æ–‡, æ³¨æ„é•¿åº¦å¿…é¡»å¤§äºç­‰äº6ä½ public static final String JWT_KEY &#x3D; &quot;huanfqc&quot;; public static String getUUID() &#123; String token &#x3D; UUID.randomUUID().toString().replaceAll(&quot;-&quot;, &quot;&quot;); return token; &#125; &#x2F;** * ç”Ÿæˆjtw * * @param subject tokenä¸­è¦å­˜æ”¾çš„æ•°æ®ï¼ˆjsonæ ¼å¼ï¼‰ * @return *&#x2F; public static String createJWT(String subject) &#123; JwtBuilder builder &#x3D; getJwtBuilder(subject, null, getUUID());&#x2F;&#x2F; è®¾ç½®è¿‡æœŸæ—¶é—´ return builder.compact(); &#125; &#x2F;** * ç”Ÿæˆjtw * * @param subject tokenä¸­è¦å­˜æ”¾çš„æ•°æ®ï¼ˆjsonæ ¼å¼ï¼‰ * @param ttlMillis tokenè¶…æ—¶æ—¶é—´ * @return *&#x2F; public static String createJWT(String subject, Long ttlMillis) &#123; JwtBuilder builder &#x3D; getJwtBuilder(subject, ttlMillis, getUUID());&#x2F;&#x2F; è®¾ç½®è¿‡æœŸæ—¶é—´ return builder.compact(); &#125; private static JwtBuilder getJwtBuilder(String subject, Long ttlMillis, String uuid) &#123; SignatureAlgorithm signatureAlgorithm &#x3D; SignatureAlgorithm.HS256; SecretKey secretKey &#x3D; generalKey(); long nowMillis &#x3D; System.currentTimeMillis(); Date now &#x3D; new Date(nowMillis); if (ttlMillis &#x3D;&#x3D; null) &#123; ttlMillis &#x3D; JwtUtil.JWT_TTL; &#125; long expMillis &#x3D; nowMillis + ttlMillis; Date expDate &#x3D; new Date(expMillis); return Jwts.builder() .setId(uuid) &#x2F;&#x2F;å”¯ä¸€çš„ID .setSubject(subject) &#x2F;&#x2F; ä¸»é¢˜ å¯ä»¥æ˜¯JSONæ•°æ® .setIssuer(&quot;huanf&quot;) &#x2F;&#x2F; ç­¾å‘è€… .setIssuedAt(now) &#x2F;&#x2F; ç­¾å‘æ—¶é—´ .signWith(signatureAlgorithm, secretKey) &#x2F;&#x2F;ä½¿ç”¨HS256å¯¹ç§°åŠ å¯†ç®—æ³•ç­¾å, ç¬¬äºŒä¸ªå‚æ•°ä¸ºç§˜é’¥ .setExpiration(expDate); &#125; &#x2F;** * åˆ›å»ºtoken * * @param id * @param subject * @param ttlMillis * @return *&#x2F; public static String createJWT(String id, String subject, Long ttlMillis) &#123; JwtBuilder builder &#x3D; getJwtBuilder(subject, ttlMillis, id);&#x2F;&#x2F; è®¾ç½®è¿‡æœŸæ—¶é—´ return builder.compact(); &#125; public static void main(String[] args) throws Exception &#123; &#x2F;&#x2F;åŠ å¯†æŒ‡å®šå­—ç¬¦ä¸²ï¼Œjwtæ˜¯123456åŠ å¯†åçš„å¯†æ–‡ String jwt &#x3D; createJWT(&quot;123456&quot;); System.out.println(jwt); String token &#x3D; &quot;eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0Mzg2MTUxZTFkNTE0ZmUwYjRlOWUzZDZiYjFlODA4OSIsInN1YiI6IjEyMzQ1NiIsImlzcyI6Imh1YW5mIiwiaWF0IjoxNjk0NzgzODI3LCJleHAiOjE2OTQ3ODc0Mjd9.z4QnAiSNBQcCAhZPwC5Xfzb0Py4np7qnyrUg0Ih8Qr4&quot;; Claims claims &#x3D; parseJWT(token); System.out.println(claims); &#125; &#x2F;** * ç”ŸæˆåŠ å¯†åçš„ç§˜é’¥ secretKey * * @return *&#x2F; public static SecretKey generalKey() &#123; byte[] encodedKey &#x3D; Base64.getDecoder().decode(JwtUtil.JWT_KEY); SecretKey key &#x3D; new SecretKeySpec(encodedKey, 0, encodedKey.length, &quot;AES&quot;); return key; &#125; &#x2F;** * è§£æ * * @param jwt * @return * @throws Exception *&#x2F; public static Claims parseJWT(String jwt) throws Exception &#123; SecretKey secretKey &#x3D; generalKey(); return Jwts.parser() .setSigningKey(secretKey) .parseClaimsJws(jwt) .getBody(); &#125; &#125; rediså·¥å…·ç±» RedisCache package com.ehzyil.utils; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.data.redis.core.BoundSetOperations; import org.springframework.data.redis.core.HashOperations; import org.springframework.data.redis.core.RedisTemplate; import org.springframework.data.redis.core.ValueOperations; import org.springframework.stereotype.Component; import java.util.*; import java.util.concurrent.TimeUnit; @SuppressWarnings(value = &#123;\"unchecked\", \"rawtypes\"&#125;) @Component //rediså·¥å…·ç±» public class RedisCache &#123; @Autowired public RedisTemplate redisTemplate; /** * ç¼“å­˜åŸºæœ¬çš„å¯¹è±¡ï¼ŒIntegerã€Stringã€å®ä½“ç±»ç­‰ * * @param key ç¼“å­˜çš„é”®å€¼ * @param value ç¼“å­˜çš„å€¼ */ public &lt;T> void setCacheObject(final String key, final T value) &#123; redisTemplate.opsForValue().set(key, value); &#125; /** * ç¼“å­˜åŸºæœ¬çš„å¯¹è±¡ï¼ŒIntegerã€Stringã€å®ä½“ç±»ç­‰ * * @param key ç¼“å­˜çš„é”®å€¼ * @param value ç¼“å­˜çš„å€¼ * @param timeout æ—¶é—´ * @param timeUnit æ—¶é—´é¢—ç²’åº¦ */ public &lt;T> void setCacheObject(final String key, final T value, final Integer timeout, final TimeUnit timeUnit) &#123; redisTemplate.opsForValue().set(key, value, timeout, timeUnit); &#125; /** * è®¾ç½®æœ‰æ•ˆæ—¶é—´ * * @param key Redisé”® * @param timeout è¶…æ—¶æ—¶é—´ * @return true=è®¾ç½®æˆåŠŸï¼›false=è®¾ç½®å¤±è´¥ */ public boolean expire(final String key, final long timeout) &#123; return expire(key, timeout, TimeUnit.SECONDS); &#125; /** * è®¾ç½®æœ‰æ•ˆæ—¶é—´ * * @param key Redisé”® * @param timeout è¶…æ—¶æ—¶é—´ * @param unit æ—¶é—´å•ä½ * @return true=è®¾ç½®æˆåŠŸï¼›false=è®¾ç½®å¤±è´¥ */ public boolean expire(final String key, final long timeout, final TimeUnit unit) &#123; return redisTemplate.expire(key, timeout, unit); &#125; /** * è·å¾—ç¼“å­˜çš„åŸºæœ¬å¯¹è±¡ã€‚ * * @param key ç¼“å­˜é”®å€¼ * @return ç¼“å­˜é”®å€¼å¯¹åº”çš„æ•°æ® */ public &lt;T> T getCacheObject(final String key) &#123; ValueOperations&lt;String, T> operation = redisTemplate.opsForValue(); return operation.get(key); &#125; /** * åˆ é™¤å•ä¸ªå¯¹è±¡ * * @param key */ public boolean deleteObject(final String key) &#123; return redisTemplate.delete(key); &#125; /** * åˆ é™¤é›†åˆå¯¹è±¡ * * @param collection å¤šä¸ªå¯¹è±¡ * @return */ public long deleteObject(final Collection collection) &#123; return redisTemplate.delete(collection); &#125; /** * ç¼“å­˜Listæ•°æ® * * @param key ç¼“å­˜çš„é”®å€¼ * @param dataList å¾…ç¼“å­˜çš„Listæ•°æ® * @return ç¼“å­˜çš„å¯¹è±¡ */ public &lt;T> long setCacheList(final String key, final List&lt;T> dataList) &#123; Long count = redisTemplate.opsForList().rightPushAll(key, dataList); return count == null ? 0 : count; &#125; /** * è·å¾—ç¼“å­˜çš„listå¯¹è±¡ * * @param key ç¼“å­˜çš„é”®å€¼ * @return ç¼“å­˜é”®å€¼å¯¹åº”çš„æ•°æ® */ public &lt;T> List&lt;T> getCacheList(final String key) &#123; return redisTemplate.opsForList().range(key, 0, -1); &#125; /** * ç¼“å­˜Set * * @param key ç¼“å­˜é”®å€¼ * @param dataSet ç¼“å­˜çš„æ•°æ® * @return ç¼“å­˜æ•°æ®çš„å¯¹è±¡ */ public &lt;T> BoundSetOperations&lt;String, T> setCacheSet(final String key, final Set&lt;T> dataSet) &#123; BoundSetOperations&lt;String, T> setOperation = redisTemplate.boundSetOps(key); Iterator&lt;T> it = dataSet.iterator(); while (it.hasNext()) &#123; setOperation.add(it.next()); &#125; return setOperation; &#125; /** * è·å¾—ç¼“å­˜çš„set * * @param key * @return */ public &lt;T> Set&lt;T> getCacheSet(final String key) &#123; return redisTemplate.opsForSet().members(key); &#125; /** * ç¼“å­˜Map * * @param key * @param dataMap */ public &lt;T> void setCacheMap(final String key, final Map&lt;String, T> dataMap) &#123; if (dataMap != null) &#123; redisTemplate.opsForHash().putAll(key, dataMap); &#125; &#125; /** * è·å¾—ç¼“å­˜çš„Map * * @param key * @return */ public &lt;T> Map&lt;String, T> getCacheMap(final String key) &#123; return redisTemplate.opsForHash().entries(key); &#125; /** * å¾€Hashä¸­å­˜å…¥æ•°æ® * * @param key Redisé”® * @param hKey Hashé”® * @param value å€¼ */ public &lt;T> void setCacheMapValue(final String key, final String hKey, final T value) &#123; redisTemplate.opsForHash().put(key, hKey, value); &#125; /** * è·å–Hashä¸­çš„æ•°æ® * * @param key Redisé”® * @param hKey Hashé”® * @return Hashä¸­çš„å¯¹è±¡ */ public &lt;T> T getCacheMapValue(final String key, final String hKey) &#123; HashOperations&lt;String, String, T> opsForHash = redisTemplate.opsForHash(); return opsForHash.get(key, hKey); &#125; /** * åˆ é™¤Hashä¸­çš„æ•°æ® * * @param key * @param hkey */ public void delCacheMapValue(final String key, final String hkey) &#123; HashOperations hashOperations = redisTemplate.opsForHash(); hashOperations.delete(key, hkey); &#125; /** * è·å–å¤šä¸ªHashä¸­çš„æ•°æ® * * @param key Redisé”® * @param hKeys Hashé”®é›†åˆ * @return Hashå¯¹è±¡é›†åˆ */ public &lt;T> List&lt;T> getMultiCacheMapValue(final String key, final Collection&lt;Object> hKeys) &#123; return redisTemplate.opsForHash().multiGet(key, hKeys); &#125; /** * è·å¾—ç¼“å­˜çš„åŸºæœ¬å¯¹è±¡åˆ—è¡¨ * * @param pattern å­—ç¬¦ä¸²å‰ç¼€ * @return å¯¹è±¡åˆ—è¡¨ */ public Collection&lt;String> keys(final String pattern) &#123; return redisTemplate.keys(pattern); &#125; &#125; config.RedisConfig ç±» package com.ehzyil.config; import com.ehzyil.utils.FastJsonRedisSerializer; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.data.redis.connection.RedisConnectionFactory; import org.springframework.data.redis.core.RedisTemplate; import org.springframework.data.redis.serializer.StringRedisSerializer; /** * @author 35238 * @date 2023/7/11 0011 15:40 */ @Configuration public class RedisConfig &#123; @Bean @SuppressWarnings(value = &#123;\"unchecked\", \"rawtypes\"&#125;) public RedisTemplate&lt;Object, Object> redisTemplate(RedisConnectionFactory connectionFactory) &#123; RedisTemplate&lt;Object, Object> template = new RedisTemplate&lt;>(); template.setConnectionFactory(connectionFactory); FastJsonRedisSerializer serializer = new FastJsonRedisSerializer(Object.class); // ä½¿ç”¨StringRedisSerializeræ¥åºåˆ—åŒ–å’Œååºåˆ—åŒ–redisçš„keyå€¼ template.setKeySerializer(new StringRedisSerializer()); template.setValueSerializer(serializer); // Hashçš„keyä¹Ÿé‡‡ç”¨StringRedisSerializerçš„åºåˆ—åŒ–æ–¹å¼ template.setHashKeySerializer(new StringRedisSerializer()); template.setHashValueSerializer(serializer); template.afterPropertiesSet(); return template; &#125; &#125; domain.ResponseResult package com.ehzyil.domain; import com.fasterxml.jackson.annotation.JsonInclude; //å“åº”ç±» @JsonInclude(JsonInclude.Include.NON_NULL) public class ResponseResult&lt;T> &#123; /** * çŠ¶æ€ç  */ private Integer code; /** * æç¤ºä¿¡æ¯ï¼Œå¦‚æœæœ‰é”™è¯¯æ—¶ï¼Œå‰ç«¯å¯ä»¥è·å–è¯¥å­—æ®µè¿›è¡Œæç¤º */ private String msg; /** * æŸ¥è¯¢åˆ°çš„ç»“æœæ•°æ®ï¼Œ */ private T data; public ResponseResult(Integer code, String msg) &#123; this.code = code; this.msg = msg; &#125; public ResponseResult(Integer code, T data) &#123; this.code = code; this.data = data; &#125; public Integer getCode() &#123; return code; &#125; public void setCode(Integer code) &#123; this.code = code; &#125; public String getMsg() &#123; return msg; &#125; public void setMsg(String msg) &#123; this.msg = msg; &#125; public T getData() &#123; return data; &#125; public void setData(T data) &#123; this.data = data; &#125; public ResponseResult(Integer code, String msg, T data) &#123; this.code = code; this.msg = msg; this.data = data; &#125; &#125; åœ¨ utile ç›®å½•æ–°å»º WebUtils ç±» package com.ehzyil.utils; import javax.servlet.http.HttpServletResponse; import java.io.IOException; public class WebUtils &#123; /** * å°†å­—ç¬¦ä¸²æ¸²æŸ“åˆ°å®¢æˆ·ç«¯ * * @param response æ¸²æŸ“å¯¹è±¡ * @param string å¾…æ¸²æŸ“çš„å­—ç¬¦ä¸² * @return null */ public static String renderString(HttpServletResponse response, String string) &#123; try &#123; response.setStatus(200); response.setContentType(\"application/json\"); response.setCharacterEncoding(\"utf-8\"); response.getWriter().print(string); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; return null; &#125; &#125; åœ¨ domainç›®å½•æ–°å»º Userç±»ï¼Œå†™å…¥å¦‚ä¸‹ package com.ehzyil.domain; import com.baomidou.mybatisplus.annotation.TableId; import com.baomidou.mybatisplus.annotation.TableName; import lombok.AllArgsConstructor; import lombok.Data; import lombok.NoArgsConstructor; import java.io.Serializable; import java.util.Date; //ç”¨æˆ·è¡¨(User)å®ä½“ç±» @Data @AllArgsConstructor @NoArgsConstructor @TableName(\"sys_user\") public class User implements Serializable &#123; private static final long serialVersionUID = -40356785423868312L; /** * ä¸»é”® */ @TableId private Long id; /** * ç”¨æˆ·å */ private String userName; /** * æ˜µç§° */ private String nickName; /** * å¯†ç  */ private String password; /** * è´¦å·çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰ */ private String status; /** * é‚®ç®± */ private String email; /** * æ‰‹æœºå· */ private String phonenumber; /** * ç”¨æˆ·æ€§åˆ«ï¼ˆ0ç”·ï¼Œ1å¥³ï¼Œ2æœªçŸ¥ï¼‰ */ private String sex; /** * å¤´åƒ */ private String avatar; /** * ç”¨æˆ·ç±»å‹ï¼ˆ0ç®¡ç†å‘˜ï¼Œ1æ™®é€šç”¨æˆ·ï¼‰ */ private String userType; /** * åˆ›å»ºäººçš„ç”¨æˆ·id */ private Long createBy; /** * åˆ›å»ºæ—¶é—´ */ private Date createTime; /** * æ›´æ–°äºº */ private Long updateBy; /** * æ›´æ–°æ—¶é—´ */ private Date updateTime; /** * åˆ é™¤æ ‡å¿—ï¼ˆ0ä»£è¡¨æœªåˆ é™¤ï¼Œ1ä»£è¡¨å·²åˆ é™¤ï¼‰ */ private Integer delFlag; &#125; è‡ªå®šä¹‰securityçš„æ•°æ®åº“ç¬¬ä¸€æ­¥: æ•°æ®åº“æ ¡éªŒç”¨æˆ·ã€‚ä»ä¹‹å‰çš„åˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ªUserDetailsServiceï¼Œè®©SpringSecurityä½¿ç”¨æˆ‘ä»¬çš„UserDetailsServiceã€‚æˆ‘ä»¬è‡ªå·±çš„UserDetailsServiceå¯ä»¥ä»æ•°æ®åº“ä¸­æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç ã€‚æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ·è¡¨ï¼Œ å»ºè¡¨è¯­å¥å¦‚ä¸‹ï¼š æ³¨æ„: è¦æƒ³è®©ç”¨æˆ·çš„å¯†ç æ˜¯æ˜æ–‡å­˜å‚¨ï¼Œéœ€è¦åœ¨å¯†ç å‰åŠ {noop}ï¼Œä½œç”¨æ˜¯ä¾‹å¦‚ç­‰ä¸‹åœ¨æµè§ˆå™¨ç™»é™†çš„æ—¶å€™å°±å¯ä»¥ç”¨huanfä½œä¸ºç”¨æˆ·åï¼Œ112233ä½œä¸ºå¯†ç æ¥ç™»é™†äº† create database if not exists huanf_security; use huanf_security; CREATE TABLE `sys_user` ( `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®', `user_name` VARCHAR(64) NOT NULL DEFAULT 'NULL' COMMENT 'ç”¨æˆ·å', `nick_name` VARCHAR(64) NOT NULL DEFAULT 'NULL' COMMENT 'æ˜µç§°', `password` VARCHAR(64) NOT NULL DEFAULT 'NULL' COMMENT 'å¯†ç ', `status` CHAR(1) DEFAULT '0' COMMENT 'è´¦å·çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰', `email` VARCHAR(64) DEFAULT NULL COMMENT 'é‚®ç®±', `phonenumber` VARCHAR(32) DEFAULT NULL COMMENT 'æ‰‹æœºå·', `sex` CHAR(1) DEFAULT NULL COMMENT 'ç”¨æˆ·æ€§åˆ«ï¼ˆ0ç”·ï¼Œ1å¥³ï¼Œ2æœªçŸ¥ï¼‰', `avatar` VARCHAR(128) DEFAULT NULL COMMENT 'å¤´åƒ', `user_type` CHAR(1) NOT NULL DEFAULT '1' COMMENT 'ç”¨æˆ·ç±»å‹ï¼ˆ0ç®¡ç†å‘˜ï¼Œ1æ™®é€šç”¨æˆ·ï¼‰', `create_by` BIGINT(20) DEFAULT NULL COMMENT 'åˆ›å»ºäººçš„ç”¨æˆ·id', `create_time` DATETIME DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´', `update_by` BIGINT(20) DEFAULT NULL COMMENT 'æ›´æ–°äºº', `update_time` DATETIME DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´', `del_flag` INT(11) DEFAULT '0' COMMENT 'åˆ é™¤æ ‡å¿—ï¼ˆ0ä»£è¡¨æœªåˆ é™¤ï¼Œ1ä»£è¡¨å·²åˆ é™¤ï¼‰', PRIMARY KEY (`id`) ) ENGINE=INNODB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·è¡¨'; insert into sys_user values (1,'admin','ç®¡ç†å‘˜','&#123;noop&#125;123456','0',DEFAULT,DEFAULT,DEFAULT,DEFAULT,'0',DEFAULT,DEFAULT,DEFAULT,DEFAULT,DEFAULT); insert into sys_user values (2,'huanf','æ¶£æ²·aé‘æƒ·','&#123;noop&#125;112233','0',DEFAULT,DEFAULT,DEFAULT,DEFAULT,'1',DEFAULT,DEFAULT,DEFAULT,DEFAULT,DEFAULT); ç¬¬äºŒæ­¥: åœ¨pom.xmlæ·»åŠ å¦‚ä¸‹ &lt;!--å¼•å…¥MybatisPulsä¾èµ–--> &lt;dependency> &lt;groupId>com.baomidou&lt;/groupId> &lt;artifactId>mybatis-plus-boot-starter&lt;/artifactId> &lt;version>3.4.3&lt;/version> &lt;/dependency> &lt;!--å¼•å…¥mysqlé©±åŠ¨çš„ä¾èµ–--> &lt;dependency> &lt;groupId>mysql&lt;/groupId> &lt;artifactId>mysql-connector-java&lt;/artifactId> &lt;/dependency> ç¬¬ä¸‰æ­¥: åœ¨ src&#x2F;main&#x2F;resources ç›®å½•æ–°å»ºFileï¼Œæ–‡ä»¶åä¸ºapplication.ymlï¼Œå†™å…¥å¦‚ä¸‹ server: port: 8089 spring: # æ•°æ®åº“è¿æ¥ä¿¡æ¯ datasource: url: jdbc:mysql://localhost:3306/huanf_security?characterEncoding=utf-8&amp;serverTimezone=Asia/Shanghai username: root password: 666666 driver-class-name: com.mysql.cj.jdbc.Driver ç¬¬å››æ­¥: åœ¨ src&#x2F;main&#x2F;java&#x2F;com.ehzyil ç›®å½•æ–°å»º mapper.UserMapper æ¥å£ï¼Œå†™å…¥å¦‚ä¸‹ import com.baomidou.mybatisplus.core.mapper.BaseMapper; import com.ehzyil.domain.User; @Service public interface UserMapper extends BaseMapper&lt;User> &#123; &#125; ç¬¬äº”æ­¥: åœ¨å¼•å¯¼ç±»æ·»åŠ å¦‚ä¸‹. @MapperScan(\"com.ehzyil.mapper\") ç¬¬å…­æ­¥: åœ¨pom.xmlæ·»åŠ å¦‚ä¸‹ &lt;!--å¼•å…¥Junitï¼Œç”¨äºæµ‹è¯•--> &lt;dependency> &lt;groupId>org.springframework.boot&lt;/groupId> &lt;artifactId>spring-boot-starter-test&lt;/artifactId> &lt;/dependency> ç¬¬ä¸ƒæ­¥: åœ¨ src&#x2F;test&#x2F;java ç›®å½•æ–°å»º com.ehzyil.MapperTestç±»ï¼Œå†™å…¥å¦‚ä¸‹ã€‚ä½œç”¨æ˜¯æµ‹è¯•mybatis-plusæ˜¯å¦æ­£å¸¸ package com.ehzyil; import com.ehzyil.domain.User; import com.ehzyil.mapper.UserMapper; import org.junit.jupiter.api.Test; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.boot.test.context.SpringBootTest; import java.util.List; @SpringBootTest public class MapperTest &#123; @Autowired private UserMapper userMapper; @Test public void testUserMapper()&#123; &#x2F;&#x2F;æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· List&lt;User&gt; users &#x3D; userMapper.selectList(null); System.out.println(users); &#125; &#125; ç¬¬å…«æ­¥: è¿è¡ŒMapperTestç±»çš„testUserMapperæ–¹æ³•ï¼Œçœ‹æ˜¯å¦èƒ½æŸ¥åˆ°æ•°æ®åº“çš„æ‰€æœ‰ç”¨æˆ·ã€‚åˆ°æ­¤ï¼Œå¯ä»¥ç¡®å®šæ•°æ®åº“æ˜¯æ²¡é—®é¢˜çš„ï¼Œç¯å¢ƒåˆ°æ­¤å°±å‡†å¤‡å¥½äº† è‡ªå®šä¹‰securityçš„è®¤è¯å®ç°ä¸Šé¢æˆ‘ä»¬å·²ç»æŠŠå‡†å¤‡å·¥ä½œåšå¥½äº†ï¼ŒåŒ…æ‹¬æ­å»ºã€ä»£ç ã€æ•°æ®åº“ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šå®ç°è®©securityåœ¨è®¤è¯çš„æ—¶å€™ï¼Œæ ¹æ®æˆ‘ä»¬æ•°æ®åº“çš„ç”¨æˆ·å’Œå¯†ç è¿›è¡Œè®¤è¯ï¼Œä¹Ÿå°±æ˜¯è¢«securityæ‹¦æˆªä¸šåŠ¡æ¥å£ï¼Œå‡ºç°ç™»å½•é¡µé¢ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡è¾“å…¥æ•°æ®åº“é‡Œçš„ç”¨æˆ·å’Œå¯†ç æ¥ç™»å½•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨securityé»˜è®¤çš„ç”¨æˆ·å’Œå¯†ç è¿›è¡Œç™»å½• ç”¨æˆ·æäº¤è´¦å·å’Œå¯†ç ç”±DaoAuthenticationProviderè°ƒç”¨UserDetailsServiceçš„loadUserByUsername()æ–¹æ³•è·å–UserDetailsç”¨æˆ·ä¿¡æ¯ã€‚ æŸ¥è¯¢DaoAuthenticationProviderçš„æºä»£ç å¦‚ä¸‹ï¼š UserDetailsServiceæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¦‚ä¸‹ï¼š package org.springframework.security.core.userdetails; public interface UserDetailsService &#123; UserDetails loadUserByUsername(String var1) throws UsernameNotFoundException; &#125; UserDetailsæ˜¯ç”¨æˆ·ä¿¡æ¯æ¥å£ public interface UserDetails extends Serializable &#123; Collection&lt;? extends GrantedAuthority> getAuthorities(); String getPassword(); String getUsername(); boolean isAccountNonExpired(); boolean isAccountNonLocked(); boolean isCredentialsNonExpired(); boolean isEnabled(); &#125; æˆ‘ä»¬åªè¦å®ç°UserDetailsService æ¥å£æŸ¥è¯¢æ•°æ®åº“å¾—åˆ°ç”¨æˆ·ä¿¡æ¯è¿”å›UserDetails ç±»å‹çš„ç”¨æˆ·ä¿¡æ¯å³å¯,æ¡†æ¶è°ƒç”¨loadUserByUsername()æ–¹æ³•æ‹¿åˆ°ç”¨æˆ·ä¿¡æ¯ä¹‹åæ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Œè§ä¸‹å›¾ï¼š æ€è·¯: åªéœ€è¦æ–°å»ºä¸€ä¸ªå®ç°ç±»ï¼Œåœ¨è¿™ä¸ªå®ç°ç±»é‡Œé¢å®ç°Securityå®˜æ–¹çš„UserDetailsServiceæ¥å£ï¼Œç„¶åé‡å†™é‡Œé¢çš„loadUserByUsernameæ–¹æ³• æ³¨æ„: é‡å†™å¥½loadUserByUsernameæ–¹æ³•ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ‹¿åˆ° â€˜æ•°æ®åº“ä¸ç”¨æˆ·è¾“å…¥çš„æ•°æ®â€™ è¿›è¡Œæ¯”å¯¹çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯userå¯¹è±¡è¿™ä¸ªç»“æœå°è£…æˆèƒ½è¢« â€˜Securityå®˜æ–¹çš„UserDetailsServiceæ¥å£â€™ æ¥æ”¶çš„ç±»å‹ï¼Œä¾‹å¦‚å¯ä»¥å°è£…æˆæˆ‘ä»¬ä¸‹é¢å†™çš„LoginUserç±»å‹ã€‚ç„¶åæ‰èƒ½ä¼ªè£…å¥½æ•°æ®ï¼Œç»™Securityå®˜æ–¹çš„è®¤è¯æœºåˆ¶å»å¯¹æ¯”userå¯¹è±¡ä¸æ•°æ®åº“çš„ç»“æœæ˜¯å¦åŒ¹é…ã€‚Securityå®˜æ–¹çš„è®¤è¯æœºåˆ¶ä¼šæ‹¿LoginUserç±»çš„æ–¹æ³•æ•°æ®(æ•°æ®åº“æ‹¿ï¼Œä¸å†ç”¨é»˜è®¤çš„)ï¼Œè·Ÿæˆ‘ä»¬å°è£…è¿‡å»çš„userå¯¹è±¡è¿›è¡ŒåŒ¹é…ï¼Œè¦ä½¿åŒ¹é…ä¸€è‡´ï¼Œå°±è¯æ˜è®¤è¯é€šè¿‡ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·åœ¨æµè§ˆå™¨é¡µé¢è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç èƒ½è¢«Securityè®¤è¯é€šè¿‡ï¼Œå°±ä¸å†æ‹¦æˆªè¯¥ç”¨æˆ·å»è®¿é—®æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£ ç¬¬ä¸€æ­¥: åœ¨domainç›®å½•æ–°å»ºLoginUserç±»ï¼Œä½œä¸ºUserDetailsæ¥å£(Securityå®˜æ–¹æä¾›çš„æ¥å£)çš„å®ç°ç±» package com.ehzyil.domain; import lombok.AllArgsConstructor; import lombok.Data; import lombok.NoArgsConstructor; import org.springframework.security.core.GrantedAuthority; import org.springframework.security.core.userdetails.UserDetails; import java.util.Collection; @Data &#x2F;&#x2F;getå’Œsetæ–¹æ³• @NoArgsConstructor &#x2F;&#x2F;æ— å‚æ„é€  @AllArgsConstructor &#x2F;&#x2F;å¸¦å‚æ„é€  &#x2F;&#x2F;å®ç°UserDetailsæ¥å£ä¹‹åï¼Œè¦é‡å†™UserDetailsæ¥å£é‡Œé¢çš„7ä¸ªæ–¹æ³• public class LoginUser implements UserDetails &#123; private User user; @Override &#x2F;&#x2F;ç”¨äºè¿”å›æƒé™ä¿¡æ¯ã€‚ç°åœ¨æˆ‘ä»¬æ­£åœ¨å­¦&#39;è®¤è¯&#39;ï¼Œ&#39;æƒé™&#39;åé¢æ‰å­¦ã€‚æ‰€ä»¥è¿”å›nullå³å¯ public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() &#123; return null; &#125; @Override &#x2F;&#x2F;ç”¨äºè·å–ç”¨æˆ·å¯†ç ã€‚ç”±äºä½¿ç”¨çš„å®ä½“ç±»æ˜¯Userï¼Œæ‰€ä»¥è·å–çš„æ˜¯æ•°æ®åº“çš„ç”¨æˆ·å¯†ç  public String getPassword() &#123; return user.getPassword(); &#125; @Override &#x2F;&#x2F;ç”¨äºè·å–ç”¨æˆ·åã€‚ç”±äºä½¿ç”¨çš„å®ä½“ç±»æ˜¯Userï¼Œæ‰€ä»¥è·å–çš„æ˜¯æ•°æ®åº“çš„ç”¨æˆ·å public String getUsername() &#123; return user.getUserName(); &#125; @Override &#x2F;&#x2F;åˆ¤æ–­ç™»å½•çŠ¶æ€æ˜¯å¦è¿‡æœŸã€‚æŠŠè¿™ä¸ªæ”¹æˆtrueï¼Œè¡¨ç¤ºæ°¸ä¸è¿‡æœŸ public boolean isAccountNonExpired() &#123; return true; &#125; @Override &#x2F;&#x2F;åˆ¤æ–­è´¦å·æ˜¯å¦è¢«é”å®šã€‚æŠŠè¿™ä¸ªæ”¹æˆtrueï¼Œè¡¨ç¤ºæœªé”å®šï¼Œä¸ç„¶ç™»å½•çš„æ—¶å€™ï¼Œä¸è®©ä½ ç™»å½• public boolean isAccountNonLocked() &#123; return true; &#125; @Override &#x2F;&#x2F;åˆ¤æ–­ç™»å½•å‡­è¯æ˜¯å¦è¿‡æœŸã€‚æŠŠè¿™ä¸ªæ”¹æˆtrueï¼Œè¡¨ç¤ºæ°¸ä¸è¿‡æœŸ public boolean isCredentialsNonExpired() &#123; return true; &#125; @Override &#x2F;&#x2F;åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å¯ç”¨ã€‚æŠŠè¿™ä¸ªæ”¹æˆtrueï¼Œè¡¨ç¤ºå¯ç”¨çŠ¶æ€ public boolean isEnabled() &#123; return true; &#125; &#125; ç¬¬äºŒæ­¥: åœ¨ src&#x2F;main&#x2F;java&#x2F;com.ehzyil ç›®å½•æ–°å»º service.impl.MyUserDetailServiceImpl ç±»,å®ç°UserDetailsServiceæ¥å£ï¼Œå†™å…¥å¦‚ä¸‹ package com.ehzyil.service.impl; import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper; import com.ehzyil.domain.LoginUser; import com.ehzyil.domain.User; import com.ehzyil.mapper.UserMapper; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.security.core.userdetails.UserDetails; import org.springframework.security.core.userdetails.UserDetailsService; import org.springframework.security.core.userdetails.UsernameNotFoundException; import org.springframework.stereotype.Service; import java.util.Objects; @Service public class MyUserDetailServiceImpl implements UserDetailsService &#123; @Autowired private UserMapper userMapper; @Override //UserDetailsæ˜¯Securityå®˜æ–¹æä¾›çš„æ¥å£ public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException &#123; //æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚æˆ‘ä»¬å†™çš„userMapperæ¥å£é‡Œé¢æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥è°ƒç”¨çš„æ˜¯mybatis-plusæä¾›çš„æ–¹æ³• LambdaQueryWrapper&lt;User> queryWrapper = new LambdaQueryWrapper&lt;>(); queryWrapper.eq(User::getUserName,username); User user = userMapper.selectOne(queryWrapper); //å¦‚æœç”¨æˆ·ä¼ è¿›æ¥çš„ç”¨æˆ·åï¼Œä½†æ˜¯æ•°æ®åº“æ²¡æœ‰è¿™ä¸ªç”¨æˆ·åï¼Œå°±ä¼šå¯¼è‡´æˆ‘ä»¬æ˜¯æŸ¥ä¸åˆ°çš„æƒ…å†µï¼Œé‚£ä¹ˆå°±è¿›è¡Œä¸‹é¢çš„åˆ¤æ–­ã€‚é¿å…ç¨‹åºå®‰å…¨é—®é¢˜ if(Objects.isNull(user))&#123; throw new RuntimeException(\"ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯\"); &#125; //æŠŠæŸ¥è¯¢åˆ°çš„userç»“æœï¼Œå°è£…æˆUserDetailsç±»å‹ï¼Œç„¶åè¿”å›ã€‚ //ä½†æ˜¯ç”±äºUserDetailsæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆéœ€è¦åœ¨dominoç›®å½•æ–°å»ºLoginUserç±»ï¼Œä½œä¸ºUserDetailsçš„å®ç°ç±»ï¼Œå†å†™ä¸‹é¢é‚£è¡Œ return new LoginUser(user); &#125; &#125; ç¬¬ä¸‰æ­¥: æµ‹è¯•ã€‚è¿è¡Œå¼•å¯¼ç±»ï¼Œæµè§ˆå™¨è¾“å…¥å¦‚ä¸‹ï¼Œç„¶åæˆ‘ä»¬è¾“å…¥ä¸€ä¸‹ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œçœ‹æ˜¯ä¸æ˜¯æ ¹æ®æ•°æ®åº“æ¥è¿›è¡Œè®¤è¯ http:&#x2F;&#x2F;localhost:8089&#x2F;hello å‡ºç°ä»¥ä¸‹é¡µé¢ è¾“å…¥ admin 123456ç™»å½• å³å¯è®¿é—® http://localhost:8089/hello å¯†ç åŠ å¯†æ ¡éªŒé—®é¢˜ä¸Šé¢æˆ‘ä»¬å®ç°äº†è‡ªå®šä¹‰Securityçš„è®¤è¯æœºåˆ¶ï¼Œè®©Securityæ ¹æ®æ•°æ®åº“çš„æ•°æ®ï¼Œæ¥è®¤è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®æ˜¯å¦æ­£ç¡®ã€‚ä½†æ˜¯å½“æ—¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨æ•°æ®åº“å­˜å…¥ç”¨æˆ·è¡¨çš„æ—¶å€™ï¼Œæ’å…¥çš„huanfç”¨æˆ·çš„å¯†ç æ˜¯ {noop}112233ï¼Œä¸ºä»€ä¹ˆç”¨112233ä¸è¡Œå‘¢ åŸå› : SpringSecurityé»˜è®¤ä½¿ç”¨çš„PasswordEncoderè¦æ±‚æ•°æ®åº“ä¸­çš„å¯†ç æ ¼å¼ä¸ºï¼š{åŠ å¯†æ–¹å¼}å¯†ç ã€‚å¯¹åº”çš„å°±æ˜¯{noop}112233ï¼Œå®é™…è¡¨ç¤ºçš„æ˜¯112233 ä½†æ˜¯æˆ‘ä»¬åœ¨æ•°æ®åº“ç›´æ¥æš´éœ²112233ä¸ºå¯†ç ï¼Œä¼šé€ æˆå®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠåŠ å¯†åçš„1234çš„å¯†æ–‡å½“ä½œå¯†ç ï¼Œæ­¤æ—¶ç”¨æˆ·åœ¨æµè§ˆå™¨ç™»å½•æ—¶è¾“å…¥1234ï¼Œæˆ‘ä»¬å¦‚ä½•ç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿç™»å½•è¿›å»å‘¢ï¼Œç­”æ¡ˆæ˜¯SpringSecurityé»˜è®¤çš„å¯†ç æ ¡éªŒï¼Œæ›¿æ¢ä¸ºSpringSecurityä¸ºæˆ‘ä»¬æä¾›çš„BCryptPasswordEncoder æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨æŠŠBCryptPasswordEncoderå¯¹è±¡æ³¨å…¥Springå®¹å™¨ä¸­ï¼ŒSpringSecurityå°±ä¼šä½¿ç”¨è¯¥PasswordEncoderæ¥è¿›è¡Œå¯†ç æ ¡éªŒã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªSpringSecurityçš„é…ç½®ç±»ï¼ŒSpringSecurityè¦æ±‚è¿™ä¸ªé…ç½®ç±»è¦ç»§æ‰¿WebSecurityConfigurerAdapterã€‚ ã€é¦–å…ˆæ˜¯ â€˜åŠ å¯†â€™ï¼Œå¦‚ä½•å®ç°ï¼Œå¦‚ä¸‹ã€‘ ç¬¬ä¸€æ­¥: åœ¨configç›®å½•æ–°å»º SecurityConfig ç±»ï¼Œå†™å…¥å¦‚ä¸‹ã€‚ä½œç”¨æ˜¯æ ¹æ®åŸæ–‡ï¼Œç”Ÿæˆä¸€ä¸ªå¯†æ–‡ package com.ehzyil.config; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter; import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder; import org.springframework.security.crypto.password.PasswordEncoder; @Configuration //å®ç°Securityæä¾›çš„WebSecurityConfigurerAdapterç±»ï¼Œå°±å¯ä»¥æ”¹å˜å¯†ç æ ¡éªŒçš„è§„åˆ™äº† public class SecurityConfig extends WebSecurityConfigurerAdapter &#123; @Bean //æŠŠBCryptPasswordEncoderå¯¹è±¡æ³¨å…¥Springå®¹å™¨ä¸­ï¼ŒSpringSecurityå°±ä¼šä½¿ç”¨è¯¥PasswordEncoderæ¥è¿›è¡Œå¯†ç æ ¡éªŒ //æ³¨æ„ä¹Ÿå¯ä»¥æ³¨å…¥PasswordEncoderï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºPasswordEncoderæ˜¯BCry..çš„çˆ¶ç±» public PasswordEncoder passwordEncoder()&#123; return new BCryptPasswordEncoder(); &#125; &#125; ç¬¬äºŒæ­¥: æµ‹è¯•ã€‚åœ¨MapperTestç±»ï¼Œæ·»åŠ å¦‚ä¸‹ï¼Œç„¶åè¿è¡Œ TestBCryptPasswordEncoder æ–¹æ³• @Test public void TestBCryptPasswordEncoder()&#123; //å¦‚æœä¸æƒ³åœ¨ä¸‹é¢é‚£è¡Œnewçš„è¯ï¼Œé‚£ä¹ˆå°±åœ¨è¯¥ç±»æ³¨å…¥PasswordEncoderï¼Œä¾‹å¦‚å¦‚ä¸‹ /** * @Autowired * private PasswordEncoder passwordEncoder; */ BCryptPasswordEncoder passwordEncoder = new BCryptPasswordEncoder(); //æ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥çš„å¯†ç  String encode1 = passwordEncoder.encode(\"1234\"); //å†æ¨¡æ‹Ÿä¸€æ¬¡ç”¨æˆ·è¾“å…¥çš„å¯†ç  String encode2 = passwordEncoder.encode(\"1234\"); //è™½ç„¶è¿™ä¸¤æ¬¡çš„å¯†ç éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åŠ å¯†åæ˜¯ä¸ä¸€æ ·çš„ã€‚æ¯æ¬¡è¿è¡Œï¼Œå¯¹åŒä¸€åŸæ–‡éƒ½ä¼šæœ‰ä¸åŒçš„åŠ å¯†ç»“æœ //åŸå› :ä¼šæ·»åŠ éšæœºçš„ç›ï¼ŒåŠ å¯†ç»“æœ=ç›+åŸæ–‡+åŠ å¯†ã€‚è¾¾åˆ°æ¯æ¬¡åŠ å¯†åçš„å¯†æ–‡éƒ½ä¸ç›¸åŒçš„æ•ˆæœ System.out.println(encode1); System.out.println(encode2); &#125; ã€ç„¶åæ˜¯ â€˜æ ¡éªŒâ€™ï¼Œå¦‚ä½•å®ç°ï¼Œå¦‚ä¸‹ã€‘ ç¬¬ä¸€æ­¥(å·²åšå¯è·³è¿‡): åœ¨configç›®å½•æ–°å»º SecurityConfig ç±»ï¼Œå†™å…¥å¦‚ä¸‹ã€‚ä½œç”¨æ˜¯æ ¹æ®åŸæ–‡ï¼Œç”Ÿæˆä¸€ä¸ªå¯†æ–‡ package com.ehzyil.config; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter; import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder; import org.springframework.security.crypto.password.PasswordEncoder; @Configuration //å®ç°Securityæä¾›çš„WebSecurityConfigurerAdapterç±»ï¼Œå°±å¯ä»¥æ”¹å˜å¯†ç æ ¡éªŒçš„è§„åˆ™äº† public class SecurityConfig extends WebSecurityConfigurerAdapter &#123; @Bean //æŠŠBCryptPasswordEncoderå¯¹è±¡æ³¨å…¥Springå®¹å™¨ä¸­ï¼ŒSpringSecurityå°±ä¼šä½¿ç”¨è¯¥PasswordEncoderæ¥è¿›è¡Œå¯†ç æ ¡éªŒ //æ³¨æ„ä¹Ÿå¯ä»¥æ³¨å…¥PasswordEncoderï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºPasswordEncoderæ˜¯BCry..çš„çˆ¶ç±» public PasswordEncoder passwordEncoder()&#123; return new BCryptPasswordEncoder(); &#125; &#125; ç¬¬äºŒæ­¥: æµ‹è¯•ã€‚åœ¨MapperTestç±»ï¼Œæ·»åŠ å¦‚ä¸‹ï¼Œç„¶åè¿è¡Œ TestBCryptPasswordEncoder æ–¹æ³• @Test public void TestBCryptPasswordEncoder()&#123; BCryptPasswordEncoder passwordEncoder = new BCryptPasswordEncoder(); //æ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥äº†1234(ç¬¬ä¸€ä¸ªå‚æ•°)ï¼Œç„¶åæˆ‘ä»¬å»è·Ÿæ•°æ®åº“çš„å¯†æ–‡è¿›è¡Œæ¯”è¾ƒ(ç¬¬äºŒä¸ªå‚æ•°) boolean result = passwordEncoder.matches(\"1234\", \"$2a$10$zOitKu6UNk.b/iPFTtIj2u80sH/dfJI9vFr57qhDGteuXj/Wl8uSy\"); //çœ‹ä¸€ä¸‹æ¯”å¯¹ç»“æœ System.out.println(result); &#125; é‡å¯æµ‹è¯•åå‘ç° è´¦å·1ç™»ä¸è¿›å»ï¼Œå¯†ç åŠ å¯†è¿‡çš„è´¦å·2å¯ä»¥ç™»å½•ã€‚ jwtå·¥å…·ç±»å®ç°åŠ å¯†æ ¡éªŒã€åŠ å¯†ã€‘ ç¬¬ä¸€æ­¥: ä½¿ç”¨createJWTæ–¹æ³•ç”ŸæˆæŒ‡å®šå­—ç¬¦ä¸²çš„å¯†æ–‡ã€‚ ç¬¬ä¸€æ­¥: ä½¿ç”¨parseJWTæ–¹æ³•å°†å¯†æ–‡è§£å¯†(æ ¡éªŒ)ä¸ºåŸæ–‡ã€‚ public static void main(String[] args) throws Exception &#123; System.out.println(\"***************åŠ å¯†****************\"); //åŠ å¯†æŒ‡å®šå­—ç¬¦ä¸²ï¼Œtokenæ˜¯123456åŠ å¯†åçš„å¯†æ–‡ String token = createJWT(\"123456\"); System.out.println(token); System.out.println(\"***************è§£å¯†****************\"); //æŠŠä¸Šé¢é‚£è¡Œçš„å¯†æ–‡è§£å¯†(æ ¡éªŒ)ä¸ºåŸæ–‡ Claims claims = parseJWT(token); System.out.println(claims); //è¾“å‡ºè§£å¯†åçš„åŸæ–‡ System.out.println(claims.getSubject()); &#125; ç¬¬äºŒæ­¥: è¿è¡ŒJwtUtilç±»çš„mainæ–¹æ³• ***************åŠ å¯†**************** eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJiYzg0ZWY1NjY1MmQ0YjgzODg2MGUxOTM2MGNlY2FiIsInN1YiI6IjEyMzQ1NiIsImlzcyI6Imh1YW5mIiwiaWF0IjoxNjk0ODMzMjU3LCJleHAiOjE2OTQ4MzY4NTd9.bJDcdufq0LMhpdwlEbE5mBkZoGYZRxHIFoo1rb5MN1U ***************è§£å¯†**************** &#123;jti&#x3D;bc84ef56652d4b838860e19360cecabc, sub&#x3D;123456, iss&#x3D;huanf, iat&#x3D;1694833257, exp&#x3D;1694836857&#125; 123456 ç™»å½•æ¥å£çš„åˆ†æåœ¨ä¸Šé¢çš„è‡ªå®šä¹‰securityçš„æ€è·¯å½“ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŠŸèƒ½éœ€æ±‚æ˜¯è‡ªå®šä¹‰ç™»å½•æ¥å£ï¼Œè¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å®ç°ï¼Œæˆ‘ä»¬éœ€è¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œä½†æ˜¯ï¼Œå®ç°è¿™ä¸ªåŠŸèƒ½éœ€è¦ä½¿ç”¨åˆ°jwtï¼Œæˆ‘ä»¬åˆšåˆšä¹Ÿå­¦ä¹ äº†ä½¿ç”¨jwtæ¥å®ç°åŠ å¯†æ ¡éªŒï¼Œé‚£ä¹ˆä¸‹é¢å°±æ­£å¼å­¦ä¹ å¦‚ä½•å®ç°è¿™ä¸ªç™»å½•æ¥å£ï¼Œé¦–å…ˆæ˜¯åˆ†æï¼Œå¦‚ä¸‹ â‘ æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ç™»é™†æ¥å£ï¼Œä¹Ÿå°±æ˜¯åœ¨controllerç›®å½•æ–°å»ºLoginControllerç±»ï¼Œåœ¨controlleræ–¹æ³•é‡Œé¢å»è°ƒç”¨serviceæ¥å£ï¼Œåœ¨serviceæ¥å£å®ç°AuthenticationManagerå»è¿›è¡Œç”¨æˆ·çš„è®¤è¯ï¼Œæ³¨æ„ï¼Œæˆ‘ä»¬å®šä¹‰çš„controlleræ–¹æ³•è¦è®©SpringSecurityå¯¹è¿™ä¸ªæ¥å£æ”¾è¡Œ(å¦‚æœä¸æ”¾è¡Œçš„è¯ï¼Œä¼šè¢«SpringSecurityæ‹¦æˆª)ï¼Œè®©ç”¨æˆ·è®¿é—®è¿™ä¸ªæ¥å£çš„æ—¶å€™ä¸ç”¨ç™»å½•ä¹Ÿèƒ½è®¿é—®ã€‚ â‘¡åœ¨serviceæ¥å£ä¸­æˆ‘ä»¬é€šè¿‡AuthenticationManagerçš„authenticateæ–¹æ³•æ¥è¿›è¡Œç”¨æˆ·è®¤è¯,æ‰€ä»¥éœ€è¦åœ¨SecurityConfigä¸­é…ç½®æŠŠAuthenticationManageræ³¨å…¥å®¹å™¨ â‘¢è®¤è¯æˆåŠŸçš„è¯è¦ç”Ÿæˆä¸€ä¸ªjwtï¼Œæ”¾å…¥å“åº”ä¸­è¿”å›ã€‚å¹¶ä¸”ä¸ºäº†è®©ç”¨æˆ·ä¸‹å›è¯·æ±‚æ—¶èƒ½é€šè¿‡jwtè¯†åˆ«å‡ºå…·ä½“çš„æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œæˆ‘ä»¬éœ€è¦æŠŠç”¨æˆ·ä¿¡æ¯å­˜å…¥redisï¼Œå¯ä»¥æŠŠç”¨æˆ·idä½œä¸ºkeyã€‚ ç™»å½•æ¥å£çš„å®ç°ç¬¬ä¸€æ­¥: ä¿®æ”¹æ•°æ®åº“çš„huanfç”¨æˆ·çš„å¯†ç ï¼ŒæŠŠ112233æ˜æ–‡ä¿®æ”¹ä¸ºå¯¹åº”çš„å¯†æ–‡ã€‚å¯†æ–‡å¯ä»¥ç”¨jwtå·¥å…·ç±»åŠ å¯†112233çœ‹ä¸€ä¸‹ï¼Œæˆ–è€…ç›´æ¥å¤åˆ¶æˆ‘ç»™å‡ºçš„ UPDATE sys_user SET password &#x3D; &#39;$2a$10$YPnG.IYUk0mMechaxSibBuKmNeTzvuHdcxkqvoxizsll6WCQG9CHG&#39; WHERE id &#x3D; 2; â€‹ ç¬¬äºŒæ­¥: åœ¨ SecurityConfig ç±»æ·»åŠ å¦‚ä¸‹ @Bean @Override public AuthenticationManager authenticationManagerBean() throws Exception &#123; return super.authenticationManagerBean(); &#125; @Override protected void configure(HttpSecurity http) throws Exception &#123; http //ç”±äºæ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œæ‰€ä»¥è¦å…³é—­csrf .csrf().disable() //ç”±äºæ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œæ‰€ä»¥sessionæ˜¯å¤±æ•ˆçš„ï¼Œæˆ‘ä»¬å°±ä¸é€šè¿‡Sessionè·å–SecurityContext .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS) .and() //æŒ‡å®šè®©spring securityæ”¾è¡Œç™»å½•æ¥å£çš„è§„åˆ™ .authorizeRequests() // å¯¹äºç™»å½•æ¥å£ anonymousè¡¨ç¤ºå…è®¸åŒ¿åè®¿é—® .antMatchers(\"/user/login\").anonymous() // é™¤ä¸Šé¢å¤–çš„æ‰€æœ‰è¯·æ±‚å…¨éƒ¨éœ€è¦é‰´æƒè®¤è¯ .anyRequest().authenticated(); &#125; ç¬¬ä¸‰æ­¥: åœ¨serviceç›®å½•æ–°å»º LoginService æ¥å£ï¼Œå†™å…¥å¦‚ä¸‹ package com.ehzyil.service; import com.ehzyil.domain.ResponseResult; import com.ehzyil.domain.User; import org.springframework.stereotype.Service; @Service public interface LoginService &#123; ResponseResult login(User user); &#125; ç¬¬å››æ­¥: åœ¨serviceç›®å½•æ–°å»º impl.LoginServiceImpl ç±»ï¼Œå†™å…¥å¦‚ä¸‹ package com.ehzyil.service.impl; @Service //å†™ç™»å½•çš„æ ¸å¿ƒä»£ç  public class LoginServiceImpl implements LoginService &#123; @Autowired //å…ˆåœ¨SecurityConfigï¼Œä½¿ç”¨@Beanæ³¨è§£é‡å†™å®˜æ–¹çš„authenticationManagerBeanç±»ï¼Œç„¶åè¿™é‡Œæ‰èƒ½æ³¨å…¥æˆåŠŸ private AuthenticationManager authenticationManager; @Autowired //RedisCacheæ˜¯æˆ‘ä»¬åœ¨utilsç›®å½•å†™å¥½çš„ç±» private RedisCache redisCache; @Override //ResponseResultå’Œuseræ˜¯æˆ‘ä»¬åœ¨domainç›®å½•å†™å¥½çš„ç±» public ResponseResult login(User user) &#123; //ç”¨æˆ·åœ¨ç™»å½•é¡µé¢è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç  UsernamePasswordAuthenticationToken authenticationToken = new UsernamePasswordAuthenticationToken(user.getUserName(),user.getPassword()); //è·å–AuthenticationManagerçš„authenticateæ–¹æ³•æ¥è¿›è¡Œç”¨æˆ·è®¤è¯ Authentication authenticate = authenticationManager.authenticate(authenticationToken); //åˆ¤æ–­ä¸Šé¢é‚£è¡Œçš„authenticateæ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯åˆ™è®¤è¯æ²¡é€šè¿‡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ if(Objects.isNull(authenticate))&#123; throw new RuntimeException(\"ç™»å½•å¤±è´¥\"); &#125; //å¦‚æœè®¤è¯é€šè¿‡ï¼Œå°±ä½¿ç”¨useridç”Ÿæˆä¸€ä¸ªjwtï¼Œç„¶åæŠŠjwtå­˜å…¥ResponseResultåè¿”å› LoginUser loginUser = (LoginUser) authenticate.getPrincipal(); String userid = loginUser.getuser().getId().toString(); String jwt = JwtUtil.createJWT(userid); //æŠŠå®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯å­˜å…¥redisï¼Œå…¶ä¸­useridä½œä¸ºkeyï¼Œæ³¨æ„å­˜å…¥redisçš„æ—¶å€™åŠ äº†å‰ç¼€ login: Map&lt;String, String> map = new HashMap&lt;>(); map.put(\"token\",jwt); redisCache.setCacheObject(\"login:\"+userid,loginUser); return new ResponseResult(200,\"ç™»å½•æˆåŠŸ\",map); &#125; &#125; ç¬¬äº”æ­¥: åœ¨controllerç›®å½•æ–°å»º LoginController ç±»ï¼Œå†™å…¥å¦‚ä¸‹ package com.ehzyil.controller; import com.ehzyil.domain.ResponseResult; import com.ehzyil.domain.User; import com.ehzyil.service.LoginService; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.web.bind.annotation.PostMapping; import org.springframework.web.bind.annotation.RequestBody; import org.springframework.web.bind.annotation.RestController; @RestController public class LoginController &#123; @Autowired //LoginServiceæ˜¯æˆ‘ä»¬åœ¨serviceç›®å½•å†™å¥½çš„æ¥å£ private LoginService loginService; @PostMapping(\"/user/login\") //ResponseResultå’Œuseræ˜¯æˆ‘ä»¬åœ¨domainç›®å½•å†™å¥½çš„ç±» public ResponseResult login(@RequestBody User user)&#123; //ç™»å½• return loginService.login(user); &#125; &#125; ç¬¬å…­æ­¥: åœ¨application.ymlæ·»åŠ å¦‚ä¸‹ï¼Œä½œç”¨æ˜¯æ·»åŠ redisçš„è¿æ¥ä¿¡æ¯ redis: host: 127.0.0.1 port: 6379 ç¬¬å…«æ­¥: è¿è¡Œå¼•å¯¼ç±» ç¬¬ä¹æ­¥: æµ‹è¯•ã€‚å‘é€ä¸‹é¢çš„POSTè¯·æ±‚ localhost:8089&#x2F;user&#x2F;login &#123; &quot;userName&quot;:&quot;huanf&quot;, &quot;password&quot;:&quot;112233&quot; &#125; &#123; \"code\": 200, \"msg\": \"ç™»å½•æˆåŠŸ\", \"data\": &#123; \"token\": \"eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI1YjgzNTU2YjQ5OWY0YjU0ODU5M2Q5OWIjk4OTMwOCIsInN1YiI6IjIiLCJpc3MiOiJodWFuZiIsImlhdCI6MTY5NDg0ODU1OCwiZXhwIjoxNjk0ODUyMTU4fQ.Jca_ufkZFNv0vMvmap3r-AvD0QAjctUzdb5TxYcwicg\" &#125; &#125; æ³¨æ„ï¼šç¬¬ä¹æ­¥çš„è¯·æ±‚ä¸€å®šè¦ä½¿ç”¨æœªåŠ å¯†çš„å¯†ç ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ˆæäº†ä¸€ä¸Šåˆæ‰è§£å†³..ï¼‰ è®¤è¯è¿‡æ»¤å™¨åœ¨ä¸Šé¢å­¦ä¹ çš„è‡ªå®šä¹‰securityçš„æ€è·¯å½“ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŠŸèƒ½éœ€æ±‚æ˜¯å®šä¹‰Jwtè®¤è¯è¿‡æ»¤å™¨ï¼Œè¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å®ç°ï¼Œä¸‹é¢å°±æ­£å¼å­¦ä¹ å¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚è¦å®ç°Jwtè®¤è¯è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬éœ€è¦è·å–tokenï¼Œç„¶åè§£ætokenè·å–å…¶ä¸­çš„useridï¼Œè¿˜éœ€è¦ä»redisä¸­è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åå­˜å…¥SecurityContextHolder ä¸ºä»€ä¹ˆè¦æœ‰rediså‚ä¸: æ˜¯ä¸ºäº†é˜²æ­¢è¿‡äº†å¾ˆä¹…ä¹‹åï¼Œæµè§ˆå™¨æ²¡æœ‰å…³é—­ï¼Œæ‹¿ç€tokenä¹Ÿèƒ½è®¿é—®ï¼Œè¿™æ ·ä¸å®‰å…¨ è®¤è¯è¿‡æ»¤å™¨çš„ä½œç”¨æ˜¯ä»€ä¹ˆ: ä¸Šé¢æˆ‘ä»¬å®ç°ç™»å½•æ¥å£çš„æ—¶ï¼Œå½“æŸä¸ªç”¨æˆ·ç™»å½•ä¹‹åï¼Œè¯¥ç”¨æˆ·å°±ä¼šæœ‰ä¸€ä¸ªtokenå€¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¤è¯è¿‡æ»¤å™¨ï¼Œç”±äºæœ‰tokenå€¼ï¼Œå¹¶ä¸”tokenå€¼è®¤è¯é€šè¿‡ï¼Œä¹Ÿå°±æ˜¯è¯æ˜æ˜¯è¿™ä¸ªç”¨æˆ·çš„tokenå€¼ï¼Œé‚£ä¹ˆè¯¥ç”¨æˆ·è®¿é—®æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£æ—¶ï¼Œå°±ä¸ä¼šè¢«Securityæ‹¦æˆªã€‚ç®€å•ç†è§£ä½œç”¨å°±æ˜¯ç™»å½•è¿‡çš„ç”¨æˆ·å¯ä»¥è®¿é—®æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£ï¼Œæ‹¿åˆ°å¯¹åº”çš„èµ„æº ç¬¬ä¸€æ­¥: å®šä¹‰è¿‡æ»¤å™¨ã€‚åœ¨ src&#x2F;main&#x2F;java&#x2F;com.ehzyil ç›®å½•æ–°å»º filter.JwtAuthenticationTokenFilter ç±»ï¼Œå†™å…¥å¦‚ä¸‹ package com.ehzyil.filter; import com.ehzyil.domain.LoginUser; import com.ehzyil.utils.JwtUtil; import com.ehzyil.utils.RedisCache; import io.jsonwebtoken.Claims; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.security.authentication.UsernamePasswordAuthenticationToken; import org.springframework.security.core.context.SecurityContextHolder; import org.springframework.stereotype.Component; import org.springframework.util.StringUtils; import org.springframework.web.filter.OncePerRequestFilter; import javax.servlet.FilterChain; import javax.servlet.ServletException; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import java.io.IOException; import java.util.Objects; @Component public class JwtAuthenticationTokenFilter extends OncePerRequestFilter &#123; @Autowired private RedisCache redisCache; @Override protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException &#123; //è·å–tokenï¼ŒæŒ‡å®šä½ è¦è·å–çš„è¯·æ±‚å¤´å«ä»€ä¹ˆ String token = request.getHeader(\"token\"); //åˆ¤ç©ºï¼Œä¸ä¸€å®šæ‰€æœ‰çš„è¯·æ±‚éƒ½æœ‰è¯·æ±‚å¤´ï¼Œæ‰€ä»¥ä¸Šé¢é‚£è¡Œçš„tokenå¯èƒ½ä¸ºç©º //!StringUtils.hasText()æ–¹æ³•ç”¨äºæ£€æŸ¥ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºæˆ–ä»…åŒ…å«ç©ºæ ¼å­—ç¬¦ if (!StringUtils.hasText(token)) &#123; //å¦‚æœè¯·æ±‚æ²¡æœ‰æºå¸¦tokenï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦è§£ætokenï¼Œä¸éœ€è¦è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œç›´æ¥æ”¾è¡Œå°±å¯ä»¥ filterChain.doFilter(request, response); //returnä¹‹åï¼Œå°±ä¸ä¼šèµ°ä¸‹é¢é‚£äº›ä»£ç  return; &#125; //è§£ætoken String userid; //æŠŠuseridå®šä¹‰åœ¨å¤–é¢ï¼Œæ‰èƒ½åŒæ—¶ç”¨äºä¸‹é¢çš„46è¡Œå’Œ52è¡Œ try &#123; Claims claims = JwtUtil.parseJWT(token); userid = claims.getSubject(); &#125; catch (Exception e) &#123; e.printStackTrace(); throw new RuntimeException(\"tokenéæ³•\"); &#125; //ä»redisä¸­è·å–ç”¨æˆ·ä¿¡æ¯ String redisKey = \"login:\" + userid; //LoginUseræ˜¯æˆ‘ä»¬åœ¨domainç›®å½•å†™çš„å®ä½“ç±» LoginUser loginUser = redisCache.getCacheObject(redisKey); //åˆ¤æ–­è·å–åˆ°çš„ç”¨æˆ·ä¿¡æ¯æ˜¯å¦ä¸ºç©ºï¼Œå› ä¸ºredisé‡Œé¢å¯èƒ½å¹¶ä¸å­˜åœ¨è¿™ä¸ªç”¨æˆ·ä¿¡æ¯ï¼Œä¾‹å¦‚ç¼“å­˜è¿‡æœŸäº† if(Objects.isNull(loginUser))&#123; //æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ throw new RuntimeException(\"ç”¨æˆ·æœªç™»å½•\"); &#125; //æŠŠæœ€ç»ˆçš„LoginUserç”¨æˆ·ä¿¡æ¯ï¼Œé€šè¿‡setAuthenticationæ–¹æ³•ï¼Œå­˜å…¥SecurityContextHolder //TODO è·å–æƒé™ä¿¡æ¯å°è£…åˆ°Authenticationä¸­ UsernamePasswordAuthenticationToken authenticationToken = //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯LoginUserç”¨æˆ·ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å‡­è¯(null)ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æƒé™ä¿¡æ¯(null) new UsernamePasswordAuthenticationToken(loginUser,null,null); SecurityContextHolder.getContext().setAuthentication(authenticationToken); //å…¨éƒ¨åšå®Œä¹‹åï¼Œå°±æ”¾è¡Œ filterChain.doFilter(request, response); &#125; &#125; ç¬¬äºŒæ­¥: ä¿®æ”¹SecurityConfigç±»ä¸ºå¦‚ä¸‹ï¼Œå…¶å®ä¹Ÿå°±æ˜¯åœ¨configureæ–¹æ³•åŠ äº†ä¸€ç‚¹ä»£ç ã€å¹¶ä¸”æ³¨å…¥äº†JwtAuthenticationTokenFilterç±» @Configuration //å®ç°Securityæä¾›çš„WebSecurityConfigurerAdapterç±»ï¼Œå°±å¯ä»¥æ”¹å˜å¯†ç æ ¡éªŒçš„è§„åˆ™äº† public class SecurityConfig extends WebSecurityConfigurerAdapter &#123; @Bean //æŠŠBCryptPasswordEncoderå¯¹è±¡æ³¨å…¥Springå®¹å™¨ä¸­ï¼ŒSpringSecurityå°±ä¼šä½¿ç”¨è¯¥PasswordEncoderæ¥è¿›è¡Œå¯†ç æ ¡éªŒ //æ³¨æ„ä¹Ÿå¯ä»¥æ³¨å…¥PasswordEncoderï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºPasswordEncoderæ˜¯BCry..çš„çˆ¶ç±» public PasswordEncoder passwordEncoder()&#123; return new BCryptPasswordEncoder(); &#125; //---------------------------è®¤è¯è¿‡æ»¤å™¨çš„å®ç°---------------------------------- @Autowired //æ³¨å…¥æˆ‘ä»¬åœ¨filterç›®å½•å†™å¥½çš„ç±» private JwtAuthenticationTokenFilter jwtAuthenticationTokenFilter; //---------------------------ç™»å½•æ¥å£çš„å®ç°---------------------------------- @Bean @Override public AuthenticationManager authenticationManagerBean() throws Exception &#123; return super.authenticationManagerBean(); &#125; @Override protected void configure(HttpSecurity http) throws Exception &#123; http //ç”±äºæ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œæ‰€ä»¥è¦å…³é—­csrf .csrf().disable() //ç”±äºæ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œæ‰€ä»¥sessionæ˜¯å¤±æ•ˆçš„ï¼Œæˆ‘ä»¬å°±ä¸é€šè¿‡Sessionè·å–SecurityContext .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS) .and() //æŒ‡å®šè®©spring securityæ”¾è¡Œç™»å½•æ¥å£çš„è§„åˆ™ .authorizeRequests() // å¯¹äºç™»å½•æ¥å£ anonymousè¡¨ç¤ºå…è®¸åŒ¿åè®¿é—® .antMatchers(\"/user/login\").anonymous() // é™¤ä¸Šé¢å¤–çš„æ‰€æœ‰è¯·æ±‚å…¨éƒ¨éœ€è¦é‰´æƒè®¤è¯ .anyRequest().authenticated(); //---------------------------è®¤è¯è¿‡æ»¤å™¨çš„å®ç°---------------------------------- //æŠŠtokenæ ¡éªŒè¿‡æ»¤å™¨æ·»åŠ åˆ°è¿‡æ»¤å™¨é“¾ä¸­ //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸Šé¢æ³¨å…¥çš„æˆ‘ä»¬åœ¨filterç›®å½•å†™å¥½çš„ç±»ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºä½ æƒ³æ·»åŠ åˆ°å“ªä¸ªè¿‡æ»¤å™¨ä¹‹å‰ http.addFilterBefore(jwtAuthenticationTokenFilter, UsernamePasswordAuthenticationFilter.class); &#125; &#125; ç¬¬ä¸‰æ­¥: æœ¬åœ°æ‰“å¼€ä½ çš„redis ç¬¬å››æ­¥: è¿è¡Œå¼•å¯¼ç±» ç¬¬äº”æ­¥: æµ‹è¯•ã€‚æ‰“å¼€ä½ çš„postmanï¼Œå‘é€å¦‚ä¸‹çš„POSTè¯·æ±‚ï¼Œä½œç”¨æ˜¯å…ˆç™»å½•ä¸€ä¸ªç”¨æˆ·ï¼Œè¿™æ ·å°±èƒ½ç”Ÿæˆè¿™ä¸ªç”¨æˆ·å¯¹åº”çš„tokenå€¼ &#123; &quot;code&quot;: 200, &quot;msg&quot;: &quot;ç™»å½•æˆåŠŸ&quot;, &quot;data&quot;: &#123; &quot;token&quot;: &quot;eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiIzZmU4MTk1YjY3MTc0MmM5YTgwODZkNzE2ZTM4OGNlNyIsInN1YiI6IjIiLCJpc3MiOiJodWFuZiIsImlhdCI6MTY5NDg0ODgzNCwiZXhwIjoxNjk0ODUyNDM0fQ.liyE_t-8Zzh2goiOg0crzQNTqMj1mNAyeg3pSQH0FZo&quot; &#125; &#125; ç¬¬å…­æ­¥: æµ‹è¯•ã€‚ç»§ç»­åœ¨ä½ çš„postmanï¼Œå‘é€å¦‚ä¸‹GETè¯·æ±‚ï¼Œä½œç”¨æ˜¯æ‹¿ç€åˆšåˆšçš„tokenå€¼ï¼Œå»è®¿é—®æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£ï¼Œçœ‹ä¼šä¸ä¼šè¢«Securityæ‹¦æˆªï¼Œå¦‚æœä¸ä¼šæ‹¦æˆªï¼Œé‚£ä¹ˆå°±è¯´æ˜è®¤è¯è¿‡æ»¤å™¨ç”Ÿæ•ˆäº†ï¼Œä½¿ç”¨åœºæ™¯å°±æ˜¯ç®€å•ç†è§£å°±æ˜¯ç™»å½•è¿‡çš„ç”¨æˆ·å¯ä»¥è®¿é—®æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£ï¼Œæ‹¿åˆ°å¯¹åº”çš„èµ„æº æ³¨æ„ï¼Œç”±äºtokenå€¼æˆ‘ä»¬æ˜¯å­˜åœ¨redisï¼Œæ‰€ä»¥æ˜¯æœ‰é»˜è®¤è¿‡æœŸæ—¶é—´çš„ã€‚æ³¨æ„åœ¨è¯·æ±‚å¤´é‚£é‡Œï¼Œkeyè¦å†™tokenï¼Œvalueè¦å†™ä½ å¤åˆ¶çš„tokenå€¼ï¼Œç„¶åç‚¹å‡»å‘é€è¯·æ±‚ã€‚è¿™ä¸ªtokenå€¼å®é™…ä¸Šå°±æ˜¯ä½¿ç”¨jwtå·¥å…·ç±»æŠŠ112233å¯†ç åŠ å¯†åçš„å¯†æ–‡ï¼Œä¸ä¿¡ä½ ç¿»ä¸€ä¸‹å‰é¢ç¬”è®°çœ‹å½“æ—¶112233çš„å¯†æ–‡ï¼Œé•¿å¾—æ˜¯ä¸æ˜¯è·Ÿç°åœ¨çš„tokenå€¼æ ¼å¼ä¸€æ · é€€å‡ºç™»å½•ä¸Šé¢æˆ‘ä»¬æ—¢æµ‹è¯•äº†ç™»å½•è®¤è¯ï¼Œåˆå®ç°äº†åŸºäºå¯†æ–‡çš„tokenè®¤è¯ï¼Œåˆ°æ­¤å°±å®Œæ•´åœ°å®ç°äº†æˆ‘ä»¬åœ¨ â€˜è®¤è¯â€™ çš„ â€˜3. è‡ªå®šä¹‰securityçš„æ€è·¯â€™ é‡Œé¢çš„ã€ç™»å½•ã€‘å’Œã€æ ¡éªŒã€‘çš„åŠŸèƒ½ é‚£ä¹ˆï¼Œæˆ‘ä»¬æ€ä¹ˆé€€å‡ºç™»å½•å‘¢ï¼Œä¹Ÿå°±æ˜¯è®©æŸä¸ªç”¨æˆ·çš„ç™»å½•çŠ¶æ€æ¶ˆå¤±ï¼Œä¹Ÿå°±æ˜¯è®©tokenå¤±æ•ˆ ? å®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ªç™»é™†æ¥å£ï¼Œç„¶åè·å–SecurityContextHolderä¸­çš„è®¤è¯ä¿¡æ¯ï¼Œåˆ é™¤redisä¸­å¯¹åº”çš„æ•°æ®å³å¯ æ³¨æ„: æˆ‘ä»¬çš„tokenå…¶å®å°±æ˜¯ç”¨æˆ·å¯†ç çš„å¯†æ–‡ï¼Œtokenæ˜¯å­˜åœ¨redisé‡Œé¢ ç¬¬ä¸€æ­¥: æŠŠLoginServiceæ¥å£ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œæ³¨æ„åªæ˜¯ç¨å¾®å¢åŠ äº†ä¸€ç‚¹ä»£ç ï¼Œæˆ‘ç”¨è™šçº¿éš”å¼€äº†ï¼Œå¢åŠ çš„ä»£ç æ˜¯åœ¨è™šçº¿çš„ä¸‹æ–¹ package com.ehzyil.service; import com.ehzyil.domain.ResponseResult; import com.ehzyil.domain.User; import org.springframework.stereotype.Service; @Service public interface LoginService &#123; ResponseResult login(User user); &#x2F;&#x2F;-----------------------------------é€€å‡ºç™»å½•-------------------------------- ResponseResult logout(); &#125; ç¬¬äºŒæ­¥: æŠŠLoginServiceImplå®ç°ç±»ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œæ³¨æ„åªæ˜¯ç¨å¾®å¢åŠ äº†ä¸€ç‚¹ä»£ç ï¼Œæˆ‘ç”¨è™šçº¿éš”å¼€äº†ï¼Œå¢åŠ çš„ä»£ç æ˜¯åœ¨è™šçº¿çš„ä¸‹æ–¹ @Service @Slf4j //å†™ç™»å½•çš„æ ¸å¿ƒä»£ç  public class LoginServiceImpl implements LoginService &#123; @Autowired //å…ˆåœ¨SecurityConfigï¼Œä½¿ç”¨@Beanæ³¨è§£é‡å†™å®˜æ–¹çš„authenticationManagerBeanç±»ï¼Œç„¶åè¿™é‡Œæ‰èƒ½æ³¨å…¥æˆåŠŸ private AuthenticationManager authenticationManager; @Autowired //RedisCacheæ˜¯æˆ‘ä»¬åœ¨utilsç›®å½•å†™å¥½çš„ç±» private RedisCache redisCache; @Override //ResponseResultå’Œuseræ˜¯æˆ‘ä»¬åœ¨domainç›®å½•å†™å¥½çš„ç±» public ResponseResult login(User user) &#123; //ç”¨æˆ·åœ¨ç™»å½•é¡µé¢è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç  UsernamePasswordAuthenticationToken authenticationToken = new UsernamePasswordAuthenticationToken(user.getUserName(), user.getPassword()); //è·å–AuthenticationManagerçš„authenticateæ–¹æ³•æ¥è¿›è¡Œç”¨æˆ·è®¤è¯ Authentication authenticate = authenticationManager.authenticate(authenticationToken); //åˆ¤æ–­ä¸Šé¢é‚£è¡Œçš„authenticateæ˜¯å¦ä¸ºnullï¼Œå¦‚æœæ˜¯åˆ™è®¤è¯æ²¡é€šè¿‡ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ if (Objects.isNull(authenticate)) &#123; throw new RuntimeException(\"ç™»å½•å¤±è´¥\"); &#125; //å¦‚æœè®¤è¯é€šè¿‡ï¼Œå°±ä½¿ç”¨useridç”Ÿæˆä¸€ä¸ªjwtï¼Œç„¶åæŠŠjwtå­˜å…¥ResponseResultåè¿”å› LoginUser loginUser = (LoginUser) authenticate.getPrincipal(); String userid = loginUser.getUser().getId().toString(); String jwt = JwtUtil.createJWT(userid); //æŠŠå®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯å­˜å…¥redisï¼Œå…¶ä¸­useridä½œä¸ºkeyï¼Œæ³¨æ„å­˜å…¥redisçš„æ—¶å€™åŠ äº†å‰ç¼€ login: Map&lt;String, String> map = new HashMap&lt;>(); map.put(\"token\", jwt); redisCache.setCacheObject(\"login:\" + userid, loginUser); log.info(\"å°†tokenå­˜å‚¨åˆ°redisï¼\"); return new ResponseResult(200, \"ç™»å½•æˆåŠŸ\", map); &#125; @Override public ResponseResult logout() &#123; //è·å–æˆ‘ä»¬åœ¨JwtAuthenticationTokenFilterç±»å†™çš„SecurityContextHolderå¯¹è±¡ä¸­çš„ç”¨æˆ·id UsernamePasswordAuthenticationToken authentication = (UsernamePasswordAuthenticationToken) SecurityContextHolder.getContext().getAuthentication(); //loginUseræ˜¯æˆ‘ä»¬åœ¨domainç›®å½•å†™å¥½çš„å®ä½“ç±» LoginUser loginUser = (LoginUser) authentication.getPrincipal(); //è·å–ç”¨æˆ·id Long userid = loginUser.getUser().getId(); //æ ¹æ®ç”¨æˆ·idï¼Œåˆ é™¤redisä¸­çš„tokenå€¼ï¼Œæ³¨æ„æˆ‘ä»¬çš„keyæ˜¯è¢« login: æ‹¼æ¥è¿‡çš„ï¼Œæ‰€ä»¥ä¸‹é¢å†™å®Œæ•´keyçš„æ—¶å€™è¦å¸¦ä¸Š longin: redisCache.deleteObject(\"login:\" + userid); return new ResponseResult(200, \"æ³¨é”€æˆåŠŸ\"); &#125; &#125; ç¬¬ä¸‰æ­¥: æŠŠLoginControllerç±»ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œæ³¨æ„åªæ˜¯ç¨å¾®å¢åŠ äº†ä¸€ç‚¹ä»£ç ï¼Œæˆ‘ç”¨è™šçº¿éš”å¼€äº†ï¼Œå¢åŠ çš„ä»£ç æ˜¯åœ¨è™šçº¿çš„ä¸‹æ–¹ //-----------------------------------é€€å‡ºç™»å½•-------------------------------- @RequestMapping(\"/user/logout\") //ResponseResultæ˜¯æˆ‘ä»¬åœ¨domainç›®å½•å†™å¥½çš„å®ä½“ç±» public ResponseResult logout()&#123; return loginService.logout(); &#125; ç¬¬å››æ­¥: æœ¬åœ°æ‰“å¼€ä½ çš„redis ç¬¬äº”æ­¥: è¿è¡Œå¼•å¯¼ç±» ç¬¬å…­æ­¥: æµ‹è¯•ã€‚æ‰“å¼€ä½ çš„postmanï¼Œå‘é€å¦‚ä¸‹çš„POSTè¯·æ±‚ï¼Œä½œç”¨æ˜¯å…ˆç™»å½•ä¸€ä¸ªç”¨æˆ·ï¼Œè¿™æ ·å°±èƒ½ç”Ÿæˆè¿™ä¸ªç”¨æˆ·å¯¹åº”çš„tokenå€¼ ç¬¬ä¸ƒæ­¥: æµ‹è¯•ã€‚ç»§ç»­åœ¨ä½ çš„postmanï¼Œå‘é€å¦‚ä¸‹GETè¯·æ±‚ï¼Œä½œç”¨æ˜¯æ‹¿ç€åˆšåˆšçš„tokenå€¼ï¼Œå»è®¿é—®æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£ï¼Œçœ‹åœ¨æœ‰ç™»å½•çŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œèƒ½ä¸èƒ½è®¿é—® æ³¨æ„è¿˜è¦å¸¦ä¸Šä½ åˆšåˆšå¤åˆ¶çš„tokenå€¼ï¼Œç²˜è´´åˆ°æ¶ˆæ¯å¤´çš„Valueè¾“å…¥æ¡† ç¬¬å…«æ­¥: æµ‹è¯•ã€‚ç»§ç»­åœ¨ä½ çš„postmanï¼Œå‘é€å¦‚ä¸‹GETè¯·æ±‚ï¼Œä½œç”¨æ˜¯é€€å‡ºç™»å½•ï¼Œç„¶åå»è®¿é—®æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£ï¼Œçœ‹åœ¨æ²¡æœ‰ç™»å½•çŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œèƒ½ä¸èƒ½è®¿é—® 2.æˆæƒæˆæƒçš„åŸºæœ¬æµç¨‹åœ¨SpringSecurityä¸­ï¼Œä¼šä½¿ç”¨é»˜è®¤çš„FilterSecurityInterceptoræ¥è¿›è¡Œæƒé™æ ¡éªŒã€‚åœ¨FilterSecurityInterceptorä¸­ä¼šä»SecurityContextHolderè·å–å…¶ä¸­çš„Authenticationï¼Œç„¶åè·å–å…¶ä¸­çš„æƒé™ä¿¡æ¯ã€‚å½“å‰ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰è®¿é—®å½“å‰èµ„æºæ‰€éœ€çš„æƒé™ æ‰€ä»¥æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­åªéœ€è¦æŠŠå½“å‰ç™»å½•ç”¨æˆ·çš„æƒé™ä¿¡æ¯ä¹Ÿå­˜å…¥Authenticationï¼Œç„¶åè®¾ç½®æˆ‘ä»¬çš„èµ„æºæ‰€éœ€è¦çš„æƒé™å³å¯ã€‚ è‡ªå®šä¹‰è®¿é—®è·¯å¾„çš„æƒé™SpringSecurityä¸ºæˆ‘ä»¬æä¾›äº†åŸºäºæ³¨è§£çš„æƒé™æ§åˆ¶æ–¹æ¡ˆï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬é¡¹ç›®ä¸­ä¸»è¦é‡‡ç”¨çš„æ–¹å¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ³¨è§£å»æŒ‡å®šè®¿é—®å¯¹åº”çš„èµ„æºæ‰€éœ€çš„æƒé™ ç¬¬ä¸€æ­¥: åœ¨SecurityConfigé…ç½®ç±»æ·»åŠ å¦‚ä¸‹ï¼Œä½œç”¨æ˜¯å¼€å¯ç›¸å…³é…ç½® @EnableGlobalMethodSecurity(prePostEnabled &#x3D; true) ç¬¬äºŒæ­¥: å¼€å¯äº†ç›¸å…³é…ç½®ä¹‹åï¼Œå°±èƒ½ä½¿ç”¨@PreAuthorizeç­‰æ³¨è§£äº†ã€‚ @PreAuthorize(&quot;hasAuthority(&#39;hello&#39;)&quot;) åœ¨HelloControllerç±»çš„helloæ–¹æ³•ï¼Œæ·»åŠ å¦‚ä¸‹æ³¨è§£ï¼Œå…¶ä¸­testè¡¨ç¤ºè‡ªå®šä¹‰æƒé™çš„åå­— @RestController public class HelloController &#123; @GetMapping(\"/hello\") @PreAuthorize(\"hasAuthority('hello')\") public String hello() &#123; return \"hello world\"; &#125; @PreAuthorize(\"hasAuthority('test')\") @GetMapping(\"/test\") public String hello2() &#123; return \"hasAuthority('test')\"; &#125; &#125; å¸¦æƒé™è®¿é—®çš„å®ç°æƒé™ä¿¡æ¯: æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ä¸² æˆ‘ä»¬å‰é¢åœ¨ç™»å½•æ—¶ï¼Œä¼šè°ƒç”¨åˆ°MyUserDetailServiceImplç±»çš„loadUserByUsernameæ–¹æ³•ï¼Œå½“æ—¶æˆ‘ä»¬å†™loadUserByUsernameæ–¹æ³•æ—¶ï¼Œåªå†™äº†æŸ¥è¯¢ç”¨æˆ·æ•°æ®ä¿¡æ¯çš„ä»£ç ï¼Œè¿˜å·®æŸ¥è¯¢ç”¨æˆ·æƒé™ä¿¡æ¯çš„ä»£ç ã€‚åœ¨ç™»å½•å®Œä¹‹åï¼Œå› ä¸ºæºå¸¦äº†tokenï¼Œæ‰€ä»¥éœ€è¦åœ¨JwtAuthenticationTokenFilterç±»æ·»åŠ  â€˜è·å–æƒé™ä¿¡æ¯å°è£…åˆ°Authenticationä¸­â€™ çš„ä»£ç ï¼Œæ·»åŠ åˆ°UsernamePasswordAuthenticationTokençš„ç¬¬ä¸‰ä¸ªå‚æ•°é‡Œé¢ï¼Œæˆ‘ä»¬å½“æ—¶ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ çš„æ˜¯nullã€‚ ç¬¬ä¸€æ­¥: åœ¨ä¸Šé¢çš„è‡ªå®šä¹‰è®¿é—®è·¯å¾„çš„æƒé™ï¼Œæˆ‘ä»¬ç»™HelloControllerç±»çš„â€&#x2F;helloâ€è·¯å¾„å’Œâ€&#x2F;testâ€è·¯å¾„æ·»åŠ äº†æƒé™é™åˆ¶ï¼Œåªæœ‰ç”¨æˆ·å…·æœ‰å«helloæˆ–testçš„æƒé™ï¼Œæ‰èƒ½è®¿é—®è¿™ä¸ªè·¯å¾„ã€‚ ç¬¬äºŒæ­¥: æŠŠMyUserDetailServiceImplç±»ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œä¸»è¦æ˜¯å¢åŠ äº†æŸ¥è¯¢ç”¨æˆ·æƒé™ä¿¡æ¯çš„ä»£ç ï¼Œæƒé™åˆ—è¡¨æš‚æ—¶å†™æ­» @Override //UserDetailsæ˜¯Securityå®˜æ–¹æä¾›çš„æ¥å£ public UserDetails loadUserByUsername(String xxusername) throws UsernameNotFoundException &#123; //æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚æˆ‘ä»¬å†™çš„userMapperæ¥å£é‡Œé¢æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥è°ƒç”¨çš„æ˜¯mybatis-plusæä¾›çš„æ–¹æ³• LambdaQueryWrapper&lt;User> queryWrapper = new LambdaQueryWrapper&lt;>(); //eqæ–¹æ³•è¡¨ç¤ºç­‰å€¼åŒ¹é…ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®åº“çš„ç”¨æˆ·åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æˆ‘ä»¬ä¼ è¿›æ¥çš„ç”¨æˆ·åï¼Œè¿™ä¸¤ä¸ªå‚æ•°è¿›è¡Œæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ queryWrapper.eq(User::getUserName,xxusername); User user = userMapper.selectOne(queryWrapper); //å¦‚æœç”¨æˆ·ä¼ è¿›æ¥çš„ç”¨æˆ·åï¼Œä½†æ˜¯æ•°æ®åº“æ²¡æœ‰è¿™ä¸ªç”¨æˆ·åï¼Œå°±ä¼šå¯¼è‡´æˆ‘ä»¬æ˜¯æŸ¥ä¸åˆ°çš„æƒ…å†µï¼Œé‚£ä¹ˆå°±è¿›è¡Œä¸‹é¢çš„åˆ¤æ–­ã€‚é¿å…ç¨‹åºå®‰å…¨é—®é¢˜ if(Objects.isNull(user))&#123;//åˆ¤æ–­userå¯¹è±¡æ˜¯å¦ä¸ºç©ºã€‚å½“åœ¨æ•°æ®åº“æ²¡æœ‰æŸ¥åˆ°æ•°æ®æ—¶ï¼Œuserå°±ä¼šä¸ºç©ºï¼Œä¹Ÿå°±ä¼šè¿›å…¥è¿™ä¸ªåˆ¤æ–­ throw new RuntimeException(\"ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯\"); &#125; //--------------------------------æŸ¥è¯¢ç”¨æˆ·æƒé™ä¿¡æ¯--------------------------------- //ç”±äºæˆ‘ä»¬è‡ªå®šä¹‰äº†3ä¸ªæƒé™ï¼Œæ‰€ä»¥ç”¨Listé›†åˆå­˜å‚¨ã€‚æ³¨æ„æƒé™å®é™…å°±æ˜¯'æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ä¸²'ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä¸‰ä¸ªå­—ç¬¦ä¸²å°±æ˜¯è‡ªå®šä¹‰çš„ //ä¸‹é¢é‚£è¡Œå°±æ˜¯æˆ‘ä»¬çš„æƒé™é›†åˆï¼Œç­‰ä¸‹è¿˜è¦åœ¨LoginUserç±»åšæƒé™é›†åˆçš„è½¬æ¢ List&lt;String> list = new ArrayList&lt;>(Arrays.asList(\"test\",\"adminAuth\",\"huanfAuth\")); //------------------------------------------------------------------------------ //æŠŠæŸ¥è¯¢åˆ°çš„userç»“æœï¼Œå°è£…æˆUserDetailsç±»å‹ï¼Œç„¶åè¿”å›ã€‚ //ä½†æ˜¯ç”±äºUserDetailsæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆéœ€è¦åœ¨dominoç›®å½•æ–°å»ºLoginUserç±»ï¼Œä½œä¸ºUserDetailsçš„å®ç°ç±»ï¼Œå†å†™ä¸‹é¢é‚£è¡Œ return new LoginUser(user,list); //è¿™é‡Œä¼ äº†ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºçš„æ˜¯æƒé™ä¿¡æ¯ &#125; ç¬¬ä¸‰æ­¥: å°è£…æƒé™ä¿¡æ¯ã€‚æŠŠLoginUserç±»ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œä¸»è¦æ˜¯å¢åŠ äº†æŠŠç”¨æˆ·æƒé™å­—ç¬¦ä¸²çš„é›†åˆï¼Œè½¬æ¢å°è£…åœ¨authoritieså˜é‡é‡Œé¢ @Data //getå’Œsetæ–¹æ³• @NoArgsConstructor //æ— å‚æ„é€  //å®ç°UserDetailsæ¥å£ä¹‹åï¼Œè¦é‡å†™UserDetailsæ¥å£é‡Œé¢çš„7ä¸ªæ–¹æ³• public class LoginUser implements UserDetails &#123; private User user; //æŸ¥è¯¢ç”¨æˆ·æƒé™ä¿¡æ¯ private List&lt;String> permissions; public LoginUser(User user, List&lt;String> permissions) &#123; this.user = user; this.permissions = permissions; &#125; //æˆ‘ä»¬æŠŠè¿™ä¸ªListå†™åˆ°å¤–é¢è¿™é‡Œäº†ï¼Œæ³¨æ„æˆå‘˜å˜é‡åä¸€å®šè¦æ˜¯authoritiesï¼Œä¸ç„¶ä¼šå‡ºç°å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ @JSONField(serialize = false) //è¿™ä¸ªæ³¨è§£çš„ä½œç”¨æ˜¯ä¸è®©ä¸‹é¢é‚£è¡Œçš„æˆå‘˜å˜é‡åºåˆ—åŒ–å­˜å…¥redisï¼Œé¿å…redisä¸æ”¯æŒè€ŒæŠ¥å¼‚å¸¸ private List&lt;SimpleGrantedAuthority> authorities; @Override //ç”¨äºè¿”å›æƒé™ä¿¡æ¯ã€‚ç°åœ¨æˆ‘ä»¬æ­£åœ¨å­¦'è®¤è¯'ï¼Œ'æƒé™'åé¢æ‰å­¦ã€‚æ‰€ä»¥è¿”å›nullå³å¯ //å½“è¦æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸èƒ½å•çº¯è¿”å›nullï¼Œè¦é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œä½œç”¨æ˜¯å°è£…æƒé™ä¿¡æ¯ public Collection&lt;? extends GrantedAuthority> getAuthorities() &#123; //é‡å†™GrantedAuthorityæ¥å£çš„getAuthoritiesæ–¹æ³• /* ç¬¬ä¸€ç§æƒé™é›†åˆçš„è½¬æ¢å†™æ³•å¦‚ä¸‹ï¼Œä¼ ç»Ÿçš„æ–¹å¼ //æŠŠxxpermissionsä¸­çš„Stringç±»å‹çš„æƒé™ä¿¡æ¯(ä¹Ÿå°±æ˜¯\"test\",\"adminAuth\",\"huanfAuth\")å°è£…æˆSimpleGrantedAuthorityå¯¹è±¡ //List&lt;GrantedAuthority> authorities = new ArrayList&lt;>(); //ç®€åŒ–è¿™è¡Œå¦‚ä¸‹ä¸€è¡Œï¼Œæˆ‘ä»¬æŠŠauthoritiesæˆå‘˜å˜é‡å†™åˆ°å¤–é¢äº† authorities = new ArrayList&lt;>(); for (String yypermission : xxpermissions) &#123; SimpleGrantedAuthority yyauthority = new SimpleGrantedAuthority(yypermission); authorities.add(yyauthority); &#125; */ /* ç¬¬äºŒç§æƒé™é›†åˆçš„è½¬æ¢å†™æ³•å¦‚ä¸‹ï¼Œå‡½æ•°å¼ç¼–ç¨‹ + streamæµ çš„æ–¹å¼ï¼ŒåŒå¼•å·è¡¨ç¤ºæ–¹æ³•å¼•ç”¨ */ //å½“authoritiesé›†åˆä¸ºç©ºï¼Œå°±è¯´æ˜æ˜¯ç¬¬ä¸€æ¬¡ï¼Œå°±éœ€è¦è½¬æ¢ï¼Œå½“ä¸ä¸ºç©ºå°±è¯´æ˜ä¸æ˜¯ç¬¬ä¸€æ¬¡ï¼Œå°±ä¸éœ€è¦è½¬æ¢ç›´æ¥è¿”å› if(authorities != null)&#123; //ä¸¥è°¨æ¥è¯´è¿™ä¸ªifåˆ¤æ–­æ˜¯é¿å…æ•´ä¸ªè°ƒç”¨é“¾ä¸­securityæœ¬åœ°çº¿ç¨‹å˜é‡åœ¨è·å–ç”¨æˆ·æ—¶çš„é‡å¤è§£æï¼Œå’Œrediså­˜å–æ— å…³ return authorities; &#125; //ä¸ºç©ºçš„è¯å°±ä¼šæ‰§è¡Œä¸‹é¢çš„è½¬æ¢ä»£ç  //List&lt;SimpleGrantedAuthority> authorities = xxpermissions //ç®€åŒ–è¿™è¡Œå¦‚ä¸‹ä¸€è¡Œï¼Œæˆ‘ä»¬æŠŠauthoritiesæˆå‘˜å˜é‡å†™åˆ°å¤–é¢äº† authorities = permissions .stream() .map(SimpleGrantedAuthority::new) .collect(Collectors.toList()); //æœ€ç»ˆè¿”å›è½¬æ¢ç»“æœ return authorities; &#125; @Override //ç”¨äºè·å–ç”¨æˆ·å¯†ç ã€‚ç”±äºä½¿ç”¨çš„å®ä½“ç±»æ˜¯Userï¼Œæ‰€ä»¥è·å–çš„æ˜¯æ•°æ®åº“çš„ç”¨æˆ·å¯†ç  public String getPassword() &#123; return user.getPassword(); &#125; @Override //ç”¨äºè·å–ç”¨æˆ·åã€‚ç”±äºä½¿ç”¨çš„å®ä½“ç±»æ˜¯Userï¼Œæ‰€ä»¥è·å–çš„æ˜¯æ•°æ®åº“çš„ç”¨æˆ·å public String getUsername() &#123; return user.getUserName(); &#125; @Override //åˆ¤æ–­ç™»å½•çŠ¶æ€æ˜¯å¦è¿‡æœŸã€‚æŠŠè¿™ä¸ªæ”¹æˆtrueï¼Œè¡¨ç¤ºæ°¸ä¸è¿‡æœŸ public boolean isAccountNonExpired() &#123; return true; &#125; @Override //åˆ¤æ–­è´¦å·æ˜¯å¦è¢«é”å®šã€‚æŠŠè¿™ä¸ªæ”¹æˆtrueï¼Œè¡¨ç¤ºæœªé”å®šï¼Œä¸ç„¶ç™»å½•çš„æ—¶å€™ï¼Œä¸è®©ä½ ç™»å½• public boolean isAccountNonLocked() &#123; return true; &#125; @Override //åˆ¤æ–­ç™»å½•å‡­è¯æ˜¯å¦è¿‡æœŸã€‚æŠŠè¿™ä¸ªæ”¹æˆtrueï¼Œè¡¨ç¤ºæ°¸ä¸è¿‡æœŸ public boolean isCredentialsNonExpired() &#123; return true; &#125; @Override //åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å¯ç”¨ã€‚æŠŠè¿™ä¸ªæ”¹æˆtrueï¼Œè¡¨ç¤ºå¯ç”¨çŠ¶æ€ public boolean isEnabled() &#123; return true; &#125; &#125; ç¬¬å››æ­¥: æŠŠJwtAuthenticationTokenFilterç±»ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œä¸»è¦æ˜¯è¡¥å……äº†å‰é¢æ²¡å†™çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå†™æˆç¬¬ä¸‰æ­¥å°è£…å¥½çš„æƒé™ä¿¡æ¯ //æŠŠæœ€ç»ˆçš„LoginUserç”¨æˆ·ä¿¡æ¯ï¼Œé€šè¿‡setAuthenticationæ–¹æ³•ï¼Œå­˜å…¥SecurityContextHolder UsernamePasswordAuthenticationToken authenticationToken = //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯LoginUserç”¨æˆ·ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å‡­è¯(null)ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æƒé™ä¿¡æ¯(null) //åœ¨å­¦ä¹ å°è£…æƒé™ä¿¡æ¯æ—¶ï¼Œå°±è¦æŠŠä¸‹é¢çš„ç¬¬ä¸‰ä¸ªå‚æ•°è¡¥å……å®Œæ•´ï¼ŒgetAuthoritiesæ˜¯æˆ‘ä»¬åœ¨loginUserå†™çš„æ–¹æ³• new UsernamePasswordAuthenticationToken(loginUser,null,loginUser.getAuthorities()); SecurityContextHolder.getContext().setAuthentication(authenticationToken); ç¬¬äº”æ­¥: æµ‹è¯•ã€‚æ‰“å¼€postmanï¼Œå‘é€å¦‚ä¸‹çš„POSTè¯·æ±‚ï¼Œä½œç”¨æ˜¯å…ˆç™»å½•ä¸€ä¸ªç”¨æˆ·ï¼Œè¿™æ ·å°±èƒ½ç”Ÿæˆè¿™ä¸ªç”¨æˆ·å¯¹åº”çš„tokenå€¼ ç»§ç»­åœ¨postmanï¼Œå‘é€å¦‚ä¸‹GETè¯·æ±‚ï¼Œä½œç”¨æ˜¯æ‹¿ç€åˆšåˆšçš„tokenå€¼ï¼Œå»è®¿é—®æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£ï¼Œçœ‹åœ¨æœ‰ç™»å½•çŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œèƒ½ä¸èƒ½è®¿é—® ç»§ç»­è®¿é—®helloè·¯å¾„å› ä¸ºæ²¡æœ‰èµ‹äºˆç”¨æˆ·helloæƒé™ï¼Œå› æ­¤ç¦æ­¢è®¿é—®ã€‚ 3.æˆæƒ-RBACæƒé™æ¨¡å‹åˆšåˆšæˆ‘ä»¬å®ç°äº†åªæœ‰å½“ç”¨æˆ·å…·å¤‡æŸç§æƒé™ï¼Œæ‰èƒ½è®¿é—®æˆ‘ä»¬çš„æŸä¸ªä¸šåŠ¡æ¥å£ã€‚ä½†æ˜¯å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ç»™ç”¨æˆ·è®¾ç½®æƒé™çš„æ—¶å€™ï¼Œæ˜¯å†™æ­»çš„ï¼Œåœ¨çœŸæ­£çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦ä»æ•°æ®åº“æŸ¥è¯¢æƒé™ä¿¡æ¯ï¼Œä¸‹é¢å°±æ¥å­¦ä¹ å¦‚ä½•ä»æ•°æ®åº“æŸ¥è¯¢æƒé™ä¿¡æ¯ï¼Œç„¶åå°è£…ç»™ç”¨æˆ·ã€‚è¿™ä¸ªåŠŸèƒ½éœ€è¦å…ˆå‡†å¤‡å¥½æ•°æ®åº“å’Œjavaä»£ç ï¼Œæ‰€ä»¥ï¼Œä¸‹é¢çš„ â€˜æˆæƒ-RBACæƒé™æ¨¡å‹â€™ éƒ½æ˜¯åœ¨å›´ç»•è¿™ä¸ªåŠŸèƒ½è¿›è¡Œå­¦ä¹ ï¼Œç›´åˆ°å®ç°è¿™ä¸ªåŠŸèƒ½ ä»‹ç»RBACæƒé™æ¨¡å‹ (Role-Based Access Control) ï¼Œæ˜¯æƒé™ç³»ç»Ÿç”¨åˆ°çš„ç»å…¸æ¨¡å‹ï¼ŒåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ã€‚è¯¥æ¨¡å‹ç”±ä»¥ä¸‹äº”ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†æ„æˆ: ä¸€ã€ç”¨æˆ·: åœ¨ç³»ç»Ÿä¸­ä»£è¡¨å…·ä½“ä¸ªä½“çš„å®ä½“ï¼Œå¯ä»¥æ˜¯äººå‘˜ã€ç¨‹åºæˆ–å…¶ä»–å®ä½“ã€‚ç”¨æˆ·éœ€è¦è®¿é—®ç³»ç»Ÿèµ„æº äºŒã€è§’è‰²: è§’è‰²æ˜¯æƒé™çš„é›†åˆï¼Œç”¨äºå®šä¹‰ä¸€ç»„ç›¸ä¼¼æƒé™çš„é›†åˆã€‚è§’è‰²å¯ä»¥è¢«èµ‹äºˆç»™ç”¨æˆ·ï¼Œä»è€Œæˆäºˆç”¨æˆ·ç›¸åº”çš„æƒé™ ä¸‰ã€æƒé™: æƒé™è¡¨ç¤ºç³»ç»Ÿä¸­å…·ä½“çš„æ“ä½œæˆ–åŠŸèƒ½ï¼Œä¾‹å¦‚è¯»å–ã€å†™å…¥ã€æ‰§è¡Œç­‰ã€‚æ¯ä¸ªæƒé™å®šä¹‰äº†å¯¹ç³»ç»Ÿèµ„æºçš„è®¿é—®è§„åˆ™ å››ã€ç”¨æˆ·-è§’è‰²æ˜ å°„: ç”¨æˆ·-è§’è‰²æ˜ å°„ç”¨äºè¡¨ç¤ºç”¨æˆ·ä¸è§’è‰²ä¹‹é—´çš„å…³ç³»ã€‚é€šè¿‡ä¸ºç”¨æˆ·åˆ†é…é€‚å½“çš„è§’è‰²ï¼Œç”¨æˆ·å¯ä»¥è·å¾—ä¸è§’è‰²ç›¸å…³è”çš„æƒé™ äº”ã€è§’è‰²-æƒé™æ˜ å°„: è§’è‰²-æƒé™æ˜ å°„è¡¨ç¤ºè§’è‰²ä¸æƒé™ä¹‹é—´çš„å…³ç³»ã€‚æ¯ä¸ªè§’è‰²éƒ½è¢«åˆ†é…äº†ä¸€ç»„æƒé™ï¼Œè¿™äº›æƒé™å†³å®šäº†è§’è‰²å¯æ‰§è¡Œçš„æ“ä½œ æˆªæ­¢ç›®å‰ï¼Œæˆ‘ä»¬æ•°æ®åº“åªæœ‰ sys_user ç”¨æˆ·è¡¨ï¼Œä¸‹é¢æˆ‘ä»¬ä¼šæ–°å¢4å¼ è¡¨ï¼Œåˆ†åˆ«æ˜¯æƒé™è¡¨(æ¯æ¡æ•°æ®æ˜¯å•ä¸ªâ€™ç²’åº¦ç»†çš„æƒé™â€™)ã€è§’è‰²è¡¨(æ¯æ¡æ•°æ®æ˜¯å¤šä¸ªâ€™ç²’åº¦ç»†çš„æƒé™â€™)ã€è§’è‰²è¡¨ä¸æƒé™è¡¨çš„ä¸­é—´è¡¨ã€ç”¨æˆ·è¡¨ä¸è§’è‰²è¡¨çš„ä¸­é—´è¡¨ã€‚æ€»å…±5å¼ è¡¨ï¼Œç»„æˆäº†RBACæ¨¡å‹ï¼Œä¸­é—´è¡¨çš„ä½œç”¨æ˜¯ç»´æŠ¤ä¸¤å¼ è¡¨çš„å¤šå¯¹å¤šå…³ç³». æ•°æ®åº“è¡¨çš„åˆ›å»ºç¬¬ä¸€æ­¥: åœ¨ä½ æ•°æ®åº“çš„huanf_security åº“ï¼Œæ–°å»º sys_menuæƒé™è¡¨ã€sys_roleè§’è‰²è¡¨ã€sys_role_menuä¸­é—´è¡¨ã€sys_user_roleä¸­é—´è¡¨ï¼Œå¹¶æ’å…¥æ•°æ® create database if not exists huanf_security; use huanf_security; CREATE TABLE `sys_menu` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `menu_name` varchar(64) NOT NULL DEFAULT 'NULL' COMMENT 'èœå•å', `path` varchar(200) DEFAULT NULL COMMENT 'è·¯ç”±åœ°å€', `component` varchar(255) DEFAULT NULL COMMENT 'ç»„ä»¶è·¯å¾„', `visible` char(1) DEFAULT '0' COMMENT 'èœå•çŠ¶æ€ï¼ˆ0æ˜¾ç¤º 1éšè—ï¼‰', `status` char(1) DEFAULT '0' COMMENT 'èœå•çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰', `perms` varchar(100) DEFAULT NULL COMMENT 'æƒé™æ ‡è¯†', `icon` varchar(100) DEFAULT '#' COMMENT 'èœå•å›¾æ ‡', `create_by` bigint(20) DEFAULT NULL, `create_time` datetime DEFAULT NULL, `update_by` bigint(20) DEFAULT NULL, `update_time` datetime DEFAULT NULL, `del_flag` int(11) DEFAULT '0' COMMENT 'æ˜¯å¦åˆ é™¤ï¼ˆ0æœªåˆ é™¤ 1å·²åˆ é™¤ï¼‰', `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨', PRIMARY KEY (`id`) ) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4 COMMENT='æƒé™è¡¨'; CREATE TABLE `sys_role` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(128) DEFAULT NULL, `role_key` varchar(100) DEFAULT NULL COMMENT 'è§’è‰²æƒé™å­—ç¬¦ä¸²', `status` char(1) DEFAULT '0' COMMENT 'è§’è‰²çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰', `del_flag` int(1) DEFAULT '0' COMMENT 'del_flag', `create_by` bigint(200) DEFAULT NULL, `create_time` datetime DEFAULT NULL, `update_by` bigint(200) DEFAULT NULL, `update_time` datetime DEFAULT NULL, `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨', PRIMARY KEY (`id`) ) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COMMENT='è§’è‰²è¡¨'; CREATE TABLE `sys_role_menu` ( `role_id` bigint(200) NOT NULL AUTO_INCREMENT COMMENT 'è§’è‰²ID', `menu_id` bigint(200) NOT NULL DEFAULT '0' COMMENT 'èœå•id', PRIMARY KEY (`role_id`,`menu_id`) ) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4; CREATE TABLE `sys_user_role` ( `user_id` bigint(200) NOT NULL AUTO_INCREMENT COMMENT 'ç”¨æˆ·id', `role_id` bigint(200) NOT NULL DEFAULT '0' COMMENT 'è§’è‰²id', PRIMARY KEY (`user_id`,`role_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4; insert into sys_user_role values (2,1); insert into sys_role values (1,'ç»ç†','ceo',0,0,default,default,default,default,default), (2,'ç¨‹åºå‘˜','coder',0,0,default,default,default,default,default); insert into sys_role_menu values (1,1),(1,2); insert into sys_menu values (1,'éƒ¨é—¨ç®¡ç†','dept','system/dept/index',0,0,'system:dept:list','#',default,default,default,default,default,default), (2,'æµ‹è¯•','test','system/test/index',0,0,'system:test:list','#',default,default,default,default,default,default) ç¬¬äºŒæ­¥: æµ‹è¯•SQLè¯­å¥ï¼Œä¹Ÿå°±æ˜¯ç¡®è®¤ä¸€ä¸‹ä½ çš„å»ºè¡¨ã€æ’å…¥æ•°æ®æ˜¯å¦è¾¾åˆ°è¦æ±‚ # é€šè¿‡ç”¨æˆ·idå»æŸ¥è¯¢è¿™ä¸ªç”¨æˆ·å…·æœ‰çš„æƒé™åˆ—è¡¨ã€‚ä¹Ÿå°±æ˜¯æ ¹æ®useridæŸ¥è¯¢permsï¼Œå¹¶ä¸”é™åˆ¶æ¡ä»¶ä¸ºroleå’Œmenuéƒ½å¿…é¡»æ­£å¸¸çŠ¶æ€ä¹ˆä¹Ÿå°±æ˜¯ç­‰äº0 SELECT DISTINCT m.`perms` FROM sys_user_role ur LEFT JOIN `sys_role` r ON ur.`role_id` = r.`id` LEFT JOIN `sys_role_menu` rm ON ur.`role_id` = rm.`role_id` LEFT JOIN `sys_menu` m ON m.`id` = rm.`menu_id` WHERE user_id = 2 AND r.`status` = 0 AND m.`status` = 0 æŸ¥è¯¢æ•°æ®åº“çš„æƒé™ä¿¡æ¯ç¬¬ä¸€æ­¥: åœ¨ domain ç›®å½•æ–°å»º Menu å®ä½“ç±»ï¼Œå†™å…¥å¦‚ä¸‹ //æƒé™è¡¨(ä¹Ÿå«èœå•è¡¨)çš„å®ä½“ç±» @TableName(value=\"sys_menu\") //æŒ‡å®šè¡¨åï¼Œé¿å…ç­‰ä¸‹mybatisplusçš„å½±å“ @Data @AllArgsConstructor @NoArgsConstructor @JsonInclude(JsonInclude.Include.NON_NULL) //Serializableæ˜¯å®˜æ–¹æä¾›çš„ï¼Œä½œç”¨æ˜¯å°†å¯¹è±¡è½¬åŒ–ä¸ºå­—èŠ‚åºåˆ— public class Menu implements Serializable &#123; private static final long serialVersionUID = -54979041104113736L; @TableId private Long id; /** * èœå•å */ private String menuName; /** * è·¯ç”±åœ°å€ */ private String path; /** * ç»„ä»¶è·¯å¾„ */ private String component; /** * èœå•çŠ¶æ€ï¼ˆ0æ˜¾ç¤º 1éšè—ï¼‰ */ private String visible; /** * èœå•çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰ */ private String status; /** * æƒé™æ ‡è¯† */ private String perms; /** * èœå•å›¾æ ‡ */ private String icon; private Long createBy; private Date createTime; private Long updateBy; private Date updateTime; /** * æ˜¯å¦åˆ é™¤ï¼ˆ0æœªåˆ é™¤ 1å·²åˆ é™¤ï¼‰ */ private Integer delFlag; /** * å¤‡æ³¨ */ private String remark; &#125; ç¬¬äºŒæ­¥: åœ¨ mapper ç›®å½•æ–°å»º MenuMapper æ¥å£ã€‚ä½œç”¨æ˜¯å®šä¹‰mapperï¼Œå…¶ä¸­æä¾›ä¸€ä¸ªæ–¹æ³•å¯ä»¥æ ¹æ®useridæŸ¥è¯¢æƒé™ä¿¡æ¯ @Mapper &#x2F;&#x2F;BaseMapperæ˜¯mybatispluså®˜æ–¹æä¾›çš„æ¥å£ï¼Œé‡Œé¢æä¾›äº†å¾ˆå¤šå•è¡¨æŸ¥è¯¢çš„æ–¹æ³• public interface MenuMapper extends BaseMapper&lt;Menu&gt; &#123; &#x2F;&#x2F;&#x2F;&#x2F;ç”±äºæ˜¯å¤šè¡¨è”æŸ¥ï¼Œmybatisplusçš„BaseMapperæ¥å£æ²¡æœ‰æä¾›ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ–¹æ³•ï¼Œæ‰€ä»¥éœ€è¦åˆ›å»ºå¯¹åº”çš„mapperæ–‡ä»¶ï¼Œå®šä¹‰å¯¹åº”çš„sqlè¯­å¥ List&lt;String&gt; selectPermsByUserId(Long id); &#125; ç¬¬ä¸‰æ­¥: åœ¨ resources ç›®å½•æ–°å»º mapperç›®å½•ï¼Œæ¥ç€åœ¨è¿™ä¸ªmapperç›®å½•æ–°å»ºFileï¼Œåå­—å« MenuMapper.xmlï¼Œå†™å…¥å¦‚ä¸‹ &lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?> &lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\" > &lt;mapper namespace=\"com.ehzyil.mapper.MenuMapper\"> &lt;select id=\"selectPermsByUserId\" resultType=\"java.lang.String\"> SELECT DISTINCT m.`perms` FROM sys_user_role ur LEFT JOIN `sys_role` r ON ur.`role_id` = r.`id` LEFT JOIN `sys_role_menu` rm ON ur.`role_id` = rm.`role_id` LEFT JOIN `sys_menu` m ON m.`id` = rm.`menu_id` WHERE user_id = #&#123;userid&#125; AND r.`status` = 0 AND m.`status` = 0 &lt;/select> &lt;/mapper> ç¬¬å››æ­¥: æŠŠapplication.ymlä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œä½œç”¨æ˜¯å‘Šè¯‰MPï¼Œåˆšåˆšå†™çš„MenuMapper.xmlæ–‡ä»¶æ˜¯åœ¨å“ªä¸ªåœ°æ–¹ mybatis-plus: # é…ç½®MenuMapper.xmlæ–‡ä»¶çš„è·¯å¾„ # ä¹Ÿå¯ä»¥ä¸å†™ï¼Œå› ä¸ºé»˜è®¤å°±æ˜¯åœ¨ç±»åŠ è½½è·¯å¾„(resouces)ä¸‹çš„mapperç›®å½•çš„ä»»æ„å±‚çº§çš„åç¼€ä¸ºxmlçš„æ–‡ä»¶ï¼Œéƒ½ä¼šè¢«æ‰«æåˆ° mapper-locations: classpath*:/mapper/**/*.xml ç¬¬äº”æ­¥: æµ‹è¯•ã€‚è¿™é‡Œåªæ˜¯æ£€æŸ¥mybatismlusèƒ½ä¸èƒ½æ‹¿åˆ°æ•°æ®åº“çš„æƒé™å­—ç¬¦ä¸²ã€‚åœ¨MapperTestç±»æ·»åŠ å¦‚ä¸‹ @Autowired private MenuMapper menuMapper; @Test public void testSelectPermsByUserId()&#123; &#x2F;&#x2F;Lè¡¨ç¤ºLongç±»å‹ List&lt;String&gt; list &#x3D; menuMapper.selectPermsByUserId(2L); System.out.println(list); &#125; RBACæƒé™æ¨¡å‹çš„å®ç°ä¸è¦æŠŠRBACæ¨¡å‹æƒ³å¾—å¾ˆéš¾ï¼Œå…¶å®éš¾çš„è¯åªæ˜¯æ•°æ®åº“è¡¨çš„è®¾è®¡å’ŒSQLè¯­å¥çš„ç¼–å†™ï¼Œéœ€è¦5å¼ è¡¨ã€‚æ•°æ®åº“è®¾è®¡å¥½ä¹‹åå°±å¾ˆç®€å•äº†ï¼Œä½¿ç”¨mybatis-pluså»æŸ¥è¯¢æ•°æ®åº“è¡¨çš„æƒé™å­—ç¬¦ä¸²(ä¾‹å¦‚æˆ‘ä»¬çš„æƒé™å­—ç¬¦ä¸²æ˜¯æ”¾åœ¨sys_menuè¡¨)ï¼Œç„¶åæŠŠä½ æŸ¥åˆ°çš„æ•°æ®å»æ›¿æ¢æ­»æ•°æ®å°±å¥½äº†ã€‚æˆ‘ä»¬åªå‰©æœ€åä¸€æ­¥ï¼Œå°±æ˜¯æ›¿æ¢æ­»æ•°æ®ï¼Œå¦‚ä¸‹ ç¬¬ä¸€æ­¥: æŠŠMyUserDetailServiceImplç±»ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œæˆ‘ä»¬åªæ˜¯å¢åŠ äº†æŸ¥è¯¢æ¥è‡ªæ•°æ®åº“çš„æƒé™ä¿¡æ¯çš„ä»£ç  @Autowired private UserMapper userMapper; @Autowired &#x2F;&#x2F;MenuMapperæ˜¯æˆ‘ä»¬åœ¨mapperç›®å½•å†™å¥½çš„æ¥å£ï¼Œä½œç”¨æ˜¯æŸ¥è¯¢æ¥è‡ªæ•°æ®åº“çš„æƒé™ä¿¡æ¯ private MenuMapper menuMapper; @Override &#x2F;&#x2F;UserDetailsæ˜¯Securityå®˜æ–¹æä¾›çš„æ¥å£ public UserDetails loadUserByUsername(String xxusername) throws UsernameNotFoundException &#123; &#x2F;&#x2F;æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚æˆ‘ä»¬å†™çš„userMapperæ¥å£é‡Œé¢æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥è°ƒç”¨çš„æ˜¯mybatis-plusæä¾›çš„æ–¹æ³• LambdaQueryWrapper&lt;User&gt; queryWrapper &#x3D; new LambdaQueryWrapper&lt;&gt;(); &#x2F;&#x2F;eqæ–¹æ³•è¡¨ç¤ºç­‰å€¼åŒ¹é…ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®åº“çš„ç”¨æˆ·åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æˆ‘ä»¬ä¼ è¿›æ¥çš„ç”¨æˆ·åï¼Œè¿™ä¸¤ä¸ªå‚æ•°è¿›è¡Œæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ queryWrapper.eq(User::getUserName,xxusername); User user &#x3D; userMapper.selectOne(queryWrapper); &#x2F;&#x2F;å¦‚æœç”¨æˆ·ä¼ è¿›æ¥çš„ç”¨æˆ·åï¼Œä½†æ˜¯æ•°æ®åº“æ²¡æœ‰è¿™ä¸ªç”¨æˆ·åï¼Œå°±ä¼šå¯¼è‡´æˆ‘ä»¬æ˜¯æŸ¥ä¸åˆ°çš„æƒ…å†µï¼Œé‚£ä¹ˆå°±è¿›è¡Œä¸‹é¢çš„åˆ¤æ–­ã€‚é¿å…ç¨‹åºå®‰å…¨é—®é¢˜ if(Objects.isNull(user))&#123;&#x2F;&#x2F;åˆ¤æ–­userå¯¹è±¡æ˜¯å¦ä¸ºç©ºã€‚å½“åœ¨æ•°æ®åº“æ²¡æœ‰æŸ¥åˆ°æ•°æ®æ—¶ï¼Œuserå°±ä¼šä¸ºç©ºï¼Œä¹Ÿå°±ä¼šè¿›å…¥è¿™ä¸ªåˆ¤æ–­ throw new RuntimeException(&quot;ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯&quot;); &#125; &#x2F;&#x2F;--------------------------------æŸ¥è¯¢ç”¨æˆ·æƒé™ä¿¡æ¯--------------------------------- &#x2F;&#x2F;ç”±äºæˆ‘ä»¬è‡ªå®šä¹‰äº†3ä¸ªæƒé™ï¼Œæ‰€ä»¥ç”¨Listé›†åˆå­˜å‚¨ã€‚æ³¨æ„æƒé™å®é™…å°±æ˜¯&#39;æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ä¸²&#39;ï¼Œæ‰€ä»¥ä¸‹é¢çš„ä¸‰ä¸ªå­—ç¬¦ä¸²å°±æ˜¯è‡ªå®šä¹‰çš„ &#x2F;&#x2F;ä¸‹é¢é‚£è¡Œå°±æ˜¯æˆ‘ä»¬çš„æƒé™é›†åˆï¼Œç­‰ä¸‹è¿˜è¦åœ¨LoginUserç±»åšæƒé™é›†åˆçš„è½¬æ¢ &#x2F;&#x2F; List&lt;String&gt; list &#x3D; new ArrayList&lt;&gt;(Arrays.asList(&quot;test&quot;,&quot;adminAuth&quot;,&quot;huanfAuth&quot;)); &#x2F;&#x2F;-------------------------------æŸ¥è¯¢æ¥è‡ªæ•°æ®åº“çš„æƒé™ä¿¡æ¯-------------------------------- List&lt;String&gt; list &#x3D; menuMapper.selectPermsByUserId(user.getId()); &#x2F;&#x2F;------------------------------------------------------------------------------ &#x2F;&#x2F;æŠŠæŸ¥è¯¢åˆ°çš„userç»“æœï¼Œå°è£…æˆUserDetailsç±»å‹ï¼Œç„¶åè¿”å›ã€‚ &#x2F;&#x2F;ä½†æ˜¯ç”±äºUserDetailsæ˜¯ä¸ªæ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆéœ€è¦åœ¨dominoç›®å½•æ–°å»ºLoginUserç±»ï¼Œä½œä¸ºUserDetailsçš„å®ç°ç±»ï¼Œå†å†™ä¸‹é¢é‚£è¡Œ return new LoginUser(user,list); &#x2F;&#x2F;è¿™é‡Œä¼ äº†ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºçš„æ˜¯æƒé™ä¿¡æ¯ &#125; ç¬¬äºŒæ­¥: ç”±äºæˆ‘ä»¬çŸ¥é“æ•°æ®åº“ä¼ è¿‡æ¥çš„æƒé™å­—ç¬¦ä¸²æ˜¯ system:dept:list å’Œ system:test:listï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠHelloControllerç±»çš„æƒé™å­—ç¬¦ä¸²ä¿®æ”¹ä¸ºå¦‚ä¸‹ system:test:list ç¬¬ä¸‰æ­¥: æµ‹è¯•ã€‚ è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†é¢çš„æˆ‘ä»¬å­¦ä¹ äº† â€˜è®¤è¯â€™ å’Œ â€˜æˆæƒâ€™ï¼Œå®ç°äº†åŸºæœ¬çš„æƒé™ç®¡ç†ï¼Œç„¶åä¹Ÿå­¦ä¹ äº†ä»æ•°æ®åº“è·å–æˆæƒçš„ â€˜æˆæƒ-RBACæƒé™æ¨¡å‹â€™ï¼Œå®ç°äº†ä»æ•°æ®åº“è·å–ç”¨æˆ·å…·å¤‡çš„æƒé™å­—ç¬¦ä¸²ã€‚åˆ°æ­¤ï¼Œæˆ‘ä»¬å®Œæ•´åœ°å®ç°äº†æƒé™ç®¡ç†çš„åŠŸèƒ½ï¼Œä½†æ˜¯ï¼Œå½“è®¤è¯æˆ–æˆæƒå‡ºç°æŠ¥é”™æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å“åº”å›æ¥çš„jsonæ•°æ®æœ‰å®ä½“ç±»çš„codeã€msgã€dataè¿™ä¸‰ä¸ªå­—æ®µï¼Œæ€ä¹ˆå®ç°å‘¢ æˆ‘ä»¬éœ€è¦å­¦ä¹ Spring Securityçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œå°±å¯ä»¥åœ¨è®¤è¯å¤±è´¥æˆ–è€…æ˜¯æˆæƒå¤±è´¥çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å’Œæˆ‘ä»¬çš„æ¥å£ä¸€æ ·è¿”å›ç›¸åŒç»“æ„çš„jsonï¼Œè¿™æ ·å¯ä»¥è®©å‰ç«¯èƒ½å¯¹å“åº”è¿›è¡Œç»Ÿä¸€çš„å¤„ç† åœ¨SpringSecurityä¸­ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è®¤è¯æˆ–è€…æˆæƒçš„è¿‡ç¨‹ä¸­å‡ºç°äº†å¼‚å¸¸ä¼šè¢«ExceptionTranslationFilteræ•è·åˆ°ï¼Œå¦‚ä¸Šå›¾ã€‚åœ¨ExceptionTranslationFilterä¸­ä¼šå»åˆ¤æ–­æ˜¯è®¤è¯å¤±è´¥è¿˜æ˜¯æˆæƒå¤±è´¥å‡ºç°çš„å¼‚å¸¸ï¼Œå…¶ä¸­æœ‰å¦‚ä¸‹ä¸¤ç§æƒ…å†µ ä¸€ã€å¦‚æœæ˜¯è®¤è¯è¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸ä¼šè¢«å°è£…æˆAuthenticationExceptionç„¶åè°ƒç”¨AuthenticationEntryPointå¯¹è±¡çš„æ–¹æ³•å»è¿›è¡Œå¼‚å¸¸å¤„ç†ã€‚ äºŒã€å¦‚æœæ˜¯æˆæƒè¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸ä¼šè¢«å°è£…æˆAccessDeniedExceptionç„¶åè°ƒç”¨AccessDeniedHandlerå¯¹è±¡çš„æ–¹æ³•å»è¿›è¡Œå¼‚å¸¸å¤„ç†ã€‚ æ€»ç»“: å¦‚æœæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ›å»ºAuthenticationEntryPointå’ŒAccessDeniedHandlerçš„å®ç°ç±»å¯¹è±¡ï¼Œç„¶åé…ç½®ç»™SpringSecurityå³å¯ ç¬¬ä¸€æ­¥: åœ¨ src&#x2F;main&#x2F;java&#x2F;com.ehzyil ç›®å½•æ–°å»º handler.AuthenticationEntryPointImplç±»ï¼Œå†™å…¥å¦‚ä¸‹ï¼Œä½œç”¨æ˜¯è‡ªå®šä¹‰è®¤è¯çš„å®ç°ç±» @Component //è¿™ä¸ªç±»åªå¤„ç†è®¤è¯å¼‚å¸¸ï¼Œä¸å¤„ç†æˆæƒå¼‚å¸¸ public class AuthenticationEntryPointImpl implements AuthenticationEntryPoint &#123; @Override //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯·æ±‚å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å“åº”å¯¹è±¡ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å¼‚å¸¸å¯¹è±¡ã€‚æŠŠå¼‚å¸¸å°è£…æˆæˆæƒçš„å¯¹è±¡ï¼Œç„¶åå°è£…åˆ°handleæ–¹æ³• public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException &#123; //ResponseResultæ˜¯æˆ‘ä»¬åœ¨domainç›®å½•å†™å¥½çš„å®ä½“ç±»ã€‚HttpStatusæ˜¯springæä¾›çš„æšä¸¾ç±»ï¼ŒUNAUTHORIZEDè¡¨ç¤º401çŠ¶æ€ç  ResponseResult result = new ResponseResult(HttpStatus.UNAUTHORIZED.value(), \"ç”¨æˆ·è®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•\"); //æŠŠä¸Šé¢é‚£è¡Œæ‹¿åˆ°çš„resultå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸² String json = JSON.toJSONString(result); //WebUtilsæ˜¯æˆ‘ä»¬åœ¨utilsç›®å½•å†™å¥½çš„ç±» WebUtils.renderString(response, json); &#125; &#125; ç¬¬äºŒæ­¥: åœ¨handlerç›®å½•æ–°å»º AccessDeniedHandlerImpl ç±»ï¼Œå†™å…¥å¦‚ä¸‹ï¼Œä½œç”¨æ˜¯è‡ªå®šä¹‰æˆæƒçš„å®ç°ç±» @Component //è¿™ä¸ªç±»åªå¤„ç†æˆæƒå¼‚å¸¸ï¼Œä¸å¤„ç†è®¤è¯å¼‚å¸¸ public class AccessDeniedHandlerImpl implements AccessDeniedHandler &#123; @Override //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯·æ±‚å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å“åº”å¯¹è±¡ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å¼‚å¸¸å¯¹è±¡ã€‚æŠŠå¼‚å¸¸å°è£…æˆè®¤è¯çš„å¯¹è±¡ï¼Œç„¶åå°è£…åˆ°handleæ–¹æ³• public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException accessDeniedException) throws IOException, ServletException &#123; //ResponseResultæ˜¯æˆ‘ä»¬åœ¨domainç›®å½•å†™å¥½çš„å®ä½“ç±»ã€‚HttpStatusæ˜¯springæä¾›çš„æšä¸¾ç±»ï¼ŒFORBIDDENè¡¨ç¤º403çŠ¶æ€ç  ResponseResult result = new ResponseResult(HttpStatus.FORBIDDEN.value(), \"æ‚¨æ²¡æœ‰æƒé™è¿›è¡Œè®¿é—®\"); //æŠŠä¸Šé¢é‚£è¡Œæ‹¿åˆ°çš„resultå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸² String json = JSON.toJSONString(result); //WebUtilsæ˜¯æˆ‘ä»¬åœ¨utilsç›®å½•å†™å¥½çš„ç±» WebUtils.renderString(response, json); &#125; &#125; ç¬¬ä¸‰æ­¥: æŠŠ SecurityConfig ç±»ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œä½œç”¨æ˜¯æŠŠåˆšåˆšä¸¤ä¸ªå¼‚å¸¸å¤„ç†çš„å®ç°ç±»é…ç½®åœ¨Spring Securityé‡Œé¢ @Configuration @EnableGlobalMethodSecurity(prePostEnabled = true) //å®ç°Securityæä¾›çš„WebSecurityConfigurerAdapterç±»ï¼Œå°±å¯ä»¥æ”¹å˜å¯†ç æ ¡éªŒçš„è§„åˆ™äº† public class SecurityConfig extends WebSecurityConfigurerAdapter &#123; @Autowired //æ³¨å…¥æˆ‘ä»¬åœ¨filterç›®å½•å†™å¥½çš„ç±» private JwtAuthenticationTokenFilter jwtAuthenticationTokenFilter; @Autowired //æ³¨å…¥Securityæä¾›çš„è®¤è¯å¤±è´¥çš„å¤„ç†å™¨ï¼Œè¿™ä¸ªå¤„ç†å™¨é‡Œé¢çš„AuthenticationEntryPointImplå®ç°ç±»ï¼Œç”¨çš„ä¸æ˜¯å®˜æ–¹çš„äº†ï¼Œ //è€Œæ˜¯ç”¨çš„æ˜¯æˆ‘ä»¬åœ¨handlerç›®å½•å†™å¥½çš„AuthenticationEntryPointImplå®ç°ç±» private AuthenticationEntryPoint authenticationEntryPoint; @Autowired //æ³¨å…¥Securityæä¾›çš„æˆæƒå¤±è´¥çš„å¤„ç†å™¨ï¼Œè¿™ä¸ªå¤„ç†å™¨é‡Œé¢çš„AccessDeniedHandlerImplå®ç°ç±»ï¼Œç”¨çš„ä¸æ˜¯å®˜æ–¹çš„äº†ï¼Œ //è€Œæ˜¯ç”¨çš„æ˜¯æˆ‘ä»¬åœ¨handlerç›®å½•å†™å¥½çš„AccessDeniedHandlerImplå®ç°ç±» private AccessDeniedHandler accessDeniedHandler; //---------------------------è®¤è¯è¿‡æ»¤å™¨çš„å®ç°---------------------------------- @Bean //æŠŠBCryptPasswordEncoderå¯¹è±¡æ³¨å…¥Springå®¹å™¨ä¸­ï¼ŒSpringSecurityå°±ä¼šä½¿ç”¨è¯¥PasswordEncoderæ¥è¿›è¡Œå¯†ç æ ¡éªŒ //æ³¨æ„ä¹Ÿå¯ä»¥æ³¨å…¥PasswordEncoderï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºPasswordEncoderæ˜¯BCry..çš„çˆ¶ç±» public PasswordEncoder passwordEncoder() &#123; return new BCryptPasswordEncoder(); &#125; //---------------------------ç™»å½•æ¥å£çš„å®ç°---------------------------------- @Bean @Override public AuthenticationManager authenticationManagerBean() throws Exception &#123; return super.authenticationManagerBean(); &#125; @Override protected void configure(HttpSecurity http) throws Exception &#123; http //ç”±äºæ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œæ‰€ä»¥è¦å…³é—­csrf .csrf().disable() //ç”±äºæ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œæ‰€ä»¥sessionæ˜¯å¤±æ•ˆçš„ï¼Œæˆ‘ä»¬å°±ä¸é€šè¿‡Sessionè·å–SecurityContext .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS) .and() //æŒ‡å®šè®©spring securityæ”¾è¡Œç™»å½•æ¥å£çš„è§„åˆ™ .authorizeRequests() // å¯¹äºç™»å½•æ¥å£ anonymousè¡¨ç¤ºå…è®¸åŒ¿åè®¿é—® .antMatchers(\"/user/login\").anonymous() // é™¤ä¸Šé¢å¤–çš„æ‰€æœ‰è¯·æ±‚å…¨éƒ¨éœ€è¦é‰´æƒè®¤è¯ .anyRequest().authenticated(); //---------------------------è®¤è¯è¿‡æ»¤å™¨çš„å®ç°---------------------------------- //æŠŠtokenæ ¡éªŒè¿‡æ»¤å™¨æ·»åŠ åˆ°è¿‡æ»¤å™¨é“¾ä¸­ //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸Šé¢æ³¨å…¥çš„æˆ‘ä»¬åœ¨filterç›®å½•å†™å¥½çš„ç±»ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºä½ æƒ³æ·»åŠ åˆ°å“ªä¸ªè¿‡æ»¤å™¨ä¹‹å‰ http.addFilterBefore(jwtAuthenticationTokenFilter, UsernamePasswordAuthenticationFilter.class); //---------------------------å¼‚å¸¸å¤„ç†çš„ç›¸å…³é…ç½®------------------------------- http.exceptionHandling() //é…ç½®è®¤è¯å¤±è´¥çš„å¤„ç†å™¨ .authenticationEntryPoint(authenticationEntryPoint) //é…ç½®æˆæƒå¤±è´¥çš„å¤„ç†å™¨ .accessDeniedHandler(accessDeniedHandler); &#125; &#125; ç¬¬å…­æ­¥: æµ‹è¯•è®¤è¯å¼‚å¸¸ã€‚æ‰“å¼€ä½ çš„postmanï¼Œå‘é€å¦‚ä¸‹çš„POSTè¯·æ±‚ï¼Œä½œç”¨æ˜¯ç™»å½•ä¸€ä¸ªä¸å­˜åœ¨çš„ç”¨æˆ·ï¼Œæ¨¡æ‹Ÿè®¤è¯å¼‚å¸¸ ç¬¬ä¸ƒæ­¥: æµ‹è¯•æˆæƒå¼‚å¸¸ã€‚å…ˆåœ¨HelloControllerç±»ä¿®æ”¹PreAuthorizeæ³¨è§£çš„æƒé™å­—ç¬¦ä¸²ï¼Œä¿®æ”¹æˆhuanfç”¨æˆ·ä¸å­˜åœ¨çš„æƒé™å­—ç¬¦ä¸²ï¼Œæ¥ç€é‡æ–°è¿è¡ŒTokenApplicationå¼•å¯¼ç±»ï¼Œç„¶åå»æ­£å¸¸ç™»å½•ä¸€ä¸ªç”¨æˆ·å¹¶è®¿é—® &#x2F;hello ä¸šåŠ¡æ¥å£ï¼Œå¿…ç„¶ä¼šæŠ¥æƒé™å¼‚å¸¸ï¼Œç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹å“åº”å›æ¥çš„æ•°æ®æ ¼å¼ï¼Œæ˜¯ä¸æ˜¯æˆ‘ä»¬å®šä¹‰çš„jsonæ ¼å¼ è·¨åŸŸè·¨åŸŸçš„åç«¯è§£å†³ç”±äºæˆ‘ä»¬çš„SpringSecurityè´Ÿè´£æ‰€æœ‰è¯·æ±‚å’Œèµ„æºçš„ç®¡ç†ï¼Œå½“è¯·æ±‚ç»è¿‡SpringSecurityæ—¶ï¼Œå¦‚æœSpringSecurityä¸å…è®¸è·¨åŸŸï¼Œé‚£ä¹ˆä¹Ÿæ˜¯ä¼šè¢«æ‹¦æˆªï¼Œæ‰€ä»¥ä¸‹é¢æˆ‘ä»¬å°†å­¦ä¹ å¹¶è§£å†³è·¨åŸŸé—®é¢˜ã€‚å‰é¢æˆ‘ä»¬åœ¨æµ‹è¯•æ—¶ï¼Œæ˜¯åœ¨postmanæµ‹è¯•ï¼Œå› æ­¤æ²¡æœ‰å‡ºç°è·¨åŸŸé—®é¢˜çš„æƒ…å†µï¼Œpostmanåªæ˜¯è´Ÿè´£å‘è¯·æ±‚è·Ÿæµè§ˆå™¨æ²¡å…³ç³» æµè§ˆå™¨å‡ºäºå®‰å…¨çš„è€ƒè™‘ï¼Œä½¿ç”¨ XMLHttpRequest å¯¹è±¡å‘èµ·HTTPè¯·æ±‚æ—¶å¿…é¡»éµå®ˆåŒæºç­–ç•¥ï¼Œå¦åˆ™å°±æ˜¯è·¨åŸŸçš„HTTPè¯·æ±‚ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯è¢«ç¦æ­¢çš„ã€‚ åŒæºç­–ç•¥è¦æ±‚æºç›¸åŒæ‰èƒ½æ­£å¸¸è¿›è¡Œé€šä¿¡ï¼Œå³åè®®ã€åŸŸåã€ç«¯å£å·éƒ½å®Œå…¨ä¸€è‡´ã€‚ å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œå‰ç«¯é¡¹ç›®å’Œåç«¯é¡¹ç›®ä¸€èˆ¬éƒ½ä¸æ˜¯åŒæºçš„ï¼Œæ‰€ä»¥è‚¯å®šä¼šå­˜åœ¨è·¨åŸŸè¯·æ±‚çš„é—®é¢˜ æˆ‘ä»¬è¦å®ç°å¦‚ä¸‹ä¸¤ä¸ªéœ€æ±‚ (æˆ‘å®é™…åšå‡ºçš„æ•ˆæœè·Ÿæ•™ç¨‹è§†é¢‘ä¸ä¸€è‡´ï¼Œç¬¬äºŒä¸ªéœ€æ±‚å…¶å®æ²¡å¿…è¦å­˜åœ¨ï¼Œbootè§£å†³äº†è·¨åŸŸå°±éƒ½è§£å†³äº†): 1ã€å¼€å¯SpringBootçš„å…è®¸è·¨åŸŸè®¿é—® 2ã€å¼€å¯SpringSecurityçš„å…è®¸è·¨åŸŸè®¿é—® ç¬¬ä¸€æ­¥: å¼€å¯SpringBootçš„å…è®¸è·¨åŸŸè®¿é—®ã€‚åœ¨ config ç›®å½•æ–°å»º CorsConfig ç±»ï¼Œå†™å…¥å¦‚ä¸‹ @Configuration public class CorsConfig implements WebMvcConfigurer &#123; @Override //é‡å†™springæä¾›çš„WebMvcConfigureræ¥å£çš„addCorsMappingsæ–¹æ³• public void addCorsMappings(CorsRegistry registry) &#123; // è®¾ç½®å…è®¸è·¨åŸŸçš„è·¯å¾„ registry.addMapping(\"/**\") // è®¾ç½®å…è®¸è·¨åŸŸè¯·æ±‚çš„åŸŸå .allowedOriginPatterns(\"*\") // æ˜¯å¦å…è®¸cookie .allowCredentials(true) // è®¾ç½®å…è®¸çš„è¯·æ±‚æ–¹å¼ .allowedMethods(\"GET\", \"POST\", \"DELETE\", \"PUT\") // è®¾ç½®å…è®¸çš„headerå±æ€§ .allowedHeaders(\"*\") // è·¨åŸŸå…è®¸æ—¶é—´ .maxAge(3600); &#125; &#125; ç¬¬äºŒæ­¥: å¼€å¯SpringSecurityçš„å…è®¸è·¨åŸŸè®¿é—®ã€‚åœ¨æŠŠ SecurityConfig ä¿®æ”¹ä¸ºå¦‚ä¸‹ã€‚ protected void configure(HttpSecurity http) throws Exception &#123; ... //--------------------------- è®¾ç½®securityè¿è¡Œè·¨åŸŸè®¿é—® ------------------ http.cors(); &#125; ç¬¬ä¸‰æ­¥: ç”±äºæ²¡æœ‰å‰ç«¯é¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸‹é¢ä¼šè·‘ä¸€ä¸ªå‰ç«¯é¡¹ç›®ï¼Œç„¶åæµ‹è¯•åç«¯çš„è·¨åŸŸåŠŸèƒ½ ç¬¬å››æ­¥: è¿è¡Œå‰ç«¯é¡¹ç›®ã€‚è¯·ç¡®ä¿ä½ ç”µè„‘æœ‰å®‰è£…node.jsï¼Œç„¶åä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€å‘½ä»¤è¡Œçª—å£ï¼Œè¾“å…¥å¦‚ä¸‹ npm install npm run serve ç¬¬äº”æ­¥: è®¿é—®å‰ç«¯çš„é¡¹ç›® http:&#x2F;&#x2F;localhost:8080&#x2F;#&#x2F;login ç¬¬å…­æ­¥: ç”±äºè¿™ä¸ªå‰ç«¯é¡¹ç›®çš„è¦æ±‚åç«¯æœåŠ¡çš„ç«¯å£æ˜¯8888ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¿®æ”¹ä¸€ä¸‹ideaçš„application.ymlæ–‡ä»¶ï¼ŒæŠŠé»˜è®¤çš„8089ç«¯å£æ”¹ä¸º8888ç«¯å£,ä¸ºäº†ç­‰ä¸‹ç›´è§‚çš„çœ‹å‡ºè·¨åŸŸçš„é—®é¢˜ï¼Œæˆ‘ä»¬æŠŠåç«¯çš„ bootä¸securityçš„è·¨åŸŸä»£ç æ³¨é‡Šæ‰ server: # æŒ‡å®šåç«¯çš„å¯åŠ¨ç«¯å£ port: 8888 ç¬¬ä¸ƒæ­¥: æµ‹è¯•ã€‚è®¿é—®å‰ç«¯é¡¹ç›®ï¼Œç™»å½•ä¸€ä¸ªæ•°æ®åº“çš„çœŸå®ç”¨æˆ·ï¼Œå‡çš„ä¹Ÿè¡Œï¼Œä¸»è¦æ˜¯çœ‹è¯·æ±‚ä¼šä¸ä¼šå‡ºç°è·¨åŸŸé—®é¢˜ ç¬¬å…«æ­¥: æˆ‘åæ¥å‘¢ï¼ŒæŠŠsecurityçš„è·¨åŸŸå•ç‹¬æ³¨é‡Šäº†ï¼Œç„¶åé‡æ–°è¿è¡Œå¼•å¯¼ç±»ï¼Œæƒ³éªŒè¯æ˜¯ä¸æ˜¯åªè¦securityä¸å…è®¸è·¨åŸŸï¼Œé‚£ä¹ˆå³ä½¿bootå…è®¸è·¨åŸŸï¼Œé‚£æœ€ç»ˆä¹Ÿæ˜¯ä¸å…è®¸è·¨åŸŸçš„ï¼ŒåŸå› æ˜¯èµ„æºå¿…ç„¶è¦ç»è¿‡securityã€‚ä½†æ˜¯å®éªŒç»“æœå´æ˜¯securityæ³¨é‡Šäº†ä¹‹åï¼Œä»…é bootçš„è·¨åŸŸæ”¾è¡Œï¼Œå‰ç«¯ç«Ÿç„¶ä¹Ÿèƒ½æ­£å¸¸è®¿é—®åç«¯æ¥å£ æˆæƒ-æƒé™æ ¡éªŒçš„æ–¹æ³•ä¸Šé¢å­¦çš„æ˜¯HelloControllerç±»çš„ @PreAuthorizeæ³¨è§£ çš„ä¸‰ä¸ªæ–¹æ³• æˆ‘ä»¬å‰é¢éƒ½æ˜¯ä½¿ç”¨@PreAuthorizeæ³¨è§£ï¼Œç„¶ååœ¨åœ¨å…¶ä¸­ä½¿ç”¨çš„æ˜¯hasAuthorityæ–¹æ³•è¿›è¡Œæ ¡éªŒã€‚SpringSecurityè¿˜ä¸ºæˆ‘ä»¬æä¾›äº†å…¶å®ƒæ–¹æ³•ä¾‹å¦‚: hasAnyAuthorityï¼ŒhasRoleï¼ŒhasAnyRoleç­‰ 1. hasAuthorityæ–¹æ³•æˆ‘ä»¬æœ€æ—©ä½¿ç”¨@PreAuthorizeæ³¨è§£æ˜¯åœ¨å‰é¢ç¬”è®°çš„ â€˜æˆæƒâ€™ çš„è‡ªå®šä¹‰è®¿é—®è·¯å¾„çš„æƒé™ã€‚å¯ä»¥å›å»çœ‹çœ‹ï¼Œå½“æ—¶å¹¶æ²¡æœ‰è¯¦ç»†å­¦ä¹ @PreAuthorizeæ³¨è§£çš„hasAuthorityæ–¹æ³•ï¼Œåªæ˜¯ç›´æ¥ä½¿ç”¨ï¼Œæˆ‘ä»¬ä¸‹é¢å°±æ¥å­¦ä¹ ä¸€ä¸‹hasAuthorityæ–¹æ³•çš„åŸç†ï¼Œç„¶åå†å­¦ä¹ hasAnyAuthorityã€hasRoleã€hasAnyRoleæ–¹æ³•å°±å®¹æ˜“ç†è§£äº† hasAuthorityæ–¹æ³•: æ‰§è¡Œåˆ°äº†SecurityExpressionRootçš„hasAuthorityï¼Œå†…éƒ¨å…¶å®æ˜¯è°ƒç”¨authenticationçš„getAuthoritiesæ–¹æ³•è·å–ç”¨æˆ·çš„æƒé™åˆ—è¡¨ã€‚ç„¶ååˆ¤æ–­æˆ‘ä»¬å­˜å…¥çš„æ–¹æ³•å‚æ•°æ•°æ®åœ¨æƒé™åˆ—è¡¨ä¸­ã€‚hasAnyAuthorityæ–¹æ³•å¯ä»¥ä¼ å…¥å¤šä¸ªæƒé™ï¼Œåªæœ‰ç”¨æˆ·æœ‰å…¶ä¸­ä»»æ„ä¸€ä¸ªæƒé™éƒ½å¯ä»¥è®¿é—®å¯¹åº”èµ„æº hasAuthorityæ–¹æ³•çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹å›¾ï¼Œå›¾æ¯”è¾ƒå¤šï¼Œè¯·ä»ä¸Šå¾€ä¸‹æŸ¥çœ‹ 2. hasAnyAuthorityæ–¹æ³•hasAnyAuthorityæ–¹æ³•çš„æ‰§è¡Œæµç¨‹è·Ÿä¸Šé¢çš„hasAuthorityæ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¼ å‚ä¸åŒã€‚æ‰€ä»¥é‡ç‚¹æ¼”ç¤ºä¼ å‚ï¼Œæ‰§è¡Œæµç¨‹æ˜¯çœŸçš„ä¸€æ¨¡ä¸€æ ·ï¼ŒæŠŠä¸Šé¢çš„hasAuthorityæ–¹æ³•çš„æ‰§è¡Œæµç¨‹è®¤çœŸçœ‹ä¸€æ¬¡å°±è¡Œäº†ã€‚hasAuthorityæ–¹æ³•åªèƒ½ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæƒé™å­—ç¬¦ä¸²ã€‚hasAnyAuthorityæ–¹æ³•å¯ä»¥ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªæƒé™å­—ç¬¦ä¸²ï¼Œåªè¦ç”¨æˆ·å…·æœ‰å…¶ä¸­ä»»æ„ä¸€ä¸ªæƒé™å°±èƒ½è®¿é—®æŒ‡å®šä¸šåŠ¡æ¥å£ ç¬¬ä¸€æ­¥: ä¸ºæ–¹ä¾¿æ¼”ç¤ºhasAnyAuthorityæ–¹æ³•èƒ½å¤Ÿä¼ å…¥å¤šä¸ªå‚æ•°å¹¶çœ‹åˆ°æœ€ç»ˆæ•ˆæœï¼Œæˆ‘ä»¬æŠŠHelloControllerç±»çš„@RequestMappingæ³¨è§£ä¿®æ”¹ä¸ºå¦‚ä¸‹ @PreAuthorize(&quot;hasAnyAuthority(&#39;zidingyi&#39;,&#39;huanf&#39;,&#39;system:dept:list&#39;)&quot;); &#x2F;&#x2F;ä¼ å…¥3ä¸ªè‡ªå®šä¹‰æƒé™ ç¬¬äºŒæ­¥: è¿è¡Œå¼•å¯¼ç±»ï¼Œæ‰“å¼€postmanï¼Œå‘é€ç™»å½•è¯·æ±‚ï¼Œç„¶åå‘é€è®¿é—®&#x2F;helloæ¥å£çš„è¯·æ±‚ 3. hasRoleæ–¹æ³•é¦–å…ˆæ˜¯æ‰§è¡Œæµç¨‹ï¼Œå¦‚ä¸‹å‡ å¼ å›¾ï¼Œä»ä¸Šå¾€ä¸‹çœ‹ï¼Œå¾ˆç²¾åæ²¡æœ‰å°¿ç‚¹ ä¸‹å›¾æ˜¯æ‰“æ–­ç‚¹åçš„æµ‹è¯•å›¾ ç„¶åæ˜¯æµ‹è¯•çš„æ“ä½œï¼Œå¦‚ä¸‹ ç¬¬ä¸€æ­¥: ä¸ºæ–¹ä¾¿æ¼”ç¤ºhasAnyAuthorityæ–¹æ³•èƒ½å¤Ÿä¼ å…¥å¤šä¸ªå‚æ•°å¹¶çœ‹åˆ°æœ€ç»ˆæ•ˆæœï¼Œæˆ‘ä»¬æŠŠHelloControllerç±»çš„@RequestMappingæ³¨è§£ä¿®æ”¹ä¸ºå¦‚ä¸‹ @PreAuthorize(\"hasRole('system:dept:list')\") //åªèƒ½ä¼ ä¸€ä¸ªæƒé™å­—ç¬¦ä¸²ï¼Œå¤šä¼ ä¼šæŠ¥çº¢çº¿ ç¬¬äºŒæ­¥: è¿è¡Œå¼•å¯¼ç±»ï¼Œæ‰“å¼€postmanè½¯ä»¶ï¼Œå‘é€ç™»å½•è¯·æ±‚ï¼Œç„¶åå‘é€è®¿é—®&#x2F;helloæ¥å£çš„è¯·æ±‚ 4. hasAnyRoleæ–¹æ³•æ‰§è¡Œæµç¨‹è·Ÿåˆšåˆšçš„hasRoleæ–¹æ³•æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œåªæ˜¯ä¼ å‚ä¸åŒã€‚æŠŠä¸Šé¢çš„hasRoleæ–¹æ³•çš„æ‰§è¡Œæµç¨‹è®¤çœŸçœ‹ä¸€æ¬¡å°±è¡Œäº†ã€‚hasRoleæ–¹æ³•åªèƒ½ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæƒé™å­—ç¬¦ä¸²ã€‚hasAnyRoleæ–¹æ³•å¯ä»¥ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªæƒé™å­—ç¬¦ä¸²ï¼Œåªè¦ç”¨æˆ·å…·æœ‰å…¶ä¸­ä»»æ„ä¸€ä¸ªæƒé™å°±èƒ½è®¿é—®æŒ‡å®šä¸šåŠ¡æ¥å£ ç¬¬ä¸€æ­¥: ä¸ºæ–¹ä¾¿æ¼”ç¤ºhasAnyAuthorityæ–¹æ³•èƒ½å¤Ÿä¼ å…¥å¤šä¸ªå‚æ•°å¹¶çœ‹åˆ°æœ€ç»ˆæ•ˆæœï¼Œæˆ‘ä»¬æŠŠHelloControllerç±»çš„@RequestMappingæ³¨è§£ä¿®æ”¹ä¸ºå¦‚ä¸‹ @PreAuthorize(\"hasAnyRole('zidingyi','huanf','system:dept:list')\") ç¬¬äºŒæ­¥: è¿è¡Œå¼•å¯¼ç±»ï¼Œæ‰“å¼€postmanè½¯ä»¶ï¼Œå‘é€ç™»å½•è¯·æ±‚ï¼Œç„¶åå‘é€è®¿é—®&#x2F;helloæ¥å£çš„è¯·æ±‚ 5.è‡ªå®šä¹‰æƒé™æ ¡éªŒçš„æ–¹æ³•åœ¨ä¸Šé¢çš„æºç ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“securityæ ¡éªŒæƒé™çš„PreAuthorizeæ³¨è§£ï¼Œå…¶å®å°±æ˜¯è·å–ç”¨æˆ·æƒé™ï¼Œç„¶åè·Ÿä¸šåŠ¡æ¥å£çš„æƒé™è¿›è¡Œæ¯”è¾ƒï¼Œæœ€åè¿”å›ä¸€ä¸ªå¸ƒå°”ç±»å‹ã€‚è‡ªå®šä¹‰ä¸€ä¸ªæƒé™æ ¡éªŒæ–¹æ³•çš„è¯ï¼Œå°±éœ€è¦æ–°å»ºä¸€ä¸ªç±»ï¼Œåœ¨ç±»é‡Œé¢å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼ŒæŒ‰ç…§å‰é¢å­¦ä¹ çš„ä¸‰ç§æ–¹æ³•çš„å®šä¹‰æ ¼å¼ï¼Œç„¶åè¿”å›å€¼æ˜¯å¸ƒå°”ç±»å‹ã€‚å¦‚ä¸‹ ç¬¬ä¸€æ­¥: åœ¨ src&#x2F;main&#x2F;java&#x2F;com.ehzyilç›®å½•æ–°å»º expression.HuanfExpressionRoot ç±»ï¼Œå†™å…¥å¦‚ä¸‹ @Component(&quot;huanfEX&quot;) &#x2F;&#x2F;è‡ªå®šä¹‰æƒé™æ ¡éªŒçš„æ–¹æ³• public class ExpressionRoot &#123; &#x2F;&#x2F;è‡ªå®šä¹‰æƒé™æ ¡éªŒçš„æ–¹æ³• public boolean huanfHasAuthority(String authority) &#123; &#x2F;&#x2F;è·å–ç”¨æˆ·å…·æœ‰çš„æƒé™å­—ç¬¦ä¸²ï¼Œæœ‰å¯èƒ½ç”¨æˆ·å…·æœ‰å¤šä¸ªæƒé™å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è·å–åæ˜¯ä¸€ä¸ªé›†åˆ Authentication authentication &#x3D; SecurityContextHolder.getContext().getAuthentication(); &#x2F;&#x2F;LoginUseræ˜¯æˆ‘ä»¬åœ¨domainç›®å½•å†™å¥½çš„å®ä½“ç±» LoginUser loginUser &#x3D; (LoginUser) authentication.getPrincipal(); List&lt;String&gt; permissions &#x3D; loginUser.getPermissions(); &#x2F;&#x2F;åˆ¤æ–­ç”¨æˆ·æƒé™é›†åˆä¸­ï¼Œæ˜¯å¦å­˜åœ¨è·Ÿä¸šåŠ¡æ¥å£(ä¸šåŠ¡æ¥å£çš„æƒé™å­—ç¬¦ä¸²ä¼šä½œä¸ºauthorityå½¢å‚ä¼ è¿›æ¥)ä¸€æ ·çš„æƒé™ return permissions.contains(authority); &#125; &#125; ç¬¬äºŒæ­¥: åˆšåˆšåœ¨ç¬¬ä¸€æ­¥è‡ªå®šä¹‰äº†huanfHasAuthorityæ–¹æ³•ï¼Œç”¨äºæƒé™æ ¡éªŒï¼Œé‚£ä¹ˆå¦‚ä½•è®© @PreAuthorize æ³¨è§£å»ä½¿ç”¨huanfHasAuthorityæ–¹æ³•ï¼Œåªéœ€è¦åœ¨SPELè¡¨è¾¾å¼æ¥è·å–å®¹å™¨ä¸­beançš„åå­—ã€‚ä¿®æ”¹HelloControllerç±»ä¸ºå¦‚ä¸‹ @RestController public class HelloController &#123; @GetMapping(\"/hello\") //å®˜æ–¹æä¾›çš„4ä¸ªæƒé™æ ¡éªŒçš„æ–¹æ³• //@PreAuthorize(\"hasAuthority('system:dept:list')\") //@PreAuthorize(\"hasAnyAuthority('zidingyi','huanf','system:dept:list')\") //@PreAuthorize(\"hasRole('system:dept:list')\") //@PreAuthorize(\"hasAnyRole('zidingyi','huanf','system:dept:list')\") //è‡ªå®šä¹‰æƒé™æ ¡éªŒçš„æ–¹æ³•ï¼ŒhuanfHasAuthority @PreAuthorize(\"@huanfEX.huanfHasAuthority('system:dept:list')\") public String hello() &#123; return \"æ¬¢è¿ï¼Œå¼€å§‹ä½ æ–°çš„å­¦ä¹ æ—…ç¨‹å§\"; &#125; @PreAuthorize(\"hasAuthority('test')\") @GetMapping(\"/test\") public String hello2() &#123; return \"hasAuthority('test')\"; &#125; &#125; ä½¿ç”¨SPELè¡¨è¾¾å¼ï¼ŒæŒ‡å®š@PreAuthorizeæ³¨è§£ä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„huanfHasAuthorityæ–¹æ³• ç¬¬ä¸‰æ­¥: è¿è¡Œå¼•å¯¼ç±»ï¼Œæ‰“å¼€postmanè½¯ä»¶ï¼Œå‘é€ç™»å½•è¯·æ±‚ï¼Œç„¶åå‘é€è®¿é—®&#x2F;helloæ¥å£çš„è¯·æ±‚ 6.åŸºäºé…ç½®çš„æƒé™æ§åˆ¶å‰é¢å­¦ä¹ çš„æƒé™æ§åˆ¶æ˜¯åŸºäº@PreAuthorizeæ³¨è§£æ¥å®Œæˆçš„ï¼Œå¦‚ä½•ä½¿ç”¨é…ç½®çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯åœ¨é…ç½®ç±»å½“ä¸­ï¼Œæ¥å®ç°æƒé™æ§åˆ¶ï¼Œå¦‚ä¸‹ ç¬¬ä¸€æ­¥: åœ¨HelloControllerç±»æ·»åŠ å¦‚ä¸‹ï¼Œä½œç”¨æ˜¯æ–°å¢ä¸€ä¸ªæ¥å£ &#x2F;&#x2F;åŸºäºé…ç½®çš„æƒé™æ§åˆ¶ @RequestMapping(&quot;&#x2F;configAuth&quot;) public ResponseResult xx()&#123; return new ResponseResult(200,&quot;è®¿é—®æˆåŠŸ&quot;); &#125; ç¬¬äºŒæ­¥: æŠŠSecurityConfigç±»ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œä¸»è¦å°±æ˜¯æ·»åŠ æƒé™æ§åˆ¶ç›¸å…³çš„é…ç½® @Override protected void configure(HttpSecurity http) throws Exception &#123; http //ç”±äºæ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œæ‰€ä»¥è¦å…³é—­csrf .csrf().disable() //ç”±äºæ˜¯å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œæ‰€ä»¥sessionæ˜¯å¤±æ•ˆçš„ï¼Œæˆ‘ä»¬å°±ä¸é€šè¿‡Sessionè·å–SecurityContext .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS) .and() //æŒ‡å®šè®©spring securityæ”¾è¡Œç™»å½•æ¥å£çš„è§„åˆ™ .authorizeRequests() // å¯¹äºç™»å½•æ¥å£ anonymousè¡¨ç¤ºå…è®¸åŒ¿åè®¿é—® .antMatchers(\"/user/login\").anonymous() //åŸºäºé…ç½®çš„çš„æƒé™æ§åˆ¶ã€‚æŒ‡å®šæ¥å£çš„åœ°å€ï¼Œä¸ºHelloControllerç±»é‡Œé¢çš„/configAuthæ¥å£ï¼ŒæŒ‡å®šæƒé™ä¸ºsystem:dept:list .antMatchers(\"/configAuth\").hasAuthority(\"system:dept:list\") //ä¸Šä¸€è¡Œçš„hasAuthorityæ–¹æ³•å°±æ˜¯securityå®˜æ–¹æä¾›çš„4ç§æƒé™æ§åˆ¶çš„æ–¹æ³•ä¹‹ä¸€ // é™¤ä¸Šé¢å¤–çš„æ‰€æœ‰è¯·æ±‚å…¨éƒ¨éœ€è¦é‰´æƒè®¤è¯ .anyRequest().authenticated(); //---------------------------è®¤è¯è¿‡æ»¤å™¨çš„å®ç°---------------------------------- //æŠŠtokenæ ¡éªŒè¿‡æ»¤å™¨æ·»åŠ åˆ°è¿‡æ»¤å™¨é“¾ä¸­ //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸Šé¢æ³¨å…¥çš„æˆ‘ä»¬åœ¨filterç›®å½•å†™å¥½çš„ç±»ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºä½ æƒ³æ·»åŠ åˆ°å“ªä¸ªè¿‡æ»¤å™¨ä¹‹å‰ http.addFilterBefore(jwtAuthenticationTokenFilter, UsernamePasswordAuthenticationFilter.class); //---------------------------å¼‚å¸¸å¤„ç†çš„ç›¸å…³é…ç½®------------------------------- http.exceptionHandling() //é…ç½®è®¤è¯å¤±è´¥çš„å¤„ç†å™¨ .authenticationEntryPoint(authenticationEntryPoint) //é…ç½®æˆæƒå¤±è´¥çš„å¤„ç†å™¨ .accessDeniedHandler(accessDeniedHandler); //---------------------------ğŸ‘‡ è®¾ç½®securityè¿è¡Œè·¨åŸŸè®¿é—® ğŸ‘‡------------------ http.cors(); &#125; ç¬¬ä¸‰æ­¥: è¿è¡Œå¼•å¯¼ç±»ï¼Œæ‰“å¼€postmanè½¯ä»¶ï¼Œå‘é€ç™»å½•è¯·æ±‚ï¼Œç„¶åå‘é€è®¿é—®&#x2F;configAuthæ¥å£çš„è¯·æ±‚ é˜²æŠ¤CSRFæ”»å‡»åœ¨SecurityConfigç±»é‡Œé¢çš„configureæ–¹æ³•é‡Œé¢ï¼Œæœ‰ä¸€ä¸ªé…ç½®å¦‚ä¸‹ï¼Œæˆ‘ä»¬ä¸Šé¢éƒ½æ²¡æœ‰å»å­¦ä¹ ï¼Œä¸‹é¢å°±æ¥äº†è§£ä¸€ä¸‹ http..csrf().disable(); //å…³é—­csrfï¼Œå¯é˜²æŠ¤csrfæ”»å‡»ã€‚å¦‚æœä¸å…³é—­çš„è¯ CSRFæ˜¯æŒ‡è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCross-site request forgeryï¼‰ï¼Œæ˜¯webå¸¸è§çš„æ”»å‡»ä¹‹ä¸€ï¼Œå¦‚å›¾ è¯¦ç»†çœ‹è¿™ç¯‡åšå®¢: https://blog.csdn.net/freeking101/article/details/86537087 é˜²æŠ¤: SpringSecurityå»é˜²æ­¢CSRFæ”»å‡»çš„æ–¹å¼å°±æ˜¯é€šè¿‡csrf_tokenã€‚åç«¯ä¼šç”Ÿæˆä¸€ä¸ªcsrf_tokenï¼Œå‰ç«¯å‘èµ·è¯·æ±‚çš„æ—¶å€™éœ€è¦æºå¸¦è¿™ä¸ªcsrf_token,åç«¯ä¼šæœ‰è¿‡æ»¤å™¨è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœæ²¡æœ‰æºå¸¦æˆ–è€…æ˜¯ä¼ªé€ çš„å°±ä¸å…è®¸è®¿é—® æˆ‘ä»¬å¯ä»¥å‘ç°CSRFæ”»å‡»ä¾é çš„æ˜¯cookieä¸­æ‰€æºå¸¦çš„è®¤è¯ä¿¡æ¯ã€‚ä½†æ˜¯åœ¨å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ä¸­æˆ‘ä»¬çš„è®¤è¯ä¿¡æ¯å…¶å®æ˜¯tokenï¼Œè€Œtokenå¹¶ä¸æ˜¯å­˜å‚¨ä¸­cookieä¸­ï¼Œå¹¶ä¸”éœ€è¦å‰ç«¯ä»£ç å»æŠŠtokenè®¾ç½®åˆ°è¯·æ±‚å¤´ä¸­æ‰å¯ä»¥ï¼Œæ‰€ä»¥CSRFæ”»å‡»ä¹Ÿå°±ä¸ç”¨æ‹…å¿ƒäº†ï¼Œå‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œåœ¨é…ç½®ç±»å…³é—­csrfå°±èƒ½é˜²èŒƒcsrfæ”»å‡» å‚è€ƒï¼šhttps://www.yuque.com/huanfqc/springsecurity/springsecurity","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Spring Security","slug":"Spring-Security","permalink":"https://blog.ehzyil.xyz/tags/Spring-Security/"}],"author":"ehzyil"},{"title":"Dockerçš„é…ç½®ä¸è½¯ä»¶å®‰è£…","slug":"2023/Dockerçš„é…ç½®ä¸è½¯ä»¶å®‰è£…","date":"2023-07-05T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/07/05/2023/Dockerçš„é…ç½®ä¸è½¯ä»¶å®‰è£…/","link":"","permalink":"https://blog.ehzyil.xyz/2023/07/05/2023/Docker%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8E%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/","excerpt":"","text":"1.CentOSå®‰è£…DockerDocker åˆ†ä¸º CE å’Œ EE ä¸¤å¤§ç‰ˆæœ¬ã€‚CE å³ç¤¾åŒºç‰ˆï¼ˆå…è´¹ï¼Œæ”¯æŒå‘¨æœŸ 7 ä¸ªæœˆï¼‰ï¼ŒEE å³ä¼ä¸šç‰ˆï¼Œå¼ºè°ƒå®‰å…¨ï¼Œä»˜è´¹ä½¿ç”¨ï¼Œæ”¯æŒå‘¨æœŸ 24 ä¸ªæœˆã€‚ Docker CE åˆ†ä¸º stable test å’Œ nightly ä¸‰ä¸ªæ›´æ–°é¢‘é“ã€‚ å®˜æ–¹ç½‘ç«™ä¸Šæœ‰å„ç§ç¯å¢ƒä¸‹çš„ å®‰è£…æŒ‡å—ï¼Œè¿™é‡Œä¸»è¦ä»‹ç» Docker CE åœ¨ CentOSä¸Šçš„å®‰è£…ã€‚ Docker CE æ”¯æŒ 64 ä½ç‰ˆæœ¬ CentOS 7ï¼Œå¹¶ä¸”è¦æ±‚å†…æ ¸ç‰ˆæœ¬ä¸ä½äº 3.10ï¼Œ CentOS 7 æ»¡è¶³æœ€ä½å†…æ ¸çš„è¦æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨CentOS 7å®‰è£…Dockerã€‚ 1.1.å¸è½½ï¼ˆå¯é€‰ï¼‰å¦‚æœä¹‹å‰å®‰è£…è¿‡æ—§ç‰ˆæœ¬çš„Dockerï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤å¸è½½ï¼š yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-selinux \\ docker-engine-selinux \\ docker-engine \\ docker-ce 1.2.å®‰è£…dockeré¦–å…ˆéœ€è¦å¤§å®¶è™šæ‹Ÿæœºè”ç½‘ï¼Œå®‰è£…yumå·¥å…· yum install -y yum-utils \\ device-mapper-persistent-data \\ lvm2 --skip-broken ç„¶åæ›´æ–°æœ¬åœ°é•œåƒæºï¼š # è®¾ç½®dockeré•œåƒæº yum-config-manager \\ --add-repo \\ https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo sed -i 's/download.docker.com/mirrors.aliyun.com\\/docker-ce/g' /etc/yum.repos.d/docker-ce.repo yum makecache fast ç„¶åè¾“å…¥å‘½ä»¤ï¼š yum install -y docker-ce docker-ceä¸ºç¤¾åŒºå…è´¹ç‰ˆæœ¬ã€‚ç¨ç­‰ç‰‡åˆ»ï¼Œdockerå³å¯å®‰è£…æˆåŠŸã€‚ 1.3.å¯åŠ¨dockerDockeråº”ç”¨éœ€è¦ç”¨åˆ°å„ç§ç«¯å£ï¼Œé€ä¸€å»ä¿®æ”¹é˜²ç«å¢™è®¾ç½®ã€‚éå¸¸éº»çƒ¦ï¼Œå› æ­¤å»ºè®®å¤§å®¶ç›´æ¥å…³é—­é˜²ç«å¢™ï¼ å¯åŠ¨dockerå‰ï¼Œä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼ï¼ å¯åŠ¨dockerå‰ï¼Œä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼ï¼ å¯åŠ¨dockerå‰ï¼Œä¸€å®šè¦å…³é—­é˜²ç«å¢™åï¼ï¼ # å…³é—­ systemctl stop firewalld # ç¦æ­¢å¼€æœºå¯åŠ¨é˜²ç«å¢™ systemctl disable firewalld é€šè¿‡å‘½ä»¤å¯åŠ¨dockerï¼š systemctl start docker # å¯åŠ¨dockeræœåŠ¡ systemctl stop docker # åœæ­¢dockeræœåŠ¡ systemctl restart docker # é‡å¯dockeræœåŠ¡ ç„¶åè¾“å…¥å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹dockerç‰ˆæœ¬ï¼š docker -v å¦‚å›¾ï¼š 1.4.é…ç½®é•œåƒåŠ é€Ÿdockerå®˜æ–¹é•œåƒä»“åº“ç½‘é€Ÿè¾ƒå·®ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®å›½å†…é•œåƒæœåŠ¡ï¼š å‚è€ƒé˜¿é‡Œäº‘çš„é•œåƒåŠ é€Ÿæ–‡æ¡£ï¼šhttps://cr.console.aliyun.com/cn-hangzhou/instances/mirrors é’ˆå¯¹Dockerå®¢æˆ·ç«¯ç‰ˆæœ¬å¤§äº 1.10.0 çš„ç”¨æˆ· æ‚¨å¯ä»¥é€šè¿‡ä¿®æ”¹daemoné…ç½®æ–‡ä»¶&#x2F;etc&#x2F;docker&#x2F;daemon.jsonæ¥ä½¿ç”¨åŠ é€Ÿå™¨ sudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF' &#123; \"registry-mirrors\": [\"https://d6kkx5k7.mirror.aliyuncs.com\"] &#125; EOF sudo systemctl daemon-reload sudo systemctl restart docker 2.CentOS7å®‰è£…DockerCompose2.1.ä¸‹è½½Linuxä¸‹éœ€è¦é€šè¿‡å‘½ä»¤ä¸‹è½½ï¼š # å®‰è£… curl -L https://github.com/docker/compose/releases/download/1.23.1/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose å¦‚æœä¸‹è½½é€Ÿåº¦è¾ƒæ…¢ï¼Œæˆ–è€…ä¸‹è½½å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨è¯¾å‰èµ„æ–™æä¾›çš„docker-composeæ–‡ä»¶ï¼š ä¸Šä¼ åˆ°/usr/local/bin/ç›®å½•ä¹Ÿå¯ä»¥ã€‚ 2.2.ä¿®æ”¹æ–‡ä»¶æƒé™ä¿®æ”¹æ–‡ä»¶æƒé™ï¼š # ä¿®æ”¹æƒé™ chmod +x /usr/local/bin/docker-compose 2.3.Baseè‡ªåŠ¨è¡¥å…¨å‘½ä»¤ï¼š# è¡¥å…¨å‘½ä»¤ curl -L https://raw.githubusercontent.com/docker/compose/1.29.1/contrib/completion/bash/docker-compose > /etc/bash_completion.d/docker-compose å¦‚æœè¿™é‡Œå‡ºç°é”™è¯¯ï¼Œéœ€è¦ä¿®æ”¹è‡ªå·±çš„hostsæ–‡ä»¶ï¼š echo \"199.232.68.133 raw.githubusercontent.com\" >> /etc/hosts 3.Dockeré•œåƒä»“åº“æ­å»ºé•œåƒä»“åº“å¯ä»¥åŸºäºDockerå®˜æ–¹æä¾›çš„DockerRegistryæ¥å®ç°ã€‚ å®˜ç½‘åœ°å€ï¼šhttps://hub.docker.com/_/registry 3.1.ç®€åŒ–ç‰ˆé•œåƒä»“åº“Dockerå®˜æ–¹çš„Docker Registryæ˜¯ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬çš„Dockeré•œåƒä»“åº“ï¼Œå…·å¤‡ä»“åº“ç®¡ç†çš„å®Œæ•´åŠŸèƒ½ï¼Œä½†æ˜¯æ²¡æœ‰å›¾å½¢åŒ–ç•Œé¢ã€‚ æ­å»ºæ–¹å¼æ¯”è¾ƒç®€å•ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š docker run -d \\ --restart=always \\ --name registry \\ -p 5000:5000 \\ -v registry-data:/var/lib/registry \\ registry å‘½ä»¤ä¸­æŒ‚è½½äº†ä¸€ä¸ªæ•°æ®å·registry-dataåˆ°å®¹å™¨å†…çš„&#x2F;var&#x2F;lib&#x2F;registry ç›®å½•ï¼Œè¿™æ˜¯ç§æœ‰é•œåƒåº“å­˜æ”¾æ•°æ®çš„ç›®å½•ã€‚ è®¿é—®http://YourIp:5000/v2/_catalog å¯ä»¥æŸ¥çœ‹å½“å‰ç§æœ‰é•œåƒæœåŠ¡ä¸­åŒ…å«çš„é•œåƒ 3.2.å¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ç‰ˆæœ¬ä½¿ç”¨DockerComposeéƒ¨ç½²å¸¦æœ‰å›¾è±¡ç•Œé¢çš„DockerRegistryï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š version: '3.0' services: registry: image: registry volumes: - ./registry-data:/var/lib/registry ui: image: joxit/docker-registry-ui:static ports: - 8080:80 environment: - REGISTRY_TITLE=ä¼ æ™ºæ•™è‚²ç§æœ‰ä»“åº“ - REGISTRY_URL=http://registry:5000 depends_on: - registry 3.3.é…ç½®Dockerä¿¡ä»»åœ°å€æˆ‘ä»¬çš„ç§æœé‡‡ç”¨çš„æ˜¯httpåè®®ï¼Œé»˜è®¤ä¸è¢«Dockerä¿¡ä»»ï¼Œæ‰€ä»¥éœ€è¦åšä¸€ä¸ªé…ç½®ï¼š # æ‰“å¼€è¦ä¿®æ”¹çš„æ–‡ä»¶ vi /etc/docker/daemon.json # æ·»åŠ å†…å®¹ï¼š \"insecure-registries\":[\"http://192.168.150.101:8080\"] # é‡åŠ è½½ systemctl daemon-reload # é‡å¯docker systemctl restart docker 4.dibianå®‰è£…æ›´æ–°ã€å®‰è£…å¿…å¤‡è½¯ä»¶ apt-get update &amp;&amp; apt-get install -y wget vim å®‰è£… wget -qO- get.docker.com | bash å¼€æœºè‡ªåŠ¨å¯åŠ¨ systemctl enable docker å¸è½½ sudo apt-get purge docker-ce docker-ce-cli containerd.io sudo rm -rf &#x2F;var&#x2F;lib&#x2F;docker sudo rm -rf &#x2F;var&#x2F;lib&#x2F;containerd 4.RabbitMQéƒ¨ç½²æŒ‡å—4.1.å•æœºéƒ¨ç½²æˆ‘ä»¬åœ¨Centos7è™šæ‹Ÿæœºä¸­ä½¿ç”¨Dockeræ¥å®‰è£…ã€‚ 4.1.1.ä¸‹è½½é•œåƒæ–¹å¼ä¸€ï¼šåœ¨çº¿æ‹‰å– docker pull rabbitmq:3-management æ–¹å¼äºŒï¼šä»æœ¬åœ°åŠ è½½ åœ¨è¯¾å‰èµ„æ–™å·²ç»æä¾›äº†é•œåƒåŒ…ï¼š ä¸Šä¼ åˆ°è™šæ‹Ÿæœºä¸­åï¼Œä½¿ç”¨å‘½ä»¤åŠ è½½é•œåƒå³å¯ï¼š docker load -i mq.tar 4.1.2.å®‰è£…MQæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥è¿è¡ŒMQå®¹å™¨ï¼š docker run \\ -e RABBITMQ_DEFAULT_USER=root \\ -e RABBITMQ_DEFAULT_PASS=666666 \\ --name mq \\ --hostname mq1 \\ -p 15672:15672 \\ -p 5672:5672 \\ -d \\ rabbitmq:3-management 4.2.é›†ç¾¤éƒ¨ç½²æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å®‰è£…RabbitMQçš„é›†ç¾¤ã€‚ 4.2.1.é›†ç¾¤åˆ†ç±»åœ¨RabbitMQçš„å®˜æ–¹æ–‡æ¡£ä¸­ï¼Œè®²è¿°äº†ä¸¤ç§é›†ç¾¤çš„é…ç½®æ–¹å¼ï¼š æ™®é€šæ¨¡å¼ï¼šæ™®é€šæ¨¡å¼é›†ç¾¤ä¸è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œæ¯ä¸ªMQéƒ½æœ‰è‡ªå·±çš„é˜Ÿåˆ—ã€æ•°æ®ä¿¡æ¯ï¼ˆå…¶å®ƒå…ƒæ•°æ®ä¿¡æ¯å¦‚äº¤æ¢æœºç­‰ä¼šåŒæ­¥ï¼‰ã€‚ä¾‹å¦‚æˆ‘ä»¬æœ‰2ä¸ªMQï¼šmq1ï¼Œå’Œmq2ï¼Œå¦‚æœä½ çš„æ¶ˆæ¯åœ¨mq1ï¼Œè€Œä½ è¿æ¥åˆ°äº†mq2ï¼Œé‚£ä¹ˆmq2ä¼šå»mq1æ‹‰å–æ¶ˆæ¯ï¼Œç„¶åè¿”å›ç»™ä½ ã€‚å¦‚æœmq1å®•æœºï¼Œæ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚ é•œåƒæ¨¡å¼ï¼šä¸æ™®é€šæ¨¡å¼ä¸åŒï¼Œé˜Ÿåˆ—ä¼šåœ¨å„ä¸ªmqçš„é•œåƒèŠ‚ç‚¹ä¹‹é—´åŒæ­¥ï¼Œå› æ­¤ä½ è¿æ¥åˆ°ä»»ä½•ä¸€ä¸ªé•œåƒèŠ‚ç‚¹ï¼Œå‡å¯è·å–åˆ°æ¶ˆæ¯ã€‚è€Œä¸”å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œå¹¶ä¸ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ä¸è¿‡ï¼Œè¿™ç§æ–¹å¼å¢åŠ äº†æ•°æ®åŒæ­¥çš„å¸¦å®½æ¶ˆè€—ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹æ™®é€šæ¨¡å¼é›†ç¾¤ã€‚ 4.2.2.è®¾ç½®ç½‘ç»œé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è®©3å°MQäº’ç›¸çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ã€‚ åˆ†åˆ«åœ¨3å°æœºå™¨ä¸­ï¼Œè®¾ç½® &#x2F;etc&#x2F;hostsæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š 192.168.150.101 mq1 192.168.150.102 mq2 192.168.150.103 mq3 å¹¶åœ¨æ¯å°æœºå™¨ä¸Šæµ‹è¯•ï¼Œæ˜¯å¦å¯ä»¥pingé€šå¯¹æ–¹ï¼š 5.Dockerå®‰è£…MySQL5.1.ä¸Šä¼ åœ¨å°†è¯¾å‰èµ„æ–™ä¸­çš„mysql.taræ–‡ä»¶ä¸Šä¼ åˆ°è™šæ‹Ÿæœºçš„&#x2F;tmpç›®å½•ï¼š é€šè¿‡loadå‘½ä»¤åŠ è½½ä¸ºé•œåƒï¼š docker load -i mysql.tar æ•ˆæœï¼š 5.2.åˆ›å»ºç›®å½•åˆ›å»ºä¸¤ä¸ªç›®å½•ï¼Œä½œä¸ºæ•°æ®åº“çš„æ•°æ®å·ï¼š åˆ›å»ºç›®å½•&#x2F;tmp&#x2F;mysql&#x2F;data åˆ›å»ºç›®å½•&#x2F;tmp&#x2F;mysql&#x2F;conf # åˆ›å»ºç›®å½• mkdir -p /tmp/mysql/data mkdir -p /tmp/mysql/conf å°†è¯¾å‰èµ„æ–™æä¾›çš„my.cnfæ–‡ä»¶ä¸Šä¼ åˆ°&#x2F;tmp&#x2F;mysql&#x2F;confï¼Œå¦‚å›¾ï¼š 5.3.è¿è¡Œdockerå‘½ä»¤è¿è¡Œå‘½ä»¤ï¼š docker run \\ --name mysql \\ -d \\ -p 3306:3306 \\ --restart unless-stopped \\ -v /tmp/mysql/log:/var/log/mysql \\ -v /tmp/mysql/data:/var/lib/mysql \\ -v /tmp/mysql/conf:/etc/mysql \\ -e MYSQL_ROOT_PASSWORD=666666 \\ -d \\ mysql:5.7.25 å‚è€ƒ docker run \\ --name mysql \\ -d \\ -p 3306:3306 \\ --restart unless-stopped \\ -v /mydata/mysql/log:/var/log/mysql \\ -v /tmp/mysql/conf/my.cnf:/etc/mysql/conf.d/hmy.cnf \\ -v /tmp/mysql/data:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=666666 \\ mysql:5.7 [mysqld] skip-name-resolve character_set_server=utf8 datadir=/var/lib/mysql server-id=1000 bind-address=0.0.0.0 docker exec -it mysql bash mysql -uroot -p æ‹‰å–æŒ‡å®šç‰ˆæœ¬ sudo docker pull mysql:8.0.23 sudo docker run -p 3306:3306 --name mysql8 \\ --restart unless-stopped \\ -v &#x2F;tmp&#x2F;mysql&#x2F;mysql-files:&#x2F;var&#x2F;lib&#x2F;mysql-files \\ -v &#x2F;tmp&#x2F;mysql&#x2F;conf:&#x2F;etc&#x2F;mysql \\ -v &#x2F;tmp&#x2F;mysql&#x2F;logs:&#x2F;var&#x2F;log&#x2F;mysql \\ -v &#x2F;tmp&#x2F;mysql&#x2F;data:&#x2F;var&#x2F;lib&#x2F;mysql \\ -e MYSQL_ROOT_PASSWORD&#x3D;root \\ -d mysql:8.0.23 6.å®‰è£…elasticsearch1.éƒ¨ç½²å•ç‚¹es1.1.åˆ›å»ºç½‘ç»œå› ä¸ºæˆ‘ä»¬è¿˜éœ€è¦éƒ¨ç½²kibanaå®¹å™¨ï¼Œå› æ­¤éœ€è¦è®©eså’Œkibanaå®¹å™¨äº’è”ã€‚è¿™é‡Œå…ˆåˆ›å»ºä¸€ä¸ªç½‘ç»œï¼š docker network create es-net 1.2.åŠ è½½é•œåƒè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨elasticsearchçš„7.12.1ç‰ˆæœ¬çš„é•œåƒï¼Œè¿™ä¸ªé•œåƒä½“ç§¯éå¸¸å¤§ï¼Œæ¥è¿‘1Gã€‚ä¸å»ºè®®å¤§å®¶è‡ªå·±pullã€‚ è¯¾å‰èµ„æ–™æä¾›äº†é•œåƒçš„taråŒ…ï¼š å¤§å®¶å°†å…¶ä¸Šä¼ åˆ°è™šæ‹Ÿæœºä¸­ï¼Œç„¶åè¿è¡Œå‘½ä»¤åŠ è½½å³å¯ï¼š # å¯¼å…¥æ•°æ® docker load -i es.tar åŒç†è¿˜æœ‰kibanaçš„taråŒ…ä¹Ÿéœ€è¦è¿™æ ·åšã€‚ 1.3.è¿è¡Œè¿è¡Œdockerå‘½ä»¤ï¼Œéƒ¨ç½²å•ç‚¹esï¼š docker run -d \\ --name es \\ -e \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" \\ -e \"discovery.type=single-node\" \\ -v es-data:/usr/share/elasticsearch/data \\ -v es-plugins:/usr/share/elasticsearch/plugins \\ --privileged \\ --network es-net \\ -p 9200:9200 \\ -p 9300:9300 \\ elasticsearch:7.12.1 å‘½ä»¤è§£é‡Šï¼š -e &quot;cluster.name=es-docker-cluster&quot;ï¼šè®¾ç½®é›†ç¾¤åç§° -e &quot;http.host=0.0.0.0&quot;ï¼šç›‘å¬çš„åœ°å€ï¼Œå¯ä»¥å¤–ç½‘è®¿é—® -e &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;ï¼šå†…å­˜å¤§å° -e &quot;discovery.type=single-node&quot;ï¼šéé›†ç¾¤æ¨¡å¼ -v es-data:/usr/share/elasticsearch/dataï¼šæŒ‚è½½é€»è¾‘å·ï¼Œç»‘å®šesçš„æ•°æ®ç›®å½• -v es-logs:/usr/share/elasticsearch/logsï¼šæŒ‚è½½é€»è¾‘å·ï¼Œç»‘å®šesçš„æ—¥å¿—ç›®å½• -v es-plugins:/usr/share/elasticsearch/pluginsï¼šæŒ‚è½½é€»è¾‘å·ï¼Œç»‘å®šesçš„æ’ä»¶ç›®å½• --privilegedï¼šæˆäºˆé€»è¾‘å·è®¿é—®æƒ --network es-net ï¼šåŠ å…¥ä¸€ä¸ªåä¸ºes-netçš„ç½‘ç»œä¸­ -p 9200:9200ï¼šç«¯å£æ˜ å°„é…ç½® åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼šhttp://192.168.150.101:9200 å³å¯çœ‹åˆ°elasticsearchçš„å“åº”ç»“æœï¼š 2.éƒ¨ç½²kibanakibanaå¯ä»¥ç»™æˆ‘ä»¬æä¾›ä¸€ä¸ªelasticsearchçš„å¯è§†åŒ–ç•Œé¢ï¼Œä¾¿äºæˆ‘ä»¬å­¦ä¹ ã€‚ 2.1.éƒ¨ç½²è¿è¡Œdockerå‘½ä»¤ï¼Œéƒ¨ç½²kibana docker run -d \\ --name kibana \\ -e ELASTICSEARCH_HOSTS=http://es:9200 \\ --network=es-net \\ -p 5601:5601 \\ kibana:7.12.1 --network es-net ï¼šåŠ å…¥ä¸€ä¸ªåä¸ºes-netçš„ç½‘ç»œä¸­ï¼Œä¸elasticsearchåœ¨åŒä¸€ä¸ªç½‘ç»œä¸­ -e ELASTICSEARCH_HOSTS=http://es:9200&quot;ï¼šè®¾ç½®elasticsearchçš„åœ°å€ï¼Œå› ä¸ºkibanaå·²ç»ä¸elasticsearchåœ¨ä¸€ä¸ªç½‘ç»œï¼Œå› æ­¤å¯ä»¥ç”¨å®¹å™¨åç›´æ¥è®¿é—®elasticsearch -p 5601:5601ï¼šç«¯å£æ˜ å°„é…ç½® kibanaå¯åŠ¨ä¸€èˆ¬æ¯”è¾ƒæ…¢ï¼Œéœ€è¦å¤šç­‰å¾…ä¸€ä¼šï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤ï¼š docker logs -f kibana æŸ¥çœ‹è¿è¡Œæ—¥å¿—ï¼Œå½“æŸ¥çœ‹åˆ°ä¸‹é¢çš„æ—¥å¿—ï¼Œè¯´æ˜æˆåŠŸï¼š æ­¤æ—¶ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥åœ°å€è®¿é—®ï¼šhttp://192.168.150.101:5601ï¼Œå³å¯çœ‹åˆ°ç»“æœ 2.2.DevToolskibanaä¸­æä¾›äº†ä¸€ä¸ªDevToolsç•Œé¢ï¼š è¿™ä¸ªç•Œé¢ä¸­å¯ä»¥ç¼–å†™DSLæ¥æ“ä½œelasticsearchã€‚å¹¶ä¸”å¯¹DSLè¯­å¥æœ‰è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚ 3.å®‰è£…IKåˆ†è¯å™¨3.1.åœ¨çº¿å®‰è£…ikæ’ä»¶ï¼ˆè¾ƒæ…¢ï¼‰# è¿›å…¥å®¹å™¨å†…éƒ¨ docker exec -it elasticsearch /bin/bash # åœ¨çº¿ä¸‹è½½å¹¶å®‰è£… ./bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.12.1/elasticsearch-analysis-ik-7.12.1.zip #é€€å‡º exit #é‡å¯å®¹å™¨ docker restart elasticsearch 3.2.ç¦»çº¿å®‰è£…ikæ’ä»¶ï¼ˆæ¨èï¼‰1ï¼‰æŸ¥çœ‹æ•°æ®å·ç›®å½• å®‰è£…æ’ä»¶éœ€è¦çŸ¥é“elasticsearchçš„pluginsç›®å½•ä½ç½®ï¼Œè€Œæˆ‘ä»¬ç”¨äº†æ•°æ®å·æŒ‚è½½ï¼Œå› æ­¤éœ€è¦æŸ¥çœ‹elasticsearchçš„æ•°æ®å·ç›®å½•ï¼Œé€šè¿‡ä¸‹é¢å‘½ä»¤æŸ¥çœ‹: docker volume inspect es-plugins æ˜¾ç¤ºç»“æœï¼š [ &#123; \"CreatedAt\": \"2022-05-06T10:06:34+08:00\", \"Driver\": \"local\", \"Labels\": null, \"Mountpoint\": \"/var/lib/docker/volumes/es-plugins/_data\", \"Name\": \"es-plugins\", \"Options\": null, \"Scope\": \"local\" &#125; ] è¯´æ˜pluginsç›®å½•è¢«æŒ‚è½½åˆ°äº†ï¼š/var/lib/docker/volumes/es-plugins/_data è¿™ä¸ªç›®å½•ä¸­ã€‚ 2ï¼‰è§£å‹ç¼©åˆ†è¯å™¨å®‰è£…åŒ… ä¸‹é¢æˆ‘ä»¬éœ€è¦æŠŠè¯¾å‰èµ„æ–™ä¸­çš„ikåˆ†è¯å™¨è§£å‹ç¼©ï¼Œé‡å‘½åä¸ºik 3ï¼‰ä¸Šä¼ åˆ°eså®¹å™¨çš„æ’ä»¶æ•°æ®å·ä¸­ ä¹Ÿå°±æ˜¯/var/lib/docker/volumes/es-plugins/_data ï¼š 4ï¼‰é‡å¯å®¹å™¨ # 4ã€é‡å¯å®¹å™¨ docker restart es # æŸ¥çœ‹esæ—¥å¿— docker logs -f es 5ï¼‰æµ‹è¯•ï¼š IKåˆ†è¯å™¨åŒ…å«ä¸¤ç§æ¨¡å¼ï¼š ik_smartï¼šæœ€å°‘åˆ‡åˆ† ik_max_wordï¼šæœ€ç»†åˆ‡åˆ† GET /_analyze &#123; \"analyzer\": \"ik_max_word\", \"text\": \"é»‘é©¬ç¨‹åºå‘˜å­¦ä¹ javaå¤ªæ£’äº†\" &#125; ç»“æœï¼š &#123; \"tokens\" : [ &#123; \"token\" : \"é»‘é©¬\", \"start_offset\" : 0, \"end_offset\" : 2, \"type\" : \"CN_WORD\", \"position\" : 0 &#125;, &#123; \"token\" : \"ç¨‹åºå‘˜\", \"start_offset\" : 2, \"end_offset\" : 5, \"type\" : \"CN_WORD\", \"position\" : 1 &#125;, &#123; \"token\" : \"ç¨‹åº\", \"start_offset\" : 2, \"end_offset\" : 4, \"type\" : \"CN_WORD\", \"position\" : 2 &#125;, &#123; \"token\" : \"å‘˜\", \"start_offset\" : 4, \"end_offset\" : 5, \"type\" : \"CN_CHAR\", \"position\" : 3 &#125;, &#123; \"token\" : \"å­¦ä¹ \", \"start_offset\" : 5, \"end_offset\" : 7, \"type\" : \"CN_WORD\", \"position\" : 4 &#125;, &#123; \"token\" : \"java\", \"start_offset\" : 7, \"end_offset\" : 11, \"type\" : \"ENGLISH\", \"position\" : 5 &#125;, &#123; \"token\" : \"å¤ªæ£’äº†\", \"start_offset\" : 11, \"end_offset\" : 14, \"type\" : \"CN_WORD\", \"position\" : 6 &#125;, &#123; \"token\" : \"å¤ªæ£’\", \"start_offset\" : 11, \"end_offset\" : 13, \"type\" : \"CN_WORD\", \"position\" : 7 &#125;, &#123; \"token\" : \"äº†\", \"start_offset\" : 13, \"end_offset\" : 14, \"type\" : \"CN_CHAR\", \"position\" : 8 &#125; ] &#125; 3.3 æ‰©å±•è¯è¯å…¸éšç€äº’è”ç½‘çš„å‘å±•ï¼Œâ€œé€ è¯è¿åŠ¨â€ä¹Ÿè¶Šå‘çš„é¢‘ç¹ã€‚å‡ºç°äº†å¾ˆå¤šæ–°çš„è¯è¯­ï¼Œåœ¨åŸæœ‰çš„è¯æ±‡åˆ—è¡¨ä¸­å¹¶ä¸å­˜åœ¨ã€‚æ¯”å¦‚ï¼šâ€œå¥¥åŠ›ç»™â€ï¼Œâ€œä¼ æ™ºæ’­å®¢â€ ç­‰ã€‚ æ‰€ä»¥æˆ‘ä»¬çš„è¯æ±‡ä¹Ÿéœ€è¦ä¸æ–­çš„æ›´æ–°ï¼ŒIKåˆ†è¯å™¨æä¾›äº†æ‰©å±•è¯æ±‡çš„åŠŸèƒ½ã€‚ 1ï¼‰æ‰“å¼€IKåˆ†è¯å™¨configç›®å½•ï¼š 2ï¼‰åœ¨IKAnalyzer.cfg.xmlé…ç½®æ–‡ä»¶å†…å®¹æ·»åŠ ï¼š &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?> &lt;!DOCTYPE properties SYSTEM \"http://java.sun.com/dtd/properties.dtd\"> &lt;properties> &lt;comment>IK Analyzer æ‰©å±•é…ç½®&lt;/comment> &lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ *** æ·»åŠ æ‰©å±•è¯å…¸--> &lt;entry key=\"ext_dict\">ext.dic&lt;/entry> &lt;/properties> 3ï¼‰æ–°å»ºä¸€ä¸ª ext.dicï¼Œå¯ä»¥å‚è€ƒconfigç›®å½•ä¸‹å¤åˆ¶ä¸€ä¸ªé…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹ ä¼ æ™ºæ’­å®¢ å¥¥åŠ›ç»™ 4ï¼‰é‡å¯elasticsearch docker restart es # æŸ¥çœ‹ æ—¥å¿— docker logs -f elasticsearch æ—¥å¿—ä¸­å·²ç»æˆåŠŸåŠ è½½ext.dicé…ç½®æ–‡ä»¶ 5ï¼‰æµ‹è¯•æ•ˆæœï¼š GET /_analyze &#123; \"analyzer\": \"ik_max_word\", \"text\": \"ä¼ æ™ºæ’­å®¢Javaå°±ä¸šè¶…è¿‡90%,å¥¥åŠ›ç»™ï¼\" &#125; æ³¨æ„å½“å‰æ–‡ä»¶çš„ç¼–ç å¿…é¡»æ˜¯ UTF-8 æ ¼å¼ï¼Œä¸¥ç¦ä½¿ç”¨Windowsè®°äº‹æœ¬ç¼–è¾‘ 3.4 åœç”¨è¯è¯å…¸åœ¨äº’è”ç½‘é¡¹ç›®ä¸­ï¼Œåœ¨ç½‘ç»œé—´ä¼ è¾“çš„é€Ÿåº¦å¾ˆå¿«ï¼Œæ‰€ä»¥å¾ˆå¤šè¯­è¨€æ˜¯ä¸å…è®¸åœ¨ç½‘ç»œä¸Šä¼ é€’çš„ï¼Œå¦‚ï¼šå…³äºå®—æ•™ã€æ”¿æ²»ç­‰æ•æ„Ÿè¯è¯­ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æœç´¢æ—¶ä¹Ÿåº”è¯¥å¿½ç•¥å½“å‰è¯æ±‡ã€‚ IKåˆ†è¯å™¨ä¹Ÿæä¾›äº†å¼ºå¤§çš„åœç”¨è¯åŠŸèƒ½ï¼Œè®©æˆ‘ä»¬åœ¨ç´¢å¼•æ—¶å°±ç›´æ¥å¿½ç•¥å½“å‰çš„åœç”¨è¯æ±‡è¡¨ä¸­çš„å†…å®¹ã€‚ 1ï¼‰IKAnalyzer.cfg.xmlé…ç½®æ–‡ä»¶å†…å®¹æ·»åŠ ï¼š &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?> &lt;!DOCTYPE properties SYSTEM \"http://java.sun.com/dtd/properties.dtd\"> &lt;properties> &lt;comment>IK Analyzer æ‰©å±•é…ç½®&lt;/comment> &lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸--> &lt;entry key=\"ext_dict\">ext.dic&lt;/entry> &lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸ *** æ·»åŠ åœç”¨è¯è¯å…¸--> &lt;entry key=\"ext_stopwords\">stopword.dic&lt;/entry> &lt;/properties> 3ï¼‰åœ¨ stopword.dic æ·»åŠ åœç”¨è¯ ä¹ å¤§å¤§ 4ï¼‰é‡å¯elasticsearch # é‡å¯æœåŠ¡ docker restart elasticsearch docker restart kibana # æŸ¥çœ‹ æ—¥å¿— docker logs -f elasticsearch æ—¥å¿—ä¸­å·²ç»æˆåŠŸåŠ è½½stopword.dicé…ç½®æ–‡ä»¶ 5ï¼‰æµ‹è¯•æ•ˆæœï¼š GET /_analyze &#123; \"analyzer\": \"ik_max_word\", \"text\": \"ä¼ æ™ºæ’­å®¢Javaå°±ä¸šç‡è¶…è¿‡95%,ä¹ å¤§å¤§éƒ½ç‚¹èµ,å¥¥åŠ›ç»™ï¼\" &#125; æ³¨æ„å½“å‰æ–‡ä»¶çš„ç¼–ç å¿…é¡»æ˜¯ UTF-8 æ ¼å¼ï¼Œä¸¥ç¦ä½¿ç”¨Windowsè®°äº‹æœ¬ç¼–è¾‘ 4.éƒ¨ç½²esé›†ç¾¤æˆ‘ä»¬ä¼šåœ¨å•æœºä¸Šåˆ©ç”¨dockerå®¹å™¨è¿è¡Œå¤šä¸ªeså®ä¾‹æ¥æ¨¡æ‹Ÿesé›†ç¾¤ã€‚ä¸è¿‡ç”Ÿäº§ç¯å¢ƒæ¨èå¤§å®¶æ¯ä¸€å°æœåŠ¡èŠ‚ç‚¹ä»…éƒ¨ç½²ä¸€ä¸ªesçš„å®ä¾‹ã€‚ éƒ¨ç½²esé›†ç¾¤å¯ä»¥ç›´æ¥ä½¿ç”¨docker-composeæ¥å®Œæˆï¼Œä½†è¿™è¦æ±‚ä½ çš„Linuxè™šæ‹Ÿæœºè‡³å°‘æœ‰4Gçš„å†…å­˜ç©ºé—´ 4.1.åˆ›å»ºesé›†ç¾¤é¦–å…ˆç¼–å†™ä¸€ä¸ªdocker-compose.ymæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š version: '2.2' services: es01: image: elasticsearch:7.12.1 container_name: es01 environment: - node.name=es01 - cluster.name=es-docker-cluster - discovery.seed_hosts=es02,es03 - cluster.initial_master_nodes=es01,es02,es03 - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" volumes: - data01:/usr/share/elasticsearch/data ports: - 9201:9201 networks: - elastic es02: image: elasticsearch:7.12.1 container_name: es02 environment: - node.name=es02 - cluster.name=es-docker-cluster - discovery.seed_hosts=es01,es03 - cluster.initial_master_nodes=es01,es02,es03 - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" volumes: - data02:/usr/share/elasticsearch/data ports: - 9202:9202 networks: - elastic es03: image: elasticsearch:7.12.1 container_name: es03 environment: - node.name=es03 - cluster.name=es-docker-cluster - discovery.seed_hosts=es01,es02 - cluster.initial_master_nodes=es01,es02,es03 - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" volumes: - data03:/usr/share/elasticsearch/data networks: - elastic ports: - 9203:9203 volumes: data01: driver: local data02: driver: local data03: driver: local networks: elastic: driver: bridge esè¿è¡Œéœ€è¦ä¿®æ”¹ä¸€äº›linuxç³»ç»Ÿæƒé™ï¼Œä¿®æ”¹/etc/sysctl.confæ–‡ä»¶ vi /etc/sysctl.conf æ·»åŠ ä¸‹é¢çš„å†…å®¹ï¼š vm.max_map_count=262144 ç„¶åæ‰§è¡Œå‘½ä»¤ï¼Œè®©é…ç½®ç”Ÿæ•ˆï¼š sysctl -p é€šè¿‡docker-composeå¯åŠ¨é›†ç¾¤ï¼š docker-compose up -d 4.2.é›†ç¾¤çŠ¶æ€ç›‘æ§kibanaå¯ä»¥ç›‘æ§esé›†ç¾¤ï¼Œä¸è¿‡æ–°ç‰ˆæœ¬éœ€è¦ä¾èµ–esçš„x-pack åŠŸèƒ½ï¼Œé…ç½®æ¯”è¾ƒå¤æ‚ã€‚ è¿™é‡Œæ¨èä½¿ç”¨cerebroæ¥ç›‘æ§esé›†ç¾¤çŠ¶æ€ï¼Œå®˜æ–¹ç½‘å€ï¼šhttps://github.com/lmenezes/cerebro è¯¾å‰èµ„æ–™å·²ç»æä¾›äº†å®‰è£…åŒ…ï¼š è§£å‹å³å¯ä½¿ç”¨ï¼Œéå¸¸æ–¹ä¾¿ã€‚ è§£å‹å¥½çš„ç›®å½•å¦‚ä¸‹ï¼š è¿›å…¥å¯¹åº”çš„binç›®å½•ï¼š åŒå‡»å…¶ä¸­çš„cerebro.batæ–‡ä»¶å³å¯å¯åŠ¨æœåŠ¡ã€‚ è®¿é—®http://localhost:9000 å³å¯è¿›å…¥ç®¡ç†ç•Œé¢ï¼š è¾“å…¥ä½ çš„elasticsearchçš„ä»»æ„èŠ‚ç‚¹çš„åœ°å€å’Œç«¯å£ï¼Œç‚¹å‡»connectå³å¯ï¼š ç»¿è‰²çš„æ¡ï¼Œä»£è¡¨é›†ç¾¤å¤„äºç»¿è‰²ï¼ˆå¥åº·çŠ¶æ€ï¼‰ã€‚ 4.3.åˆ›å»ºç´¢å¼•åº“ 1ï¼‰åˆ©ç”¨kibanaçš„DevToolsåˆ›å»ºç´¢å¼•åº“ åœ¨DevToolsä¸­è¾“å…¥æŒ‡ä»¤ï¼š PUT /itcast &#123; \"settings\": &#123; \"number_of_shards\": 3, // åˆ†ç‰‡æ•°é‡ \"number_of_replicas\": 1 // å‰¯æœ¬æ•°é‡ &#125;, \"mappings\": &#123; \"properties\": &#123; // mappingæ˜ å°„å®šä¹‰ ... &#125; &#125; &#125; 2ï¼‰åˆ©ç”¨cerebroåˆ›å»ºç´¢å¼•åº“ åˆ©ç”¨cerebroè¿˜å¯ä»¥åˆ›å»ºç´¢å¼•åº“ï¼š å¡«å†™ç´¢å¼•åº“ä¿¡æ¯ï¼š ç‚¹å‡»å³ä¸‹è§’çš„createæŒ‰é’®ï¼š 4.4.æŸ¥çœ‹åˆ†ç‰‡æ•ˆæœå›åˆ°é¦–é¡µï¼Œå³å¯æŸ¥çœ‹ç´¢å¼•åº“åˆ†ç‰‡æ•ˆæœï¼š Dockerå®‰è£…Minio1.Docker æœç´¢é•œåƒ docker search minio 2.æ‹‰å–é•œåƒ docker pull minio&#x2F;minio 3.Docker å¯åŠ¨Minioé•œåƒ docker run -d \\ -p 9000:9000 \\ -p 9001:9001 \\ --name minio \\ -v &#x2F;home&#x2F;minio&#x2F;data:&#x2F;data \\ -e &quot;MINIO_ROOT_USER&#x3D;admin&quot; \\ -e &quot;MINIO_ROOT_PASSWORD&#x3D;adminadmin&quot; \\ minio&#x2F;minio:RELEASE.2023-03-24T21-41-23Z server --address &#39;:9000&#39; &#x2F;data --console-address &quot;:9001&quot; è§£é‡Šï¼š docker run :docker å¯åŠ¨å®¹å™¨å‘½ä»¤ -d ï¼šåå°å¯åŠ¨ -p ï¼šç«¯å£æ˜ å°„ â€“name ä¸ºè¿™ä¸ªå®¹å™¨å–ä¸€ä¸ªåå­— -e ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ -v :æ–‡ä»¶æŒ‚è½½ minio&#x2F;minio server &#x2F;data ï¼š minioçš„å¯åŠ¨å‘½ä»¤ ï¼ˆminio&#x2F;minio æ˜¯é•œåƒåå­—ã€ &#x2F;data:æ•°æ®å­˜å‚¨ä½ç½®ï¼‰ å¯†ç é•¿åº¦è¦æ±‚è‡³å°‘8ä½ ä½¿ç”¨docker-composeå®‰è£… 1ã€å®‰è£… docker-compose å¹¶æˆæƒ 2ã€åˆ›å»ºç¼–æ’ymlæ–‡ä»¶ æŒ‡å®šæ§åˆ¶å°è·¯å¾„ --console-address &quot;127.0.0.1:9000&quot;æŒ‡å®šAPIè·¯å¾„ --address &quot;127.0.0.1:9090&quot; version: '3' services: minio: image: minio/minio hostname: \"minio\" ports: - 9000:9000 # api ç«¯å£ - 9001:9001 # æ§åˆ¶å°ç«¯å£ environment: MINIO_ACCESS_KEY: admin #ç®¡ç†åå°ç”¨æˆ·å MINIO_SECRET_KEY: admin123 #ç®¡ç†åå°å¯†ç ï¼Œæœ€å°8ä¸ªå­—ç¬¦ volumes: - /docker/minio/data:/data #æ˜ å°„å½“å‰ç›®å½•ä¸‹çš„dataç›®å½•è‡³å®¹å™¨å†…/dataç›®å½• - /docker/minio/config:/root/.minio/ #æ˜ å°„é…ç½®ç›®å½• command: server --console-address ':9001' /data #æŒ‡å®šå®¹å™¨ä¸­çš„ç›®å½• /data privileged: true restart: always 3ã€æ‰§è¡Œæµç¨‹ åœ¨ymlæ–‡ä»¶æ‰€åœ¨ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç­‰å¾…æ‰§è¡Œå®Œæ¯• created...done docker-compose up -d 4.ç™»å½•æ§åˆ¶å° æ§åˆ¶å°è·¯å¾„ï¼šhttp://ip:9001/","categories":[{"name":"Docker","slug":"Docker","permalink":"https://blog.ehzyil.xyz/categories/Docker/"}],"tags":[{"name":"è½¯ä»¶","slug":"è½¯ä»¶","permalink":"https://blog.ehzyil.xyz/tags/%E8%BD%AF%E4%BB%B6/"},{"name":"Docker","slug":"Docker","permalink":"https://blog.ehzyil.xyz/tags/Docker/"}],"author":"ehzyil"},{"title":"Nacoså®‰è£…æŒ‡å—","slug":"2023/Nacoså®‰è£…æŒ‡å—","date":"2023-07-05T00:00:00.000Z","updated":"2024-01-30T06:30:58.127Z","comments":true,"path":"2023/07/05/2023/Nacoså®‰è£…æŒ‡å—/","link":"","permalink":"https://blog.ehzyil.xyz/2023/07/05/2023/Nacos%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97/","excerpt":"","text":"1.Windowså®‰è£…å¼€å‘é˜¶æ®µé‡‡ç”¨å•æœºå®‰è£…å³å¯ã€‚ 1.1.ä¸‹è½½å®‰è£…åŒ…åœ¨Nacosçš„GitHubé¡µé¢ï¼Œæä¾›æœ‰ä¸‹è½½é“¾æ¥ï¼Œå¯ä»¥ä¸‹è½½ç¼–è¯‘å¥½çš„NacosæœåŠ¡ç«¯æˆ–è€…æºä»£ç ï¼š GitHubä¸»é¡µï¼šhttps://github.com/alibaba/nacos GitHubçš„Releaseä¸‹è½½é¡µï¼šhttps://github.com/alibaba/../../../images/nacos/releases å¦‚å›¾ï¼š æœ¬è¯¾ç¨‹é‡‡ç”¨1.4.1.ç‰ˆæœ¬çš„Nacosï¼Œè¯¾å‰èµ„æ–™å·²ç»å‡†å¤‡äº†å®‰è£…åŒ…ï¼š windowsç‰ˆæœ¬ä½¿ç”¨nacos-server-1.4.1.zipåŒ…å³å¯ã€‚ 1.2.è§£å‹å°†è¿™ä¸ªåŒ…è§£å‹åˆ°ä»»æ„éä¸­æ–‡ç›®å½•ä¸‹ï¼Œå¦‚å›¾ï¼š ç›®å½•è¯´æ˜ï¼š binï¼šå¯åŠ¨è„šæœ¬ confï¼šé…ç½®æ–‡ä»¶ 1.3.ç«¯å£é…ç½®Nacosçš„é»˜è®¤ç«¯å£æ˜¯8848ï¼Œå¦‚æœä½ ç”µè„‘ä¸Šçš„å…¶å®ƒè¿›ç¨‹å ç”¨äº†8848ç«¯å£ï¼Œè¯·å…ˆå°è¯•å…³é—­è¯¥è¿›ç¨‹ã€‚ å¦‚æœæ— æ³•å…³é—­å ç”¨8848ç«¯å£çš„è¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥è¿›å…¥nacosçš„confç›®å½•ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£ï¼š ä¿®æ”¹å…¶ä¸­çš„å†…å®¹ï¼š 1.4.å¯åŠ¨å¯åŠ¨éå¸¸ç®€å•ï¼Œè¿›å…¥binç›®å½•ï¼Œç»“æ„å¦‚ä¸‹ï¼š ç„¶åæ‰§è¡Œå‘½ä»¤å³å¯ï¼š windowså‘½ä»¤ï¼š startup.cmd -m standalone æ‰§è¡Œåçš„æ•ˆæœå¦‚å›¾ï¼š 1.5.è®¿é—®åœ¨æµè§ˆå™¨è¾“å…¥åœ°å€ï¼šhttp://127.0.0.1:8848/nacoså³å¯ï¼š é»˜è®¤çš„è´¦å·å’Œå¯†ç éƒ½æ˜¯nacosï¼Œè¿›å…¥åï¼š 2.Linuxå®‰è£…Linuxæˆ–è€…Macå®‰è£…æ–¹å¼ä¸Windowsç±»ä¼¼ã€‚ 2.1.å®‰è£…JDKNacosä¾èµ–äºJDKè¿è¡Œï¼Œç´¢å¼•Linuxä¸Šä¹Ÿéœ€è¦å®‰è£…JDKæ‰è¡Œã€‚ ä¸Šä¼ jdkå®‰è£…åŒ…ï¼š ä¸Šä¼ åˆ°æŸä¸ªç›®å½•ï¼Œä¾‹å¦‚ï¼š/usr/local/ ç„¶åè§£å‹ç¼©ï¼š tar -xvf jdk-8u144-linux-x64.tar.gz ç„¶åé‡å‘½åä¸ºjava é…ç½®ç¯å¢ƒå˜é‡ï¼š export JAVA_HOME=/usr/local/java export PATH=$PATH:$JAVA_HOME/bin è®¾ç½®ç¯å¢ƒå˜é‡ï¼š source /etc/profile 2.2.ä¸Šä¼ å®‰è£…åŒ…å¦‚å›¾ï¼š ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨è¯¾å‰èµ„æ–™ä¸­çš„tar.gzï¼š ä¸Šä¼ åˆ°LinuxæœåŠ¡å™¨çš„æŸä¸ªç›®å½•ï¼Œä¾‹å¦‚/usr/local/srcç›®å½•ä¸‹ï¼š 2.3.è§£å‹å‘½ä»¤è§£å‹ç¼©å®‰è£…åŒ…ï¼š tar -xvf nacos-server-1.4.1.tar.gz ç„¶ååˆ é™¤å®‰è£…åŒ…ï¼š rm -rf nacos-server-1.4.1.tar.gz ç›®å½•ä¸­æœ€ç»ˆæ ·å¼ï¼š ç›®å½•å†…éƒ¨ï¼š 2.4.ç«¯å£é…ç½®ä¸windowsä¸­ç±»ä¼¼ 2.5.å¯åŠ¨åœ¨..&#x2F;..&#x2F;..&#x2F;images&#x2F;nacos&#x2F;binç›®å½•ä¸­ï¼Œè¾“å…¥å‘½ä»¤å¯åŠ¨Nacosï¼š sh startup.sh -m standalone 3.Nacosçš„ä¾èµ–çˆ¶å·¥ç¨‹ï¼š &lt;dependency> &lt;groupId>com.alibaba.cloud&lt;/groupId> &lt;artifactId>spring-cloud-alibaba-dependencies&lt;/artifactId> &lt;version>2.2.5.RELEASE&lt;/version> &lt;type>pom&lt;/type> &lt;scope>import&lt;/scope> &lt;/dependency> å®¢æˆ·ç«¯ï¼š &lt;!-- nacoså®¢æˆ·ç«¯ä¾èµ–åŒ… --> &lt;dependency> &lt;groupId>com.alibaba.cloud&lt;/groupId> &lt;artifactId>spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId> &lt;/dependency>","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://blog.ehzyil.xyz/tags/Docker/"},{"name":"Nacos","slug":"Nacos","permalink":"https://blog.ehzyil.xyz/tags/Nacos/"}],"author":"ehzyil"},{"title":"[è½¬è½½]Telegramï¼ˆç”µæŠ¥ï¼‰ï¼šæ–°æ‰‹æŒ‡å—ã€ä½¿ç”¨æ•™ç¨‹åŠé¢‘é“æ¨è","slug":"2023/Telegramï¼šæ–°æ‰‹æŒ‡å—ã€ä½¿ç”¨æ•™ç¨‹åŠé¢‘é“æ¨è","date":"2019-11-09T00:00:00.000Z","updated":"2022-11-28T00:00:00.000Z","comments":true,"path":"2019/11/09/2023/Telegramï¼šæ–°æ‰‹æŒ‡å—ã€ä½¿ç”¨æ•™ç¨‹åŠé¢‘é“æ¨è/","link":"","permalink":"https://blog.ehzyil.xyz/2019/11/09/2023/Telegram%EF%BC%9A%E6%96%B0%E6%89%8B%E6%8C%87%E5%8D%97%E3%80%81%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%E5%8F%8A%E9%A2%91%E9%81%93%E6%8E%A8%E8%8D%90/","excerpt":"Telegram æ˜¯è¿„ä»Šä¸ºæ­¢æœ€æ£’çš„å³æ—¶èŠå¤©è½¯ä»¶ï¼Œåœ¨è¿™ä¸ªè‡ªç”±æ–°ä¸–ç•Œï¼Œä¸å¿…è‡ªæˆ‘å®¡æŸ¥ï¼ˆFreedom of speechï¼‰ã€‚","text":"Telegram æ˜¯è¿„ä»Šä¸ºæ­¢æœ€æ£’çš„å³æ—¶èŠå¤©è½¯ä»¶ï¼Œåœ¨è¿™ä¸ªè‡ªç”±æ–°ä¸–ç•Œï¼Œä¸å¿…è‡ªæˆ‘å®¡æŸ¥ï¼ˆFreedom of speechï¼‰ã€‚ ğŸ’¡ å…¨æ–‡æœ‰ä¸¤ä¸‡ä¸ƒåƒå¤šå­—ï¼Œå–„ç”¨å³ä¾§çš„ç›®å½•æ å’ŒæŸ¥æ‰¾åŠŸèƒ½ï¼ˆCtrl + Fï¼‰ï¼ŒåŠ©ä½ å¿«é€Ÿå®šä½æƒ³è¦çœ‹åˆ°çš„å†…å®¹ã€‚ä½ ä¹Ÿå¯ä»¥ç§»æ­¥åˆ° Telegram å†…é˜…è¯»æ­¤æ–‡çš„ ç²¾ç®€ç‰ˆã€‚ ğŸ§± TG åœ¨ä¸­å›½å¤§é™†å¿…é¡» ç¿»å¢™ åæ‰èƒ½ä½¿ç”¨ã€‚ä¸è¿‡ï¼Œå­¦ä¼šç§‘å­¦ä¸Šç½‘ï¼Œéš¾é“ä¸æ˜¯å½“ä»£æ•°å­—å…¬æ°‘çš„å¿…å¤‡æŠ€èƒ½å—ï¼Ÿ ğŸ“ tingtalk.me åœ¨ 2020-04-04 è¢«å¢™äº†ï¼Œå¦‚éœ€åœ¨å¢™å†…ä¼ é˜…ï¼š å‰å¾€ GitHub é˜…è¯» ä¸‹è½½æœ¬æ–‡çš„ PDF æˆ– å¯ç¼–è¾‘çš„ Markdown æºæ–‡æ¡£ âœˆï¸ ç”µæŠ¥ä»‹ç»2013 å¹´ 5 æœˆ 20 æ—¥ï¼Œæ–¯è¯ºç™»å‘ã€Šå«æŠ¥ã€‹åª’ä½“é€éœ²æ£±é•œè®¡åˆ’ï¼ˆPRISMï¼‰ï¼š æˆ‘æ„¿æ„ç‰ºç‰²æ‰è¿™ä¸€åˆ‡ï¼ˆå·¥ä½œã€æ”¶å…¥å’Œå¥³æœ‹å‹ï¼‰ï¼ˆæŠŠçœŸç›¸å‘Šè¯‰ä¸–äººï¼‰ï¼Œå› ä¸ºç¾å›½æ”¿åºœåˆ©ç”¨ä»–ä»¬æ­£åœ¨ç§˜å¯†å»ºé€ çš„è¿™ä¸€ä¸ªåºå¤§ç›‘è§†æœºå™¨æ‘§æ¯éšç§ã€äº’è”ç½‘è‡ªç”±å’Œä¸–ç•Œå„åœ°äººä»¬çš„åŸºæœ¬è‡ªç”±çš„è¡Œä¸ºè®©ä»–è‰¯å¿ƒä¸å®‰ã€‚by Edward Snowden è®¸å¤šäººç¬¬ä¸€æ¬¡æ„è¯†åˆ° Ta ä»¬çš„æ•°å­—é€šä¿¡é­åˆ°äº†ç›‘è§†ï¼ˆThe year Telegram was born was marked by the Snowden Revelations, when many people realized for the first time their digital communications were being watched.ï¼‰ã€‚ 2013 å¹´ 8 æœˆ 14 æ—¥ï¼Œæœæ´›å¤«å…„å¼Ÿï¼ˆPavel Durov å’Œ Nikolai Durovï¼‰æ­£å¼å‘å¸ƒäº†å¼€æºï¼ˆOpen Sourceï¼‰çš„ Telegramï¼ˆç‰¹æŒ‡å®¢æˆ·ç«¯ï¼‰ã€‚è¿™ä¸ªå……æ»¡ç†æƒ³ä¸»ä¹‰çš„è½¯ä»¶ä¸æ¥å—å¤–éƒ¨æŠ•èµ„ï¼ˆä¸éœ€è¦å‘ä»»ä½•è‚¡ä¸œè´Ÿè´£ï¼‰ï¼Œä¹Ÿä¸ä¼šé€šè¿‡å¹¿å‘Šç›ˆåˆ©ï¼Œä¸”æŒ£é’±æ°¸è¿œä¸ä¼šæ˜¯ Telegram çš„ç»ˆæç›®æ ‡ï¼ˆMaking profits will never be an end-goal for Telegramï¼‰ï¼Œæ‰€ä»¥ Telegram è‡³ä»Šæ²¡æœ‰å‘ç¬¬ä¸‰æ–¹æŠ«éœ²è¿‡ä¸€ä¸ªå­—èŠ‚çš„ç”¨æˆ·ç§äººæ•°æ®ã€‚Telegram åªä¼šé»˜é»˜åœ°è·µè¡Œä¸€ä¸ªç†å¿µï¼šè¿™ä¸ªæ˜Ÿçƒä¸Šçš„æ¯ä¸ªäººéƒ½äº«æœ‰è‡ªç”±çš„æƒåˆ©ï¼ˆEveryone on the planet has a right to be free.ï¼‰ã€‚This is the Telegram wayï¼š We believe that humans are inherently intelligent and benevolent beings that deserve to be trusted; trusted with freedom to share their thoughts, freedom to communicate privately, freedom to create tools. This philosophy defines everything we do. æˆ‘ä»¬ç›¸ä¿¡äººç±»å¤©ç”Ÿå°±æ˜¯èªæ˜å’Œä»æ…ˆçš„ï¼Œå€¼å¾—ä¿¡ä»»çš„ï¼›åšä¿¡äººç±»å¯ä»¥è‡ªç”±åœ°åˆ†äº«æƒ³æ³•ï¼Œè‡ªç”±åœ°ç§ä¸‹äº¤æµï¼Œè‡ªç”±åœ°åˆ›é€ å·¥å…·ã€‚ è¿™ç§å“²å­¦å®šä¹‰äº†æˆ‘ä»¬æ‰€åšçš„ä¸€åˆ‡ã€‚by Pavel Durov æˆªæ­¢ 2022 å¹´ 6 æœˆ 19 æ—¥ï¼ŒTelegram å·²æœ‰ 7 äº¿æœˆæ´»è·ƒç”¨æˆ·ã€‚ ğŸ‘ è¿‘ä¹å®Œç¾ **é«˜åº¦åŠ å¯†**ï¼šä½¿ç”¨ç‹¬æœ‰çš„ç½‘ç»œä¼ è¾“åè®® MTProtoï¼Œæ— æƒ§è¢«é»‘å®¢æ”»å‡»ã€‚ **æ²¡æœ‰å®¡æŸ¥**ï¼šä¸ç”¨æ‹…å¿ƒè¢«å°å·ï¼Œé™¤éæ‰§æ³•è°ƒæŸ¥å•ä½èƒ½è¯æ˜ç”¨æˆ·æ˜¯ææ€–åˆ†å­ã€‚ æ²¡æœ‰å¹¿å‘Šï¼šä¸€ä¸ªçº¯ç¢æè‡´çš„å¤§ä¼—åŒ–å³æ—¶é€šè®¯è½¯ä»¶ï¼ˆInstant Messaging Appï¼‰ã€‚ **ä¸å å†…å­˜**ï¼šèŠå¤©è®°å½•ä¿å­˜åœ¨äº‘ç«¯ï¼ˆCloud-Basedï¼‰ï¼Œä»»ä½•è®¾å¤‡ï¼Œæ— ç¼åŒæ­¥ï¼Œéšå–éšç”¨ã€‚ è¶…å¤§ç¾¤èŠï¼šå°é¡¶ 20 ä¸‡äººï¼Œé…åˆå„ç§ç®¡ç†å·¥å…·ï¼ˆä¾‹å¦‚é™åˆ¶å‘è¨€é—´éš”ï¼‰ï¼Œè®©å¤§å‹ç¤¾ç¾¤çš„äº¤æµä¹Ÿèƒ½äº•äº•æœ‰æ¡ã€‚ **è¡¨æƒ…è´´çº¸**ï¼šé‡‡ç”¨é«˜æ¸…çš„ çŸ¢é‡ æ ¼å¼ï¼Œå¹¶ä¸”æ”¯æŒè‡ªåˆ¶è¡¨æƒ…åŒ…ï¼ˆCustom Sticker Setsï¼‰ã€‚ ğŸ‘ ç‘•ä¸æ©ç‘œæ¬¢è¿è®¿é—® Feature Suggestion Platformï¼Œå‘ Telegram æäº¤ç¼ºé™·æŠ¥å‘Šå’ŒåŠŸèƒ½å»ºè®®ï¼ˆBugs and Suggestionsï¼‰ï¼Œä¸€èµ·å¸®æ‰¶ Telegram åšå¤§åšå¼ºã€‚ ğŸ¼ ä¸­æ–‡æœç´¢ä½“éªŒå·®æ¯•ç«Ÿæ˜¯å›½å¤–çš„è½¯ä»¶ï¼Œæ‰€ä»¥æœ‰ä¸€äº›æ°´åœŸä¸æœä¹Ÿæ˜¯å¯ä»¥ç†è§£çš„ã€‚ä»¥ä¸‹æ–¹æ³•å¯ä»¥åŠ©ä½ æ›´å¿«åœ°æ‰¾åˆ°èŠå¤©è®°å½•å’Œé¢‘é“ä¿¡æ¯ã€‚ æ–¹æ³•ä¸€ï¼šæ‰‹åŠ¨åˆ†è¯Telegram çš„ä¸­æ–‡æœç´¢æ˜¯ä»¥ã€Œè¯ç»„ã€ä¸ºå•ä½çš„ï¼Œä»¥æ ‡ç‚¹ç¬¦å·æˆ–ç©ºæ ¼ä½œä¸ºè¯çš„é—´éš”ã€‚ è¾œé¸¿é“­è¯´è¿‡ï¼šçœŸæ­£çš„è‡ªç”±ï¼Œå¹¶ä¸æ„å‘³ç€å¯ä»¥éšå¿ƒæ‰€æ¬²ï¼Œè€Œæ˜¯å¯ä»¥è‡ªç”±åœ°åšæ­£ç¡®çš„äº‹æƒ…ã€‚ åœ¨æœç´¢æ¡†è¾“å…¥ï¼š çœŸæ­£çš„è‡ªç”± å¹¶ä¸æ„å‘³ç€å¯ä»¥éšå¿ƒæ‰€æ¬² è€Œæ˜¯å¯ä»¥è‡ªç”±åœ°åšæ­£ç¡®çš„äº‹æƒ… éƒ½å¯æœåˆ°è¿™æ¡å†å²ä¿¡æ¯ï¼Œå› ä¸ºæ ‡ç‚¹ç¬¦å·å……å½“äº†åˆ†è¯ç¬¦ã€‚ä½†æ˜¯è¿™äº›è¯æœªå…å¤ªé•¿äº†å§ï¼Ÿï¼ä¹Ÿè®°ä¸ä½å‘€ã€‚ä¸è¿‡åˆ«å¿˜äº† Telegram åˆ†è¯è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ·»åŠ å¤šä½™çš„æ ‡ç‚¹ç¬¦å·ï¼ˆä¾‹å¦‚äº•å· ï¼ƒï¼‰æˆ–ç©ºæ ¼æ¥åˆ†è¯ï¼š #è¾œé¸¿é“­ è¯´è¿‡ï¼šçœŸæ­£çš„ #è‡ªç”±ï¼Œå¹¶ä¸æ„å‘³ç€å¯ä»¥éšå¿ƒæ‰€æ¬²ï¼Œè€Œæ˜¯å¯ä»¥è‡ªç”±åœ°åšæ­£ç¡®çš„äº‹æƒ…ã€‚ ç‚¹å‡»ä»¥ä¸‹è¯ç»„ï¼Œæˆ–è€…åœ¨æœç´¢æ¡†è¾“å…¥ï¼š #è¾œé¸¿é“­ #è‡ªç”± éƒ½å¯ä»¥æ‰¾åˆ°è¿™å¥è¯ã€‚å»ºè®®é¢‘é“ä¸»åœ¨å‘å¸ƒå†…å®¹çš„æ—¶å€™ï¼Œç”¨ # æ‰“ä¸Šç›¸åº”çš„æ ‡ç­¾ï¼Œæ–¹ä¾¿è®¢é˜…è€…æ‰¾åˆ°æƒ³è¦çš„ä¿¡æ¯ã€‚ æ–¹æ³•äºŒï¼šå¯¼å‡ºæ–‡ä»¶å«Œæ‰‹åŠ¨åˆ†è¯å¤ªéº»çƒ¦äº†ï¼Ÿé‚£å°±åœ¨ç”µè„‘ä¸Šå¯¼å‡º HTML æˆ– JSON æ ¼å¼çš„èŠå¤©è®°å½•ï¼Œæƒ³æ€ä¹ˆæœå°±æ€ä¹ˆæœã€‚ ä¸è¿‡ï¼Œå·²ç»æœ‰äººå‘ Telegram æäº¤äº† æ”¹å–„ä¸­æ–‡æœç´¢çš„ææ¡ˆï¼Œæ‰€ä»¥è¯·ä¸ºè¿™ä¸ª Suggestion æŠ•ç¥¨å’Œé¼“æ°”ã€‚æ‹œæ‰˜äº†ã€‚ å…³è”é˜…è¯» ä¸ºä»€ä¹ˆ Telegram ä¸èƒ½æœç´¢ä¸­æ–‡è®¯æ¯ - ç¿å›ç‰§ Telegram ä¸­æ–‡æœç´¢æ–¹æ¡ˆæ¢ç´¢ - Newlearner ğŸ™ƒ ç¡¬å¸çš„å¦ä¸€é¢åœ¨åŠ å¯†é€šä¿¡ã€Œåº‡æŠ¤ã€ä¸‹çš„åœŸå£¤ï¼Œæ»‹ç”Ÿäº†è‡­åæ˜­è‘—çš„ç½‘ç»œæ€§çŠ¯ç½ªæ¡ˆä»¶ï¼šN å·æˆ¿äº‹ä»¶ã€‚æ‰€å¹¸çš„æ˜¯ï¼Œ2020 å¹´ 11 æœˆ 26 æ—¥ï¼Œä¸»çŠ¯èµµä¸»å½¬ä¸€å®¡åˆ¤å¤„ç›‘ç¦ 40 å¹´ã€‚ ä»¥åŠå­˜åœ¨å¤§é‡çš„ NSFW å†…å®¹ã€å¸åœˆå¹¿å‘Šå’Œç°è‰²äº§ä¸šé“¾ã€‚ç§‘æŠ€èƒ½å¦å‘å–„ï¼Œåœ¨äºæˆ‘ä»¬èƒ½å¦çº¦æŸè‡ªå·±å†…å¿ƒçš„ é‚ªå¿µã€‚ ğŸ“± åªèƒ½ç”¨æ‰‹æœºå·ç æ³¨å†Œ å›½å¤–ï¼šæ‰‹æœºå·ä¸ç”¨å®ååˆ¶ï¼Œç›¸å¯¹å®‰å…¨ã€‚ å›½å†…ï¼šé€šè¿‡ Google Voice æ³¨å†Œç”µæŠ¥ï¼Œå¹¶ä¸”å¯ä»¥ç»•å¼€ç§èŠé™åˆ¶ã€‚ è€Œä¸”ï¼Œæ·»åŠ é™Œç”Ÿäººåˆ°é€šè®¯å½•ï¼ˆAdd to contactsï¼‰ï¼Œè®°å¾—æ¯æ¬¡éƒ½è¦å–æ¶ˆå‹¾é€‰ Share my phone number with ***ã€‚Telegram åœ¨è¿™ä¸ªæ–¹é¢ä¸Šæ²¡æœ‰è®°ä½ç”¨æˆ·ä¹ æƒ¯ï¼Œä¸åº”è¯¥å‘€ï¼Œæˆ‘å»åé¦ˆåé¦ˆã€‚ å¦å¤–ï¼Œå¦‚æœä½ çš„æ‰‹æœºå·ç ï¼Œè¢«æŸäººä¿å­˜åœ¨ Ta çš„æ‰‹æœºé€šè®¯å½•ï¼ŒTa ä¹Ÿå¼€æ”¾äº†é€šè®¯å½•ç»™ Telegramã€‚å½“ä½ ç”¨è¿™ä¸ªæ‰‹æœºå·ç æ³¨å†Œ Telegram åï¼ŒTa å°±ä¼šç¬¬ä¸€æ—¶é—´çŸ¥é“ä½ ä¹ŸåŠ å…¥ Telegram äº†ã€‚æ‰€ä»¥å¯¹éšç§æœ‰è¦æ±‚ï¼Œè¯·ä½¿ç”¨æ— éœ€å®åçš„è™šæ‹Ÿå·ç æˆ–è€…å•ç‹¬å°å·æ¥æ³¨å†Œã€‚ ğŸ—“ï¸ é€ƒç¦»å¾®ä¿¡æˆ‘ä¸ Telegram çš„ç»“ç¼˜ï¼Œå§‹äº 2016 å¹´æ˜¥ã€‚é‚£æ—¶æˆ‘åˆšå­¦ä¼šäº†ç§‘å­¦ä¸Šç½‘ï¼Œå¹¶ä¸‹è½½äº† Telegram è¿™ä¸ª Instant Messaging appã€‚è™½ç„¶æˆ‘åœ¨ç”µæŠ¥ä¸Šæ‰¾ä¸åˆ°æœ‹å‹å’Œæˆ‘èŠå¤©ï¼Œä½†æˆ‘å¹¶æ²¡æœ‰å¸è½½ Telegramï¼Œå› ä¸ºç›¸æ¯”è¾“å…¥æ³•å’Œå¾®ä¿¡ï¼ŒTelegram æä¾›äº†ä¸°å¯Œçš„ Emoji ä¾›æˆ‘é€‰æ‹©ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘åœ¨ Android æ‰‹æœºä¸Šä¹Ÿèƒ½ä½¿ç”¨æœ€æ–°çš„ Emoji ç‚¹ç¼€æœ‹å‹åœˆã€‚ è¿‘å¹´æ¥ï¼Œå¤©ä¸‹è‹¦å¾®ä¿¡ä¹…çŸ£ã€‚ WeChat æŒé—¨äººå¯èƒ½æ˜¯ä¸€ä¸ªæ— é©¬ï¼ˆç ï¼‰ä¸æ¬¢çš„ éª‘å…µï¼šæ¯æ¬¡ç™»å½•å¾®ä¿¡ç”µè„‘ç‰ˆéƒ½è¦æ‰«ç æ—¶ï¼Œæˆ‘çš„å¿ƒä¸­éƒ½ä¼šä¸‡é©¬å¥”è…¾ã€‚ åªèƒ½å‘é€å°äº 100 MB çš„æ–‡ä»¶ï¼›ä¸€æ¬¡åªèƒ½å‘é€ 9 å¼ å›¾ç‰‡ï¼Œè€Œä¸”æ¯æ¬¡å‘é€éƒ½è¦å‹¾é€‰åŸå›¾ï¼ˆTelegram ä¼šè®°ä½è¿™ä¸ªç”¨æˆ·ä¹ æƒ¯ï¼‰ï¼Œä¸‹è½½åŸå›¾æ–‡ä»¶åä¼šæ”¹å˜ã€‚ å ç”¨å·¨å¤§çš„å­˜å‚¨ç©ºé—´ï¼Œå¤‡ä»½ä¸åŒæ­¥çš„ä½“éªŒç‰¹åˆ«å·®ï¼Œä¹Ÿä¸èƒ½æ¢æˆæ¬§ç›Ÿå·ç å¯¼å‡ºç”¨æˆ·æ•°æ®ã€‚ æ³¨å†Œå¾®ä¿¡çš„æ—¶å€™ï¼Œç”¨æˆ·ä¼šé»˜è®¤åŒæ„ è…¾è®¯å¾®ä¿¡è½¯ä»¶è®¸å¯åŠæœåŠ¡åè®® ï¼Œå…¶ä¸­åœ¨ 7.1.2 æåˆ°ä¸€ä¸ªéœ¸ç‹æ¡æ¬¾ï¼šã€Œå¾®ä¿¡å¸å·çš„æ‰€æœ‰æƒå½’è…¾è®¯å…¬å¸æ‰€æœ‰ï¼Œç”¨æˆ·å®Œæˆç”³è¯·æ³¨å†Œæ‰‹ç»­åï¼Œä»…è·å¾—å¾®ä¿¡å¸å·çš„ä½¿ç”¨æƒï¼Œä¸”è¯¥ä½¿ç”¨æƒä»…å±äºåˆå§‹ç”³è¯·æ³¨å†Œäººã€‚â€¦â€¦ã€ã€‚ ç”¨æˆ·å…è´¹ä½¿ç”¨å¾®ä¿¡ï¼ˆæ— æ‰€æœ‰æƒï¼‰ï¼Œå¾®ä¿¡æ”¶é›†ç”¨æˆ·çš„ç§äººæ•°æ®ï¼Œè´©å–ç»™å¹¿å‘Šå•†ï¼Œè¿™æ— å¯åšéã€‚ä½†å½“ç”¨æˆ·æƒ³è¦å–å› Ta æ‰€åˆ›é€ çš„å†…å®¹ï¼ˆæ•°å­—èµ„äº§ï¼‰æ—¶ï¼Œä¾‹å¦‚å¯¼å‡ºå¾®ä¿¡ä¸ªäººæ•°æ®ï¼ˆæœ‹å‹åœˆæ•°æ®å’Œæ”¶è—åŠŸèƒ½æ•°æ®ç­‰ï¼‰ï¼Œåªå¥½å€ŸåŠ©æ¬§ç›Ÿçš„ GDPRï¼ˆé€šç”¨æ•°æ®ä¿æŠ¤æ¡ä¾‹ï¼‰è¡Œä½¿æ•°æ®å¯æºæƒã€‚äºæ˜¯æˆ‘èŠ±äº† 5.26 USDï¼ˆå«ç¨ï¼‰ä¹°äº†ä¸€ä¸ªæ¯”åˆ©æ—¶çš„æ‰‹æœºå·ç ï¼Œå¾®ä¿¡å´çŒ–è¨€é“ï¼šã€Œç”±äºå½“åœ°æ³•è§„é™åˆ¶ï¼ŒWeChat æš‚ä¸æ”¯æ´ä¸­å›½å¤§é™†ç”¨æˆ·å°†ç»‘å®šçš„æ‰‹æœºå·ç æ›´æ¢ä¸ºæ¬§ç›Ÿæ‰‹æœºå·ç ã€‚ã€ è¯·é—®æ˜¯å“ªæ¡ã€Œå½“åœ°æ³•è§„ã€ï¼Ÿè¿™ä¸æ˜¯ã€Œæ³•åˆ¶ã€ï¼Œè€Œæ˜¯ã€ŒFuck åˆ¶ã€ï¼šå¼ºå¥¸ä¸€ä¸ªä¸ªæ²¡æœ‰åæŠ—èƒ½åŠ›çš„ç”¨æˆ·ï¼2020-04-22 åŸè°…æˆ‘ã€Œå£åèŠ¬èŠ³ã€ï¼Œä¸æ‡‚ä¸­å›½ç‰¹è‰²ã€‚å¦å¤–ï¼Œéšç€è¨€è®ºå®¡æŸ¥åŠ›åº¦çš„åŠ å¤§ï¼Œä»»ä½•ã€Œé£å¹è‰åŠ¨ã€éƒ½è¦ã€Œæ–©è‰é™¤æ ¹ã€ï¼š Cyberspace Administration of Chinaï¼ˆç½‘ä¿¡åŠï¼‰ä¼šå› ä¸ºæˆ‘è½¬å‘ä¸€åˆ™å…³äº ä¸­åäººæ°‘å…±å’Œå›½å®ªæ³•ä¿®æ­£æ¡ˆ çš„ Twitter è¯„è®ºåˆ° 24 äººçš„å¾®ä¿¡åŒå­¦ç¾¤ï¼Œå‡ å°æ—¶åï¼Œè¯·æˆ‘åˆ°æœ€è¿‘çš„æ´¾å‡ºæ‰€ã€Œå–èŒ¶ã€ï¼Œé‚£æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åè­¦è½¦ã€‚ å¾®ä¿¡ä¸Šæ— æ³•å‘é€æŸäº›é“¾æ¥ï¼ˆä¾‹å¦‚çº½çº¦æ—¶æŠ¥çš„æ–‡ç« ï¼‰ï¼Œä¹Ÿä¸æ˜¾ç¤ºå‘é€å¤±è´¥ï¼Œè®©ä½ ä»¥ä¸ºå‘å‡ºå»äº†ï¼Œå…¶å®åªå¯¹ä½ å¯è§ã€‚ å¾®ä¿¡ä¼šç§‹åç®—è´¦ï¼Œåˆ é™¤æˆ‘ä¹‹å‰å†™çš„ä¸€ç¯‡ä»‹ç» æœç´¢æŠ€å·§ çš„å…¬ä¼—å·æ–‡ç« ï¼Œæ¥ç€ åšå®¢ åœ¨ä¸­å›½å¤§é™†åœ°åŒºè¢«å¢™ï¼Œå…¬ä¼—å· è¢«æ°¸ä¹…å°å·ã€‚è™½ç„¶å…¬ä¼—å·å†™äº† 4 å¹´åªæœ‰äº”ç™¾å¤šä¸ªå…³æ³¨è€…ï¼Œä½†æ¯ä¸€ä¸ªè®¢é˜…è€…éƒ½æ¥ä¹‹ä¸æ˜“ã€‚å°±è¿™æ ·ï¼Œæˆ‘è·Ÿè¯»è€…ä»¬éƒ½å¤±è”äº†ã€‚ ç»è¿‡ä¸€ç³»åˆ—å‘ç”Ÿæˆ‘èº«ä¸Šçš„ å±è”½äº‹ä»¶ åï¼Œè®©æˆ‘æ„è¯†åˆ°ä¸­æ–‡äº’è”ç½‘å·²ç»å®Œå…¨æ²¦é™·äº†ï¼Œäºæ˜¯é€ƒéš¾åˆ° Telegramã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„ä½¿ç”¨åï¼Œæˆ‘å½»åº•æˆä¸ºäº† Telegram çš„ è‡ªæ¥æ°´ï¼Œè§äººå°±å¤¸ã€‚ç„¶è€Œèº«è¾¹çš„äº²æœ‹å¥½å‹å´ä¸ä¸ºæ‰€åŠ¨ï¼Œä¸æ„¿è·Ÿæˆ‘ä¸€èµ· æ•°å­—ç§»æ°‘ åˆ°è¿™ä¸ªå¯ä»¥å®‰å¿ƒè¯´è¯çš„åœ°æ–¹ï¼Œç”˜æ„¿åšã€Œæ¸©å®¤é‡Œçš„èŠ±æœµã€å’Œã€Œç¬¼çš„ä¼ äººã€ï¼Œäº«å—è¡¨é¢ä¸Šçš„å²æœˆé™å¥½ã€‚æˆ‘ä¸ä¼šè´£æ€ª Ta ä»¬ï¼Œå¦‚æœä½ çœ‹è¿‡ã€Šè‚–ç”³å…‹çš„æ•‘èµã€‹ï¼Œå°±èƒ½ç†è§£è¿™ç§ã€Œæ”¾å¼ƒæŠ—äº‰ã€çš„å¿ƒæ€ã€‚ åˆšå…¥ç‹±çš„æ—¶å€™ï¼Œä½ ç—›æ¨å‘¨å›´çš„é«˜å¢™ï¼Œæ…¢æ…¢åœ°ï¼Œä½ ä¹ æƒ¯äº†ç”Ÿæ´»åœ¨å…¶ä¸­ï¼Œæœ€ç»ˆä½ å‘ç°ï¼Œè‡ªå·±ä¸å¾—ä¸ä¾é å®ƒè€Œç”Ÿå­˜ã€‚by The Shawshank Redemption æ—¢ç„¶è¯´ä¸åŠ¨è®¤è¯†æˆ‘çš„äººï¼Œä½†ä¸–ç•Œé‚£ä¹ˆå¤§ï¼Œäººå£é‚£ä¹ˆå¤šï¼Œç½‘ç»œä¸–ç•Œä¸Šä¸€å®šæœ‰ä¸€ç¾¤äººï¼ŒTa ä»¬å’Œæˆ‘ä¸€æ ·ï¼Œåæ„Ÿã€Œæ¸©å®¤å›­ä¸ã€ä¸é€æ˜çš„åšæ³•ï¼Œä¸æ„¿åšä¸€åªæ•°å­—å†œåœºé‡Œçš„ç”µå­ç»µç¾Šï¼Œç›¸ä¿¡ã€Œè‡ªç”±ä»·æ›´é«˜ã€ã€‚ æˆ‘è¦å½“ä¸€ä¸ª è¸¹è½¦è½® çš„äººï¼Œä¸ºæˆ‘å¿ƒä¸­çš„ç†æƒ³ä¸–ç•ŒæŠ•ç¥¨ã€‚å› æ­¤æˆ‘ç†¬äº†å‡ ä¸ªæœˆï¼ŒæŠŠ Telegram å®˜ç½‘çš„ FAQ å’Œ Blog å…¨éƒ¨çœ‹å®Œäº†ï¼ˆä» 2013 å¹´åˆ›ç«‹ç”µæŠ¥è‡³ä»Šï¼‰ï¼Œç»“åˆ Google æœç´¢å¼•æ“æ—å¾åšå¼•ï¼Œæ•´ç†å‡ºè¿™ç¯‡å¯èƒ½æ˜¯ä¸­æ–‡äº’è”ç½‘å†…å®¹æœ€ç¿”å®ï¼Œæ’ç‰ˆæœ€ç²¾ç¾çš„ã€Šç”µæŠ¥æŒ‡å—ã€‹ï¼Œç›®çš„å°±æ˜¯å°½å¯èƒ½åœ°ä¸ºè¯»è€…å‘ˆç° Telegram çš„å¼ºå¤§ã€ç§å¯†ä»¥åŠå‹å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ åœ¨ Durovâ€™s Chat ç”¨è¹©è„šçš„ä¸­å¼è‹±è¯­ç»™æ•™ç¨‹åšæ¨å¹¿ï¼Œå—åˆ° Pavel çš„è‚¯å®šã€‚ 2016 å¹´å›½åº†ï¼Œæˆ‘èŠ±äº†ä¸€å‘¨æ—¶é—´çœ‹å®Œäº†ã€Œå³åˆ» appã€çš„æ‰€æœ‰ä¸»é¢˜ï¼ˆåœˆå­ï¼‰ï¼Œå†™äº†ä¸€ç¯‡ä¸‰åƒå¤šå­—æ–‡ç« ï¼šã€Šå³åˆ» App - ä¸å†é”™è¿‡ä½ æ„Ÿå…´è¶£çš„èµ„è®¯ã€‹(å›¾æ–‡ç‰ˆ | æ–‡å­—ç‰ˆï¼‰ã€‚å³åˆ»å·²ç»æ²¡æœ‰å¤æ´»çš„å¯èƒ½äº†ï¼ˆå³åˆ» App å±…ç„¶åœ¨ 2020 å¹´ 6 æœˆ 10 æ—¥å›æ¥äº†ï¼Œä½†æ˜¯ç¼ºå¤±äº†è¯é¢˜è¿½è¸ªåŠŸèƒ½ï¼‰ï¼ŒTelegram é¡ºåŠ¿æˆäº†æ–°çš„èµ„è®¯ä¸­å¿ƒã€‚ äººç”Ÿè‹¦çŸ­ï¼Œé€ƒç¦»å¾®ä¿¡ï¼ˆEscape from the WeChatï¼‰ã€‚stay-away-from-wechat é¡¹ç›®æ”¶é›†å¾®ä¿¡çš„åäººæ€§è®¾è®¡ã€æ— ç†å®¡æŸ¥è¡Œä¸ºã€ä¾µçŠ¯ç”¨æˆ·éšç§ã€ç›‘æ§èŠå¤©è®°å½•ã€è¯•å›¾æ§åˆ¶äººæ°‘ç”Ÿæ´»ç›¸å…³ä¿¡æ¯ï¼ŒæœŸæœ›ç”¨æˆ·è®¤è¯†åˆ°å¾®ä¿¡çš„å¼Šç—…ï¼Œå€¡å¯¼ç”¨æˆ·ç”¨è„šæŠ•ç¥¨ã€æ‹’ç»ä½¿ç”¨å¾®ä¿¡ ğŸ‘ï¸ã€‚æ¬¢è¿æäº¤ Issues å’Œ Pull requests ğŸ¤–ï¸ã€‚ æ¬¢è¿è¯»è€…ä»¬è½¬ç§»åˆ°æ²¡æœ‰ç›‘æ§å’Œå®¡æŸ¥çš„åœ°æ–¹ ï¼Œä¸€èµ·åœ¨è¿™ç‰‡ä¹åœŸä¸Šè¿‡ä¸Šæ²¡ç¾æ²¡è‡Šä½“é¢çš„æ•°å­—ç”Ÿæ´»ã€‚ ğŸŒŸ æ³¨å†Œä½¿ç”¨æ¥ä¸‹æ¥ï¼Œå°±æ­£å¼è¿›å…¥ä¸»é¢˜ï¼Œæ•™è¯»è€…æœ‹å‹ä»¬ç”µæŠ¥æ€ä¹ˆä½¿ç”¨ã€‚ ğŸ‘‡ ä¸‹è½½ç™»å½•è¯·è¿›å…¥ Telegram Apps çš„å®˜æ–¹ä¸‹è½½é¡µé¢ï¼Œé€‰æ‹©å¯¹åº”çš„å¹³å°ï¼Œä¸‹è½½ï¼Œå®‰è£…ï¼Œæ³¨å†Œã€‚ è‡ªç”±å¼€æ”¾çš„ Telegram åœ¨å„å¹³å°éƒ½æœ‰æ•°åç§å®¢æˆ·ç«¯ï¼Œå„æœ‰å“ªäº›ä¼˜ç¼ºç‚¹ï¼Œåˆè¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿè¯·æŸ¥é˜… Telegram å®¢æˆ·ç«¯ç‰ˆæœ¬æ¯”è¾ƒï¼Œä½†æˆ‘ä¸æ¨èä½¿ç”¨ç¬¬ä¸‰æ–¹ç”µæŠ¥å®¢æˆ·ç«¯ï¼Œå®‰å…¨æ²¡æœ‰ä¿è¯ã€‚ å¦‚æœä½ æœ‰æ³¨å†Œæˆ–ç™»å½•é—®é¢˜ å…ˆä» å¸¸è§ç™»å½•é—®é¢˜ ä¸­å¯»æ‰¾æ–¹æ³•ï¼Œæ— æœï¼Œè”ç³» Telegramï¼š é€”å¾„ä¸€ï¼šè¯·ä½¿ç”¨æ­¤ è¡¨æ ¼ ä¸ Telegram è”ç³» é€”å¾„äºŒï¼šåœ¨ Twitter ä¸Šè”ç³» Telegram Login Help ä¸çŸ¥ä½•ç§åŸå› é­åˆ°å°ç¦ï¼Œè¯·å†™é‚®ä»¶ç»™ &#114;&#x65;&#99;&#111;&#118;&#101;&#x72;&#x40;&#116;&#101;&#108;&#101;&#x67;&#x72;&#97;&#x6d;&#46;&#111;&#x72;&#x67; ç”¨è‹±æ–‡å†™ Email ç”¨ å›½é™…ç”µè¯å·ç æ ¼å¼ ä¹¦å†™è¢«å°çš„æ‰‹æœºå·ç ï¼ˆä¸­å›½çš„å›½å®¶ä»£ç ä¸º +86ï¼Œç¾å›½çš„ +1ï¼‰ çœŸäººå€¼ç­ï¼Œå¤§æ¦‚ 24 å°å†…å°±ä¼šè¢«è§£å°ã€‚ä½†è¿å Telegram æœåŠ¡æ¡æ¬¾ï¼ˆTerms of Serviceï¼‰ï¼Œä¾‹å¦‚ä¹±å‘å¹¿å‘Šï¼Œæ˜¯ä¸ä¼šè¢«è§£å°çš„ã€‚ å‚è€ƒèµ„æ–™ï¼š è®°ä¸€æ¬¡æˆåŠŸçš„ Telegram è´¦å·è§£å° by @askahh Telegram å®˜æ–¹å°ç¦çš„è´¦å·ä¼šå—åˆ°ä»€ä¹ˆå¤„ç½š by @TGgeek å¦‚ä½•åœ¨ç”µè„‘ä¸Šä½¿ç”¨ Telegram for Desktop æ‰“å¼€å®¢æˆ·ç«¯ ç‚¹å‡»å³ä¸Šè§’çš„ SETTINGSï¼ˆè®¾ç½®ï¼‰&gt; Connection typeï¼ˆè¿æ¥ç±»å‹ï¼‰&gt; Use custom proxyï¼ˆä½¿ç”¨è‡ªå®šä¹‰ä»£ç†ï¼‰&gt; ADD PROXYï¼ˆæ·»åŠ ä»£ç†ï¼‰ï¼Œä»¥ Shadowsocks(R) ä¸ºä¾‹ï¼š SOCKS Hostname: 127.0.0.1 Port: 1080ï¼ˆä¸åŒçš„ç¿»å¢™å®¢æˆ·ç«¯ï¼Œç«¯å£ç•¥æœ‰ä¸åŒï¼‰ ä½¿ç”¨ Clash ç¿»å¢™çš„ç”¨æˆ·ï¼Œå¯è·³è¿‡è¿™ä¸€æ­¥ï¼Œé€‰æ‹© Use system proxy settingsï¼ˆä½¿ç”¨ç³»ç»Ÿä»£ç†è®¾ç½®ï¼‰ã€‚ ğŸ¼ æ±‰åŒ–ç•Œé¢æ—¢ç„¶å·²ç»å‡ºæ¥æ··äº†ï¼ˆçªç ´ç½‘ç»œå¢™ï¼‰ï¼Œé¦–é€‰ä½¿ç”¨è‹±æ–‡ç‰ˆçš„ Telegramï¼ˆçªç ´è¯­è¨€å¢™ï¼‰ï¼Œå¥½åƒåŠ èµ·æ¥ä¹Ÿæ²¡å‡ ä¸ªå•è¯ã€‚è¦æ˜¯ä¸€ç‚¹è‹±æ–‡åº•å­éƒ½æ²¡æœ‰ï¼š ç‚¹æ­¤å®‰è£…å®˜æ–¹ç®€ä½“ä¸­æ–‡è¯­è¨€åŒ… é€‰æ‹© CHANGEï¼ˆæ›´æ”¹ï¼‰ å³å¯æŠŠç•Œé¢è¯­è¨€æ›¿æ¢ä¸ºç®€ä½“ä¸­æ–‡ æˆªè‡³ 2020 å¹´ 11 æœˆ 01 æ—¥ï¼ŒTelegram for Android ç¿»è¯‘å·²å®Œæˆ 95% äº†ï¼Œä½†ä¸å¦¨ç¢æ—¥å¸¸ä½¿ç”¨ã€‚ ğŸ”’ è´¦å·è®¾ç½® æ”¯æŒè§†é¢‘å¤´åƒï¼ˆProfile Videosï¼‰ã€‚ æ”¯æŒç™»å½•å¤šä¸ªè´¦å·ã€‚æ‰‹æœºç«¯é•¿æŒ‰å¦ä¸€ä¸ªè´¦å·ï¼Œä¸åˆ‡æ¢è´¦å·ï¼Œä¹Ÿèƒ½å¿«é€Ÿé¢„è§ˆæ¶ˆæ¯ã€‚Multiple accounts: preview chat list. You can press and hold on another connected account in Settings for a sneak peek of its chats list. ğŸ‘¤ è®¾ç½®ç”¨æˆ·åä½ å¯ä»¥åœ¨ Settingï¼ˆè®¾ç½®ï¼‰é‡Œé¢å¡«å†™ä¸€ä¸ª Usernameï¼ˆç”¨æˆ·åï¼‰ã€‚è®¾ç½®åï¼Œåˆ«äººèƒ½å¤Ÿåœ¨ä¸çŸ¥é“ä½ çš„ç”µè¯å·ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡æœç´¢ç”¨æˆ·åæ‰¾åˆ°ä½ ã€‚ ç”¨æˆ·åå¯ä»¥éšæ—¶æ›´æ”¹æˆ–åˆ é™¤ï¼ˆç”¨æˆ·åä¸ºç©ºï¼‰ã€‚ ç”¨æˆ·åä¸åŒºåˆ†å¤§å°å†™ï¼ˆTingTalk &#x3D; tingtalkï¼‰ï¼Œä½† Telegram ä¼šè®°ä½å¤§å°å†™åå¥½ã€‚ ä¾µæƒ å¦‚æœä¸€ä¸ªéª—å­å‡è£…æ˜¯ä½ ï¼Œè”ç³» @notoscamã€‚ å¦‚ä½•ä¸¾æŠ¥å‡å†’çš„é¢‘é“æˆ–ç¾¤ç»„ï¼šç‚¹å‡»å³ä¸Šè§’çš„ ... &gt; Report &gt; Fake Account é’ˆå¯¹å“ç‰Œæ–¹ï¼Œç”¨æˆ·åè¢«å ç”¨æ€ä¹ˆåŠï¼ŸæŠŠä½ åœ¨ Facebookã€Twitter æˆ– Instagram çš„ç”¨æˆ·åï¼ˆä¸¤ä¸ªå¹³å°ä»¥ä¸Šï¼‰å‘ç»™ @username_botã€‚ å¦‚æœä½ çœ‹åˆ°è¡¨æƒ…åŒ…ï¼ˆsticker setsï¼‰ã€é¢‘é“ï¼ˆchannelsï¼‰æˆ–æœºå™¨äººï¼ˆbotsï¼‰ä¾µçŠ¯äº†ä½ çš„ç‰ˆæƒï¼Œè¯·æäº¤æŠ•è¯‰åˆ° &#100;&#109;&#99;&#x61;&#x40;&#116;&#101;&#108;&#x65;&#103;&#114;&#x61;&#x6d;&#x2e;&#x6f;&#x72;&#x67; è”ç³»äºº æ·»åŠ å’Œåˆ é™¤è”ç³»äººï¼ˆContactsï¼‰éƒ½æ˜¯å•å‘æ“ä½œï¼ŒåŒæ–¹çš„é€šè®¯å½•éƒ½æ˜¯ç‹¬ç«‹çš„ï¼ˆä½ ä¸­æœ‰æˆ‘ï¼Œæˆ‘ä¸­å¯èƒ½æ²¡æœ‰ä½ ï¼‰ï¼Œä¹Ÿæ²¡æœ‰é€šçŸ¥ã€‚ ï¼ˆå•å‘ï¼‰æ·»åŠ è”ç³»äººä¹‹åï¼ŒåŠ å…¥å…±åŒå°ç»„åï¼Œé€šè®¯å½•å¥½å‹ä¼šæ’åœ¨å°ç»„åå•å‰é¢ã€‚å¦‚æœä½ æƒ³åŠ å…¥ä¸€äº›ä¸æƒ³è®©åˆ«äººçŸ¥é“çš„ç¾¤ç»„ï¼Œè¿˜æ˜¯ç”¨å°å·å§ã€‚ ç‚¹å‡»å·¦ä¾§èœå•æ  &gt; Contactsï¼ˆè”ç³»äººï¼‰&gt; Find People Nearbyï¼ˆå¯»æ‰¾é™„è¿‘çš„äººï¼‰ã€‚ä½ ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªåŸºäºæœ¬åœ°çš„ç¾¤èŠã€‚ ğŸ”“ è§£é™¤ç§èŠé™åˆ¶è‡ªç”±çš„åœŸå£¤å¸å¼•äº†æ¯”ç‰¹å¸ã€ç¤¾å·¥åº“ã€NSFW ç­‰ç°è‰²äº§ä¸šåˆ°ç”µæŠ¥é‡è›®ç”Ÿé•¿ï¼Œå› ä¸ºè¿™äº›å›½äº§è€é¼ å±å¯¹ç”µæŠ¥çš„æ»¥ç”¨ï¼Œå¯¼è‡´ä½¿ç”¨ä¸­å›½å¤§é™†çš„æ‰‹æœºå·ç ï¼ˆ+86ï¼‰æ³¨å†Œ Telegram åï¼Œç§èŠ Ta äººæ—¶ï¼Œå¯èƒ½ä¼šæç¤º Sorry, you can only send messages to mutual contacts at the momet.ï¼ˆå¯¹ä¸èµ·ï¼Œä½ ç°åœ¨åªèƒ½å‘é€ç§ä¿¡ç»™åŒå‘è”ç³»äººã€‚ï¼‰ï¼Œè¿™è¡¨æ˜æ­¤è´¦å·è¢«åˆ¤å®šä¸º Spamï¼ˆåƒåœ¾ä¿¡æ¯ï¼‰è´¦å·äº†ã€‚ å¦‚ä½•è§£é™¤ç§èŠé™åˆ¶ï¼šåœ¨ Telegram æœç´¢ @SpamBotï¼Œç‚¹å‡» STARTï¼Œç„¶åä¾æ¬¡ç‚¹å‡»åº•éƒ¨å‡ºç°çš„èœå•æˆ–å›å¤ä»¥ä¸‹è¯æœ¯ï¼ˆä»…ä¾›å‚è€ƒï¼‰ï¼š But I canâ€™t message non-contacts. No, Iâ€™ll never do any of this. I canâ€™t chat with non-contacts. Accident. å¤§æ¦‚åŠå°æ—¶ä¹‹åï¼ˆæœ‰äº›äººè¦åå‡ å¤©ï¼‰ï¼Œå³å¯è§£é™¤ç¦è¨€ã€‚ å¦å¤–ï¼Œè‹¥ç”¨æˆ·åœ¨ 24 å°æ—¶å†…è®¿é—®è¶…è¿‡ 200 ä¸ªç¾¤ç»„æˆ–é¢‘é“çš„é“¾æ¥ï¼ˆç‚¹å‡»æ‰“å¼€å°±ç®—è®¿é—®ï¼Œä¸éœ€è¦åŠ å…¥ï¼‰ï¼Œå°±ä¼šè¢«æ‰“å…¥å†·å®« 24 å°æ—¶ã€‚ç¦é—­æœŸé—´ï¼Œæ— æ³•é€šè¿‡é“¾æ¥è®¿é—®æ–°çš„ç¾¤ç»„æˆ–é¢‘é“ï¼ˆç‚¹å‡»é“¾æ¥ä¸€ç›´è½¬åœˆè€Œæ— æ³•è®¿é—®ï¼‰ã€‚ â›‘ï¸ éšç§å’Œå®‰å…¨ä¾æ¬¡ç‚¹å‡» Settingï¼ˆè®¾ç½®ï¼‰&gt; Privacy and Securityï¼ˆéšç§å’Œå®‰å…¨ï¼‰ ğŸ™ˆ éšè—æ‰‹æœºå·ç Phone numberï¼ˆæ‰‹æœºå·ç ï¼‰&gt; Who can see my phone numberï¼ˆè°å¯ä»¥çœ‹åˆ°æˆ‘çš„æ‰‹æœºå·ç ï¼šNobody ä¸å…è®¸ä»»ä½•äººï¼‰ å¯¹éšç§æœ‰è¦æ±‚ï¼Œæˆ–è€…å½»åº•è§£é™¤ +86 å¼€å¤´çš„æ‰‹æœºå·ç çš„ç§èŠé™åˆ¶ï¼Œå¯ä»¥æŠŠæ‰‹æœºå·ç æ¢ç»‘åˆ°éä¸­å›½åŒºçš„æ‰‹æœºå·ç ï¼Œä¾‹å¦‚ Google Voiceï¼š æ³¨å†Œ Google è´¦å·ã€‚ åœ¨ Google æˆ–æ·˜å®ä¸Šæœç´¢å…³é”®è¯ Google Voice æˆ– GV ï¼Œè´­ä¹°åˆ«äººæ³¨å†Œä¸‹æ¥çš„å·ç ã€‚ è½¬ç§»åˆ°è‡ªå·±çš„ Google è´¦å·ä¸Šã€‚ ä»¥åŠ ğŸ§¨ å†æ¬¡å¼ºè°ƒï¼šæ·»åŠ é™Œç”Ÿäººåˆ°é€šè®¯å½•ï¼ˆAdd to contactsï¼‰ï¼Œè®°å¾—æ¯æ¬¡éƒ½è¦å–æ¶ˆå‹¾é€‰ Share my phone number with ***ã€‚ å¼€å¯ SIM å¡çš„å¯†ç ï¼Œçºµä½¿åˆ«äººæ¡åˆ°ä½ çš„æ‰‹æœºï¼ˆå¡ï¼‰ï¼Œæ²¡æœ‰ PIN ç å°±ä¸èƒ½ä½¿ç”¨ä½ çš„æ‰‹æœºå·ç ï¼Œä¹Ÿå°±ä¸èƒ½æ”¶åˆ°ç™»å½•éªŒè¯ç ï¼Œä»¥æ­¤æ¥ç™»å½• Telegramã€‚ ğŸ­ åŒ¿åè½¬å‘Forwarded messages: Nobodyï¼ˆå¼•ç”¨è½¬å‘æ¥æºï¼šä¸å…è®¸ä»»ä½•äººï¼‰ å¯ç”¨æ­¤è®¾ç½®åï¼Œè½¬å‘ä½ çš„æ¶ˆæ¯å°†æ— æ³•æŒ‡å‘ï¼ˆé“¾æ¥ï¼‰å›ä½ çš„å¸æˆ·ï¼Œåªä¼šåœ¨ From ***ï¼ˆæ¥è‡ª***ï¼‰å­—æ®µä¸­æ˜¾ç¤ºä¸€ä¸ªæ— æ³•ç‚¹å‡»çš„æ˜µç§°ï¼ˆéç”¨æˆ·åï¼‰ã€‚è€Œæ˜µç§°ä¸æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°†æ²¡æœ‰è¯æ®è¯æ˜æŸæ¡æ¶ˆæ¯æ˜¯ä½ å‘é€çš„ï¼ˆæ— æ³•æº¯æºï¼‰ã€‚ ğŸ“ éšè—é€šè¯ IP åœ°å€Calls &gt; Peer-to-Peerï¼šNobody Telegram ä¸ºäº†æé«˜è¯­éŸ³é€šè¯çš„è´¨é‡ï¼Œé»˜è®¤é‡‡ç”¨ç«¯å¯¹ç«¯è¿æ¥ï¼ˆPeer-to-Peerï¼‰ã€‚ç”±äºæµé‡æ²¡æœ‰ç»è¿‡ Telegram æœåŠ¡å™¨ä¸­è½¬ï¼Œæ‰€ä»¥ä¼šæš´éœ²ç”¨æˆ·çš„ IP åœ°å€ã€‚ä½†æ˜¯ç¦ç”¨ç«¯å¯¹ç«¯é€šè¯åï¼Œé€šè¯è´¨é‡ä¼šç•¥æœ‰ä¸‹é™ã€‚ å¦å¤–ï¼Œé…åˆä½¿ç”¨ Torï¼ˆThe Onion Routerã€æ´‹è‘±è·¯ç”±å™¨ï¼‰å¯ä»¥éšè—ç”¨æˆ·çœŸå® IP åœ°å€ã€é¿å…ç½‘ç»œç›‘æ§åŠæµé‡åˆ†æã€‚ ğŸ” æœ¬æœºé”å®šç Passcode Lock ç›¸å½“äºç»™ Telegram åŠ ä¸Šåº”ç”¨é”ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸´æ—¶å€Ÿç”¨ä½ è®¾å¤‡çš„äººä¹Ÿçœ‹ä¸åˆ°ä½ çš„å°ç§˜å¯†ã€‚ è®¾ç½®å®Œå¯†ç é”ä¹‹åï¼Œå¯ä»¥åœ¨ä¸‹æ–¹çš„è‡ªåŠ¨é”ï¼ˆAuto-lockï¼‰è®¾å®šæ—¶é•¿ï¼Œä¸€æ—¦è¶…è¿‡æ—¶é•¿æœªæ“ä½œï¼Œé‚£ä¹ˆ Telegram å°†è‡ªåŠ¨ä¸Šé”ã€‚æˆ–è€…åœ¨èŠå¤©åˆ—è¡¨é¡µé¢ä¸Šä¸»åŠ¨ç‚¹å‡»é”å¤´å›¾æ ‡ï¼ŒTelegram å°±ä¼šç«‹å³é”å®šåº”ç”¨ï¼Œæ–°æ¶ˆæ¯é€šçŸ¥å°†ä¸åŒ…æ‹¬æ–‡æœ¬æˆ–å‘ä»¶äººå§“åã€‚å†æ¬¡è¿›å…¥åº”ç”¨æ—¶ï¼Œè¦æ±‚è¾“å…¥é”å®šç ã€‚ åœ¨ Android å®¢æˆ·ç«¯ä¸Šï¼Œè¿˜å¯ä»¥å…³é—­ã€Œåœ¨ä»»åŠ¡åˆ‡æ¢é¡µé¢æ˜¾ç¤ºå†…å®¹ã€ï¼ˆShow App Content in Task Switcherï¼‰ï¼ŒåŒæ—¶åœ¨ Telegram å†…ä¹Ÿæ— æ³•æˆªå±ã€‚ å¯†ç é”åªåœ¨å½“å‰è®¾å¤‡å¯ç”¨ï¼Œä¸ä¼šåŒæ­¥åˆ°äº‘ç«¯æˆ–å…¶ä»–è®¾å¤‡ï¼Œæ‰€ä»¥åœ¨ä¸åŒçš„è®¾å¤‡ä¸Šå¯ä»¥è®¾ç½®ä¸åŒçš„å¯†ç é”ã€‚å¦‚æœå¿˜è®°ï¼Œåªèƒ½é‡è£… Appï¼Œè€Œä¸”é‡æ–°ç™»å½•ä¹‹åï¼Œéœ€è¦é‡æ–°è®¾ç½®æ–°çš„å¯†ç é”ï¼Œç§å¯†èŠå¤©ï¼ˆSecret Chatï¼‰ä¹Ÿä¸ä¼šåŒæ­¥å›æ¥ã€‚ âœŒï¸ ä¸¤æ­¥éªŒè¯Two-step verificationï¼ˆä¸¤æ­¥éªŒè¯ï¼šæ·»åŠ å¯†ç æç¤ºå’Œ â—ï¸ å®‰å…¨é‚®ç®± â—ï¸ï¼‰ ä»¥åç™»å½•æ—¶ï¼Œè¾“å…¥éªŒè¯ç åï¼Œè¿˜è¦è¾“å…¥å¯†ç ã€‚ å®‰å…¨å¯†ç ï¼šè¯·å‹¿ä½¿ç”¨çº¯æ•°å­—å¯†ç ï¼Œå¯ä½¿ç”¨å¼€æºçš„ KeePass ç”Ÿæˆé«˜å¼ºåº¦å¯†ç ã€‚ ç”µå­é‚®ç®±ï¼šå¿˜è®°å¯†ç ï¼Œå¯ä»¥é€šè¿‡ Email æ‰¾å›å¯†ç ã€‚å°½é‡é€‰æ‹©å›½å¤–é‚®ç®±æœåŠ¡ï¼Œä¾‹å¦‚ Gmail æˆ–è€… Outlook ğŸ’¥ åˆ é™¤è´¦æˆ·Delete my account if away for 1 month/3 months/6 months/1 year ï¼ˆåˆ é™¤æˆ‘çš„å¸æˆ·è‹¥ç¦»çº¿æ—¶é—´è¾¾ 1 ä¸ªæœˆ &#x2F; 3 ä¸ªæœˆ &#x2F; 6 ä¸ªæœˆ &#x2F; 1 å¹´ï¼‰ è‡ªåŠ¨åˆ é™¤ï¼šä»¥ä¸Šå°±æ˜¯ç”µæŠ¥è‡ªå¸¦è´¦æˆ·è‡ªæ¯æœºåˆ¶ï¼ˆAccount Self-Destructionï¼‰ ä¸»åŠ¨åˆ é™¤ï¼šä¸æƒ³ä½¿ç”¨æ­¤è´¦å·ï¼Œå¯ æ°¸ä¹…åˆ é™¤è´¦æˆ·ï¼ˆDelete Accountï¼‰ ä¸ºä»€ä¹ˆè¦ç»™è´¦æˆ·è®¾ç½®è‡ªæ¯æœºåˆ¶ Telegram ä½œä¸ºä¸€ä¸ªå…è´¹çš„éå•†ä¸šè½¯ä»¶ï¼Œæ²¡æœ‰ä»»ä½•æ”¶å…¥æ¥æºï¼Œä¸ºäº†èŠ‚çº¦æœåŠ¡å™¨çš„å­˜å‚¨ç©ºé—´ï¼ŒTelegram ä¼šè‡ªåŠ¨åˆ é™¤é•¿æ—¶é—´ä¸ä¸Šçº¿çš„ç”¨æˆ·ã€‚å†è¯´äº†ï¼ŒTelegram ä¹Ÿä¸éœ€è¦ä½ çš„ç§äººæ•°æ®ã€‚ å¦‚æœä¸æ…ä¸¢å¤±äº† SIMï¼ˆæ‰‹æœºå¡ï¼‰ï¼Œæ­¤å‰æœªå¼€å¯ SIM å¡çš„ PIN ç ï¼ˆå¼ºçƒˆå»ºè®®å¼€å¯ï¼‰å’Œ Telegram è´¦æˆ·çš„ä¸¤æ­¥éªŒè¯ï¼Œæ–°çš„ã€Œä¸»äººã€å°±èƒ½æŠŠä½ çš„ Telegram è´¦å·å ä¸ºå·±æœ‰ã€‚ä½†æ˜¯å‡å¦‚ä½ è®¾ç½®äº† 1 ä¸ªæœˆä¸ä¸Šçº¿å°±é”€æˆ·ï¼Œåäººåœ¨ç¬¬ 32 å¤©æ¡åˆ°ä½ çš„æ‰‹æœºï¼Œä¸è¿‡æ­¤æ—¶ä½ çš„ Telegram è´¦å·å·²ç»ä¸å­˜åœ¨äº†ã€‚ ğŸ›¡ï¸ å…¶å®ƒéšç§è®¾ç½® ä½¿ç”¨æ²¡æœ‰ä¸ªäººç‰¹å¾çš„å¤´åƒï¼ˆè®°å¾—åœ¨ä¸ªäººèµ„æ–™é‡Œåˆ é™¤å†å²å¤´åƒï¼‰ã€æ˜µç§°å’Œç”¨æˆ·åï¼Œç¡®ä¿ç¡…åŸºèº«ä»½ä¸ä¼šå’Œç¢³åŸºèº«ä»½äº§ç”Ÿå…³è”ã€‚ ä¸ä½¿ç”¨ Touch ID æˆ– Face ID è§£é”ä½ çš„æ‰‹æœºï¼Œåªä»¥å¯†ç é”å±ï¼ˆæ•°å­— + å­—æ¯ï¼‰ï¼Œä»¥å…è¢«ã€Œæ‰§æ³•äººå‘˜ã€æ§åˆ¶èº«ä½“åå¼ºè¡Œè§£é”ã€‚ ğŸ’¬ å¯¹è¯ç•Œé¢Telegram æœ‰ä¸€ä¸ªéå¸¸äººæ€§åŒ–çš„ç‰¹æ€§ï¼šè®°å¿†æµè§ˆè¿›åº¦ï¼Œæ‰“å¼€å¯¹è¯ç•Œé¢ä¼šè‡ªåŠ¨è·³è½¬åˆ°æœªè¯»æ¶ˆæ¯ Unread Messagesï¼ˆThe app restores your previous scroll position when you switch back to a chatï¼‰æˆ–è€…ä¸Šæ¬¡çš„æœªè¯»ä½ç½®ã€‚çºµä½¿é‡æ–°å®‰è£… Telegramï¼Œæ²¡çœ‹å®Œçš„æ¶ˆæ¯ï¼ŒçŠ¶æ€ä¾æ—§æ˜¯æœªè¯»çš„ã€‚ âœï¸ æ¶ˆæ¯å‘é€å‰æ‰“ä¸Šå¥å·ä¹‹å‰ï¼Œæ£€æŸ¥ä¸€éå†…å®¹æ˜¯å¦æœ‰è¯¯ï¼Œè™½ç„¶ Telegram æ”¯æŒæ— é™æœŸçš„ï¼ˆæ’¤å›ï¼‰ä¿®æ”¹ã€‚ â†©ï¸ å¼•ç”¨æ¶ˆæ¯æ‰‹æœº å·¦æ»‘ï¼ˆSwipe leftï¼‰Reply æ¶ˆæ¯ã€‚ é•¿æŒ‰ï¼Œåœ¨å¼¹å‡ºçš„ç•Œé¢ä¸­é€‰æ‹© Replyã€‚ ç”µè„‘ å·¦é”®åŒå‡»æ¶ˆæ¯çš„ç©ºç™½å¤„ï¼Œä¾‹å¦‚åœ¨æ—¶é—´é™„è¿‘ã€‚ å·¦é”®å•å‡»å¯¹è¯æ¡†çš„å³ä¸Šè§’çš„ Replyã€‚ å³å‡»æ¶ˆæ¯ï¼Œåœ¨å¼¹å‡ºçš„èœå•ä¸­é€‰æ‹© Replyã€‚ ç‚¹å‡»å¼•ç”¨çš„æ¶ˆæ¯ï¼Œå°±ä¼šå‘ä¸Šæ»šåŠ¨åˆ°åŸå§‹æ¶ˆæ¯ï¼ˆIf you tap on the quote, the app scrolls up to the original messageï¼‰ã€‚ å‡è®¾ä» Unread Messages å¼€å§‹æµè§ˆåŠ¨æ€ï¼ˆå·²å‘å¸ƒ 120 æ¡ Postï¼‰ï¼Œé‡åˆ°æ–°æ¶ˆæ¯å¼•ç”¨äº†æ—§æ¶ˆæ¯ï¼Œä¾‹å¦‚åº­è¯´é¢‘é“çš„ç¬¬ 100 æ¡æ¶ˆæ¯ https://t.me/tingtalk/100 å¼•ç”¨ç¬¬ 56 æ¡æ¶ˆæ¯ https://t.me/tingtalk/56ï¼Œç‚¹å‡»å¼•ç”¨çš„æ¶ˆæ¯ï¼Œå³å¯å®šä½åˆ°ç¬¬ 56 æ¡æ¶ˆæ¯ã€‚å¦‚ä½•å›åˆ°ç¬¬ 100 æ¡æ¶ˆæ¯ï¼Œç‚¹å‡»å³ä¸‹è§’çš„ ğŸ”½ å°±ä¼šå›åˆ°ç¬¬ 100 æ¡æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯å›åˆ°æœ€æ–°çš„æ¶ˆæ¯ï¼ˆshows an arrow button to go back to the previous location. This makes navigating conversations in groups easy even if youâ€™ve been away for a whileï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸åŠ¨äººçš„ç»†èŠ‚ï¼Œæ·±æ·±åœ°è¢« Telegram æŠ˜æœã€‚ ç”µè„‘å³å‡» &#x2F; æ‰‹æœºç‚¹æŒ‰è¢«å¼•ç”¨æ¶ˆæ¯ï¼ˆå³ä¸‹è§’æœ‰ä¸ª â†¶ï¼‰ï¼Œåœ¨å¼¹å‡ºçš„èœå•é‡Œé€‰æ‹© View * Replyï¼Œå°±èƒ½å±•å¼€æ‰€æœ‰å¯¹æ­¤è¯é¢˜çš„è®¨è®ºï¼ˆå›å¤ï¼‰ã€‚ ğŸ“ æ–‡æœ¬æ ¼å¼åŒ–å­¦ä¼šæ’å…¥è¶…æ–‡æœ¬é“¾æ¥ï¼Œé¿å…å†—é•¿çš„ URL éœ¸å±ï¼ˆç®€çŸ­çš„ç½‘å€ä¾‹å¤–ï¼‰ï¼Œæ˜¯ä¸€ç§ç½‘ç»œç¾å¾·ã€‚ Markdown è¯­æ³•å®˜æ–¹å®¢æˆ·ç«¯åªæ”¯æŒä»¥ä¸‹Markdown è¯­æ³•ï¼š åŠ ç²—ï¼ˆå‰ååŠ å…¥ä¸¤ä¸ªæ˜Ÿå·ï¼‰ï¼š**bold** åˆ é™¤çº¿ï¼ˆå‰ååŠ å…¥ä¸¤ä¸ªæ³¢æµªå·ï¼‰ï¼š~~strikethrough~~ ç­‰å®½å­—ä½“ï¼ˆå‰ååŠ å…¥ä¸€ä¸ªé‡éŸ³ç¬¦ï¼‰ï¼š`monospace` æ–œä½“ï¼ˆå‰ååŠ å…¥ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰ï¼š__italic__ï¼ˆåŸç”Ÿ Markdown è¯­æ³•æ˜¯å‰åä¸€ä¸ªæ˜Ÿå·ï¼‰ ä¸æ”¯æŒä½¿ç”¨ Markdown è¯­æ³• Create linkï¼Œè™½ç„¶å¯ä»¥é€šè¿‡å¿«æ·é”® Ctrl + K æ’å…¥è¶…é“¾æ¥ï¼Œä½†ç•¥æ˜¾éº»çƒ¦ã€‚å¦‚æœä½ æ˜¯ Windows 10 ç”¨æˆ·å’Œ Markdown çˆ±å¥½è€…ï¼Œæˆ‘æƒ³åˆ°äº†ä¸€ä¸ªä¼˜é›…çš„å†™ä½œæ–¹æ³•ã€‚ @sudo_radio æä¾›ä¿¡æ¯ï¼šTelegram X for Android ä¹Ÿæ”¯æŒè¶…é“¾æ¥è¯­æ³•ã€‚ å…¬å¼€ç‰ˆï¼šæœ€åä¸€æ¬¡æ›´æ–°æ˜¯ 2020 å¹´ 5 æœˆ 15 æ—¥ æµ‹è¯•ç‰ˆï¼šç”³è¯·å…¥å£ | APKMirror å‡†å¤‡å·¥ä½œ ä¸‹è½½ Unigramï¼ˆä¸‹æ–‡ æœ‰å®‰è£…æ•™ç¨‹ï¼‰ ä¸‹è½½ Typora æˆ–å…¶å®ƒ Markdown ç¼–è¾‘å™¨ æ·»åŠ æµè§ˆå™¨æ’ä»¶ æ²¹çŒ´ï¼Œå¹¶å®‰è£…è¿™ä¸ª è„šæœ¬ï¼šå¿«é€Ÿå¤åˆ¶ Markdown æ ¼å¼ï¼ˆ[æ ‡é¢˜](ç½‘å€)ï¼‰çš„è¶…é“¾æ¥åˆ°å‰ªè´´æ¿ å†™ä½œæµç¨‹ æ‰“å¼€ Typoraï¼Œå¼€å§‹å†™ä½œ é€šè¿‡è„šæœ¬å¿«é€Ÿæ’å…¥è¶…é“¾æ¥ å†™å¥½åå¤åˆ¶ Markdown æºä»£ç ï¼Œæ‰“å¼€ Unigram å¹¶ç²˜è´´ æ‰“ä¸Šä¸€äº› #æ ‡ç­¾ï¼ˆHashtagsï¼‰ç»™æ¶ˆæ¯åˆ†ç±»ï¼Œæ–¹ä¾¿è¯»è€…æ£€ç´¢ ç‚¹å‡»å‘é€ï¼ŒMarkdown è¯­æ³•å³å¯è¢«æ¸²æŸ“ï¼ŒåŒ…æ‹¬è¶…é“¾æ¥ è¿™æ ·å†™é•¿æ–‡ï¼Œä¸€æ°”å‘µæˆï¼ŒAwesomeï¼ å¾—ç›Šäº Telegram è´¦å·å¯ä»¥ç™»å½•å¾ˆå¤šä¸ªè®¾å¤‡ï¼Œç”¨å®Œ Unigram å’Œ Telegram X for Android åï¼Œå¯åˆ‡æ¢å›å®˜æ–¹å®¢æˆ·ç«¯ã€‚ å…³è”é˜…è¯»ï¼šæ–‡æ¡ˆé£æ ¼æŒ‡å— by åº­è¯´ Desktopï¼ˆæ¡Œé¢ç”µè„‘ç«¯ï¼‰ åœ¨ç¼–è¾‘åŒºè¾“å…¥æ–‡æœ¬ã€‚ å·¦é”®é€‰æ‹©æƒ³è¦æ ¼å¼åŒ–çš„æ–‡æœ¬ã€‚ å³å‡» &gt; Formattingï¼ˆæ ¼å¼é€‰é¡¹ï¼‰ã€‚ Formatting Shortcut for Windows Boldï¼ˆåŠ ç²— ï¼‰ Ctrl + B Italicï¼ˆæ–œä½“ï¼‰ Ctrl + I Underlineï¼ˆä¸‹åˆ’çº¿ï¼‰ Ctrl + U Strikethroughï¼ˆåˆ é™¤çº¿ï¼‰ Ctrl + Shift + X Monospaceï¼ˆç­‰å®½å­—ä½“ï¼‰ Ctrl + Shift + M Create linkï¼ˆè¶…é“¾æ¥ï¼‰ Ctrl + K Plain textï¼ˆçº¯æ–‡æœ¬ï¼‰ Ctrl + Shift + N é‡ç£…æ¨è Ctrl + Kï¼ç®€å•å‡ æ­¥ï¼Œè®©æ’ç‰ˆæ¸…æ¸…çˆ½çˆ½ã€‚ Androidï¼ˆå®‰å“ï¼‰ åœ¨ç¼–è¾‘åŒºè¾“å…¥æ–‡æœ¬ã€‚ é•¿æŒ‰é€‰æ‹©æƒ³è¦æ ¼å¼åŒ–çš„æ–‡æœ¬ã€‚ åŸç”Ÿ Android ç³»ç»Ÿä¼šç›´æ¥å¼¹å‡ºæ ¼å¼åŒ–é€‰é¡¹ï¼›é­”æ”¹å®‰å“ç³»ç»Ÿï¼ˆä¾‹å¦‚ MIUIï¼‰éœ€è¦è½»è§¦ç•Œé¢å³ä¸Šè§’çš„ä¸‰ä¸ªç‚¹ï¼ˆåœ¨é¡¶æ å³ä¾§ï¼Œå¤§æ¦‚åœ¨é€šçŸ¥æ ç”µé‡ ğŸ”‹ çš„ä¸‹æ–¹ã€‚éå¸¸åˆé’»çš„ä¸€ä¸ªä½ç½®ï¼‰ï¼Œæ‰èƒ½çœ‹åˆ°æ–‡æœ¬æ ¼å¼åŒ–é€‰é¡¹ã€‚ iOSï¼ˆiPhone &amp; iPadï¼‰ åœ¨ç¼–è¾‘åŒºè¾“å…¥æ–‡æœ¬ã€‚ é•¿æŒ‰é€‰æ‹©æƒ³è¦æ ¼å¼åŒ–çš„æ–‡æœ¬ï¼Œä¼šå¼¹å‡ºä¸€äº›æ–‡å­—æ“ä½œçš„é€‰é¡¹ã€‚ è½»è§¦ BIUï¼ˆæˆ–è®¸è—åœ¨ â–¶ï¸ åé¢ï¼‰ï¼Œå³å¯çœ‹åˆ°æ–‡æœ¬æ ¼å¼åŒ–é€‰é¡¹ã€‚ å¦‚æœè§‰å¾—ä»¥ä¸Šæ ¼å¼åŒ–æ–‡æœ¬çš„æ–¹æ³•å¤ªéº»çƒ¦ï¼Œæ‰“ä¹±äº†è¾“å…¥èŠ‚å¥ï¼Œå¯åœ¨ä»»æ„èŠå¤©æ¡†è¾“å…¥ @boldï¼Œæ¥ç€ä½¿ç”¨ Markdown ç¼–è¾‘æ¶ˆæ¯ï¼ˆæœ€å¤šè¾“å…¥ 256 å­—ç¬¦ï¼‰ï¼Œæœ€åé€‰æ‹© Custom markdownã€‚ #ï¸âƒ£ ä¸»é¢˜æ ‡ç­¾ä»»ä½•ä»¥ # å¼€å¤´çš„è¯ç»„ï¼Œä»¥æ ‡ç‚¹ç¬¦å·æˆ–ç©ºæ ¼ç»“å°¾çš„è¯ç»„ï¼ˆhashtagsï¼‰éƒ½å¯ä»¥è¢«ç‚¹å‡»æœç´¢ï¼Œä¹Ÿç›¸å½“äºç”¨æ ‡ç­¾ç»™æ¶ˆæ¯åˆ†ç»„ã€‚ åº·å¾·è¯´è¿‡ï¼š#è‡ªç”± ä¸æ˜¯è®©ä½ æƒ³åšä»€ä¹ˆå°±åšä»€ä¹ˆï¼Œè‡ªç”±æ˜¯æ•™ä½ ä¸æƒ³åšä»€ä¹ˆï¼Œå°±å¯ä»¥ä¸åšä»€ä¹ˆã€‚ æ¶ˆæ¯å‘å‡ºåï¼Œ#è‡ªç”± å°±ä¼šå˜æˆä¸€ä¸ªå¯ç‚¹å‡»æœç´¢çš„çŠ¶æ€ã€‚ ğŸŒ… å‘é€åŸå›¾å…ˆé€‰æ‹©æƒ³è¦å‘é€çš„å›¾ç‰‡ï¼ˆä¸æ­¢äº 9 å¼ ï¼‰ï¼š Androidï¼šç‚¹å‡»å¼¹å‡ºçª—å£å³ä¸Šè§’çš„ä¸‰ä¸ªç‚¹ï¼ŒSend without compression iOSã€macOS å’Œ Windowsï¼šSend as a file è¯·æ³¨æ„ï¼š åŸå›¾ä¸ä¼šå‹ç¼©å›¾ç‰‡ï¼Œä½†æ˜¯ä¼šæš´éœ²æ–‡ä»¶åã€éšè—çš„ GPS ä¿¡æ¯å’Œæ‹æ‘„ä¿¡æ¯ï¼Œæ…é‡å‘é€ã€‚ Telegram ä¼šè®°ä½ä½ çš„æ“ä½œä¹ æƒ¯ï¼Œä¸‹æ¬¡å‘é€å›¾ç‰‡æ—¶ä¸å¿…å†æ¬¡å‹¾é€‰åŸå›¾é€‰é¡¹ã€‚ ğŸ¬ å‘é€è§†é¢‘æ”¯æŒæ—¶é—´æˆ³ï¼ˆTimestampï¼‰ï¼šå‘é€æœ¬åœ°è§†é¢‘æˆ– YouTube è§†é¢‘æ—¶ï¼Œåœ¨ Add a captionï¼ˆæ·»åŠ æ ‡é¢˜ï¼‰é‡Œæ ‡è®°ä½ æœ€å–œæ¬¢çš„æ—¶åˆ»ï¼ˆmark your favorite momentsï¼‰ï¼Œä¾‹å¦‚ï¼š å»ºè®®ç›´æ¥è·³åˆ° 05:06 å¼€å§‹æ¬£èµï¼Œæœ‰æƒŠå–œã€‚ 05:06 ä¼šè‡ªåŠ¨é«˜äº®æ˜¾ç¤ºï¼Œç‚¹å‡» 05:06ï¼Œè§†é¢‘å°±ä¼šä»ç¬¬ 5 åˆ† 6 ç§’æ’­æ”¾ã€‚å…¶ä¸­ 05:06 å¿…å¡«é¡¹ï¼Œæç¤ºçš„è¯å¯ä»¥é€‰å¡«ã€‚ å¼•ç”¨å›å¤æœ¬åœ°è§†é¢‘æˆ– YouTube è§†é¢‘ä¹Ÿæ”¯æŒåŠ å…¥æ—¶é—´æˆ³ï¼ˆTimestamps in replies and captions open videos and YouTube links to that exact moment.ï¼‰ã€‚ ä½ å‘ç°äº†å—ï¼ŸYouTube å’Œå“”å“©å“”å“©çš„è¯„è®ºåŒºä¹Ÿæ˜¯æ”¯æŒè¿™ç§æ—¶é—´æˆ³ã€‚ ä¸æ”¯æŒæ—¶é—´æˆ³çš„è½¯ä»¶å’Œç½‘é¡µï¼Œæ€ä¹ˆåŠ YouTubeï¼šhttps://www.youtube.com/watch?v=SyM3jMFjess&amp;t=05m06s å³é”®ç‚¹å‡»è¿›åº¦æ¡ åœ¨å¼¹å‡ºçš„èœå•ä¸­é€‰æ‹© å¤åˆ¶å½“å‰æ—¶é—´çš„è§†é¢‘ç½‘å€ å“”å“©å“”å“©ï¼šhttps://www.bilibili.com/video/av55857100?t=14m15s ä¸æ”¯æŒå¤åˆ¶å½“å‰æ—¶é—´çš„è§†é¢‘ç½‘å€ï¼Œéœ€è¦æ‰‹åŠ¨å¡«å†™ å‚æ•°è¯´æ˜ ?t= &#x2F; &amp;t= æ—¶é—´ time h æ—¶ hour m åˆ† minute s ç§’ second å‘é€è§†é¢‘æ—¶ï¼Œå¯é€‰æ‹©å‹ç¼©ç­‰çº§ã€‚Change the resolution of a video from the editorâ€™s quality slider. å†…ç½®è§†é¢‘æ’­æ”¾å™¨ï¼ˆin-app media playerï¼‰ï¼šç›´æ¥åœ¨ app å†…è§‚çœ‹ YouTube æˆ– Vimeo è§†é¢‘ï¼Œä¸å¿…è·³è½¬åˆ°æµè§ˆå™¨æˆ–è€…ç›¸åº”çš„è§†é¢‘ appã€‚æ“ä½œé€»è¾‘ä¸å›½å¤–è§†é¢‘ App ä¿æŒä¸€è‡´ï¼šåŒå‡»å·¦ä¾§å¿«é€€ï¼ŒåŒå‡»å³ä¾§å¿«è¿›ã€‚ åˆ¶ä½œ GIF åŠ¨å›¾åœ¨å‘é€è§†é¢‘æ—¶ï¼Œç‚¹å‡»è§†é¢‘æ‰“å¼€ç¼–è¾‘çª—å£ï¼Œä½¿å…¶é™éŸ³ï¼ˆtap the mute audio buttonï¼‰ï¼Œæ–°çš„ GIF å°±è¯ç”Ÿäº†ï¼Œè¿˜ä¼šè‡ªåŠ¨ä¿å­˜åœ¨æœ€è¿‘ä½¿ç”¨çš„ GIF é‡Œï¼ˆrecent GIFs tabï¼‰ã€‚ ğŸ“¡ æ¶ˆæ¯å‘é€æ—¶æ‰‹æœºä¸Šé•¿æŒ‰ï¼ˆç”µè„‘ä¸Šå³å‡»ï¼‰æ¶ˆæ¯å‘é€é”®ï¼š Send without soundï¼ˆé™éŸ³å‘é€ï¼‰ï¼šçºµä½¿å¯¹æ–¹åœ¨ç¡è§‰ï¼Œä½ çš„ urgent idea ä¹Ÿä¸ä¼šæ…äººæ˜¥æ¢¦ï¼Œç®€ç›´å°±æ˜¯ä¸ºå¥å¿˜çš„äººè€Œè®¾è®¡ã€‚ Scheduled Messageï¼ˆå®šæ—¶å‘é€ï¼‰ å‘é€æ—¥ç¨‹æ¶ˆæ¯æ—¶ï¼Œå¯¹æ–¹æ˜¯ä¸çŸ¥é“ä½ ä½¿ç”¨äº†å®šæ—¶å‘é€ã€‚ åœ¨ Saved Messagesï¼ˆæˆ‘çš„æ”¶è—ï¼‰ä¹Ÿå¯ä»¥å‘é€å®šæ—¶æ¶ˆæ¯ä½œä¸ºæé†’ï¼ˆSet a reminderï¼‰ã€‚ Send when * comes onlineï¼ˆå½“å¯¹æ–¹ä¸Šçº¿æ—¶å‘é€ï¼‰ï¼šè¿™æ ·å°±å¯ä»¥æ’åœ¨å¯¹æ–¹èŠå¤©åˆ—è¡¨çš„å‰é¢ï¼ˆPut you right at the top of their chat list.ï¼‰ã€‚æ­¤åŠŸèƒ½éœ€è¦å¯¹æ–¹åœ¨éšç§è®¾ç½®é‡Œå¼€å¯å±•ç¤ºæœ€åä¸Šçº¿æ—¶é—´ï¼ˆThis option only appears for users who share their Last Seen status with you, and vice versa.ï¼‰ æ¥æ”¶è€…å¯å±è”½è”ç³»äºº &#x2F; ç¾¤ç»„ &#x2F; é¢‘é“çš„æ¶ˆæ¯é€šçŸ¥ï¼ˆMute Notificationsï¼‰ï¼š 1 ä¸ªå°æ—¶ 4 ä¸ªå°æ—¶ 18 ä¸ªå°æ—¶ 3 å¤© æ°¸ä¹…é™éŸ³ ğŸ”™ æ¶ˆæ¯å‘é€åç‚¹å‡»æ¶ˆæ¯ï¼Œé€‰æ‹© Pinï¼Œå³å¯åœ¨é¢‘é“ã€ç¾¤ç»„æˆ–ç§èŠç•Œé¢ä¸­ç½®é¡¶å¤šä¸ªæ¶ˆæ¯ï¼ˆMultiple Pinned Messagesï¼‰ã€‚åœ¨ç¾¤ç»„ä¸­ç½®é¡¶æ¶ˆæ¯æ—¶ï¼Œå¯å¼ºåˆ¶é€šçŸ¥å…¨å‘˜ï¼ˆnotify all membersï¼‰ï¼Œå³ä½¿æˆå‘˜çš„ç¾¤ç»„å·²ç»è®¾ç½®ä¸ºé™éŸ³ã€‚ âœ”ï¸ æ¶ˆæ¯çŠ¶æ€æ¶ˆæ¯çš„è¯»å–çŠ¶æ€ï¼ˆå›æ‰§ï¼‰åˆ†ä¸ºä¸¤ç§ One checkï¼ˆâœ”ï¸ï¼‰ï¼šå‘é€æˆåŠŸã€‚åœ¨å¾®ä¿¡ï¼Œæœ‰äº›æ¶ˆæ¯æ²¡å‘é€å‡ºå»ï¼Œåªå¯¹ä½ å¯è§ï¼Œä¹Ÿä¸ä¼šæœ‰å‘é€å¤±è´¥çš„æ„Ÿå¹å· â—ã€‚è¿™æ˜¯å¯¹ç”¨æˆ·èµ¤è£¸è£¸çš„æ¬ºéª— ã€‚ Two checksï¼ˆâœ”ï¸âœ”ï¸ï¼‰ï¼šæ¶ˆæ¯å·²é˜…ã€‚ç¥è§çŠ¶æ€æ å¼¹å‡ºæ¥çš„æ¶ˆæ¯ï¼Œä¸ä¼šäº§ç”Ÿå·²è¯»æ ‡è®°ã€‚å› æ­¤ï¼Œä¸€ç›´æ˜¾ç¤ºå•å‹¾ï¼Œä¸ä»£è¡¨å¯¹æ–¹æ²¡çœ‹åˆ°ä¿¡æ¯ã€‚ ä¸€ä¸ªå·çœ‹æ¶ˆæ¯çš„å°æŠ€å·§ï¼šåœ¨å¯¹è¯åˆ—è¡¨ï¼Œé•¿æŒ‰å¤´åƒå¯é¢„è§ˆæ¶ˆæ¯ï¼Œä½†æ¶ˆæ¯çŠ¶æ€ä¸ä¼šå˜ä¸ºå·²è¯»ã€‚ï¼ˆPull up a preview of messages â€“ without making messages as read. ï¼‰ âœï¸ æ¶ˆæ¯æ›´æ­£åœ¨ Telegramï¼Œè¯´å‡ºå»çš„è¯ä¸ä¼šåƒæ³¼å‡ºå»çš„æ°´æ”¶ä¸å›æ¥ï¼Œåœ¨ 48 å°æ—¶å†…ï¼ˆé¢‘é“æ˜¯æ— é™æœŸä¿®æ”¹ï¼‰ï¼Œä½ éƒ½å¯ä»¥é‡æ–°ç¼–è¾‘ï¼ˆEdit your messages after postingï¼‰ï¼ŒåŒ…æ‹¬æ–‡å­—ã€å›¾ç‰‡å’Œè§†é¢‘ï¼ˆEdit sent media to re-crop, re-decorate or completely replace photos and videos.ï¼‰ï¼Œæ‰€ä»¥ï¼š æ–‡å­—å‡ºç° typosï¼Œä¸ç”¨åˆ é™¤ï¼Œå¤šä¹…ä¹‹å‰å‘çš„æ¶ˆæ¯éƒ½èƒ½éšæ—¶æ›´æ­£ï¼ˆEditï¼‰ã€‚ å›¾ç‰‡å¿˜è®°æ‰“é©¬èµ›å…‹ï¼Œä½†å› ä¸ºæœ‰å›¾ç‰‡è¯´æ˜ï¼ˆé…æ–‡ï¼‰ï¼Œæ‡’å¾—æ’¤å›é‡è¾“ï¼Œå¯ä»¥å½“åœºæŠ¹é™¤æ•æ„Ÿä¿¡æ¯ï¼Œå½“åœºæ¢å›¾ç‰‡ï¼ˆReplace Mediaï¼‰ã€‚ è§†é¢‘å‘é”™äº†ï¼Œå–„åæ–¹å¼ä¸å›¾ç‰‡åŒç†ã€‚ å›¾ç‰‡æ¢è§†é¢‘ï¼Œè§†é¢‘æ¢å›¾ç‰‡ï¼ŒWhy not? å¦‚ä½•æ›¿æ¢å›¾ç‰‡æˆ–è§†é¢‘ï¼Ÿé•¿æŒ‰æˆ–å³å‡»æ¶ˆæ¯ï¼Œé€‰æ‹© Editï¼š é€šç”¨æ³•ï¼šç‚¹å‡»ç¬”å¤´å›¾æ ‡ âœï¸ï¼ˆæˆ– Replace file&#x2F;photoï¼‰ï¼Œå¼¹å‡ºèµ„æºçª—å£ï¼Œé€‰æ‹©æ­£ç¡®çš„å›¾ç‰‡å’Œè§†é¢‘å³å¯æ›¿æ¢ã€‚ æ¡Œé¢ç«¯ï¼šå¤åˆ¶æ­£ç¡®çš„å›¾ç‰‡å’Œè§†é¢‘ï¼Œå›åˆ° Telegramï¼Œç²˜è´´å³å¯æ›¿æ¢ã€‚ å¹¶ä¸”æ”¯æŒç›´æ¥æ ‡è®°åˆ«äººå‘æ¥çš„å›¾ç‰‡ï¼Œä¿®æ”¹å®Œå†å‘å‡ºå»ï¼Œæ— éœ€ä¿å­˜åœ¨æœ¬åœ°å›¾åº“ã€‚Instantly edit and send back media you receive to add notations or decorations without saving it to your gallery. åœ¨ç”µè„‘ç«¯ï¼ŒæŠŠé¼ æ ‡æ”¾åœ¨ edited ä¸Šï¼Œä¼šæ˜¾ç¤ºæœ€åä¿®æ”¹æ¶ˆæ¯çš„æ—¶é—´ã€‚ ğŸ‘‡ é•¿æŒ‰æ¶ˆæ¯ æ¶ˆæ¯å¯ä»¥æ— é™æœŸæ’¤å›ï¼ˆDelete Messagesï¼‰ï¼šåˆ é™¤ä¿¡æ¯æ—¶ï¼Œå‹¾é€‰ Also delete for ***ï¼ŒèŠå¤©è®°å½•å°±å¯ä»¥åŒå‘åˆ é™¤ï¼Œé€šè¯è®°å½•ä¹Ÿæ”¯æŒè¿™ä¸ªç‰¹æ€§ï¼ˆCall history can also be deleted for all sides at any timeï¼‰ã€‚ç”µæŠ¥æœåŠ¡å™¨æ›´ä¸ä¼šå­˜å‚¨è¢«åˆ é™¤çš„èŠå¤©è®°å½•å’Œé€šè¯è®°å½•ï¼Œå› æ­¤æ•°æ®å°†å½»åº•æ°¸è¿œæ¶ˆå¤±ã€‚ é€‰æ‹©éƒ¨åˆ†æ¶ˆæ¯ï¼ˆSelect Parts of Messagesï¼‰ï¼šé•¿æŒ‰ 2 æ¬¡æ¶ˆæ¯ï¼Œå¯é€‰æ‹©éƒ¨åˆ†æ–‡å­—ï¼Œè€Œä¸æ˜¯å¤åˆ¶å…¨æ–‡ï¼ˆCopy Selected Textï¼‰ã€‚ é•¿æŒ‰ç½‘å€æˆ–é•¿ä¸²æ•°å­—å¯ä»¥é€‰æ‹©æ‰“å¼€ï¼ˆOpenï¼‰æˆ–è€…å¤åˆ¶ï¼ˆCopyï¼‰ã€‚ è½¬å‘æ¶ˆæ¯æ—¶ï¼Œé•¿æŒ‰è”ç³»äºº &#x2F; ç¾¤ç»„ &#x2F; é¢‘é“å¯å¤šé€‰ã€‚ ğŸ—£ æœ—è¯»æ¶ˆæ¯Announce Messages ç›®å‰ç”± iOS ç”¨æˆ·ç‹¬å ã€‚ä½ å¯ä»¥è®© Siri åœ¨ä½ çš„è€³æœºé‡Œå¤§å£°è¯»å‡ºä½ æ”¶åˆ°çš„ä¿¡æ¯ï¼Œå³ä½¿æ˜¯åœ¨æ´—ç¢—çš„æ—¶å€™ä¹Ÿå¯ä»¥ä¿æŒèŠå¤©çš„æœ€æ–°çŠ¶æ€ã€‚ å¼€å¯è·¯å¾„ï¼šiOS Settings &gt; Notifications &gt; Announce Messagesã€‚ â³ è‡ªåŠ¨åˆ é™¤ è‡ªåŠ¨åˆ é™¤åªé€‚ç”¨äºå®šæ—¶å™¨è®¾ç½®åå‘é€çš„æ¶ˆæ¯ï¼Œä»¥å‰çš„æ¶ˆæ¯å°†ä¿ç•™åœ¨èŠå¤©è®°å½•ä¸­ã€‚ å€’è®¡æ—¶åœ¨æ¶ˆæ¯å‘é€æ—¶å¼€å§‹è®¡æ—¶ï¼›è€Œç§˜å¯†èŠå¤©æ˜¯é˜…åå³ç„šï¼Œæ˜¯ä»å·²è¯»åå¼€å§‹è®¡æ—¶ã€‚ ğŸ—£ï¸ è¯­éŸ³æ¶ˆæ¯ æ”¯æŒ 2 å€é€Ÿæ’­æ”¾ï¼ˆ2X playbackï¼‰ã€‚ æ”¯æŒæ»‘åŠ¨è¿›åº¦æ¡ã€‚ï¼ˆSlide forward and back on voice messages to skip ahead or repeat something you missed.ï¼‰ è®°å¿†æ’­æ”¾ä½ç½®ï¼šè¶…è¿‡ 20 åˆ†é’Ÿçš„éŸ³é¢‘æ–‡ä»¶ï¼ˆ2021 å¹´ 3 æœˆ 18 æ—¥å–æ¶ˆæ­¤é™åˆ¶ï¼‰ï¼ŒTelegram ä¼šå¸®ä½ è®°ä½æœ€åçš„æ’­æ”¾ä½ç½®ï¼Œä»¥ä¾¿ä¸­æ–­åå†æ¬¡æ”¶å¬ï¼ˆTelegram apps will remember your last position when resuming playback of audio files longer than 20 minutes.ï¼‰ã€‚ æ­¤å¤–ï¼Œåœ¨ Telegram ä¸Šè¿›è¡Œè¯­éŸ³é€šè¯ï¼ˆæ‰“ç”µè¯ï¼‰ï¼Œéœ€è¦åœ¨ç¿»å¢™æœåŠ¡ç«¯&#x2F;å®¢æˆ·ç«¯å¼€å¯ UDP è½¬å‘ã€‚ ğŸ“² è§†é¢‘é€šè¯å‘èµ·è§†é¢‘é€šè¯å’ŒéŸ³é¢‘é€šè¯åï¼Œå¦‚æœå±å¹•ä¸Šçš„ 4 ä¸ª Emoji ä¸€è‡´ï¼Œè¡¨ç¤ºæ­¤è¿æ¥å·²é‡‡ç”¨ç«¯åˆ°ç«¯åŠ å¯†ï¼Œ100% å®‰å…¨ã€‚ Video Calls: All voice and video calls are protected with end-to-end encryption. To confirm your connection, compare the four emoji shown on screen. If they match with your partnerâ€™s, your call is 100% secure. ğŸ™ˆ ç”ŸåŠ¨è¡¨æƒ…Emojiï¼ˆç»˜æ–‡å­—ï¼‰æŒ‰å…³é”®å­—æœç´¢è¡¨æƒ…ï¼ˆSearch emoji by keywordï¼‰ï¼šåœ¨æ¶ˆæ¯æ¡†è¾“å…¥å…³é”®è¯ï¼Œå°±ä¼šå¼¹å‡ºç›¸å…³çš„ Emojiã€‚ èƒ½è§¦å‘ Emoji çš„è‹±æ–‡å…³é”®è¯åˆé›† èƒ½è§¦å‘ Emoji çš„ç®€ä½“ä¸­æ–‡å…³é”®è¯åˆé›† éƒ¨åˆ† Emoji æ”¯æŒåŠ¨æ€æ’­æ”¾ï¼ˆAnimated Emojiï¼‰åœ¨ä»»æ„èŠå¤©çª—å£å‘é€ 1 ä¸ª éç¤¼å‹¿è§†çŒ¿ ğŸ™ˆï¼ˆSee-No-Evil Monkeyï¼‰ï¼Œå†åŠ¨ Ta è¯•è¯•ï¼Œå¯çˆ±å§ï¼æŸ¥çœ‹æ›´å¤šè¢« Telegram èµ‹äºˆã€Œç”Ÿå‘½ã€çš„åŠ¨æ€ Emojiï¼Œè¯·å‚é˜… Telegram Animated Emoji Listã€‚ ä»¥ä¸‹è¡¨æƒ…ç¬¦å·å¯ä»¥ä½œä¸ºæ‰“èµŒå°æ¸¸æˆï¼ˆEmoji Gameï¼‰ å‘é€å•ä¸ª è§¦å‘æ•ˆæœ ğŸ² æ·éª°å­ dice ğŸ¯ æ‰”é£é•– darts ğŸ€ æŠ•ç¯® basketball âš½ å°„é—¨ football ğŸ³ ä¿é¾„çƒ bowling ğŸ° è€è™æœº jackpot &#x2F; slot machine å¦‚ä½•åœ¨å¥ä¸­ï¼ˆmid-messageï¼‰å¿«æ·æ·»åŠ  Emojiï¼Ÿè¯­æ³•æ˜¯ :ï¼ˆè‹±æ–‡åŠè§’å†’å·ï¼‰ + å…³é”®è¯ã€‚ä¾‹å¦‚è¾“å…¥ I am :happyï¼Œå°±ä¼šå¼¹å‡ºå¼€å¿ƒç›¸å…³çš„ Emojiï¼Œè¿™æ ·å°±ä¸ç”¨ä» Emoji é¢æ¿æŒ‘é€‰ Emoji äº†ã€‚ Stickersï¼ˆè¡¨æƒ…åŒ…ï¼‰ æˆªè‡³ 2021 å¹´ 1 æœˆ 13 æ—¥ï¼ŒTelegram ä¸Šå·²æœ‰ 20,000+ å…è´¹çš„é«˜æ¸…è¡¨æƒ…åŒ…ã€‚ åœ¨èŠå¤©çª—å£è¾“å…¥ @sticker + Emojiï¼Œå¯ä»¥æ£€ç´¢æ‰€æœ‰ä¸ Emoji ç›¸å…³è¡¨æƒ…åŒ…ï¼Œä¾‹å¦‚ @sticker ğŸ‘ã€‚æˆ‘éå¸¸å–œæ¬¢è¿™ä¸ªè¡¨æƒ…åŒ…å»ºè®®åŠŸèƒ½ï¼ˆSuggest stickers by emojiï¼‰ï¼Œç»å¸¸èƒ½æ‰¾åˆ°ä¸€äº›å¾ˆæœ‰åˆ›æ„é«˜æ¸…è¡¨æƒ…åŒ…ï¼Œç»™èŠå¤©ä½“éªŒå¢è‰²ä¸å°‘ã€‚ åœ¨å“ªé‡Œæ‰¾è¡¨æƒ…åŒ… å®˜æ–¹ï¼š æ‰“å¼€ Telegram çš„ä¸€ä¸ªå¯¹è¯ç•Œé¢ï¼Œè¾“å…¥æ¡†é€‰æ‹© Stickerï¼ˆæ—è¾¹æ˜¯é€‰æ‹© Emoji å’Œ GIFï¼‰ å¾€ä¸‹æ‹‰ï¼Œå³å¯åœ¨é¡¶éƒ¨çœ‹åˆ° Search sticker setsï¼ˆåªæ”¯æŒç”¨è‹±æ–‡å…³é”®è¯æœç´¢ï¼‰ ç½‘ç«™ï¼š Stickers Cloud tlgrmï¼šåªæ”¯æŒç”¨è‹±æ–‡å…³é”®è¯æœç´¢ ç¾¤ç»„ï¼šStickers Cloud é¢‘é“ï¼šTrending Stickers ğŸ“¤ å¦‚ä½•å¯¼å‡ºç”µæŠ¥ä¸Šçš„è¡¨æƒ…åŒ… é€‰æ‹©ä¸€ä¸ª Sticker to GIF Converterï¼Œä¾‹å¦‚ @tgstogifbot æˆ– @Sticker2GIFBotï¼ˆåä¸€ä¸ª Bot å¯ä¸‹è½½æ•´å¥—è¡¨æƒ…åŒ…ï¼‰ å‘é€ Stickersï¼ŒBots å°±ä¼šæŠŠ Telegram ä¸Š tgs æ ¼å¼çš„è¡¨æƒ…åŒ…è½¬æ¢ä¸º gif æ ¼å¼ ğŸ—œï¸ åœ¨é™åˆ¶å¤šå¤šçš„å¾®ä¿¡ App ä¸Šï¼Œå°äº 1 MB çš„ GIF å›¾ç‰‡æ‰ä¼šè‡ªåŠ¨æ’­æ”¾ã€‚å¦‚ä½•å‹ç¼©ï¼š æ‰“å¼€ å›¾è´´å¼ï¼ˆç½‘ç«™ï¼‰ï¼Œé€‰æ‹© GIF å‹ç¼© å®½åº¦è®¾ç½®ä¸º 240ï¼Œå‹ç¼©è´¨é‡ 70ï¼ˆé»˜è®¤ï¼‰ é€‰æ‹©æˆ–æ‹–æ‹½ä¸€ä¸ªæˆ–å¤šä¸ª GIF åˆ°å‹ç¼©çª—å£ï¼Œå¼€å§‹å‹ç¼© å‹ç¼©å®Œæˆåï¼Œï¼ˆæ¨èä½¿ç”¨ IDMï¼‰æ‰“åŒ…ä¸‹è½½ æ­¤æ—¶æŸäº›è¡¨æƒ…åŒ…å¯èƒ½å¤§äº 1 MBï¼Œéœ€è¦å†å‹ä¸€æ¬¡ï¼š æ–¹æ³•ä¸€ï¼šä¿®æ”¹ å›¾è´´å¼ çš„å‹ç¼©è´¨é‡ç­‰çº§ï¼ˆå‹å¾—å¤ªç‹ ä¼šå¤±çœŸï¼‰ æ–¹æ³•äºŒï¼šä½¿ç”¨ docsmallï¼ˆç½‘ç«™ï¼‰æˆ–è€… å›¾å‹ï¼ˆè½¯ä»¶ï¼‰äºŒæ¬¡å‹ç¼© ä¸ºä»€ä¹ˆä¸ç”¨ Photoshop å‹ç¼© GIFï¼Ÿå› ä¸ºä¼šäº§ç”Ÿæ¯›ç³™çš„ç™½è¾¹ã€‚ ä¸¤å¤–ï¼Œæ¨èä¸€ä¸ªå¯ä»¥æ‰¹é‡ä¿®æ”¹å›¾ç‰‡å°ºå¯¸çš„ç½‘ç«™ï¼šiLoveIMG ğŸ“Š æŠ•ç¥¨åŠŸèƒ½åªæ”¯æŒåœ¨ç¾¤ç»„å’Œé¢‘é“ä¸­å‘èµ·ï¼Œå› ä¸º they feel lonely in one-on-one chats. å‘èµ·äºº æ”¯æŒï¼šåŒ¿åæŠ•ç¥¨ï¼ˆAnonymous Votingï¼‰ã€å¤šé€‰ï¼ˆMultiple Answersï¼‰ã€ç­”é¢˜æ¨¡å¼ï¼ˆ Quiz Modeï¼‰ã€‚ ä¸æ”¯æŒï¼šä¿®æ”¹å‘å‡ºçš„ Pollã€‚ æŠ•ç¥¨è€… &#x2F; ç­”é¢˜è€… ä¸æ»¡æ„é•¿æŒ‰æˆ–å³å‡»æŠ•ç¥¨ï¼ˆPollï¼‰å¯ä»¥æ’¤å›æŠ•ç¥¨ï¼ˆRetract voteï¼‰ã€‚ ç¼ºç‚¹ Telegram å†…ç½®æŠ•ç¥¨å¯è¢«ä»»æ„ç”¨æˆ·è½¬å‘è‡³å…¶ä»–å¯¹è¯å†…ï¼ˆå¦‚ç¾¤ç»„ï¼‰è¿›è¡ŒæŠ•ç¥¨ï¼Œè¿™å¯¹äºå…¬å¼€æ€§çš„æŠ•ç¥¨æ¥è¯´æ˜¯å¢åŠ ç»Ÿè®¡æ•°æ®é‡çš„å¥½æ–¹å¼ï¼Œä½†è¯¥ç‰¹æ€§å¯¹äºæœ‰ç§å¯†&#x2F;éå…¬å¼€éœ€æ±‚çš„æŠ•ç¥¨æ¥è¯´å®ä¸ºä¸åˆ©ã€‚ï¼ˆæˆªæ­¢ 2021 å¹´ 5 æœˆ 28 æ—¥ by TGgeekï¼‰ æ”¹å–„æ–¹æ³•ï¼šé€šè¿‡ @vote åˆ›å»ºæŠ•ç¥¨ã€‚ ğŸ“– é€šç”¨æŠ€å·§ğŸŒ äº’è”å¼€æ”¾å…¬å¼€ï¼ˆPublicï¼‰çš„é¢‘é“æˆ–ç¾¤ç»„ï¼Œæ˜¯å¯ä»¥è¢«æœç´¢å¼•æ“æŠ“å–çš„ï¼ˆThe contents of public channels can be seen on the Web without a Telegram account and are indexed by search engines.ï¼‰ï¼Œå¹¶ä¸”ä¸æ³¨å†Œ Telegram è´¦å·ä¹Ÿçœ‹åˆ°å…¬å¼€é¢‘é“æˆ–ç¾¤ç»„ä¸­çš„å†…å®¹ï¼Œæ–¹æ³•å°±æ˜¯åœ¨ Public linkï¼ˆå…¬å¼€é“¾æ¥ï¼‰ä¸­åŠ ä¸€ä¸ª sï¼Œä¾‹å¦‚åœ¨æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥ t.me&#x2F;s&#x2F;tingtalkï¼Œå³å¯æŸ¥é˜…åº­è¯´é¢‘é“çš„æ‰€æœ‰å†…å®¹ã€‚ ä¸€ä¸ªç”¨æˆ·æœ€å¤šå¯åˆ›å»º 10 ä¸ªå…¬å¼€ç”¨æˆ·åï¼ˆpublic usernamesï¼‰ï¼ŒåŒ…æ‹¬å…¬å¼€çš„é¢‘é“å’Œç¾¤ç»„ã€‚ ğŸ” å…¨å±€æœç´¢Search Filters: To quickly find a specific message or media item, search filters allow users to refine results by keyword, source, media type and time period â€“ all at once. è¿™é‡ŒæŒ‡ç”µæŠ¥å†…çš„å…¨å±€æœç´¢ã€‚ éšè—æŠ€å·§ï¼šå¦‚ä½•æŒ‰æ—¥æœŸæœç´¢ï¼Ÿ æ‰“å¼€åœ¨ Telegram ç§»åŠ¨ç«¯é¦–é¡µ ç‚¹å‡»æœç´¢æ¡† è¾“å…¥æ—¥æœŸï¼Œå³å¯æŒ‰ç…§æ—¥æœŸç­›é€‰å†å²æ¶ˆæ¯ 2021ï¼š2021 å¹´ 01.2021 &#x2F; Jan 2021ï¼š2021 å¹´ 1 æœˆ 01.13.2021ï¼š2021 å¹´ 1 æœˆ 13 æ—¥ ğŸ“… åˆ›å»ºæ—¥æœŸåœ¨ä»»æ„å¯¹è¯çª—å£ï¼ˆä¾‹å¦‚ Saved Messagesï¼‰è¾“å…¥ https://t.me &#x2F; ID &#x2F; 1ï¼Œä¾‹å¦‚ https://t.me/tingtalk/1 æˆ–è€…åœ¨æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥ https://t.me &#x2F; s &#x2F; ID &#x2F; 1ï¼Œä¾‹å¦‚ https://t.me/s/tingtalk/1 å°±ä¼šè·³è½¬åˆ°è¯¥ç¾¤ç»„æˆ–é¢‘é“ï¼ˆæœªåˆ é™¤çš„ï¼‰ç¬¬ä¸€æ¡æ¶ˆæ¯ï¼Œåœ¨å…¶ä¸Šæ–¹ï¼Œå¯ä»¥çœ‹åˆ°åˆ›å»ºæ—¥æœŸï¼ˆChannel createdï¼‰ â˜ï¸ å¤šç«¯åŒæ­¥ Telegram å¯ä»¥åœ¨å¤šä¸ªè®¾å¤‡ä¸ŠåŒæ—¶ä½¿ç”¨ã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„è®¾å¤‡åˆ—è¡¨ï¼š 2 å° Windows ç”µè„‘ï¼ˆå¼€æœºè‡ªå¯ï¼‰ 1 éƒ¨ Android æ‰‹æœº 1 éƒ¨ iPhone æ‰‹æœº 1 ä¸ª ç½‘é¡µç«¯ â€¦â€¦ å¹¶ä¸”å…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿ï¼š ç™»å½•è¿‡çš„è®¾å¤‡ï¼Œä¸‹æ¬¡ç™»å½•æ—¶ï¼Œä¸å¿…å†æ¬¡æ‰«æäºŒç»´ç æˆ–è€…è¾“å…¥å¯†ç ã€‚ äº‘è‰ç¨¿ï¼ˆCloud draftsï¼‰ï¼šé™¤äº†æ¶ˆæ¯å¯åœ¨å„ä¸ªå¹³å°åŒæ­¥ä¹‹å¤–ï¼Œè¿æœªå®Œæˆç¼–è¾‘çš„æ¶ˆæ¯ï¼ˆè‰ç¨¿ï¼‰éƒ½å¯ä»¥è·¨è®¾å¤‡åŒæ­¥ã€‚Now you can start typing on your phone, then continue on your computer â€“ right where you left off. ä½†æ˜¯é•¿æ–‡æœ¬è¿˜æ˜¯ä¸è¦æ”¾åœ¨è‰ç¨¿ç®±äº†ï¼Œå°±æ€• Bug çˆ¬ä¸Šæ¥ã€‚å¦‚æœè‰ç¨¿ä¸¢å¤±ï¼Œåœ¨æ¡Œé¢ç«¯æŒ‰ Ctrl + Z è¯•è¯•ã€‚ ä¸ WhatsApp ä¸åŒçš„æ˜¯ï¼Œæ‰‹æœºä¸‹çº¿ Telegram åï¼Œå…¶ä»–è®¾å¤‡çš„ Telegram å¹¶ä¸ä¼šé€€å‡ºã€‚ å…è®¸ä¼ é€æœ€å¤§ 2000 MiB çš„æ–‡ä»¶ï¼Œç®€ç›´å°±æ˜¯ç»ä½³çš„ã€Œæ–‡ä»¶ä¼ è¾“åŠ©æ‰‹ã€ï¼š æŠŠ Saved Messagesï¼ˆæ”¶è—å¤¹ï¼‰å½“ä½œæ˜¯ GTD ä¸­ Inboxã€‚å¹¶ä¸”æ¯æ¡ä¿å­˜çš„æ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ª â–¶ï¸ æŒ‰é’®ï¼Œå¯ä»¥å°†ä½ å¸¦åˆ°æœ€åˆå‘å¸ƒæ¶ˆæ¯çš„ä½ç½®ã€‚ å»ºç«‹å¤šä¸ªç§äººé¢‘é“ï¼ˆæ— æ•°é‡é™åˆ¶ï¼‰ï¼Œåˆ†ç±»å­˜æ”¾ä½ çš„ä¿¡æ¯å’Œèµ„è®¯ã€‚ä½ ç”šè‡³å¯ä»¥åœ¨ Telegram ä¸Šä¼ æœ¬åœ°éŸ³ä¹æˆ–è€…å½•éŸ³åˆ°è‡ªå·±çš„é¢‘é“ï¼Œå»ºç«‹è‡ªå·±çš„äº‘ç«¯éŸ³ä¹æ’­æ”¾åº“å’Œæ’­å®¢ï¼ˆPodcastï¼‰ã€‚Create playlists by sending multiple songs at the same time. ğŸ–¥ï¸ ç”µè„‘ç‰ˆæŠ€å·§Windows çš„ Ctrl ç­‰äº macOS ä¸­ Command âŒ˜ã€‚ å¿«é€Ÿå¤šé€‰ï¼šåœ¨å¯¹è¯ç•Œé¢çš„ç©ºç™½ä½ç½®ï¼ŒæŒ‰ä½é¼ æ ‡å·¦é”®ä¸æ”¾ï¼Œç„¶åæ¨æ‹½å¤šé€‰ä¿¡æ¯ï¼Œæ¥ç€å³å¯è½¬å‘æˆ–è€…åˆ é™¤ã€‚ é“¾æ¥ç›´è¾¾ï¼šæŒ‰ä½ Ctrl å†ç‚¹å‡» URLï¼Œç›´æ¥æ‰“å¼€é“¾æ¥ï¼Œä¸å¿…å¼¹çª—ç¡®è®¤ï¼ˆOpen this link? CANCEL &#x2F; OPENï¼‰ã€‚ ç¼©æ”¾å›¾ç‰‡ï¼šæŒ‰ä½ Ctrl å†æ—‹è½¬é¼ æ ‡çš„æ»šè½®ï¼Œå³å¯æ”¾å¤§æˆ–ç¼©å°å›¾ç‰‡ã€‚ å¿«æ·å›å¤ï¼šç›´æ¥åœ¨æ¡Œé¢å³ä¸‹è§’çš„æ¶ˆæ¯å¼¹çª—é‡Œå›å¤æ¶ˆæ¯ã€‚ å¿«æ·å¼•ç”¨ï¼šå·¦é”®åŒå‡»æ¶ˆæ¯çš„ç©ºç™½å¤„ï¼Œä¾‹å¦‚åœ¨æ—¶é—´é™„è¿‘ï¼Œå³å¯å¼•ç”¨æ¶ˆæ¯ã€‚ é”®ç›˜å¿«æ·é”®èŠå¤© Chats åŠ¨ä½œ Action å¿«æ·é”® Shortcut åŠ é€Ÿæµè§ˆèŠå¤©è®°å½•Speed up in-Chat Navigation Shift + Scroll åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªä¼šè¯Move to the Chat Below Ctrl + TabCtrl + PageDownAlt + â†“ åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªä¼šè¯Move to the Chat Above Ctrl + Shift + TabCtrl + PageUpAlt + â†‘ å‘é€æ–‡ä»¶Send File Ctrl + O é€€å‡º Exitè¿”å› Go Backå–æ¶ˆå½“å‰æ“ä½œ Cancel Current Action Esc æ¶ˆæ¯ Messages åŠ¨ä½œ Action å¿«æ·é”® Shortcut å¼•ç”¨æ¶ˆæ¯Reply to a Message Ctrl + â†‘Ctrl + â†“æŒ‰ä½ Ctrl ä¸æ”¾ï¼Œé€šè¿‡ â†‘ &#x2F; â†“ é€‰æ‹©éœ€è¦å¼•ç”¨çš„æ¶ˆæ¯ å–æ¶ˆå¼•ç”¨Cancel Reply Ctrl + â†“Esc ç¼–è¾‘æœ€åå‘é€çš„æ¶ˆæ¯Edit Last Message Sent â†‘ ç¼–è¾‘åª’ä½“ï¼ˆä¾‹å¦‚æ›¿æ¢å›¾ç‰‡ï¼‰Edit Media Ctrl + E æ”¾å¤§æˆ–ç¼©å°å›¾ç‰‡&#x2F;è§†é¢‘Zoom Image&#x2F;Video In&#x2F;Out Ctrl + + &#x2F; -ï¼ˆåœ¨æ•°å­—å°é”®ç›˜ï¼‰Ctrl + é¼ æ ‡æ»šè½® é€šè¿‡å†…è”æ¶ˆæ¯æ‰“å¼€ Bot é…ç½®æ–‡ä»¶Open Bot Profile via Inline Message Ctrl + ç‚¹å‡»å†…è”æœºå™¨äººçš„åå­— æœç´¢é€‰å®šçš„ä¼šè¯çš„èŠå¤©è®°å½•Search Selected Chat Ctrl + F åˆ†ç»„ Folders åŠ¨ä½œ Action å¿«æ·é”® Shortcut åˆ‡æ¢åˆ°æ”¶è—å¤¹ï¼ˆSave Messagesï¼‰ Ctrl + 0 ç›´æ¥åˆ‡æ¢åˆ°å¯¹åº”çš„åˆ†ç»„Jump directly to the folder Ctrl + 1Ctrl + 2Ctrl + 3Ctrl + 4Ctrl + 5Ctrl + 6Ctrl + 7 åˆ‡æ¢åˆ°æœ€åçš„åˆ†ç»„Jump to the last folder Ctrl + 8 åˆ‡æ¢åˆ°å½’æ¡£å¯¹è¯ï¼ˆArchived Chatsï¼‰ Ctrl + 9 çª—å£ç›¸å…³ Window Related åŠ¨ä½œ Action å¿«æ·é”® Shortcut æœ€å°åŒ–åˆ°ç³»ç»Ÿæ‰˜ç›˜Minimize to System Tray Ctrl + W é€€å‡ºç”µæŠ¥Quit Telegram Ctrl + Q é”å®šç”µæŠ¥Lock Telegram Ctrl + L æœ€å°åŒ–åˆ°ä»»åŠ¡æ Minimize Telegram Ctrl + M é€‰å–æ–‡å­— Selected Text åŠ¨ä½œ Action å¿«æ·é”® Shortcut åŠ ç²—Bold Ctrl + B æ–œä½“Italic Ctrl + I æ’å…¥æ–‡æœ¬é“¾æ¥Create Link Ctrl + K ä¸‹åˆ’çº¿Underline Ctrl + U ç­‰å®½å­—ä½“Monospace Ctrl + Shift + M çº¯æ–‡æœ¬ï¼ˆæ¸…é™¤æ‰€æœ‰æ ¼å¼ï¼‰Null &#x2F; Plain Text Ctrl + Shift + N åˆ é™¤çº¿Strikethrough Ctrl + Shift + X é¼ æ ‡å¿«æ·é”® åŠ¨ä½œ Action é¼ æ ‡å¿«æ·é”® Shortcut å¼•ç”¨Reply å·¦é”®åŒå‡»æ¶ˆæ¯Double click the message å¤šé€‰æ¶ˆæ¯Select Messages åœ¨æ¶ˆæ¯å¤–æ‹–æ‹½å¤šé€‰Drag outside the messages æ˜¾ç¤ºæ¶ˆæ¯å…·ä½“å‘é€æ—¶é—´å’Œæœ€åæ›´æ­£æ—¶é—´Info about Messages é¼ æ ‡æ‚¬åœåœ¨æ—¶é—´æˆ³ä¸ŠHover the timestamp æŠ•ç¥¨æ€»æ•°Amount of Votes in Poll é¼ æ ‡æ‚¬åœåœ¨ç™¾åˆ†æ¯”ä¸ŠHover percentage è½¬å‘æ¶ˆæ¯Forward a message to a chat æ‹–æ‹½æ¶ˆæ¯åˆ°ä¼šè¯åˆ—è¡¨Drag the message to a chat in the list é™éŸ³å‘é€Send Message Silently Sendå®šæ—¶å‘é€Schedule Message å³å‡»å‘é€é”®Right Click on Send Button æŸ¥çœ‹åç»­æ›´æ–°çš„ Keyboard&#x2F;Mouse shortcuts for Telegram Desktopï¼Œè¯·è®¿é—® UseTheKeyboard æˆ– telegramdesktop&#x2F;tdesktop Wikiã€‚ UnigramUnigram æ˜¯ä¸“ä¸º Windows 10 å¼€å‘çš„ Telegram ç¬¬ä¸‰æ–¹å¼€æºå®¢æˆ·ç«¯ï¼ˆåŸºäº TDLibï¼‰ï¼Œå¹¶ä¸”è¢« å®˜æ–¹è®¤å¯ã€‚ä½œä¸º UWP åº”ç”¨ï¼ŒåŸºæœ¬ä¸Š Mobile app ä¸Šæœ‰çš„åŠŸèƒ½ï¼ŒUnigram éƒ½ä¸è½ä¸‹ã€‚ ç›¸æ¯”å®˜æ–¹çš„ Desktop ç‰ˆï¼š æ”¯æŒ Instant View æ”¯æŒç«¯åˆ°ç«¯åŠ å¯†çš„ç§å¯†èŠå¤©ï¼ˆ Secret Chatsï¼‰ æ”¯æŒæŸ¥çœ‹é˜…åå³ç„šçš„ç…§ç‰‡å’Œè§†é¢‘ï¼ˆSelf-destructï¼‰ åœ¨å•ç‹¬çš„çª—å£ä¸­æ‰“å¼€èŠå¤©è®°å½•ï¼ˆShift + å•å‡»ï¼‰ èŠå¤©è¾“å…¥æ¡†ä¸‹å¯æ˜¾ç¤ºæ ¼å¼åŒ–æ–‡æœ¬èœå•ï¼ˆShow formattingï¼‰ åœ¨è¾“å…¥æ¡†ç²˜è´´ Markdown æºç ï¼Œå‘é€åå³å¯æ¸²æŸ“ï¼ŒåŒ…æ‹¬è¶…é“¾æ¥ï¼ˆCtrl + Kï¼‰ é¢‘é“ä¸»å³å‡»å‘é€çš„åŠ¨æ€ï¼Œå¯æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯ï¼ˆStatiaticsï¼‰ï¼šæ­¤æ¡ä¿¡æ¯çš„åˆ†äº«æ¬¡æ•°ä»¥åŠè¢«åˆ†äº«åˆ°å“ªäº›å…¬å¼€é¢‘é“ ç¼ºç‚¹ï¼š ä¸èƒ½æœ€å°åŒ–åˆ°ç³»ç»Ÿæ‰˜ç›˜ï¼Œå¿…é¡»å¸¸é©»åœ¨ä»»åŠ¡æ  å®‰è£… Windows + S è°ƒå‡ºæœç´¢æ¡†ï¼Œè¾“å…¥ åŒºåŸŸ æŠŠ å›½é™…æˆ–åœ°åŒº æ¢åˆ°å…¶å®ƒåœ°æ–¹ï¼Œä¾‹å¦‚ é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒº Windows + S è°ƒå‡ºæœç´¢æ¡†ï¼Œè¾“å…¥ Storeï¼Œæ‰“å¼€ Microsoft Storeï¼Œæœç´¢ Unigram å¹¶å®‰è£… æŠŠ å›½é™…æˆ–åœ°åŒº æ”¹å› ä¸­å›½ ä½¿ç”¨ä»¥ Clash .NET ä¸ºä¾‹ï¼Œå¦‚ä½•è®¾ç½®ç½‘ç»œä»£ç†ï¼Œè®© Unigram è¿ä¸Šå›½é™…äº’è”ç½‘ï¼š å³å‡»æ¡Œé¢ä»»åŠ¡æ æ‰˜ç›˜ä¸Šçš„ Clash .NETï¼Œé€‰æ‹© UWPå›ç¯ &gt; å¯åŠ¨åŠ©æ‰‹ åœ¨å¼¹å‡ºçš„çª—å£ç¡®å®šä¸¤æ¬¡ï¼ˆå¦‚æœæœ‰ï¼‰ å‹¾é€‰ Unigramï¼Œä¿å­˜ï¼ˆSave Changesï¼‰ å®˜æ–¹é¢‘é“ï¼šUnigram News å†…æµ‹é¢‘é“ï¼šUnigram Mirrorï¼ˆæ— éœ€é€šè¿‡ Microsoft Sotre å®‰è£…ï¼‰ å®˜æ–¹ç¾¤ç»„ï¼šUnigram Insiders ç›¸å…³æ–°é—»ï¼šUnigram ç°ç‰ˆæœ¬ï¼ˆv7.8.6586.0ï¼‰ä¼šæœªåŠ å¯†ä¿å­˜åª’ä½“æ–‡ä»¶ - by TGgeek å…³è”é˜…è¯»ï¼š Unigram çš„å®‰è£…åŠä½¿ç”¨ - 404 Unigram å®‰è£…åŠä½¿ç”¨æ•™ç¨‹ â€“ Telegraph by TGgeek ğŸ“ å¯¹è¯åˆ—è¡¨é•¿æŒ‰æŸä¸ªå¯¹è¯çš„å·¦ä¾§ï¼ˆå¤´åƒï¼‰å³å¯é¢„è§ˆæ¶ˆæ¯ï¼ˆPreview mediaï¼‰ã€‚ é•¿æŒ‰æŸä¸ªå¯¹è¯çš„å³ä¾§ï¼š åˆ é™¤å¯¹è¯ï¼ˆDelete chatï¼‰ï¼šå‹¾é€‰ Also delete for ***ï¼Œå³å¯åŒæ—¶åˆ é™¤åŒæ–¹æ‰€æœ‰çš„èŠå¤©è®°å½•ã€‚ ä¸ç”¨ç»è¿‡å¯¹æ–¹åŒæ„ã€‚å¦‚æœä½ çš„æœ‹å‹é­é‡ä¸æµ‹ï¼Œä½ å¯ä»¥åŠæ—¶æ¸…é™¤æ¶ˆæ¯æ¥ä¿æŠ¤è‡ªå·±å’Œå¯¹æ–¹ã€‚ åä¹‹ï¼Œéœ€è¦ä¿ç•™è¯æ®æ—¶ï¼Œè¯·åŠæ—¶æˆªå›¾æˆ–åœ¨æ¡Œé¢ç«¯å¯¼å‡ºèŠå¤©è®°å½•ã€‚ å½’æ¡£å¯¹è¯ï¼ˆArchive chatï¼‰ï¼šæŠŠä¸å¸¸ç”¨çš„ç¾¤ç»„å’Œé¢‘é“æ”¾åˆ°å½’æ¡£æ–‡ä»¶å¤¹ä¸­ï¼Œç²¾ç®€å¯¹è¯åˆ—è¡¨ï¼ŒEverything in its placeã€‚ åœ¨ç§»åŠ¨ç«¯çš„å¯¹è¯åˆ—è¡¨é‡Œï¼Œä»é¡¶éƒ¨å¾€ä¸‹æ‹‰ï¼Œå³å¯çœ‹åˆ°ã€Œå·²å½’æ¡£å¯¹è¯ã€ï¼Œé•¿æŒ‰å¯æ ‡è®°å…¨éƒ¨å½’æ¡£å¯¹è¯ä¸ºå·²è¯»çŠ¶æ€ã€‚ å½“æœªè®¾ç½®é™éŸ³çš„å­˜æ¡£å¯¹è¯æ”¶åˆ°é€šçŸ¥æ—¶ï¼Œå®ƒå°†ä»å½’æ¡£åˆ—è¡¨ä¸­è¿”å›åˆ°èŠå¤©åˆ—è¡¨ä¸­ã€‚ æ›´æ”¹ç½®é¡¶å¯¹è¯çš„é¡ºåº æ‰‹æœºï¼šé•¿æŒ‰æŸä¸ªå¯¹è¯çš„å³ä¾§ï¼Œå³å¯å‡ºç°é¡ºåºæ“çºµæ†ã€‚ ç”µè„‘ï¼šå·¦é”®é•¿æŒ‰å¯¹è¯å¹¶æ‹–åŠ¨ã€‚ ğŸ“‚å¯¹è¯åˆ†ç»„ä» Settings &gt; Folders è¿›å…¥ åˆ†ç»„ç®¡ç† è®¾ç½®ï¼š æœ€å¤šåˆ›å»º 10 ä¸ªåˆ†ç»„ã€‚ æ¯ä¸ªåˆ†ç»„éƒ½èƒ½ç½®é¡¶æ— æ•°ä¸ªå¯¹è¯ï¼ˆUnlimited Pinsï¼‰ã€‚ é»˜è®¤åˆ†ç»„ Unreadï¼šæœªè¯»æ¶ˆæ¯ç»„ï¼Œå¿«é€Ÿæ¶ˆç­æœªè¯»çº¢ç‚¹ã€‚ Personalï¼šä¸ªäººç§èŠç»„ã€‚ Creat New Folderï¼ˆæ–°å»ºåˆ†ç»„ï¼‰æ—¶æœ‰ä»¥ä¸‹ç­›é€‰æ¡ä»¶å¯é€‰ï¼š Contactsï¼ˆè”ç³»äººï¼‰ Non Contactsï¼ˆéè”ç³»äººï¼‰ Groupsï¼ˆç¾¤ç»„ï¼‰ Channelsï¼ˆé¢‘é“ï¼‰ Botsï¼ˆæœºå™¨äººï¼‰ â€¦â€¦ æ“ä½œæŠ€å·§ åœ¨å¯¹è¯åˆ—è¡¨ç•Œé¢ï¼Œé•¿æŒ‰æˆ–è€…å³å‡»åˆ†ç»„åå¯è¿›è¡Œ Reorderï¼ˆæ’åºï¼‰ã€Editï¼ˆé‡å‘½åï¼‰ã€Deleteï¼ˆåˆ é™¤ï¼‰å’Œ Mark ad readï¼ˆæ ‡è®°ä¸ºå·²è¯»ï¼‰ç­‰æ“ä½œã€‚ ç›®å‰åªæ”¯æŒåœ¨ç”µè„‘å®¢æˆ·ç«¯ä¸­è®¾ç½®åˆ†ç»„å›¾æ ‡ï¼ˆFolder Iconsï¼‰ã€‚ ğŸ”´ å…³é—­é€šçŸ¥ Settingsï¼ˆè®¾ç½®ï¼‰&gt; Notifications and Soundsï¼ˆé€šçŸ¥å’Œå£°éŸ³ï¼‰ã€‚ Badge Counterï¼ˆæœªè¯»æ¶ˆæ¯æ•°é‡æ˜¾ç¤ºï¼‰ï¼šå–æ¶ˆ Include Muted Chatsï¼ˆåŒ…å«å·²å…³é—­é€šçŸ¥çš„å¯¹è¯ï¼‰ å¦‚æ­¤è®¾ç½®ï¼Œåªæœ‰æœªé™éŸ³çš„å¯¹è¯ï¼ˆç§èŠ &#x2F; ç¾¤ç»„ &#x2F; é¢‘é“ï¼‰æ¥æ¶ˆæ¯äº†ï¼Œæ‰ä¼šæ”¶åˆ°ã€Œå°çº¢ç‚¹ã€ã€‚ ğŸ§¹ æ¸…é™¤ç¼“å­˜æ­¤ä¸¾åªæ˜¯æš‚æ—¶é‡Šæ”¾å­˜å‚¨ç©ºé—´ï¼Œå› ä¸ºåª’ä½“æ–‡ä»¶éƒ½ä¼šä¿ç•™åœ¨ Telegram äº‘ç«¯ï¼Œè‹¥éœ€è¦å¯ä»¥å†æ¬¡ä¸‹è½½ï¼Œä¾‹å¦‚ç¿»çœ‹å†å²æ¶ˆæ¯çš„æ—¶å€™ã€‚ Settingsï¼ˆè®¾ç½®ï¼‰ Data and Storageï¼ˆæ•°æ®å’Œå­˜å‚¨ï¼‰ Storage Usageï¼ˆå­˜å‚¨ä½¿ç”¨æƒ…å†µï¼‰ Clear Telegram Cacheï¼ˆæ¸…ç†ç¼“å­˜ï¼‰ ğŸ“² å¯¼å…¥æ•°æ®æ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡ WhatsAppã€ Line å’Œ KakaoTalk ç­‰åº”ç”¨ç¨‹åºå°†èŠå¤©è®°å½•ï¼ˆåŒ…æ‹¬è§†é¢‘å’Œæ–‡æ¡£ï¼‰è¿ç§»åˆ° Telegram ä¸Šã€‚ä»¥ WhatsApp ä¸ºä¾‹ï¼š iOS æ‰“å¼€ WhatsApp çš„è”ç³»æ–¹å¼æˆ–ç¾¤ç»„ä¿¡æ¯é¡µé¢ï¼ˆContact Info or Group Infoï¼‰ ç‚¹å‡»å¯¼å‡ºèŠå¤©ï¼ˆExport Chatï¼‰ ç„¶ååœ¨å…±äº«ï¼ˆShareï¼‰èœå•ä¸­é€‰æ‹© Telegram Android æ‰“å¼€ WhatsApp èŠå¤© ç‚¹å‡»æ›´å¤šï¼ˆMoreï¼‰ &gt; å¯¼å‡ºèŠå¤©ï¼ˆExport Chatï¼‰ ç„¶ååœ¨åˆ†äº«èœå•ä¸­é€‰æ‹© Telegram å€ŸåŠ© Telegram çš„äº‘å­˜æ¡£åŠŸèƒ½ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒèŠå¤©è®°å½•ä¸¢å¤±çš„é—®é¢˜ã€‚ ğŸ—ƒï¸ å¯¼å‡ºæ•°æ®âš ï¸æ­¤åŠŸèƒ½éœ€åœ¨ Telegram ç”µè„‘ç‰ˆ ä¸Šè¿è¡Œã€‚ The original meaning of the paper plane on the Telegram logo means â€œfreedomâ€. For us, freedom of choice and data portability are paramount. People should be in complete control over their own data â€“ and their own lives. Telegram æ ‡å¿—ä¸Šçš„çº¸é£æœºçš„åŸæ„æ˜¯ã€Œè‡ªç”±ã€ã€‚å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œé€‰æ‹©è‡ªç”±å’Œæ•°æ®ä¾¿æºæ€§æ˜¯æœ€é‡è¦çš„ã€‚äººä»¬åº”è¯¥å®Œå…¨æ§åˆ¶è‡ªå·±çš„æ•°æ®â€”â€”ä»¥åŠè‡ªå·±çš„ç”Ÿæ´»ã€‚by Pavel Durov èŠå¤©å†å²ä¼šè¢«å­˜å‚¨åœ¨ Telegram äº‘ç«¯ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥å¯¼å‡ºéƒ¨åˆ†ï¼ˆæˆ–å…¨éƒ¨ï¼‰èŠå¤©è®°å½•åˆ°ç”µè„‘ä¸Šç¦»çº¿å›å‘³ï¼Œè€Œä¸”æ’ç‰ˆè¿˜æ˜¯åŸæ¥çš„æ ·å­ã€‚ æ‰“å¼€ Telegram Desktop é€‰æ‹©æŸä¸ªå¯¹è¯ ç‚¹å‡»å¯¹è¯ç•Œé¢å³ä¸Šè§’çš„è®¾ç½®ï¼ˆä¸‰ä¸ªç‚¹ â€¦ï¼‰ å¯¼å‡ºèŠå¤©è®°å½•ï¼ˆExport chat historyï¼‰ ä½ ä¹Ÿå¯ä»¥å¯¼å‡º Telegram çš„æ‰€æœ‰æ•°æ®ã€‚å¯¹ï¼Œæ˜¯æ‰€æœ‰ï¼Œä¸ä»…ä»…æ˜¯èŠå¤©è®°å½•ï¼Œè¿˜æœ‰è´¦å·ä¿¡æ¯ï¼š æ‰“å¼€ Telegram Desktop ä¾æ¬¡ç‚¹å‡» Settings &gt; Advanced &gt; Export Telegram data é€‰æ‹©è¦å¯¼å‡ºçš„æ•°æ®ç±»å‹ ğŸ” è§£é”æ•æ„Ÿå†…å®¹å¦‚ä½•åœ¨ iOS åŸç”Ÿå®¢æˆ·ç«¯æŸ¥çœ‹æ•æ„Ÿå†…å®¹ï¼Œä¾‹å¦‚ NSFWï¼š ç™»å½• Telegram Webï¼ˆç½‘é¡µç‰ˆï¼‰æˆ–è€…ä¸‹è½½å¹¶ç™»å½• Telegram Desktopï¼ˆå®¢æˆ·ç«¯ï¼‰ã€‚ Settingsï¼ˆè®¾ç½®ï¼‰&gt; Privacy and Securityï¼ˆéšç§å’Œå®‰å…¨ï¼‰ã€‚ Sensitive contentï¼ˆæ•æ„Ÿå†…å®¹ï¼‰ å®¢æˆ·ç«¯ï¼šæ‰“å¼€ Disable filteringï¼ˆå…³é—­è¿‡æ»¤ï¼‰ ç½‘é¡µç‰ˆï¼šæ‰“å¼€ Show Sensitive Content æ“ä½œå®Œæˆåï¼Œé‡æ–°å¯åŠ¨ iOS åŸç”Ÿå®¢æˆ·ç«¯ï¼Œå³å¯ Display sensitive media in public channels on all your Telegram devicesï¼ˆå…è®¸åœ¨æ‚¨æ‰€æœ‰ç™»å½• Telegram çš„è®¾å¤‡ä¸Šæ˜¾ç¤ºå…¬å…±é¢‘é“å†…çš„æ•æ„Ÿå†…å®¹ï¼‰ã€‚ ğŸ“£ é¢‘é“æ¨èChannels ç›¸å½“äºå…¬å‘Šæ¿ï¼Œæ˜¯å‘å¤§ä¼—ä¼ æ’­ä¿¡æ¯çš„å®Œç¾å·¥å…·ï¼ˆThe perfect tool for broadcasting messages to the massesï¼‰ï¼Œç±»ä¼¼å¾®ä¿¡å…¬ä¼—å·ï¼Œä½†æ¯”å…¬ä¼—å·å¥½ç”¨å¾—å¤šã€‚ é€šè¿‡ Post Widgetï¼Œä½ å¯ä»¥å°†é¢‘é“æˆ–å…¬å…±ç¾¤ç»„çš„ä»»ä½•æ¶ˆæ¯åµŒå…¥åˆ°ä»»ä½•åœ°æ–¹ã€‚You can embed messages from public groups and channels anywhere. ğŸ“¢ é¢‘é“ä¸» Hashtagsï¼šå¤šç”¨ # ï¼ˆæ ‡ç­¾ï¼‰ç»™æ¶ˆæ¯åˆ†ç±»ï¼Œæ–¹ä¾¿å¿«é€Ÿæ£€ç´¢ï¼ˆç‚¹å‡»é«˜äº®çš„å…³é”®è¯ï¼Œæˆ–è€…åœ¨æœç´¢æ¡†æ‰‹åŠ¨è¾“å…¥ # + å…³é”®è¯ï¼‰ï¼Œç„¶åæŠŠæ ‡ç­¾æ”¾åœ¨ç½®é¡¶ä¿¡æ¯é‡Œï¼Œæˆ–é¢‘é“ä»‹ç»é‡Œã€‚ é¢‘é“åˆ†æï¼ˆChannel Statsï¼‰ğŸ“ˆï¼šè®¢é˜…äººæ•°è¶…è¿‡ 50 äººï¼ˆä¹‹å‰æ˜¯ 1,000 äººï¼‰çš„é¢‘é“ä¼šæœ‰è¯¦ç»†çš„ç»Ÿè®¡æ•°æ®åˆ†ææŠ¥å‘Šï¼ˆStatisticsï¼‰ã€‚ é¢‘é“å¯ä»¥æœ‰æ— æ•°ä¸ªè®¢é˜…è€…ï¼Œä½†æ˜¯åˆ›å»ºè€…åªèƒ½é‚€è¯·å‰ 200 ä¸ªæˆå‘˜åˆ°ä½ çš„é¢‘é“ã€‚ é‡æ–°ç¼–è¾‘ï¼ˆEditï¼‰æ¶ˆæ¯ï¼Œå¤šä¹…ä¹‹å‰å‘çš„ Post éƒ½å¯ä»¥ã€‚ æ”¯æŒåˆ é™¤æ¶ˆæ¯é€šçŸ¥ï¼Œå‡å°‘æ— å…³ç´§è¦çš„åŠ¨æ€å¯¹è®¢é˜…è€…çš„å¹²æ‰°ã€‚å‡ºç°ä»¥ä¸‹é€šçŸ¥åï¼Œå¯ç«‹å³é•¿æŒ‰åˆ é™¤ï¼š æ›´æ¢é¢‘é“ç½®é¡¶çš„æ¶ˆæ¯é€šçŸ¥ *** pinned *** æ›´æ¢é¢‘é“å¤´åƒçš„æ¶ˆæ¯é€šçŸ¥ Channel photo updated æ›´æ”¹é¢‘é“åå­—çš„æ¶ˆæ¯é€šçŸ¥ Channel name was changed to *** å¦‚ä½•è®©ä½ çš„é¢‘é“æˆ–ç¾¤ç»„è¢«æ›´å¤šåŒå¥½çŸ¥é“ï¼Ÿ æ‰“å¼€ @zh_secretary_bot å‘é€é¢‘é“ IDï¼Œä¾‹å¦‚ @tingtalk ç¼–è¾‘ç®€ä»‹å’Œæ ‡ç­¾åï¼Œå³å¯æäº¤æ”¶å½•åˆ° @zh_secretary äººå·¥å®¡æ ¸é€šè¿‡åï¼Œå°±ä¼šåœ¨å¼€æºéç›ˆåˆ©çš„ SE-ç´¢å¼•å…¬å‘Šæ¿ è¢«æ›´å¤šåŒå¥½çœ‹åˆ°å•¦ ç›¸ä¼¼çš„ç´¢å¼•æœºå™¨äººè¿˜æœ‰ @PolarisseekBotã€‚ 2020 å¹´ 9 æœˆ 30 å¼€å§‹ï¼Œç”µæŠ¥é¢‘é“åŸç”Ÿæ”¯æŒè¯„è®ºåŠŸèƒ½ï¼ˆChannel Commentsï¼‰ é¦–å…ˆè¦ åœ¨é¢‘é“çš„è®¾ç½®é‡Œç»‘å®šä¸€ä¸ªç¾¤èŠï¼ˆGroupï¼‰ï¼Œé¢‘é“ä¸­çš„æ¯æ¡æ–°å¸–å­ï¼ˆnew postï¼‰éƒ½ä¼šè‡ªåŠ¨è½¬å‘åˆ°è¯¥ç¾¤ç»„å¹¶è¢«ç½®é¡¶ï¼ˆPinï¼‰ã€‚ é¢‘é“å‘é€æ¶ˆæ¯åï¼Œæœ‰ä¸¤ä¸ªè¯„è®ºå…¥å£ï¼š é¢‘é“ï¼šç‚¹å‡» Leave a comment å³å¯è¿›å…¥ç•™è¨€æ¿ï¼ˆæ— éœ€åŠ å…¥è®¨è®ºç»„ï¼‰ã€‚ ç¾¤ç»„ï¼š ç¬¬ä¸€å±‚è¯„è®ºï¼šå¼•ç”¨ï¼ˆReplyï¼‰å›å¤å¯¹åº”çš„é¢‘é“æ¶ˆæ¯ã€‚ ç¬¬äºŒå±‚è¯„è®ºï¼šæ¥é¾™å¼•ç”¨ç¬¬ä¸€å±‚è¯„è®ºã€‚ ç¬¬ N å±‚è¯„è®ºï¼šä»¥æ­¤ç±»æ¨ã€‚ é€šè¿‡ @LikeComBot ç»™é¢‘é“çš„æ¶ˆæ¯ä¸‹å¢åŠ  Emoji æŒ‰é’®ï¼Œä¾‹å¦‚ ğŸ‘ã€ğŸ‘ã€ğŸ˜ã€‚ ğŸ”” è®¢é˜…è€… Subscriber Privacyï¼šå…³æ³¨è€…æ— æ³•å¾—çŸ¥é¢‘é“åˆ›å»ºè€…ï¼ˆcreatorï¼‰æ˜¯è°ï¼Œä¹Ÿæ— æ³•å¾—çŸ¥è°å…³æ³¨äº†è¿™ä¸ªé¢‘é“ï¼Œä½†æ˜¯é¢‘é“ä¸»çŸ¥é“è°å…³æ³¨äº†é¢‘é“ã€‚ è‹¥ç”¨æˆ·åœ¨ 24 å°æ—¶å†…è®¿é—®è¶…è¿‡ 200 ä¸ªç¾¤ç»„æˆ–é¢‘é“çš„é“¾æ¥ï¼ˆç‚¹å‡»æ‰“å¼€å°±ç®—è®¿é—®ï¼Œä¸éœ€è¦åŠ å…¥ï¼‰ï¼Œå°±ä¼šè¢«æ‰“å…¥å†·å®« 24 å°æ—¶ã€‚ç¦é—­æœŸé—´ï¼Œæ— æ³•é€šè¿‡é“¾æ¥è®¿é—®æ–°çš„ç¾¤ç»„æˆ–é¢‘é“ï¼ˆç‚¹å‡»é“¾æ¥ä¸€ç›´è½¬åœˆè€Œæ— æ³•è®¿é—®ï¼‰ã€‚ é¢‘é“&#x2F;è¶…çº§ç¾¤ç»„çš„å…³æ³¨ä¸Šé™æ˜¯ 500 ä¸ªï¼ˆå…·ä½“æ•°å­—æœªå¾—åˆ°å®˜æ–¹çš„æ±‚è¯ï¼‰ï¼Œä½†æ˜¯é™åˆ¶æ˜¯ä¸€å®šå­˜åœ¨çš„ï¼Œå› ä¸ºé™åˆ¶æç¤ºè¯­å‡ºç°åœ¨å®˜æ–¹ç¿»è¯‘é¡µé¢ï¼šæŠ±æ­‰ï¼Œæ‚¨å·²åŠ å…¥å¤ªå¤šé¢‘é“&#x2F;è¶…çº§ç¾¤ç»„ã€‚è¯·å…ˆé€€å‡ºä¸€äº›é¢‘é“&#x2F;è¶…çº§ç¾¤ç»„åå†åŠ å…¥ã€‚ï¼ˆSorry, you have joined too many channels and supergroups. Please leave some before joining this one.ï¼‰ å»å“ªé‡Œæ‰¾é’Ÿæ„çš„é¢‘é“ï¼ˆChannelï¼‰ï¼Œç¾¤ç»„ï¼ˆGroupï¼‰å’Œæœºå™¨äººï¼ˆBotï¼‰å‘¢ï¼Ÿ â˜ï¸ åœ¨ Telegram å†…ç›´æ¥æœç´¢å…³é”®è¯ï¼Œä½†ä¸­æ–‡æœç´¢è¯†åˆ«è¾ƒå·®ã€‚ä¾‹å¦‚ï¼Œã€Œåº­è¯´ã€çš„é¢‘é“æ˜¯ https://t.me/tingtalk æœç´¢è‹±æ–‡ tingtalkï¼ˆt.me/ åé¢çš„å­—ç¬¦å°±æ˜¯ IDï¼‰ï¼Œå¯ä»¥å‡†ç¡®è¯†åˆ«ã€‚ æœç´¢ä¸­æ–‡ åº­è¯´ï¼Œå¯èƒ½æ— æ³•è¯†åˆ«ã€‚ âœŒï¸ åœ¨ Google ä¸Šæœç´¢ï¼Œé…åˆä¸€äº› Google æœç´¢æŠ€å·§ï¼š æœç´¢ç»“æœè¾ƒå°‘ï¼šå…³é”®è¯ + site:t.meï¼Œä¾‹å¦‚ ç”µå­ä¹¦ site:t.me æœç´¢ç»“æœè¾ƒå¤šï¼šå…³é”®è¯ + telegram åŠå…¶åˆ«ç§°ï¼Œä¾‹å¦‚ï¼šç”µå­ä¹¦ telegram OR ç”µæŠ¥ OR tg è¿™ä¹Ÿè¯æ˜äº† Telegram çš„å†…å®¹æ˜¯å¯ä»¥è¢« Google ç­‰æœç´¢å¼•æ“æŠ“å–çš„ã€‚åè§‚å›½å†…çš„äº’è”ç½‘æ±Ÿæ¹–ï¼Œå„è‡ªå‰²æ®ï¼Œæå¾—ç½‘æ°‘è‹¦ä¸å ªè¨€ã€‚å°±æ‹¿å¾®ä¿¡æ¥è¯´ï¼Œä½ ä¸èƒ½åœ¨ Google æˆ–è€…ç™¾åº¦æœåˆ°å…¬ä¼—å·æ–‡ç« ï¼Œè¿™ä¹Ÿæ˜¯åº­è¯´å¦å¼€ä¸€ä¸ªç‹¬ç«‹åšå®¢çš„åŸå› ã€‚ ä¹Ÿæ„å‘³ç€å¦‚æœä½ æ²¡æœ‰åšå¥½éšç§ä¿æŠ¤ï¼Œè¯·ä¸è¦åœ¨å…¬å¼€é¢‘é“æˆ–ç¾¤ç»„å‘è¨€ï¼Œå°å¿ƒä¸æ€€å¥½æ„çš„ ç½‘ç»œèœ˜è›› çˆ¬åˆ°ä½ èº«ä¸Šã€‚ ğŸ‘Œ Telegram æœç´¢å¼•æ“ï¼ˆéå®˜æ–¹ï¼‰ï¼Œå¯èƒ½åŒ…å«ä¸å°‘ NSFW å†…å®¹ã€‚ ç´¢å¼•æœºå™¨äºº @zh_secretary_bot ğŸ‘ï¼ˆæ”¯æŒä¸­æ–‡æœç´¢ï¼‰ @PolarisseekBot ğŸ‘ï¼ˆæ”¯æŒä¸­æ–‡æœç´¢ï¼‰ @hao1234bot @hao6bot ç½‘é¡µç‰ˆ Lyzem Search ååˆ€ç”µæŠ¥æœç´¢ sssoou.com Telegram å…¬çœ¾ç´¢å¼•ç³»çµ± tlgrmï¼šåªæ”¯æŒç”¨è‹±æ–‡å…³é”®è¯æœç´¢ å¦‚ä½•é€šè¿‡ RSS è®¢é˜… Telegram é¢‘é“ æœ‰äº›ç”¨æˆ·è§‰å¾— Telegram ç”¨æ‰‹æœºå·ç æ³¨å†Œä¸å®‰å…¨ï¼Œä½†æ˜¯åˆæƒ³ç¬¬ä¸€æ—¶é—´è·å¾— Telegram å…¬å¼€é¢‘é“çš„æ›´æ–°ï¼Œé‚£ä¹ˆå¯ä»¥ å€ŸåŠ© RSSHub ç”Ÿæˆç”µæŠ¥å…¬å¼€é¢‘é“çš„ RSS è®¢é˜…é“¾æ¥ï¼Œä¾‹å¦‚ï¼š https:&#x2F;&#x2F;rsshub.app&#x2F;telegram&#x2F;channel&#x2F;tingtalk åªè¦æŠŠ tingtalk æ›¿æ¢æˆå…¶ä»–å…¬å…±é¢‘é“çš„ Permanent linkï¼ˆæ°¸ä¹…é“¾æ¥ï¼‰åç¼€å³å¯ã€‚ é¡»çŸ¥å‚å·®å¤šæ€ï¼Œä¹ƒæ˜¯ç”µæŠ¥ä¹‹ç¦ã€‚æœ¯ä¸šæœ‰ä¸“æ”»ï¼Œæ¬¢è¿å‘æˆ‘æ¨èå…¶å®ƒé¢†åŸŸçš„ä¼˜è´¨é¢‘é“ï¼š åœ¨ Telegram æœç´¢ @tingbot ç®€å•è¯´æ˜æ¨èç†ç”± ä¼˜è´¨é¢‘é“å°†ä¼šæ›´æ–°åœ¨è¿™ç¯‡ã€Šç”µæŠ¥æ•™ç¨‹ã€‹é‡Œï¼Œè®©å¥½å†…å®¹å¾—åˆ°æ›´å¤šçš„å±•ç° ä»¥ä¸‹æ˜¯æˆ‘æ”¶é›†çš„é¢‘é“ï¼Œä¸ä»£è¡¨åŒæ„å…¶è§‚ç‚¹ï¼Œä¹Ÿè®¸ä¸ºäº†ä¸°å¯Œæ–‡ç« å†…å®¹ã€‚å¦‚æœä½ å‘ç°æŸäº›é¢‘é“å¼€å§‹ã€Œä½œæ¶ã€äº†æˆ–è€…å¤±æ•ˆäº†ï¼Œè¯·è”ç³» @tingbot ä»è¿™ä¸ªåˆ—è¡¨ä¸­åˆ é™¤ã€‚ 2021 å¹´ï¼Œä½ éœ€è¦å¤šè¿åŠ¨ï¼Œå¤šåƒè”¬æœï¼Œå¶å°”å¬ æ’­å®¢ï¼Œæ”¾ä¸‹æ‰‹æœºæ—©ç‚¹ç¡è§‰ï¼Œå°‘çœ‹é¸¡é›¶ç‹—ç¢çš„æ¶ˆæ¯ã€‚ å¦‚ä½•åŠ å…¥é¢‘é“æ–¹æ³•ä¸€ï¼šç›´æ¥ç‚¹å‡»é¢‘é“çš„åå­—ï¼Œä¾‹å¦‚ åº­è¯´ï¼Œæµè§ˆå™¨ä¼šè·³è½¬åˆ° Telegram å®¢æˆ·ç«¯å¹¶è¿›å…¥è¯¥é¢‘é“æ–¹æ³•äºŒï¼šå¤åˆ¶é¢‘é“çš„ IDï¼Œä¾‹å¦‚ tingtalkï¼Œç²˜è´´åœ¨ Telegram å®¢æˆ·ç«¯é¦–é¡µçš„ ğŸ” æœç´¢æ¡†ï¼Œåœ¨æœç´¢ç»“æœä¸­æ‰¾åˆ°è¯¥é¢‘é“ âœˆï¸ ç”µæŠ¥å®˜æ–¹é¢‘é“ é¢‘é“ è¯¦æƒ… Telegram News ğŸ‘ ç”µæŠ¥å®˜æ–¹æ–°é—»é¢‘é“ã€‚ Durovâ€™s Channel ğŸ‘ æœç½—å¤«ï¼ˆTelegram åˆ›å§‹äººå’Œ CEOï¼‰çš„é¢‘é“ã€‚ Telegram Tips ğŸ‘ ç”µæŠ¥å°è´´å£«ï¼ˆTipsï¼‰å®˜æ–¹é¢‘é“ã€‚ Telegram APKs for Android Official channel for Telegram Android APKs. You can also download them here. Telegram for macOS Updates This channel publishes release builds for Telegram macOS. Telegram Designers å‘ç”µæŠ¥æä½ æƒ³è¦çš„åŠŸèƒ½ @design_bot BotNews The official source for news about the Telegram Bot API. Telegram Contests Here we announce Telegram coding contests in Android Java, iOS Swift, JS, C&#x2F;C++. Desktop Themes Channel ç”µè„‘å®¢æˆ·ç«¯ä¸»é¢˜åˆ›å»ºæŒ‡å¼• | Custom Themes çš„ç®€å•ä»‹ç» Android Themes Channel å®‰å“å®¢æˆ·ç«¯ä¸»é¢˜åˆ›å»ºæŒ‡å¼• | æ›´å¤šæŠ€æœ¯ç»†èŠ‚å‚é˜… Custom Cloud Themes Telegram Auditions åŠ å…¥ Telegram Support Forceï¼Œå¸®æ‰¶ Telegram åšå¤§åšå¼ºï¼Œè¯¦æƒ…å‚é˜…è¿™ä»½ Initiativeã€‚ ISIS Watch ç”µæŠ¥å®˜æ–¹åæé¢‘é“ï¼šæ¯æ—¥æ±‡æŠ¥æœ‰å¤šå°‘ææ€–ç»„ç»‡ç›¸å…³çš„é¢‘é“è¢«å°äº†ã€‚ æ­¤å¤–ï¼ŒTelegram ä¸Šä¹Ÿæœ‰ å›½å®¶æˆ–åœ°åŒºçš„é¢†å¯¼äººå®˜æ–¹é¢‘é“ã€‚ ç”¨æˆ·åˆ›å»º é¢‘é“ è¯¦æƒ… TGgeek ğŸ‘ TG æå®¢ï¼šåˆ†äº« Telegram ä½¿ç”¨æŠ€å·§ã€é‡è¦èµ„è®¯ã€å¸¸è§é—®ç­”ã€ä¸­æ–‡æ±‰åŒ–ã€ç‰ˆæœ¬æ›´æ–°ç­‰ä¿¡æ¯ã€‚ ç”µæŠ¥å°åŠ©æ‰‹ ç”¨ç®€ä½“ä¸­æ–‡åŒæ­¥ç¿»è¯‘å®˜æ–¹ @TelegramTips ä¸­çš„å°æŠ€å·§ã€‚ Trending Stickers Telegram åˆæ–°å¢äº†å“ªäº›è¡¨æƒ…åŒ…ã€‚ ç´™é£›æ©Ÿ æ¬¢è¿æ­ä¹˜çº¸é£æœºï¼ŒPorsche å’Œä½ èŠèŠ Telegram çš„å¤§å°äº‹ã€‚æ’­å®¢ RSS è®¢é˜…é“¾æ¥ã€‚ Anti Revoke Plugin Telegram æœ¬åœ°æ¶ˆæ¯é˜²æ’¤å›æ’ä»¶ï¼Œå®‰å…¨æ€§æœªçŸ¥ï¼Œåªæ”¯æŒ Windows 32 ä½ç³»ç»Ÿã€‚GitHub é¡¹ç›®åœ°å€ã€‚ ç”µæŠ¥å¯¼èˆª SE-ç´¢å¼•å…¬å‘Šæ¿ zh_secretaryğŸ‘ Telegram ä¸­æ–‡åœˆèµ„æºç´¢å¼•æœåŠ¡ï¼ˆåŒ…å« NSFWï¼‰ã€‚ åŒ—ææ˜Ÿæœç´¢ç™»è®°æ¿ PolarisseekIndex ç”µæŠ¥æŒ‡å— &amp; ç²¾å“æ’è¡Œæ¦œ TgTrillion CN å¯¼èˆª CN_DHç®€å•å¥½è®°çš„ä¸­æ–‡å¤šåŠŸèƒ½å…¬ç›Šå¯¼èˆªé¢‘é“ã€‚ Tg Tips Tg1230ç­æœ›å°æ——ä¸‹ TG ç”µæŠ¥å¼•èˆªï¼šç”µæŠ¥æ“ä½œã€é¢‘é“ã€å¹¿æ’­ã€ç¾¤ç»„çš„ä¿¡æ¯åº“ã€‚ é›»å ±æ–°ç¾¤æ¨é€ Telegram Group Links linkpushæœ¬é »é“æ˜¯æ–°ç¾¤æ¨é€é »é“ä¸€èˆ¬åªæ”¶éŒ„å‰›å‰›å»ºç«‹çš„ç¾¤çµ„æˆ–è€…äººæ•¸å°‘æ–¼ 150 çš„ç¾¤çµ„ã€‚ ğŸ¦  ç–«æƒ… é¢‘é“ è¯¦æƒ… 2019-nCoV ç–«æƒ…å®æ—¶æ’­æŠ¥ ğŸ‘ COVID-19 ä¸­æ–‡æ¶ˆæ¯ by NFNFã€‚ Coronavirus Info å„å›½å®˜æ–¹ç–«æƒ…é€šæŠ¥é¢‘é“åˆ—è¡¨ï¼ˆA list of official channels with information on COVID-19ï¼‰ã€‚ Financial Times: Coronavirus news COVID-19 è‹±æ–‡æ¶ˆæ¯ by é‡‘èæ—¶æŠ¥ã€‚ ğŸ“° æ–°é—»åœ¨ä¸€ä¸ªåçœŸç›¸æ—¶ä»£ï¼Œè¦åˆ†æ¸…äº‹å®å’Œè§‚ç‚¹: å¯¹äºäº‹å®ï¼Œè¦æœ‰å¤šä¸ªç‹¬ç«‹ä¿¡æºäº¤å‰éªŒè¯ã€‚ å¯¹äºè§‚ç‚¹ï¼Œè¦æ³¨æ„è®ºè¿°é€»è¾‘å’Œå› æœå…³ç³»ã€‚ é¢‘é“ è¯¦æƒ… çœ‹é‰´ä¸­å›½ OutsightChina ğŸ‘ ä¸€ä¸ªå¥åº·çš„ç¤¾ä¼šï¼Œä¸è¯¥åªæœ‰ä¸€ç§å£°éŸ³ã€‚çœ‹é‰´ä¸­å›½ï¼Œæ¯å¤©èšç„¦ä¸€åˆ™å…³äºä¸­å›½çš„æ–°é—»äº‹ä»¶ï¼Œå¸¦ä½ å¯¹æ¯”æ¥è‡ªä¸­å¤–ä¸åŒåª’ä½“å¤šå…ƒçš„ã€ä¸ä¸€æ ·çš„è§‚ç‚¹ã€‚ ä¹Œé¸¦è§‚å¯Ÿ ğŸ‘ ä¸å®šæœŸæ¨é€æ–°é—»å’Œæ‚è°ˆã€‚ ç«¹æ–°ç¤¾ 7Ã—24 ä¸å®šæ—¶ç¼–è¯‘å›½å†…å¤–åª’ä½“çš„å³æ—¶æ–°é—»æŠ¥é“ã€‚ æœ‰æ® China Fact Check æ˜¯ä¸€ä¸ªä¸“æ³¨äºå¯¹ä¸­æ–‡å›½é™…èµ„è®¯è¿›è¡Œäº‹å®æ ¸æŸ¥çš„è®¡åˆ’ï¼Œæ˜¯åŸºäºå¿—æ„¿å’Œç½‘ç»œåä½œåŸåˆ™çš„äº‹å®æ ¸æŸ¥è®¡åˆ’ï¼ŒåŠªåŠ›è¿æ¥å¤§å­¦ã€åª’ä½“å’Œå¹³å°ä¸‰æ–¹åŠ›é‡ã€‚ æ–°é—»å®éªŒå®¤ æ¨èè®¢é˜…æ–¹å¯æˆè€å¸ˆçš„ Newsletterã€‚å¾®ä¿¡å…¬ä¼—å·æ–‡ç« å¤‡ä»½ã€‚ å—æ–¹å‘¨æœ« åœ¨è¿™é‡Œï¼Œè¯»æ‡‚ä¸­å›½ã€‚éå®˜æ–¹ã€‚ iDaily æ¯æ—¥ç¯çƒè§†é‡ã€‚ æ–°å‘¨åˆŠ ä¸€æœ¬æ‚å¿—å’Œä¸€ä¸ªæ—¶ä»£çš„ä½“æ¸©ã€‚ å—éƒ½è§‚å¯Ÿ RSS åœ°å€ï¼šhttps://www.nanduguancha.cn/rss æ–°é—»è”æ’­ï¼ˆæ–‡å­—ç‰ˆï¼‰ ã€Šæ–°é—»è”æ’­ã€‹æ˜¯ä¸­å›½ä¸­å¤®ç”µè§†å°æ¯æ—¥åœ¨åŒ—äº¬æ—¶é—´æ™šé—´ 19:00 æ’­å‡ºçš„ä¸€å€‹é‡ç‚¹æ—¶æ”¿æ–°é—»èŠ‚ç›®ï¼Œäº 1978 å¹´ 1 æœˆ 1 æ—¥å¯æ’­ã€‚ ä¸­å›½æ•°å­—æ—¶ä»£æ¶ˆæ¯æ¨é€ è‡´åŠ›äºèšåˆã€Œä¸­å›½çš„ç¤¾ä¼šä¸æ”¿æ²»æ–°é—»ï¼Œå’Œå®ƒåœ¨ä¸–ç•Œä¸Šçš„æ–°å…´çš„è§’è‰²ã€æœ‰å…³çš„æŠ¥é“å’Œè¯„è®ºã€‚ å¤šæ•°æ´¾Masses æˆ‘ä»¬æ˜¯ä¸€ç¾¤åå¯¹èµ„æœ¬ä¸»ä¹‰ã€åå¯¹å¸å›½ä¸»ä¹‰ã€åå¯¹çˆ¶æƒåˆ¶ã€åå¯¹ä¸€åˆ‡å‹è¿«å’Œå®°åˆ¶çš„é’å¹´ã€‚Matters çš„åˆ›ä½œç©ºé—´ç«™ | Newsletter 60 ç§’è¯»æ‡‚ä¸–ç•Œ æ¥è‡ª 60 ç§’è¯»æ‡‚ä¸–ç•Œå…¬ä¼—å·ã€‚ çªå‘æ–°é—» çªå‘æ–°é—»æ¨é€æœåŠ¡ï¼ˆç®€ä½“ä¸­æ–‡ï¼‰ã€‚ NFW News for Work, Not for Work. ç”µæŠ¥æ—¶æŠ¥ æä¾›å…¨å¤©å€™çƒ­ç‚¹ä¸­å›½åŠå›½é™…æ–°é—»ï¼Œæ¶µç›–çªå‘æ–°é—»ã€æ—¶äº‹ã€è´¢ç»ã€å¨±ä¹ã€ä½“è‚²ï¼Œè¯„è®ºã€æ‚å¿—å’Œåšå®¢ç­‰ã€‚ è˜‹æœæ—¥å ± Apple Daily ä¸ºé¦™æ¸¯ä¸Šå¸‚å…¬å¸å£¹ä¼ åª’æ——ä¸‹ç¹ä½“ä¸­æ–‡æŠ¥çº¸ï¼Œç”±å¤§è‚¡ä¸œé»æ™ºè‹±æ‰€åˆ›ç«‹ï¼Œè¢«æ°‘ä¸»æ´¾æ”¯æŒè€…æ™®éè®¤ä¸ºæ˜¯é¦™æ¸¯ç›®å‰å”¯ä¸€æœªè¢«ã€ŒæŸ“çº¢ã€çš„åª’ä½“ã€‚by ç»´åŸºç™¾ç§‘ å°æ¹¾ ä¸­å¤®ç¤¾ é¦™æ¸¯ è‹¹æœæ—¥æŠ¥ å¦‚é¢˜ã€‚ NGOCN NGOCN æ˜¯ä¸€å®¶ä¸­å›½ç‹¬ç«‹åª’ä½“ï¼Œéè¥åˆ©æ€§è´¨ï¼Œè‡´åŠ›å‘å…¬ä¼—æä¾›è¿›æ­¥ã€è´Ÿè´£ä»»ä¸”å¤šå…ƒçš„çºªå®æ€§å†…å®¹ï¼Œç›®å‰ç”±è®¤åŒå…¶ç†å¿µå¿—æ„¿è€…è¿è¥ã€‚ ä¸­åäººæ°‘å…±å’Œå›½å¤–äº¤éƒ¨å‘è¨€äººè¡¨æ€ å¤–äº¤éƒ¨è´Ÿè´£å¤„ç†ä¸­åäººæ°‘å…±å’Œå›½æ”¿åºœä¸ä¸–ç•Œå…¶ä»–å›½å®¶æ”¿åºœåŠæ”¿åºœé—´å›½é™…ç»„ç»‡çš„å¤–äº¤äº‹åŠ¡ã€‚ ç«¯å‚³åª’ Initium Media ç”±ç¨‹å¼è‡ªå‹•ç²å–ä¸¦æ¨é€ç«¯å‚³åª’ RSS æ‰€æœ‰æ–‡ç« ï¼Œé“¾æ¥è‡³å®˜ç½‘ã€‚ ç«¯ä¼ åª’ RSS é“¾æ¥è‡³ Telegraph å’Œå®˜ç½‘ã€‚RSS åœ°å€ï¼šhttps://rsshub.app/initium/latest/zh-hans ç«¯ä¼ åª’ æ¯æ—¥æ¨é€ç«¯ä¼ åª’ï¼ˆä»˜è´¹ï¼‰æ–‡ç« .pdfã€‚æ‰‹å¤´å®½è£•ï¼Œè¿˜æ˜¯ ä»˜è´¹è´­ä¹°ç«¯ä¼šå‘˜ æˆ–è´­ä¹° æ–°é—»é€šè®¯ Newsletterã€‚ ğŸŒ å›½å¤–åª’ä½“ï¼ˆç®€ä½“ä¸­æ–‡ï¼‰ é¢‘é“ è¯¦æƒ… çº½çº¦æ—¶æŠ¥ä¸­æ–‡ç½‘ ğŸ‘ The New York Times (NYT) åˆ›åˆŠäº 1851 å¹´ï¼Œä¸–ç•Œä¸Šæœ€è‘—åçš„æŠ¥çº¸ä¹‹ä¸€ã€‚ç¾å›½ä¸¥è‚ƒæŠ¥åˆŠçš„ä»£è¡¨ï¼Œè·å¾—è¿‡ 122 é¡¹æ™®åˆ©ç­–å¥–ï¼Œæ˜¯è·å¥–æœ€å¤šçš„åª’ä½“ã€‚ BBC ä¸­æ–‡ç½‘ BBC News æ˜¯ä¸–ç•Œæœ€å¤§çš„å…¬å…±å¹¿æ’­å…¬å¸ï¼Œä½äºè‹±å›½ï¼Œèµ„é‡‘ä¸»è¦æ¥è‡ªè‹±å›½å›½æ°‘ç¼´çº³çš„ç”µè§†ç‰Œç…§è´¹ï¼Œæ˜¯ä¸€å®¶ç‹¬ç«‹è¿ä½œçš„å…¬å…±åª’ä½“ï¼ˆéå•†ä¸šåª’ä½“ï¼Œä¹Ÿä¸ç”±è‹±å›½æ”¿åºœæ§åˆ¶ï¼‰ã€‚ è”åˆæ—©æŠ¥ zaobao.sg æ—©æŠ¥ + æ™šæŠ¥ + æ–°æ˜æ–°é—»ã€‚ è·¯é€ä¸­æ–‡ç½‘ Reuters ä¸–ç•Œä¸‰å¤§é€šè®¯ç¤¾ä¹‹ä¸€ï¼Œæˆç«‹äº 1851 å¹´ï¼Œæ€»éƒ¨ä½äºè‹±å›½ä¼¦æ•¦ã€‚ å¾·å›½ä¹‹å£° Deutsche Welle (DW) æŒ‰å¾·å›½å…¬æ³•è®¾ç«‹çš„å›½é™…åŒ–å…¬å…±åª’ä½“ï¼Œä»è”é‚¦æ”¿åºœè·å¾—æ‹¨æ¬¾ï¼Œæ€»éƒ¨ä½äºæ³¢æ©å’ŒæŸæ—ã€‚ æ¾³å¤§åˆ©äºšå¹¿æ’­å…¬å¸ Australian Broadcasting Corporation (ABC) æ˜¯æ¾³å¤§åˆ©äºšçš„å›½å®¶å…¬å…±å¹¿æ’­æœºæ„ï¼Œå®ƒç”±æ”¿åºœå‡ºèµ„ï¼Œå‘æ¾³å¤§åˆ©äºšå’Œæµ·å¤–æä¾›ç”µå°ã€ç”µè§†ã€äº’è”ç½‘æœåŠ¡ã€‚æ€»éƒ¨è®¾åœ¨æ‚‰å°¼ã€‚ æ³•å›½å›½é™…å¹¿æ’­ç”µå° Radio France Internationale (RFI) æ˜¯æ³•å›½ä¸“è´£ä¸–ç•Œå¤§éƒ¨åˆ†åœ°åŒºä¹‹å›½é™…å¹¿æ’­çš„ç”µå°å¹¿æ’­æœºæ„ï¼Œç°éš¶å±æ³•å›½å›½è¥å›½é™…å¹¿æ’­å…¬å¸æ³•å›½ä¸–ç•Œåª’ä½“æ——ä¸‹ã€‚by ç»´åŸºç™¾ç§‘ ç¾å›½ä¹‹éŸ³ä¸­æ–‡ç½‘ Voice of America (VOA) æˆç«‹äº 1942 å¹´ 2 æœˆï¼Œæ˜¯ç¾å›½æ”¿åºœå¯¹å¤–è®¾ç«‹å’Œèµ„åŠ©çš„å›½æœ‰éå†›äº‹å›½é™…å¹¿æ’­å®£ä¼ å–‰èˆŒï¼Œç”±ç¾å›½å›½é™…åª’ä½“ç½²ç®¡ç†ï¼Œæ——ä¸‹æ‹¥æœ‰å¹¿æ’­ç”µå°ä¸ç”µè§†å°ï¼Œæ€»éƒ¨åº§è½åœ¨é¦–éƒ½åç››é¡¿ã€‚by ç»´åŸºç™¾ç§‘ åå°”è¡—æ—¥æŠ¥ RSS åœ°å€ï¼šhttps://feedx.net/rss/wsj.xml ä¿„ç½—æ–¯å«æ˜Ÿé€šè®¯ç¤¾æ–°é—» Sputnik æ˜¯ä¿„ç½—æ–¯æ”¿åºœæ§åˆ¶çš„æ–°é—»æœºæ„ä»Šæ—¥ä¿„ç½—æ–¯åª’ä½“é›†å›¢äº 2014 å¹´ 10 æœˆå¼€é€šçš„æ–°é—»é€šè®¯ç¤¾ã€æ–°é—»ç½‘ç«™ã€å¹¿æ’­ç”µå°ä¸åª’ä½“æ–°é—»ä¸­å¿ƒã€‚by ç»´åŸºç™¾ç§‘ éŸ©å›½æ–°é—» æœé²œæ—¥æŠ¥ + ä¸­å¤®æ—¥æŠ¥ä¸­æ–‡ç‰ˆ æ—¥æœ¬æ–°é—» å…±åŒç½‘ + æœæ—¥æ–°é—»ä¸­æ–‡ç½‘ + æ—¥æœ¬ç»æµæ–°é—»ä¸­æ–‡ç‰ˆ åŒè¯­æ–°é—» çº½çº¦æ—¶æŠ¥åŒè¯­æ–°é—» + ä¸­å›½æ—¥æŠ¥ç½‘è‹±è¯­ç‚¹æ´¥ Twitter Subscription æ¬è¿ä»¥ä¸‹ Twitter è´¦å·ï¼šBBC News ä¸­æ–‡ã€DW ä¸­æ–‡- å¾·å›½ä¹‹å£°ã€å›½é™…ç‰¹èµ¦ç»„ç»‡ä¸­æ–‡ã€çº½çº¦æ—¶æŠ¥ä¸­æ–‡ç½‘ã€‚ æ–°é—»æ’­æŠ¥ PDF æ¯å¤©ä¸ºå¤§å®¶é€æ¥ NYT å’Œ BBC çš„æ–°é—» PDFã€‚ Whatâ€™s News æ¨é€å„ç§è‹±æ–‡å¤–åˆŠå’Œæ‚å¿—çš„ PDFã€‚ ä»¥ä¸Šéƒ¨åˆ†ä»‹ç»æ¥è‡ªè¥¿æ–¹åª’ä½“æŸ¥ä¸€æŸ¥ã€‚æŸ¥è¯¢å¯ä¿¡åº¦å’Œå€¾å‘æ€§ï¼Œè¯·å®‰è£… æµè§ˆå™¨æ’ä»¶ï¼Œæˆ–è€…è®¿é—® å¾®ä¿¡å°ç¨‹åºã€‚ å›½å®¶ &amp; å‘è¨€äººï¼ˆå·²è®¤è¯ï¼‰ é¢‘é“ è¯¦æƒ… Gov.sg æ–°åŠ å¡ã€‚ Donald Trump Jr ç‰¹æœ—æ™®ã€‚ ğŸ’¸ è´¢ç»æ–°é—» é¢‘é“ è¯¦æƒ… è´¢ç»å¿«è®¯ å…¨çƒè´¢ç»èµ„è®¯ 24 å°æ—¶ä¸é—´æ–­ç›´æ’­ã€‚ FT ä¸­æ–‡ç½‘ Financial Timesï¼ˆé‡‘èæ—¶æŠ¥ï¼‰åˆ›åˆŠäº 1888 å¹´ï¼Œç¼–è¾‘æ€»éƒ¨ä½äºä¼¦æ•¦ï¼Œ2015 å¹´è¢«æ—¥æœ¬ç»æµæ–°é—»æ”¶è´­ã€‚ ğŸ’¾ ç§‘æŠ€ é¢‘é“ è¯¦æƒ… Solidot ğŸ‘ å¥‡å®¢çš„èµ„è®¯ï¼Œé‡è¦çš„ä¸œè¥¿ã€‚ Readhub ğŸ‘ readhub.cn éå®˜æ–¹ RSS æ¨é€é¢‘é“ã€‚ Newlearnerã®è‡ªç•™åœ° ğŸ‘ ä¸å®šæœŸæ¨é€ IT ç›¸å…³èµ„è®¯ã€‚ Appinn Feed ğŸ‘ åˆ†äº«å…è´¹ã€å°å·§ã€å®ç”¨ã€æœ‰è¶£ã€ç»¿è‰²çš„è½¯ä»¶ã€‚ å°‘æ•°æ´¾ ğŸ‘ å°‘æ•°æ´¾è‡´åŠ›äºæ›´å¥½åœ°è¿ç”¨æ•°å­—äº§å“æˆ–ç§‘å­¦æ–¹æ³•ï¼Œå¸®åŠ©ç”¨æˆ·æå‡å·¥ä½œæ•ˆç‡å’Œç”Ÿæ´»å“è´¨ã€‚ ç§‘æŠ€çˆ±å¥½è€…å‘¨åˆŠ ğŸ‘ è®°å½•æ¯å‘¨å€¼å¾—åˆ†äº«çš„ç§‘æŠ€å†…å®¹ï¼Œå‘¨äº”å‘å¸ƒï¼›éå®˜æ–¹é¢‘é“ã€‚ç§‘æŠ€çˆ±å¥½è€…å‘¨åˆŠåˆé›†ã€‚ TestFlight ç§‘æŠ€èŠ± å‘å¸ƒç§‘æŠ€æ–°é—»ã€App æµ‹è¯•ç‰ˆé“¾æ¥ã€è½¯ä»¶ä½¿ç”¨ç›¸å…³è¯é¢˜ã€‚ Hacker News Top stories from news.ycombinator.com (with 100+ score). V2EX - æœ€æ–°&#x2F;æœ€çƒ­ä¸»é¢˜ V2EX æ˜¯åˆ›æ„å·¥ä½œè€…ä»¬çš„ç¤¾åŒºï¼Œå¯ä»¥åˆ†äº«ç”Ÿæ´»å’Œäº‹ä¸šã€‚ ç§‘æŠ€åœˆçš„æ—¥å¸¸ ç§‘æŠ€åœˆå†…çš„å¤§äº‹å°äº‹ã€‚ Telegram ä¸­æ–‡ NEWS èªèª çš„é¢‘é“ï¼šæä¾›å°è±¡ç¬”è®°ã€Telegramã€ç§‘å­¦ä¸Šç½‘ç­‰æ–°é—»ã€‚Telegram çŸ¥è¯†æ±‡æ€»ã€‚ æ¯æ—¥æ¶ˆè´¹ç”µå­è§‚å¯Ÿ ä¸å…¬æ­£ï¼Œä¸å®¢è§‚ï¼Œä¸ç†æ€§ã€‚ cnBeta cnBeta.COM ä¸­æ–‡ä¸šç•Œèµ„è®¯ç«™æ˜¯ä¸€ä¸ªæä¾› IT ç›¸å…³æ–°é—»èµ„è®¯ã€æŠ€æœ¯æ–‡ç« å’Œè¯„è®ºçš„è§‚ç‚¹çš„ä¸­æ–‡ç½‘ç«™ã€‚ IT ä¹‹å®¶ RSS åœ°å€ï¼šhttps://www.ithome.com/rss/ APPDO æ•°å­—ç”Ÿæ´»æŒ‡å— ä¼˜è´¨æ•°å­—ç”Ÿæ´»æŒ‡å—ï¼Œä¼ é€’æ•°ç ç”Ÿæ´»å’Œè®¾è®¡ç†å¿µã€‚ VPS ä¿¡å·æ——æ’­æŠ¥ å…³æ³¨ VPS å’Œé€šä¿¡è‡ªç”±ã€‚ ç¡¬æ ¸å°å’ åˆ†äº«ä¼˜è´¨çš„ç§‘æŠ€&#x2F;å•†ä¸šèµ„è®¯ã€‚ çŸ¥ä¹æ—¥æŠ¥ è¶Šæ¥è¶Šéš¾ç”¨çš„é—®ç­”ç½‘ç«™ã€‚ Daily Tech News æ¯æ—¥ç§‘æŠ€æ–°é—»ã€‚ æ¯æ—¥ AWESOME è§‚å¯Ÿ æ¯æ—¥æ›´æ–°åˆ†äº«æœ€ç‚«é…·çš„å¼€æºé¡¹ç›®ã€‚ LetITFly News ä¸»é¢˜åŒ…æ‹¬ä½†ä¸é™äº Androidã€Windowsã€Webã€æ¶ˆè´¹ç”µå­ç›¸å…³ï¼Œå¹æ°´ä¸ºä¸»ã€‚ Science Science News channel, videos and articles - international project, 35+ countries. OnePlus Everything OnePlus. è€æ¯›å­ Padavan å›ºä»¶å‘å¸ƒ ä¸€ä¸ªè·¯ç”±å™¨å›ºä»¶ã€‚ æ²¹æ²¹åˆ†äº«é¢‘é“ åˆ†äº«å¼€æºã€ä¼˜ç§€çš„è½¯ä»¶ï¼Œæœ‰è¶£ã€å®ç”¨çš„ç½‘ç«™èµ„æºã€‚ Widget ä¼˜è´¨å·¥å…·å’Œè½¯ä»¶ï¼Œä»¥åŠæœ‰ç”¨æœ‰è¶£çš„ç§‘æŠ€èµ„è®¯ã€‚ ç§‘æŠ€äº’è”ç½‘ å³åˆ»ç²¾é€‰ jike_readå³åˆ»ç²¾é€‰ï¼Œä»¥åŠç›¸å…³è®¨è®ºã€‚è¿™é‡Œæ˜¯å³å‹ä»¬çš„ TG è‡ªç•™åœ°ã€‚ Apple AppleGuide AppleBuyersGuideå°èƒ– çš„è‹¹æœäº§å“è´­ä¹°æŒ‡å—ï¼Œæ›´ç³»ç»Ÿè¯·æŸ¥çœ‹ AppleGuide.cnï¼Œä¸æ–­å®Œå–„ä¸­ã€‚ æœæ ¸ Apple Nuts AppleNutsä¸€ä¸ªæœç²‰ï¼ˆHackl0usï¼‰çš„é—²è¨€ç¢è¯­ï¼Œ ç”¨æ¥æ¨é€è‹¹æœï¼ˆAppleï¼‰ ç›¸å…³çš„æŠ€æœ¯ã€æ–°é—»èµ„è®¯ã€æŠ€å·§ã€äº§å“&#x2F;è½¯ä»¶å¿ƒå¾—ä½“ä¼šç­‰ã€‚ AppPie AppPieApple ç›¸å…³çš„æ•°å­—ç”Ÿæ´»æŒ‡å—ã€‚ iOS é™å…ä¸ä¼˜è´¨åº”ç”¨æ¨è iosblackteckappå…è´¹ä½¿ç”¨æ­£ç‰ˆåº”ç”¨ï¼Œä»¥åŠåˆ†äº« iOS å„ç§é«˜æ•ˆå®ç”¨åº”ç”¨ä¸å®ç”¨é»‘æŠ€å·§ã€‚ iOS Releases iOSUpdatesiOS, TvOS and watchOS signing status updates. This channel will notify you when apple starts or stops signing a firmware version. Android é—®é“ mdqwsfè¯¥é¢‘é“ apk ä¸ºä¸ªäººæ±‰åŒ–è€Œæ¥ã€‚ è½¯ä»¶ ç®€æ‚¦ - SimpRead simpreadè®©ä½ ç¬é—´è¿›å…¥æ²‰æµ¸å¼é˜…è¯»çš„ Chrome æ‰©å±•ï¼Œè¿˜åŸé˜…è¯»çš„æœ¬è´¨ï¼Œæå‡ä½ çš„é˜…è¯»ä½“éªŒã€‚å¸Œæœ›åšä¸€äº›è®©è¿™ä¸ªä¸–ç•Œå˜å¾—æ›´ç¾å¥½çš„å°äº‹ã€‚by Kenshinç½‘ç«™ | è®¢é˜…ä¸­å¿ƒ ğŸ“š åšä¸» é¢‘é“ è¯¦æƒ… åº­è¯´ ğŸ‘ ç¬¬ä¸€æ—¶é—´è·å–åšå®¢çš„æ›´æ–°é€šçŸ¥ä»¥åŠç¢ç‰‡åŒ–æ€è€ƒã€‚ åº­è¯´ - å” å¨é¢‘é“ @tingtalk_all å‘å¸ƒä¸€äº›ä¸»é¢‘é“ @tingtalk ä¹‹å¤–çš„å¢é‡æ›´æ–°ä»¥åŠç¢ç‰‡åŒ–æ€è€ƒã€‚ å°ç ´ä¸å…¥æ¸  ğŸ‘ ç§‘æŠ€è¯„è®ºäºº Jesse Chanï¼Œåšå®¢æ˜¯ å¤§ç ´è¿›å‡»ã€‚ ä¸€å¤©ä¸–ç•Œ ğŸ‘ ä¸€å¤©ä¸–ç•Œï¼Œæ˜†ä¹±ä¸æŒ¡ã€‚ä¸é¸Ÿä¸‡å¦‚ä¸€ä¸»ç†ã€‚IPN å‡ºå“ã€‚ caoz çš„æ¢¦å‘“ ğŸ‘ è®¤è¯†æ›¹æ”¿ä¹‹åï¼Œæ„Ÿè§‰äº’è”ç½‘ç»ˆäºå…¥é—¨äº†ã€‚by Fenng ZUOLUOTV ğŸ‘ ç§‘æŠ€ &#x2F; æ—…è¡Œ &#x2F; æ‘„å½± &#x2F; ç”Ÿæ´»æ–¹å¼ &#x2F; åšå®¢ ä¸æ±‚ç”šè§£ ğŸ‘ Newlearnerã®è‡ªç•™åœ° ç¼–è¾‘ï¼›è®¾è®¡å¸ˆ oooooohmygosh çš„ä»£è¨€äººã€‚ å°é“æ¶ˆæ¯ å¤§é“æ— å½¢ï¼Œå°é“æ¶ˆæ¯ï¼›å…¬ä¼—å·å¤‡ä»½ç«™ç‚¹ã€‚ å–æ¡ƒè€…è¯´ åšå®¢æ˜¯ MacTalkï¼šæ± å»ºå¼ºçš„éšæƒ³å½•å…³æ³¨æŠ€æœ¯å’Œäººæ–‡ã€‚ æ•°å­—ç§»æ°‘ æ— æ³•è‚‰èº«ç§»æ°‘çš„æƒ…å†µä¸‹ï¼Œåœ¨æ•°å­—ç”Ÿæ´»ä¸Šè¿½æ±‚ä¸€å®šçš„è‡ªç”±ï¼›åšå®¢ã€‚ Real Spencer Woo å¼€å‘è€… &#x2F; è®¾è®¡å¸ˆ &#x2F; å°‘æ•°æ´¾ &#x2F; å­¦ç”Ÿ &#x2F; åšå®¢ã€‚ Sukkaâ€™s Notebook Belongs to Hexo dev team &#x2F; åšå®¢ã€‚ æ‰«åœ°åƒ§ç¬”è®° æ¯å¤©æ‰€è§æ‰€é—»æ‰€æƒ³ï¼Œæ˜¯ä¸ªæ ‘æ´ã€‚ ä¸€æ–¹å¤©åœ° å¿ƒç•™ä¸€æ–¹å¤©åœ°ï¼Œä¸–ç•Œä¾æ—§ç¾å¥½ã€‚ æ¹¾åŒºæ—¥æŠ¥ å…³æ³¨åˆ›ä¸šä¸æŠ€æœ¯ï¼Œä¸å®šæœŸæ¨é€ 5 ç¯‡ä¼˜è´¨è‹±æ–‡æ–‡ç« ã€‚ æµ·é¾™è¯´ ç‰¢è®°æ¢¦æƒ³ï¼Œè‡ªç„¶ç”Ÿé•¿ã€‚by éƒæµ·é¾™çš„åšå®¢ è”ææœ¨ è¿™ä¸ªä¸–ç•Œå¾ˆå¤æ‚ï¼Œæˆ‘å°è¯•ç€å»ç†è§£å®ƒã€‚ KAIX.IN æ€è€ƒç¢ç‰‡ï¼Œåšå®¢ æ›´æ–°ã€‚ TSBBLOG å½±å­çš„åšå®¢ï¼šç‹¬ç«‹è§‚å¯ŸåŠè®°å½•ã€‚ AK è®²åºŸè¯ ç§‘æ™®è§†é¢‘ç³»åˆ—ï¼šæ— çº¿æŠ€æœ¯ã€æ˜¾ç¤ºæŠ€æœ¯ã€ç¿»å¢™æŠ€æœ¯â€¦â€¦ P3TERX ZONE P3TERX è¯»ä½œ Peter Xã€‚ å€¼ç‰©å¿— åˆ†äº«å„ç§å€¼å¾—å°è¯•çš„äº‹ç‰©ï¼šå€¼å¾—è¯»çš„ä¹¦ã€å€¼å¾—ç”¨çš„è½¯ä»¶ã€å€¼å¾—çœ‹çš„ç”µè§†å‰§â€¦â€¦ å°è™ã®è‡ªç•™åœ° è®¨è®ºå®¶è£…å¿ƒå¾—æˆ–è€…æœ‰è¶£å®ç”¨çš„å®¶å…·ç”µå™¨ã€‚ Leonn çš„åšå®¢ ä½ä»·ä¸»æœºï¼ˆVPSï¼‰èµ„æºã€‚ Yachenâ€™s Channel åˆ˜äºšæ™¨æ˜¯ Surge çš„å¼€å‘è€…| Yachenâ€™s Blog BennyThinkâ€™s Blog éšä¾¿åˆ†äº«ç‚¹ä»€ä¹ˆï¼Œå¯èƒ½æ˜¯æŸéƒ¨å‰§ï¼Œå¯èƒ½æ˜¯æŸé¦–æ­Œï¼Œå¯èƒ½æ˜¯ä¸€ç‚¹ç‚¹æ„ŸåŠ¨çš„ç¬é—´ï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘æœ€çˆ±çš„è€å©†ã€‚ MolunSays å¸Œå†€ç¬”å°–ä¹‹ä¸‹ï¼Œä¸–ç•Œå…´æ—ºç¹å | åšå®¢ æ—¥å¸¸äººé—´è§‚å¯Ÿ å…³å¿ƒç§‘æŠ€ &#x2F; äººæ–‡ &#x2F; è‰ºæœ¯ &#x2F; åŸå¸‚å…¬å…±ç©ºé—´ &#x2F; å¥³æ€§å’Œæ€§åˆ«è®®é¢˜ &#x2F; åŠ³å·¥æƒç›Š &#x2F; ä¸ªä½“å™äº‹ &#x2F; ç”µå½± &#x2F; éŸ³ä¹ &#x2F; ä¹¦ &#x2F; æ˜Ÿæ˜Ÿâ€¦â€¦ In The Flux å…³äºæ–‡åŒ–ã€è‰ºæœ¯ä¸æŠ€æœ¯çš„ä¿¡æ¯æµã€‚ ä¸ºä¹Ÿè¡Œ ã€Œä¹¦ç± | ç”µå½± | èµ„æº | æŠ€å·§ | æ‘¸é±¼å›¾ã€å¤§å¤šåŸåˆ›ï¼Œå°‘éƒ¨åˆ†è½¬å‘ã€‚ Jerry Zhang çš„é¢‘é“ åœ¨æ¸¥å¤ªåçš„é•¿æ˜¥äººã€‚åšå®¢ï¼šOverflowï¼Œå‘ä¿¡æ¯è¿‡è½½çš„ä¸–ç•Œå¤§å–Šã€‚æ’­å®¢ï¼šã€Šç§‘æŠ€èšå˜ã€‹ï¼ˆTechFusionï¼‰ï¼Œæˆ‘ä»¬è°ˆè®ºæœ‰å…³äº’è”ç½‘çš„ä¸€åˆ‡ã€‚ è€äººå’Œç³Ÿ æ²¡æœ‰é¢‘é“ç®€ä»‹ï¼Œç§‘æŠ€ç›¸å…³ã€‚ Karen åŒ»ç”Ÿã®æ—¥å¸¸ ä¸€ä¸ªå°åŒ»ç”Ÿçš„é€šè®¯ç«™ã€‚ä¸æƒ³å‡ºåï¼Œåªä¼ æ’­ä¸€äº›ä¿¡æ¯å’Œç§‘æ™®ã€‚è°¨æ…å…³æ³¨ï¼Œä¼šå‘ä¸€äº›è¡€æ·‹æ·‹çš„å›¾ç‰‡ã€‚ äººæµ·æ‹¾è´FlipRadio ç¿»è½¬ç”µå°çš„ Channelï¼Œä¸€äº›é›¶é›¶æ•£æ•£çš„è¦åˆ†äº«çš„ä¸œè¥¿ã€‚ Find Blog å‘ç°ä¼˜ç§€çš„åšå®¢ä¸åˆ›ä½œè€…ã€‚ TomBenâ€™s Web Excursions PhD Studentã€Productivity Enhancerã€Writing Enthusiast åšå®¢ | å°‘æ•°æ´¾ ç†Šè¨€ç†Šè¯­ ã€Œç†Šè¨€ç†Šè¯­ã€æ˜¯ä¸€æ¡£å…³æ³¨å­¦ä¹ åˆ†äº«å’ŒçŸ¥è¯†ç§‘æ™®çš„ æ’­å®¢ æ ç›®ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨å£°éŸ³è®°å½•æ”¹å˜ä¸æˆé•¿ã€‚æ€è€ƒé—®é¢˜çš„ç†Šå’Œä»–çš„æœ‹å‹ä»¬ä¸€èµ·èŠå­¦ä¹ å·¥ä½œã€èŠç§‘ç ”ç§‘æ™®ã€‚åšå®¢ | Newsletter Hell Cell åŠŸèƒ½æ•™å­¦ é€šè¿‡ YouTube è§†é¢‘è®²è§£ä¸€äº›å®ç”¨è½¯ä»¶é‚£äº›æœ‰ç”¨æœ‰è¶£çš„åŠŸèƒ½ã€‚ The Sociologist æˆ‘ä»¬åªè°ˆè®ºè®°å¿†ï¼Œå› ä¸ºä¸å†æœ‰è®°å¿†ã€‚ æ¯æ—¥æ‘„å½±è§‚å¯Ÿ ä¸€ä¸ªä¸ä¸¥è‚ƒçš„æ‘„å½±é¢‘é“ã€‚ ä¸­åœ‹å®¶åœ°ç†é›œèªŒä¸­æ–‡ç‰ˆ Hi æ¢éšªå®¶ï¼Œå’Œåœ‹å®¶åœ°ç†ä¸€èµ·æ¢ç´¢ä¸–ç•Œå§ï¼ EdNovas çš„å°ç«™ @ednovas2ç½‘ç«™ï¼šednovas.xyzå¯¼èˆªï¼šnavigate.ednovas.xyz gledos çš„å¾®å‹åšå®¢ gledos_microbloggingè¯·è®°ä½æˆ‘ä»¬ï¼Œå› æˆ‘ä»¬ä¹Ÿåœ¨è¿™ä¸–ä¸Šçˆ±è¿‡å’Œç¬‘è¿‡ã€‚ Route 66 Blog landofmaplexç½‘ç«™ï¼šç•™å­¦ã€ç§»æ°‘ã€ç¨‹åºå‘˜ã€æ­»ç£•åŒ—ç¾ã€åŠ æ‹¿å¤§ã€ç¾å›½ã€è·‘è·¯ã€ç§»æ°‘ç”Ÿæ´»ã€‚ ä¸­æ–‡ç‹¬ç«‹åšå®¢åˆ—è¡¨ by timqian ğŸ”” RSS é¢‘é“ è¯¦æƒ… RSSHub å¸ƒå‘Šæ  ä¸‡ç‰©çš†å¯ RSSã€‚ All About RSS å…³äº RSS æŠ€æœ¯çš„åº”ç”¨ã€å‘¨è¾¹ã€ä»‹ç»ã€æ–¹æ³•ã€æ•™ç¨‹ã€æŒ‡å—ã€è®¨è®ºã€è§‚ç‚¹ã€‚ RSS é¢‘é“æ”¶é›† æ”¶é›†æ¨é€ RSS çš„é¢‘é“ï¼ŒæŠŠ TG å˜æˆ RSS é˜…è¯»å™¨ã€‚ ğŸ™ æ’­å®¢é‡‡ç”¨ RSS è®¢é˜…çš„æ’­å®¢ï¼Œæ°¸è¿œéƒ½ä¸ä¼šè¿‡æ—¶ã€‚ é¢‘é“ è¯¦æƒ… ã€Œåˆ©å™¨xæ’­å®¢ã€è®¡åˆ’ å®˜ç½‘ æ’­å®¢å…ˆå£° åˆ†äº«å…³äºæ’­å®¢çš„ä¸€åˆ‡ã€‚by Zac ä¸­æ–‡æ’­å®¢ç²¾é€‰ åˆ†äº«ç²¾é€‰ä¼˜è´¨ä¸­æ–‡æ’­å®¢ï¼Œç›®å‰æ¨èå•æœŸèŠ‚ç›®ä¸ºä¸»ã€‚by ç™½æ˜¼ç”µå° çš„ä¸»æ’­ Stella Your Daily Dose of Podcast æ¯å¤©æ¨èä¸€é›†è®©äººå¿ƒæ½®æ¾æ¹ƒã€è‹¥æœ‰æ‰€æ€ã€æ‰“å¼€æ–°ä¸–ç•Œå¤§é—¨çš„æ’­å®¢èŠ‚ç›®ã€‚by ç©¿å ‚é£æ¨èçš„æ’­å®¢ä¼šåŒæ­¥æ›´æ–°åœ¨ Mediumæˆ‘åœ¨è±†ç“£ä¸Šåˆ†äº«äº† 400 é›†æ’­å®¢èŠ‚ç›®ï¼Œæœ‰ä»€ä¹ˆç”¨ï¼Ÿ äº¤å·®ç‚¹ Technology alone is not enough. ä¸å®¢è§‚ Not Objective ä¸€æ¡£æ­å»ºåœ¨ Telegram çš„ç®€æ˜“æ’­å®¢ï¼Œçº¯ä¸»è§‚æ„Ÿå—ã€‚by éƒæµ·é¾™ ç™½æ˜¼ç”µå° The Day é»‘å¤œå·²æ·±ï¼Œç™½æ˜¼å°†è¿‘ï¼Œæˆ‘ä»¬å°±å½“è„±å»æš—æ˜§çš„è¡Œä¸ºï¼Œå¸¦ä¸Šå…‰æ˜çš„å…µå™¨ã€‚ ç»´ç”Ÿç´  E ç»æµå­¦ä¸å“²å­¦çŸ¥è¯†åˆ†äº«ã€‚ Go å¤œèŠ ä¸€æ¡£ç”±æ¨æ–‡å’Œæ¬§é•¿å¤ä¸»æŒçš„é’ˆå¯¹ Go è¯­è¨€çš„æ’­å®¢èŠ‚ç›® é˜¿ä¹æ‚è´§é“º è¿™é‡Œæ¯æ—¥æ¨é€å°äººç‰©æ’­å®¢åŠæ’­å®¢å‘¨è¾¹ï¼›èŒä¸šå‘å±•ã€è‡ªæˆ‘æˆé•¿ã€è¯»ä¹¦ç”µå½±ã€æµ·å¤–å·¥ä½œä¸ç”Ÿæ´»ç¢ç‰‡ã€‚ ğŸµ éŸ³ä¹ é¢‘é“ è¯¦æƒ… çŸ¥éŸ³ ğŸ‘ å‘ä¸€äº›å…³äºéŸ³ä¹çš„ä¸œè¥¿ã€‚ Imusic éŸ³ä¹ï¼Œå°±æ˜¯ç†æƒ³çš„æŒ½æ­Œï¼Œå¹´ä»£ä¹…è¿œï¼Œä¾ç„¶é£˜æ‰¬ã€‚ æ‚é±¼Music Channel æˆ‘ç›¸ä¿¡ï¼Œçˆ±éŸ³ä¹çš„äººéƒ½æœ‰ç€ä¸€é¢—æŸ”è½¯çš„å¿ƒã€‚ éŸ³ä¹ä¸–ç•Œ æ¸©æŸ”è¢«æˆ‘å”±æˆäº†æ­Œï¼Œä¼´ä½ äººå±±äººæµ·ä¸åœç•™ã€‚ å¿ƒå£°ï¼šéŸ³ä¹åˆ†äº«é¢‘é“ åˆ†äº«ä¸€äº›èƒ½å¼•èµ·å…±é¸£çš„éŸ³ä¹ã€‚ æ¯æ—¥ä¸€æ­Œ æ„¿ä½ ä¹Ÿèƒ½åœ¨è¿™é‡Œæ‰¾åˆ°å±äºä½ è‡ªå·±çš„å…±é¸£ã€‚ Classical Music ä¸€èµ·æ¥å¬å¤å…¸éŸ³ä¹å§ã€‚ è›™éŸ³é€šè®¯ Feels wonderful again man. æ— æŸéŸ³ä¹é¢‘é“ åˆ†äº«æ— æŸéŸ³ä¹ã€é«˜å“è´¨éŸ³ä¹ã€åŸç¢Ÿæ•´è½¨åˆ†è½¨éŸ³é¢‘ã€‚ æµ¦é•‡é’å¹´ æå¿—ã€‚ å´”å¥æ— æŸ ä¸­å›½å¤§é™†æ‘‡æ»šå…ˆé©±è€…ã€‚ éŸ³ä¹åˆ†äº«é¢‘é“ ä¸€èˆ¬ä¸ºæ— æŸéŸ³ä¹ã€‚ éŸ³ä¹å±‹ å‘ç°éŸ³ä¹æ–°ä¸–ç•Œï¼šliveã€é»‘èƒ¶ã€ç£å¸¦ CXPLAY MUSIC å•æ›²éŸ³ä¹è¯•å¬ï¼Œä¸“è¾‘å­˜æ”¾åœ¨ è¿™ã€‚ ä¸‹è½½éŸ³ä¹ï¼Œè¿˜å¯ä»¥æŸ¥é˜…ä¸‹æ–‡ä¸­æåˆ°çš„éŸ³ä¹æœºå™¨äººã€‚ ğŸ« è¯»ä¹¦äººç±»çš„æ‚²å–œå¹¶ä¸äº’é€šï¼Œä½†è¯»ä¹¦æ˜¯èµ°å‘å…±åŒç†è§£çš„æ·å¾„ã€‚ é¢‘é“ è¯¦æƒ… Word Power Made Easy åˆ©ç”¨è¯æ ¹ï¼ˆåŸå§‹å°æ¬§è¯­ã€æ‹‰ä¸è¯­ã€å¤å¸Œè…Šè¯­ï¼‰å­¦ä¹ è‹±è¯­å•è¯ã€‚ è‹±è¯­ç²¾è¯»å­¦ä¹  å¤œç©ºä¸­æœ€äº®çš„æ˜Ÿï¼Œå°±æ˜¯ä½ è‡ªå·±ï¼æˆ‘ä»¬ä¸€èµ·ç²¾è¯»è‹±è¯­ï¼Œä¸€èµ·è¿›æ­¥ï¼Œé‡è§æ›´å¥½çš„è‡ªå·±å§ï¼èµ„æ–™ä¸å®šæ—¶æ›´æ–°å“Ÿï¼ ENGLISH PODCASTS INFINITY PODCASTS CHANNEL WITHOUT ANY LIMITS. ä¸­æ–‡ç¤¾ç§‘è®²åº§èµ„è®¯ ä¸€ä¸ªè®²åº§ä¿¡æ¯èšåˆå’Œ PPT å…±äº«å¹³å°ã€‚ ReadFine ç”µå­ä¹¦å±‹ è‡´åŠ›äºç”µå­ä¹¦åˆ†äº«çš„è¯»ä¹¦é¢‘é“ã€‚EPUB ç”µå­ä¹¦ä¸€ç«™å¼é˜…è¯»ä½“éªŒï¼ˆåŒ…æ‹¬è±†ç“£è¯„åˆ†ã€ä¹¦ç±ç®€ä»‹ã€å°é¢æˆªå›¾ï¼‰ï¼Œä¸€é”®ä¸‹è½½ï¼Œäº«å—è¯»è¶£ã€‚ The Economist Sharing Channel Sharing the Economist and E-books every week. ä»€ä¹ˆä¹¦å€¼å¾—è¯» ä»…æ¨é€æŸäºšåŸç‰ˆèµ„æºï¼Œå¯åŒæ—¶ä¸‹è½½ .azw3 .epub .mobi çš„ç”µå­ä¹¦ã€‚ å¥½ä¹¦åˆ†äº«é¢‘é“ å­¦ä¹ ï¼Œæ˜¯ä¸€è¾ˆå­çš„å¤§äº‹ã€‚ å°å£°è¯»ä¹¦ ä¸€ä¸ªæ¢ç´¢æ•°å­—é˜…è¯»å¯èƒ½æ€§å’Œæœªæ¥çš„å¼€æ”¾é¡¹ç›®ï¼Œè‡´åŠ›äºæ‰“ç ´ä¿¡æ¯èŒ§æˆ¿ï¼ŒæŒ–æ˜ä»·å€¼ä¿¡æ¯ã€‚ å€¼å¾—ä¸€çœ‹çš„æ–‡ç«  é˜…è¯»æ›´å°‘ï¼Œæ”¶è·æ›´å¤šã€‚ äº‘ä¸ŠæŠ¥åˆŠäº­ è‹±æ–‡æŠ¥åˆŠæ‚å¿—ã€ç”µå­ä¹¦ã€æŠ¥çº¸å’Œå¤–æ–‡æ‚å¿—ç²¾é€‰ã€‚ Î›-Reading åˆ†äº«ä¹¦å’Œé˜…è¯»ã€è®¤çŸ¥ç§‘å­¦ã€ç§‘æŠ€å“²å­¦ã€æ–°ç§‘æŠ€ä»¥åŠå…¶å®ƒç»™ç”Ÿæ´»å¸¦æ¥ä¸€ä¸ç¾å¥½çš„äº‹ç‰© | Newsletter è‡­ï¼ˆxiÃ¹ï¼‰æ–‡å­— è¯—æ­Œé¢‘é“ï¼›æˆ‘æ˜¯ä¸€ä¸ªå—…è§‰ç‰¹åˆ«å‘è¾¾çš„äººï¼Œä½ è¯´ï¼Œç„¶è€Œï¼Œæ²¡æœ‰ä¸€ç§è‰ºæœ¯å¯ä¾›æˆ‘çš„é¼»å­ç”¨æ­¦ï¼Œåªæœ‰ç”Ÿå‘½å¯ä»¥ã€‚ å·²æœ‰ä¸¹é’ç´„ï¼»æ›¸ç•«ï¼½ é«˜æ¸…æ²¹ç”»æ¡£æ¡ˆï¼ˆè¶…è¿‡ä¸¤ä¸‡å¼ ï¼‰ã€‚ é˜¿é“¶ä¹¦å±‹ å¶å°”æ›´æ–°ï¼Œæ²¡äº‹æ¥çœ‹çœ‹ã€‚ çº¢æ¥¼æ¢¦ æ¯æ—¥ä¸€ç«  ğŸ’DreamOfRedMansionsã€‚ æ’æ’­ä¸€ä¸ªå…è´¹çš„å¹¿å‘Šï¼šå­¦è‹±è¯­ï¼Œæ¨èè´­ä¹°éƒæµ·é¾™è€å¸ˆçš„ã€Šè‹±è¯­è‡ªå­¦æ‰‹å†Œã€‹ï¼ˆï¿¥119ï¼‰ã€‚ ğŸš€ ç¿»å¢™è½¯ä»¶ é¢‘é“ è¯¦æƒ… Clash .NET å…¬å‘Š ğŸ‘&#x2F; A Clash GUI Proxy For Windows Based On .NET 5 Fndroid çš„æ—¥å¸¸ ğŸ‘ Clash for Windows Clash for Android Channel A Graphical user interface of Clash for Android Surfboard News å®‰å“ä¸“äº«çš„ç¿»å¢™å®¢æˆ·ç«¯ï¼Œä½†ä¸æ”¯æŒ SSRã€‚ç”¨æˆ·æ‰‹å†Œ SagerNet Apks æ”¯æŒ SOCKSã€HTTP(S)ã€Shadowsocksã€ShadowsocksRã€VMessã€VLESSã€Trojanâ€¦â€¦ç­‰åè®®SagerNet å®˜ç½‘ AnXray Another Xray for Android GitHub Shadowrocket News iOS ä¸Šå°ç«ç®­ Quantumult News Quantumult çš„éå®˜æ–¹é¢‘é“ã€‚ Quantumult X News æ­¤é¢‘é“ç”¨äºå‘å¸ƒ Quantumult ä¸ Quantumult X çš„ç›¸å…³èµ„è®¯ã€‚ è¿·é›¾é€šï¼ˆGephï¼‰ ä¸ä¼—ä¸åŒçš„å¼€æºç¿»å¢™è½¯ä»¶ï¼Œæä¾›å®Œå…¨å…è´¹çš„ä¸­é€Ÿæµè§ˆï¼Œå¤Ÿæµè§ˆæ–°é—»ã€æŸ¥é‚®ä»¶ã€çœ‹æ ‡æ¸…è§†é¢‘ç­‰ã€‚è¶…å¿«é€Ÿåº¦çš„ä»˜è´¹ Plus è´¦å·ä»…éœ€ â‚¬5&#x2F;æœˆã€‚æˆªè‡³ 2021 å¹´ 5 æœˆ 29 æ—¥ï¼Œæš‚ä¸æ”¯æŒ iOS è®¾å¤‡ã€‚ åè®® &amp; è„šæœ¬ &amp; è§„åˆ™ é¢‘é“ è¯¦æƒ… V2Fly Shadowsocks æ˜¯ä¸€ä¸ªçº¯ç²¹çš„ä»£ç†å·¥å…·ï¼Œè€Œ V2Ray å®šä½ä¸ºä¸€ä¸ªå¹³å°ï¼Œä»»ä½•å¼€å‘è€…éƒ½å¯ä»¥åˆ©ç”¨ V2Ray æä¾›çš„æ¨¡å—å¼€å‘å‡ºæ–°çš„ä»£ç†è½¯ä»¶ã€‚by æ–° V2Ray ç™½è¯æ–‡æŒ‡å— ACL4SSR https://github.com/ACL4SSR/ACL4SSR å®˜æ–¹é¢‘é“ã€‚ QuanX &amp; Surge &amp; Loon è„šæœ¬æ”¶é›† å„ç§è„šæœ¬ã€‚ QuantumultX æ•™ç¨‹&amp;API&amp;è§£æå™¨ å¦‚é¢˜ã€‚ Cool Scripts QuanX, Loon, Surge, JsBox, Pythonista, Scriptable, Shortcuts ç­‰è„šæœ¬åˆ†äº«ã€‚ DivineEngine ç¥æœºè§„åˆ™ è¯„æµ‹ é¢‘é“ è¯¦æƒ… æ¯’è¯æœºåœºè¯„æµ‹ ç”±äºå¤§é™†åœ°åŒºç½‘ç»œç¯å¢ƒååˆ†å¤æ‚ï¼Œæµ‹é€Ÿä¸ä»£è¡¨æ¨èã€‚å¦å¤–ï¼Œæœ‰äº›æœºåœºä¼šæ³„éœ²ä¸ªäººä¿¡æ¯ï¼Œé€‰è´­æ—¶å¤šåŠ æœç´¢æˆ–è€…è¿›å…¥æœºåœºç”¨æˆ·ç¾¤æ‰“æ¢æ‰“æ¢ã€‚ å“äº‘â˜ï¸æµ‹é€Ÿ ç»†å“å„ç§äº‘â˜ï¸ã€‚PinYun is a non-profit organization dedicated to making the internet a better place for everyone. ç§‘å­¦ä¸Šç½‘ä¸æœºåœºè§‚å¯Ÿ ç§‘å­¦ä¸Šç½‘ä¸æœºåœºç›¸å…³è§‚å¯Ÿã€ç‚¹è¯„ã€éšæƒ³å’Œæ–°é—»èµ„è®¯ã€‚ å…³è”é˜…è¯» ç•ªèŒ„é£Ÿç”¨æŒ‡å—ï¼ˆç§‘å­¦ä¸Šç½‘æ•™ç¨‹ï¼‰ | åº­è¯´ ç•ªèŒ„ç§æ¤æŒ‡å—ï¼ˆæ¢¯å­æ­å»ºæ•™ç¨‹ï¼‰ | åº­è¯´ ğŸ—„ï¸ æ¬è¿ é¢‘é“ è¯¦æƒ… ç…è›‹æ— èŠå›¾ è‡ªåŠ¨æŠ“å–ç…è›‹é¦–é¡µæ¨èæ— èŠå›¾åŠå…¶è¯„è®ºã€‚ å†…æ¶µæ®µå­ï¼šçš®ä¸€ä¸‹ å¦‚é¢˜ã€‚ ç¾å›¾ä¸æ²™é›• å¦‚é¢˜ã€‚ ç³—äº‹ç™¾ç§‘ å¦‚é¢˜ã€‚ å¿ƒæƒŠæŠ¥ åˆä¸€ä¸ªæ²™é›•å›¾é¢‘é“ï¼Œæ¯æ—¥éšç¼˜æ›´æ–°ã€‚ ä½ çŸ¥é“çš„å¤ªå¤šäº† ä¸å®šæœŸå‘å¸ƒå’Œè½¬è½½å„ç±»ä¸ä¸€å®šé è°±çš„å†…å¹•ã€æµè¨€èœšè¯­ã€å°çŸ¥è¯†ç­‰ã€‚ è›‹æŒæŠ¥ åˆ†äº«é˜…è¯»ä½“éªŒã€‚ å¾®ä¿¡æ¬è¿å·¥ æœ‰äº›å¾®ä¿¡çš„å†…å®¹åˆ†äº«äº†ä¹‹åå°±å’Œè°äº†ï¼Œæœ¬é¢‘é“å¯ä»¥åšä¸ªå¤‡ä»½ï¼Œä»¥åŠä¸°å¯Œç”µæŠ¥ä¸Šçš„ä¸­æ–‡å†…å®¹ï¼ˆä¸å¯å¦è®¤è¿˜æ˜¯æœ‰å¾ˆå¤šéæ”¿æ²»çš„ä¼˜è´¨å†…å®¹åœ¨å¾®ä¿¡å…¬ä¼—å·é‡Œï¼‰ã€‚ å¾®åšç²¾é€‰ æ¥è‡ªå¾®åšçš„æ–‡ç« ã€èµ„æºå’Œè§‚ç‚¹ã€‚ è±†ç“£ç²¾é€‰ è±†ç“£ä¹¦å½±éŸ³ï¼Œä»¥åŠç›¸å…³è®¨è®ºã€‚ é¹…ç»„ç²¾é€‰ è±†ç“£é¹…ç»„ éå®˜æ–¹æ¬è¿ã€‚ å³åˆ»ç²¾é€‰ ç²¾é€‰å³åˆ» app çƒ­é—¨è¯é¢˜æ›´æ–°ã€‚æˆ‘çš„å³åˆ» ID æ˜¯ Dr_Tingã€‚ ä½ ä¸çŸ¥é“çš„å†…å¹•æ¶ˆæ¯ åŒæ—¶æŠ“å–æ¥è‡ªå³åˆ» app çš„ #å¤§å…¬å¸çš„è´Ÿé¢æ–°é—»ã€‚ Matters é–²è®€ç²¾é¸ matters.news ä¸€å€‹è‡ªä¸»ã€æ°¸çºŒã€æœ‰åƒ¹çš„å‰µä½œèˆ‡å…¬å…±è¨è«–ç©ºé–“ã€‚ ğŸ†“ èµ„æº é¢‘é“ è¯¦æƒ… Google Play é™å…ä¿¡æ¯ ä¸å®šæ—¶æ¨ä»‹ Play Store ä¸Šçš„é™å…æ¸¸æˆå’Œ Appã€‚ Price Tag æ¨è App é™å…é™ä»·ï¼Œæ¨é€å¥½ç‰©å¥½åˆ¸ã€‚ çº¯ç²¹çš„ App Store åº”ç”¨æ¨è iOS å®ç”¨å…è´¹ã€ç²¾é€‰é™å…ã€ä¼˜è´¨å†°ç‚¹åº”ç”¨æ¨èã€‚ åæ–—é™å… è¿™é‡Œæœ‰åæ–—è½¯ä»¶å’Œåæ–—é™å…çš„æ–‡ç« æ›´æ–°ã€‚æ›´æ–°é¢‘ç¹é«˜ã€‚ å¦‚æœ‰ä¹äº« æ›´æ–° å¦‚æœ‰ä¹äº«åšå®¢ çš„å†…å®¹ï¼šäº‘æœåŠ¡å™¨ã€ä¼˜æƒ æ´»åŠ¨ã€ç¾Šæ¯›ä¿¡æ¯ä»¥åŠå„ç§ Bugã€‚ iShare News ä¸€ä¸ªæ²¡æœ‰ç®€ä»‹çš„èµ„æºåˆ†äº«é¢‘é“ã€‚ Zapro Notice è½¯ä»¶åˆ†äº«ã€‚ App å–µ ç ´è§£è½¯ä»¶èµ„æºå…±äº«ã€‚ Google Drive èµ„æº å„ç§ Google Drive èµ„æºï¼ŒåŒ…æ‹¬ç”µå½±ã€ç”µå­ä¹¦ã€æ— æŸéŸ³ä¹ç­‰ï¼Œ10 ä¸‡+ å…³æ³¨ã€‚ Google Voice é“å· ä¸€ä¸ª GV å–å®¶ã€‚ Windows 10 æ¿€æ´»ç åˆ†äº« ğŸ¤« Office Tool Plus Office Tool Plus æ˜¯ä¸€ä¸ªç”¨äºéƒ¨ç½²ã€æ¿€æ´»Officeã€Visioã€Project çš„å°å·¥å…·ã€‚å€ŸåŠ©æœ¬å·¥å…·ï¼Œä½ å¯ä»¥å¿«é€Ÿåœ°å®Œæˆå„é¡¹Office éƒ¨ç½²å·¥ä½œã€‚ ä½ æœ‰ä¸€ä¸ªæ‰“æŠ˜éœ€è¦äº†è§£ åˆ†äº« Steam çš„å‘¨æ¦œã€æŠ˜æ‰£ã€èµ„è®¯ã€å–œåŠ ä¸€ç­‰ã€‚ 52 ç ´è§£ä¿¡æ¯ å¾çˆ±ç ´è§£ã€‚ æ“…é•¿æœç´¢çš„é«˜æœ¨åŒå­¦ gaomutongxue é»‘ç§‘æŠ€è½¯ä»¶èµ„æºåˆ†äº« kkaifenxiang åˆ†äº«å…è´¹å®ç”¨é«˜æ•ˆç‡ç½‘ç»œèµ„æºã€é»‘ç§‘æŠ€è½¯ä»¶ã€å®ç”¨é»‘æŠ€å·§ã€‚ Discover good software ksc666 åˆ†äº« Magiskã€Riruã€LSPosedã€è™šæ‹Ÿæ¡†æ¶ã€Xposed æ¨¡å—ã€Magisk æ¨¡å—ã€Androidã€Windowsâ€¦â€¦ç­‰è½¯ä»¶ã€‚ ç ´è§£å®‰å“ VPN è½¯ä»¶ vpn_cracked å‘å¸ƒåŸåˆ›ç ´è§£çš„ VPN å’Œå„ç§è½¯ä»¶ï¼Œä»¥åŠåˆ†äº«å„ç±»èµ„æºï¼Œå¤šä½å®‰å“é€†å‘å¤§ä½¬åé•‡ã€‚ ä¸‡èƒ½ç¦åˆ©å§ @wnflbåˆ†äº«æœ‰è¶£çš„ä¿¡æ¯ï¼ŒåŒ…å«ç½‘ç«™ã€æ´»åŠ¨ã€ç½‘è´­ã€ä¸‹è½½ç»¼åˆç—‡ã€å¥½å­©å­çœ‹ä¸è§ç­‰ç¦åˆ©ã€‚ ğŸï¸ è§†é¢‘ç”µå½± &#x2F; å‰§é›† å››åº“å…¨ä¹¦ video4lib ğŸ‘ä¸€ä¸ªä¸æ–­æ”¶é›†äº’è”ç½‘æœ‰ä»·å€¼å†…å®¹çš„ä¼åˆ’ã€‚ ç”µå½±é¢‘é“ TGDY188ç²¾é€‰å›½å†…å¤–é«˜åˆ†ç”µå½±ã€‚ åè”ç¤¾ç”µå½±é¢‘é“ Cctv365 éœ¸ç‹é¾™å‘å¸ƒé¢‘é“ T_rex2333ä¸“æ³¨äºéŸ©ç¾å‰§ï¼Œé€‰å–ä¼˜è´¨å½±ç‰‡æºã€‚ è‹ç‚å½±é™¢ cangyanmovieåˆ†äº«æœ€æ–°æœ€çƒ­é—¨çš„ä¼˜è´¨ç”µå½±ã€‚ åŒè¯­çŸ­è§†é¢‘åˆé›† english_bilingualå­¦ä¹ è‹±è¯­ï¼Œäº†è§£ä¸–ç•Œã€‚ åŠ¨æ¼« æµ·è´¼ç‹æ›´æ–°æé†’ tingtalk_op@TingTalk å­é¢‘é“ï¼Œè¯•è¿è¥ã€‚ç”±åˆä¸­å¼€å§‹è¿½ One Piece çš„ Dr_Ting åˆ›å»ºï¼Œ Rick and Morty@TingTalk å­é¢‘é“ï¼Œè¯•è¿è¥ã€‚æ›¾ç»æŠŠã€Šç‘å…‹å’Œè«è’‚ã€‹ä½œä¸ºç»ƒå£è¯­çš„ ç´ æï¼Œå¬äº†ä¸Šç™¾éï¼Œä½†æ•ˆæœç”šå¾®ï¼ŒWubba Lubba Dub-Dubã€‚ ä¸‹è½½ç«™ Odyssey+ odysseypluså…¬ç›Šæœé£Ÿç”¨æŒ‡å—ã€‚ PT èµ„è®¯é¢‘é“ @PrivateTrackerNewsPrivate Tracker èµ„è®¯ä»¥åŠå¼€æ”¾æ³¨å†Œä¿¡æ¯æ¨é€ï¼›PT å¯ä»¥ç®€å•ç†è§£ä¸ºç§æœ‰åŒ–çš„ BTã€‚ Sync èµ„æºæ›´æ–° @shenkeyåªå‘ keyã€‚ ç”µè§†æœºé¡¶ç›’ &amp; æ‰‹æœºå½±è§† App @tvbox001 å¯çœ‹æ¸¯å°ç”µè§†ç›´æ’­ã€ç¾å‰§ç­‰ã€‚ ğŸ˜º å…¶å®ƒè½¯ä»¶ Aria2 Channel @Aria2_ChannelAria2 å®Œç¾é…ç½®ã€Pro Dockerã€Pro Coreã€ä¸€é”®å®‰è£…ç®¡ç†è„šæœ¬å¢å¼ºç‰ˆ (GNU&#x2F;Linux)ã€‚ æœªåˆ†ç±» NBA tingtalk_nba@TingTalk å­é¢‘é“ï¼Œè¯•è¿è¥ã€‚ä»é«˜ä¸­å¼€å§‹åªç»ƒè·³æŠ•ï¼Œå› æ­¤ä¸¥é‡åç§‘ï¼Œä¸ä¼šçªç ´ï¼Œä¸ä¼šæŠ¢ç¯®æ¿ï¼Œä¸ä¼šé˜²å®ˆï¼Œä½†å´´è„šå°‘äº†ï¼Œå‘½ä¸­ç‡é«˜äº†ã€‚ é¢‘é“ è¯¦æƒ… iYouPort IYP ä¸æ˜¯è¿‡çœ¼äº‘çƒŸçš„æ–°é—»ç½‘ç«™ï¼Œæˆ‘ä»¬æä¾›å®æˆ˜èƒ½åŠ›ï¼Œè¿™é‡Œæ˜¯å€¼å¾—æ‚¨åå¤å›çœ‹çš„æ¡£æ¡ˆå®¤ã€‚ å®‰å…¨ä¸Šç½‘æ³¨æ„äº‹é¡¹ è½¬è½½ä¸€äº›å…³äºå®‰å…¨ä¸Šç½‘çš„æ–‡ç« ï¼Œè¿™äº›æ–‡ç« éƒ½æ¯”è¾ƒæµ…æ˜¾ã€‚ åšæµ·æ‹¾è´ åšæµ·æ‹¾è´ çš„ç½‘ç«™ï¼šbh.sb å›å½¢é’ˆPaperClip &amp; çµå…‰ç¯æ³¡ å›å½¢é’ˆå†…å®¹æ¨é€ã€‚ åˆç§Ÿ Netflixã€YouTubeã€Spotifyã€Office 365ã€HBOã€Appleã€Surgeâ€¦â€¦ History Digging Past. Photos from Past who shaped today. æ¯æ—¥æ— æ•°çŒ« è®©æˆ‘ä»¬æ‰“é€ ä¸€ä¸ªå…¨æ˜¯çŒ«çš„ä¸–ç•Œï¼à¸…^â€¢ï»Œâ€¢^à¸… NS æ–°é—»è½¬æŠ¥ ä»»å¤©å ‚ï¼ˆNintendoï¼‰ç›¸å…³çš„æ–°é—»ã€‚ åŸºç£è®²é“ åŸºç£è®²é“èµ„æºé¢‘é“ã€‚ å°±è¦é€ å æ­¤é¢‘é“ç«‹è¶³ç”Ÿæ´»ï¼Œä»¥éå¸¸å¤æ€ªçš„æ–‡å­—é£æ ¼è¿›è¡Œç”Ÿå­˜ç»éªŒä¹¦å†™ï¼Œç»˜åˆ¶æ™¯è§‚ä¸æ¶ˆè´¹ç¤¾ä¼šä¸­æå…·ç°å®æ€§çš„ä¸ªæ¡ˆï¼Œä»¥æ­¤ä¸ºä¸ªä½“æä¾›å¯æ“çš„ã€åˆ›é€ æ€§çš„æŠµåˆ¶ç­–ç•¥ä¸é€ åè®¡è°‹ã€‚ä¸ºä¸€åˆ‡é€ åè€…è¾©æŠ¤ï¼Œä¸ºæ‰€æœ‰æ— ç”¨ä¸ä¸°é¥¶è¾©æŠ¤ã€‚ æ®‹éšœä¹‹å£° åœ¨æ€åº¦å’Œç¯å¢ƒéšœç¢ç›¸äº’ä½œç”¨å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œæä¾›åˆç†ä¾¿åˆ©æ˜¯å…¨ç¤¾ä¼šéœ€è¦ä¸€åŒå»è§£å†³çš„é—®é¢˜ï¼Œæ®‹éšœäººå£«åº”å½“ç†ç›´æ°”å£®åœ°è¦æ±‚è¿™ç§æƒåˆ©å’Œä¾¿åˆ©ï¼Œå»å®šä¹‰ä¸€ä¸ªæ— éšœç¢çš„ç¤¾ä¼šã€‚ æ¯æ—¥ä¸€å¥ meiriyijuæ¯å¤©ä¸€å¥å¿ƒçµé¸¡æ±¤ï¼Œé…ä¸Šå¿…åº”æ¯æ—¥å£çº¸ã€‚ Leanote leanoteä»Šå¤©çš„å®šä½ï¼ˆä»Šå¤©çš„æ˜¯ä»€ä¹ˆæ—¥å­ï¼‰ï¼šå•å‘å†ã€monoæ—¥ç­¾ç­‰ ğŸ¤– Bot æ¨èBotsï¼ˆæœºå™¨äººï¼‰å°±åƒè¿è¡Œåœ¨ Telegram å†…éƒ¨çš„å°ç¨‹åºã€‚å€ŸåŠ© Telegram å¼€æ”¾çš„ APIsï¼Œå¯ä»¥å®ç°å¾ˆå¤šè®©ä½ æ„æƒ³ä¸åˆ°çš„åŠŸèƒ½ã€‚ BotNewsï¼šThe official source for news about the Telegram Bot API. ğŸ’  å†…è”æœºå™¨äººåœ¨ä»»æ„å¯¹è¯ç•Œé¢çš„æ¶ˆæ¯ç¼–è¾‘æ¡†ï¼Œè¾“å…¥ Inline Bots çš„åå­—ï¼Œå³å¯å°† Ta ä»¬å”¤é†’ï¼ˆJust type @inlinebots keywords in any chat.ï¼‰ã€‚ Bot Info @bing å›¾ç‰‡æœç´¢ by Bingï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼‰ã€‚ @bold ğŸ‘ ä½¿ç”¨ Markdown ç¼–è¾‘æ¶ˆæ¯ï¼ˆæœ‰å­—æ•°é™åˆ¶ï¼‰ã€‚ @coub Coub æ˜¯ä¸€ä¸ªè§†é¢‘å…±äº«ç½‘ç«™ï¼ˆæ—¶é•¿åç§’çš„å¾ªç¯è§†é¢‘ï¼‰ã€‚ @creationdatebot è·å–æ³¨å†Œ Telegram çš„æ—¥æœŸã€‚ @fanyi_bot ä¸ºå…¨ä¸–ç•Œè¯­è¨€æä¾›ä¸­æ–‡ç¿»è¯‘ã€‚ @foursquare å¸®ä½ æ‰¾åˆ°é™„è¿‘çš„é¤é¦†æˆ–é™„è¿‘çš„åœ°æ–¹ï¼Œå¹¶å°†å…¶åœ°å€å‘é€ç»™æœ‹å‹ã€‚ @gamee åœ¨ç¾¤ç»„ä¸­è¾“å…¥ @gameeï¼Œé€‰æ‹©ä¸€ä¸ªæ¸¸æˆï¼Œç«‹åˆ»å’Œä½ çš„æœ‹å‹ åœ¨ Telegram ä¸Šç©å°æ¸¸æˆã€‚ @gif ğŸ‘ GIF åŠ¨å›¾æœç´¢ï¼Œæ”¯æŒä¸­æ–‡ã€‚ä¾‹å¦‚ @gif ä½ å¥½ã€‚ @imdb æŸ¥çœ‹å½±è§†ä½œå“åœ¨ äº’è”ç½‘ç”µå½±èµ„æ–™åº“ï¼ˆIMDbï¼‰çš„è¯„åˆ†ã€‚ @GoogleDEBot åœ¨ä»»æ„èŠå¤©æ¡†ä½¿ç”¨ Google æœç´¢å¼•æ“ã€‚ @like ğŸ‘ æ·»åŠ  emoji-based like buttonsï¼Œä¾‹å¦‚ ğŸ‘ &#x2F; ğŸ‘ã€‚åœ¨æœç´¢æ¡†è¾“å…¥ @likeï¼Œé¢„è®¾ä¸€äº›å–œæ¬¢çš„æŠ•ç¥¨ç¬¦å·ï¼ˆæœ€å¤š 6 ä¸ªï¼‰ï¼Œç„¶åå°±å¯ä»¥åœ¨èŠå¤©æ¡†è¾“å…¥ @like è°ƒç”¨è¿™äº›é¢„è®¾ã€‚ @music å¸®ä½ æ‰¾åˆ°åŠ¨å¬çš„å¤å…¸éŸ³ä¹ã€‚ @pic å›¾ç‰‡æœç´¢ by Yandexï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼‰ã€‚ @QuizBot ç­”é¢˜æœºå™¨äººï¼šåˆ›å»ºä¸€ä»½åªæœ‰å•é€‰é¢˜çš„è€ƒå·ã€‚ç‚¹æ­¤ å¼€å§‹æµ‹è¯•ä½ å¯¹ Telegram çš„äº†è§£ç¨‹åº¦ã€‚è®¿é—® quiz.directory æŸ¥çœ‹æ›´å¤šé—®å·ã€‚ @sticker ğŸ‘ æ£€ç´¢æ‰€æœ‰ä¸ Emoji ç›¸å…³è¡¨æƒ…åŒ…ã€‚ä¾‹å¦‚ @sticker ğŸ˜ ã€‚ @telegraph ğŸ‘ ç™»å½•å’Œç¼–è¾‘ Telegraph æ–‡ç« ï¼Œå¹¶ ç»Ÿè®¡ telegra.ph çš„æµè§ˆé‡ã€‚ @vid å¸®ä½ æŸ¥æ‰¾ YouTube è§†é¢‘ï¼ˆæ”¯æŒä¸­æ–‡æœç´¢ï¼‰ã€‚ @vote æŠ•ç¥¨æœºå™¨äººã€‚ @wiki ç»´åŸºç™¾ç§‘ã€‚æœç´¢ä¸­æ–‡æ¡ç›® @wiki zh çŒ«ï¼›æœç´¢è‹±æ–‡æ¡ç›® @wiki en cat @youtube å¸®ä½ æŸ¥æ‰¾ YouTube è§†é¢‘ï¼ˆä¸æ”¯æŒä¸­æ–‡æœç´¢ï¼‰ã€‚ ğŸ§± éå†…è”æœºå™¨äººä»¥ä¸‹ Bots ä¸èƒ½åœ¨èŠå¤©çª—å£è°ƒå–ä½¿ç”¨ã€‚ ğŸ§¡ RSS æœºå™¨äºº ï¼ˆå¦‚æœï¼‰ä½ ä¸æ‡‚å¾— RSSï¼Œä¸Šç½‘çš„æ•ˆç‡å’Œä¹è¶£éƒ½è¦å¤§æ‰“æŠ˜æ‰£ã€‚by é˜®ä¸€å³° ç›¸æ¯”äºä¼ ç»Ÿçš„ RSS å®¢æˆ·ç«¯ï¼ŒTelegram ä¸Šçš„ RSS è®¢é˜…å™¨çš„ä¼˜ç‚¹æ˜¯ï¼š è‡ªåŠ¨è®°å½•ä¸Šæ¬¡æµè§ˆçš„ä½ç½® æŸäº› RSS Bots æ”¯æŒ âš¡ INSTANT VIEW åœ¨ All About RSS é‡Œæ¨èäº†å¾ˆå¤š RSS Botsï¼š @FeedManBot @TheFeedReaderBotï¼šä¸ä»…å¯ä»¥è®¢é˜… RSS æºï¼Œè¿˜å¯ä»¥åœ¨ Telegram ä¸Šæµè§ˆ Twitterã€‚ @Feed2Telegram_botï¼šå…è´¹ç”¨æˆ·åªæœ‰ 5 æ¡ Feedsï¼›å‘é€ Twitterï¼ˆæ¨ç‰¹ï¼‰é“¾æ¥ï¼Œå³å¯è¿½è¸ªã€‚ @el_monitorro_bot @newlearner_rss_bot @NodeRSS_bot â€¦â€¦ ä»¥ä¸Šå¤§éƒ¨åˆ† Bots éƒ½èƒ½å…è´¹ä½¿ç”¨ï¼Œä½†æ˜¯ä¿ä¸é½å“ªå¤©æœåŠ¡å™¨æ’‘ä¸ä½ï¼Œå°±åœæ­¢è¿è¥äº†ï¼Œæ‰€ä»¥è®°å¾—å®šæœŸå¯¼å‡º OPML æ–‡ä»¶ä½œä¸ºå¤‡ä»½ã€‚ å¦‚æœæœ‰ VPSï¼Œè‡ªå·±æ­ä¸€ä¸ªä¸“ç”¨çš„ RSS Bot ä¼šæ˜¯ä¸é”™çš„é€‰æ‹©ã€‚ ğŸµ éŸ³ä¹æœºå™¨äººåœ¨ Telegram ä¸Šå®ç°ç‚¹æ­Œè‡ªç”±ï¼Œæˆ–è€…åƒæˆ‘ä¸€æ ·å»ºç«‹é¢‘é“ï¼Œå­˜æ”¾å–œæ¬¢çš„æ­Œå•ï¼š@tingtalk_fm æ‰¾ä¸€ä¸ªéŸ³ä¹æœºå™¨äººï¼Œä¾‹å¦‚ @haoyybot æœç´¢æ­Œåï¼Œé€‰æ‹©æ­Œæ›²ï¼Œä¸‹è½½åè½¬å‘åˆ°é¢‘é“ ä¿®æ”¹ï¼ˆEditï¼‰æ­Œæ›²ä¿¡æ¯ï¼ŒåŠ å…¥æ ‡ç­¾ï¼ˆæ–¹ä¾¿æœç´¢ï¼‰å’Œé“¾æ¥ï¼ˆä¾‹å¦‚ YouTube ä¸Šçš„ MVï¼‰ å¦‚é‡åˆ°ç‰ˆæƒé™åˆ¶ï¼Œæ— æ³•ä¸‹è½½ï¼Œæ¢ç”¨å…¶å®ƒæ­Œæ›² Botsï¼š @ChinoNyanBot @vkm_bot @vkmusic_bot @u2bu_mp3_bot å¬æ­Œè¯†æ›² @SongIDbot ä¸‹è½½ YouTube éŸ³é¢‘ @YTAudioBot ä¸‹è½½éŸ³ä¹ã€æ­Œè¯ã€è§†é¢‘ç­‰åª’ä½“ @getmediabot å†…ç½®éŸ³é¢‘æ’­æ”¾å™¨ é•¿æŒ‰ä½ã€Œä¸‹ä¸€é¦–ã€ å’Œã€Œä¸Šä¸€é¦–ã€æŒ‰é’®å¯ä»¥å¿«è¿›å’Œå€’å¸¦ã€‚Press and hold on the Next and Previous buttons to fast-forward and rewind. ğŸ’½ DC æŸ¥è¯¢Telegram çš„æœåŠ¡å™¨åˆ†å¸ƒåœ¨ä¸–ç•Œå„åœ°çš„æ•°æ®ä¸­å¿ƒï¼ˆData Centerï¼Œç®€ç§° DCï¼‰ã€‚å¦‚ä½•æŸ¥è¯¢è‡ªå·±æ‰€åœ¨çš„æ•°æ®ä¸­å¿ƒï¼ˆå¥½åƒæ²¡å•¥ç”¨ï¼‰ï¼š ç¬¬ä¸€æ­¥ï¼Œåœ¨éšç§å’Œå®‰å…¨è®¾ç½®ä¸­ï¼Œï¼ˆä¸´æ—¶ï¼‰å¼€å¯æ‰€æœ‰äººéƒ½èƒ½æŸ¥çœ‹ä½ çš„å¤´åƒï¼ˆProfile Photosï¼‰ã€‚ ç¬¬äºŒæ­¥ï¼Œé€‰æ‹©ä¸€ä¸ªæŸ¥è¯¢ Botï¼Œä¾‹å¦‚ @WooMaiBot ç¬¬ä¸‰æ­¥ï¼Œå‘é€ /dcï¼Œå³å¯è·å¾—ä½ æ‰€åœ¨çš„æ•°æ®ä¸­å¿ƒã€‚ ğŸ å…¶å®ƒæœºå™¨äºº Bot Info @bingdict_bot åŸºäº Bing å¼€å‘çš„ä¸­è‹±æ–‡ç¿»è¯‘æœºå™¨äººã€‚ @BotsArchiveBot æ”¶é›†äº†ä¸Šåƒä¸ª Botsï¼ˆä»…é™è‹±æ–‡ç‰ˆï¼‰ï¼›å®˜ç½‘ã€‚ @CorsaBot ğŸ‘ Make Instant View from any article. å¿«é€ŸæŠŠæ–‡ç« æŠŠæ–‡ç« å¤‡ä»½åˆ° Telegraphã€‚ @cnLottery_bot Telegram ç¾¤ç»„æŠ½å¥–å·¥å…·ã€‚ @DogFatherPublicbot App Store ä»·æ ¼ç›‘æ§ã€‚ @githubbot æ¨é€ GitHub ä»“åº“çš„åŠ¨æ€ã€‚ @GmailBot ğŸ‘ åœ¨ Telegram ä¸Šæ”¶å‘ ğŸ“§ Gmailã€‚ @he_weather_bot å’Œé£å¤©æ°”å°æ£‰è¢„ã€‚å¦å¤–è¿˜æœ‰ WIEN äº§å“çš„ å¹¿å·ã€æ·±åœ³ã€ä¸œè çš„å¤©æ°”é€ŸæŠ¥é¢‘é“ã€‚ @IFTTT With this bot you can use IFTTT to link your Telegram groups or channels to more than 360 other services like Twitter and Instagram, or connected devices like Hue lights and Nest. @jobs_bot This bot lists career opportunities at Telegram and accepts candidatesâ€™ applications. Available at https://telegram.org/job @LivegramBot ğŸ‘ ä¸åŠ å¥½å‹ä¹Ÿèƒ½ç§èŠï¼Œå¯ç”¨äºæ”¶é›†åé¦ˆåŠç»•å¼€ +86 æ‰‹æœºå·ç çš„é™åˆ¶ã€‚å› ä¸ºç»è¿‡ä¸€å±‚è½¬å‘ï¼Œæ¶ˆæ¯ä¸€æ—¦å‘é€ï¼Œä¾¿æ— æ³•åˆ é™¤ï¼Œä½†æœ‰ä¸ªçŸ­æš‚çš„ä¿®æ”¹æœŸã€‚ @MakeQrBot å‘é€æ–‡å­—ï¼Œç”Ÿæˆå¯¹åº”çš„äºŒç»´ç ã€‚ @sssoou_bot Telegram æœç´¢ï¼Œæ”¯æŒä¸­æ–‡ã€‚ @Stickers ğŸ‘ åˆ›å»ºå±äºè‡ªå·±çš„è¡¨æƒ…åŒ…ã€‚ @tweet_for_me_bot åœ¨ Telegram ä¸Šå‘å¸ƒ Twitter åŠ¨æ€ã€‚ @tgstogifbot æŠŠ Telegram ä¸Š tgs æ ¼å¼çš„è¡¨æƒ…åŒ…è½¬æ¢ä¸º gif æ ¼å¼ã€‚ @utubebot åŒæ—¶ä¸‹è½½ YouTube çš„è§†é¢‘å’ŒéŸ³é¢‘ï¼Œä¸è¿‡ä¼šæ¨é€ä¸€äº›å¹¿å‘Šã€‚ @verifybot åŠ äº†å®˜æ–¹è®¤è¯åï¼Œåå­—åé¢æœ‰ä¸ª âœ…ï¼ˆverify a big andactive official channel, bot or public groupï¼‰ã€‚ @zzzdmbot çœŸæ­£å€¼å¾—ä¹°æ¨é€æœºå™¨äººï¼Œå¯ä»¥æ ¹æ®å…³é”®è¯è®¢é˜…æ¨é€ä»€ä¹ˆå€¼å¾—ä¹°ç²¾é€‰ä¼˜æƒ ä¿¡æ¯ã€‚ æ›´å¤š Bots æ¨èï¼Œè¯·å‚é˜… Raw åšå®¢ ä»¥åŠ åˆé›†ç½‘ã€‚ ğŸ‘¥ ç¾¤ç»„ç®¡ç† ç¾¤ç»„äººæ•°æœ€é«˜ 20 ä¸‡ã€‚è½¬æ¢ä¸ºå¹¿æ’­ç»„ï¼ˆBroadcast Groupï¼‰ä¹‹åï¼Œäººæ•°å°†ä¸å—é™åˆ¶ï¼Œä½†åªæœ‰ç®¡ç†å‘˜å¯ä»¥è¯´è¯ï¼Œä½†æ˜¯æˆå‘˜ä»ç„¶å¯ä»¥åŠ å…¥è¯­éŸ³èŠå¤©ã€‚æ³¨æ„ï¼Œåˆ‡æ¢ä¹‹åï¼Œå°†ä¸èƒ½å›é€€åˆ°æ™®é€šç¾¤ç»„ã€‚ é™éŸ³ç¾¤ç»„åªæœ‰åœ¨ @ æåˆ°ä½ ã€ Reply å›å¤ä½ å’Œ Pin ç®¡ç†å‘˜å‘å¸ƒç¾¤é€šçŸ¥æ—¶æ‰ä¼šæ”¶åˆ°é€šçŸ¥ã€‚ æ–°åŠ å…¥çš„æˆå‘˜å¯ä»¥çœ‹åˆ°å…¨éƒ¨çš„ç¾¤èŠå†å²è®°å½•ï¼ˆNew members can see the entire message history when they joinï¼‰ã€‚ åŠ å…¥ç¾¤ç»„ä¹‹å‰ï¼Œå¯çœ‹åˆ°ï¼ˆå•å‘ï¼‰å¥½å‹æ˜¯å¦åœ¨åˆ—ã€‚å¦‚æœä¸æƒ³è®©å¥½å‹çŸ¥é“ä½ åŠ å…¥äº†æŸä¸ªç¾¤ç»„ï¼Œæ³¨å†Œä¸€ä¸ªå°å·å§ã€‚ æ”¯æŒåœ¨ä»»ä½•è®¾å¤‡ä¸Šå‘èµ·è¯­éŸ³èŠå¤©ï¼ˆVoice Chatsï¼‰ åœ¨ Telegram Desktop å’ŒåŸç”Ÿ macOS app ä¸­ï¼Œæ”¯æŒè®¾ç½®å‘è¨€å¿«æ·é”®ï¼Œä¾‹å¦‚å¤§å°å†™é”å®šé”®ã€‚ï¼ˆOn Telegram Desktop and in the native macOS app, you can choose a push-to-talk key for Voice Chats, to control your mic even when Telegram is not focused. At long last, weâ€™ve found a use for your Caps Lock key.ï¼‰ éœ€è¦åœ¨ç¿»å¢™æœåŠ¡&#x2F;è½¯ä»¶ä¸Šå¼€å¯ UDP è½¬å‘ã€‚ æˆªè‡³ 2021 å¹´ 1 æœˆ 13 æ—¥ï¼Œè¯­éŸ³èŠå¤©æ”¯æŒ 5000 äººåŒæ—¶å‚ä¸ã€‚Voice Chats for up to 5,000 participants. ä¸»æŒäººå¯ä»¥æ§åˆ¶å‘è¨€è€…çš„éŸ³é‡ï¼ˆAdjust the Volumeï¼‰ï¼Œè¿™ä¸ªè®¾ç½®æ˜¯å…¨å±€çš„ï¼Œå¯¹æ‰€æœ‰å¬ä¼—æœ‰æ•ˆã€‚ åº­è¯´è¯»è€…ç¾¤ç»„æ˜¯ @tingtalk_groupã€‚ ğŸ‘® ç®¡ç†ä¹‹é“ å¯åˆ é™¤æˆå‘˜çš„å•æ¡æ¶ˆæ¯æˆ–å…¨éƒ¨æ¶ˆæ¯ã€‚ æ…¢é€Ÿæ¨¡å¼ï¼ˆSlow Modeï¼‰ï¼šåœ¨ 10 ç§’ &#x2F; 30 ç§’ &#x2F; 1 åˆ†é’Ÿ &#x2F; 5 åˆ†é’Ÿ &#x2F; 15 åˆ†é’Ÿ &#x2F; 1 ä¸ªå°æ—¶å†…ï¼Œæˆå‘˜åªèƒ½å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œè¿™æ ·å¯ä»¥ä½¿å°ç»„ä¸­çš„å¯¹è¯æ›´åŠ æœ‰åºï¼Œä¹Ÿå¯ä»¥æé«˜æ¯æ¡ä¿¡æ¯çš„ä»·å€¼ã€‚ ç¾¤ç»„æƒé™ï¼šç®¡ç†å‘˜å¯ä»¥é™åˆ¶æ‰€æœ‰æˆå‘˜æˆ–å•ä¸ªæˆå‘˜åªèƒ½å‘é€ç‰¹å®šç±»å‹çš„å†…å®¹ï¼ˆPartial bansï¼‰ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œä½ ä¾¿å¯å»ºç«‹ä¸€ä¸ªæ²¡æœ‰è¡¨æƒ…è´´çº¸æˆ–è€… gif çš„é«˜è´¨é‡äº¤æµç¤¾åŒºã€‚æˆ–è€…ç”šè‡³å®Œå…¨é™åˆ¶æˆå‘˜å‘é€ä¿¡æ¯ï¼Œè®©ç®¡ç†å‘˜å½¼æ­¤äº¤è°ˆï¼Œè€Œç¾¤æˆå‘˜åˆ™é»˜é»˜åœ°æ—è§‚ã€‚ å¯å¯¹ç¾¤ä¸»ï¼ˆcreatorï¼‰åŠç®¡ç†å‘˜ï¼ˆadministratorsï¼‰è®¾ç½®è‡ªå®šä¹‰å¤´è¡”ï¼ˆCustom titleï¼‰ã€‚ ç®¡ç†æ—¥å¿—ï¼ˆRecent Admin Actionsï¼‰ï¼šå½“å¤šä¸ªç®¡ç†å‘˜åœ¨ä¸€èµ·å·¥ä½œæ—¶ï¼Œå¾ˆå®¹æ˜“æä¸æ¸…æ¥šå“ªä¸ªç®¡ç†å‘˜æˆ–ç®¡ç†æœºå™¨äººï¼Œåœ¨ä»€ä¹ˆæ—¶å€™åšäº†ä»€ä¹ˆã€‚æ‰€ä»¥ Telegram çš„ç®¡ç†å‘˜é¡µé¢å¢åŠ äº†ã€Œæœ€è¿‘åŠ¨ä½œã€åŠŸèƒ½ã€‚ç”¨äºå­˜å‚¨è¿‡å» 48 å°æ—¶å†…åœ¨ç»„ä¸­æ‰§è¡Œçš„æ‰€æœ‰æœåŠ¡æ“ä½œçš„æ—¥å¿—ï¼Œä»…å¯¹ç®¡ç†å‘˜å¯è§ã€‚ 2020 å¹´ 9 æœˆ 30 å¼€å§‹ï¼Œç®¡ç†å‘˜å¯ä»¥åŒ¿åå‘å¸ƒæ¶ˆæ¯äº†ï¼ˆAnonymous Group Adminsï¼‰ã€‚ æˆå‘˜è¶…è¿‡ 500 äººåï¼Œè‡ªåŠ¨å¼€é€šç¾¤ç»„åˆ†æåŠŸèƒ½ã€‚Owners of large groups with over 500 members can view beautiful, detailed graphs about its activity and growth. ğŸ” ç®¡ç†æœºå™¨äºº åœ¨ç¾¤ç»„è®¾ç½®é‡Œæœç´¢ Bots åå­—ï¼Œå³å¯æ·»åŠ ï¼Œç„¶åèµ‹äºˆå°½å¯èƒ½å°‘çš„æƒé™ã€‚ @policr_mini_bot å¼€æºéªŒè¯æœºå™¨äººï¼Œè¯¦æƒ…å‚è§ å®˜ç½‘ èµ‹äºˆ Delete messages å’Œ Ban users æƒé™ @DeleteEventsBot æˆ– @AntiServiceMessage_Bot åˆ é™¤å†—ä½™çš„äº‹ä»¶é€šçŸ¥ï¼Œä¾‹å¦‚è°åŠ å…¥äº†ç¾¤ç»„ã€‚å¼ºçƒˆå»ºè®®ç¾¤ç»„ç®¡ç†å‘˜è£…å¤‡ä¸Šè¿™ä¸ª Botï¼Œå‡å°‘ä¿¡æ¯å™ªéŸ³ èµ‹äºˆ Delete messages æƒé™ @areply_bot è‡ªåŠ¨è§£é™¤å…³è”é¢‘é“ï¼ˆLinked hannelï¼‰è½¬å‘åˆ°ç¾¤ç»„çš„è‡ªåŠ¨ç½®é¡¶æ¶ˆæ¯ï¼Œå¹¶æ¢å¤ä¹‹å‰çš„ç½®é¡¶æ¶ˆæ¯ èµ‹äºˆ Pin messages å’Œ Delete messages æƒé™ å…¶å®ƒç®¡ç†æœºå™¨äººï¼š @keyworddel_botï¼šè‡ªåŠ¨åˆ é™¤ç¾¤ç»„æ¨å¹¿ã€å¹¿å‘Šã€åšé‡‡ç­‰æ¶ˆæ¯ã€‚ SCP-079-INFOï¼šå…è´¹å¹¶å¼€æºçš„ç¾¤ç»„ç®¡ç†æœºå™¨äººï¼Œéœ€ ç”³è¯· é€šè¿‡åæ‰èƒ½ä½¿ç”¨ã€‚æŸ¥çœ‹é¡¹ç›®ä»‹ç» ğŸ¤ ç§å¯†èŠå¤©Cloud Chatsï¼ˆé»˜è®¤èŠå¤©æ¨¡å¼ï¼‰ å®¢æˆ·ç«¯ -æœåŠ¡å™¨ &#x2F; æœåŠ¡å™¨ - å®¢æˆ·ç«¯ ä¿¡æ¯å­˜å‚¨åœ¨ Telegram Cloud ä¸­è¿›è¡ŒåŠ å¯†ï¼Œè¿™ä½¿äº‘æ¶ˆæ¯æ—¢å®‰å…¨åˆå¯ä»¥ç«‹å³ä»ä»»ä½•è®¾å¤‡è®¿é—®ï¼Œå³ä½¿ä¸¢å¤±äº†è®¾å¤‡ã€‚æ‰€ä»¥ä½ ä¸éœ€è¦å°†æ‰€æœ‰çš„ä¿¡æ¯å†å²è®°å½•å­˜å‚¨åœ¨æ‰‹æœºä¸Šï¼Œå½“ä½ éœ€è¦çš„æ—¶å€™ï¼Œä½ å¯ä»¥éšæ—¶åœ¨ Telegram ä¸‹è½½ï¼ˆç¼“å­˜ï¼‰æ—§çš„ä¿¡æ¯å’Œåª’ä½“ï¼Œè¿™ä¸ºä½ èŠ‚çœäº†å¤§é‡çš„ç£ç›˜ç©ºé—´å’Œå†…å­˜ã€‚ Secret Chatsï¼ˆä¸æ”¯æŒåœ¨ Windows å’Œ Web ä¸Šå‘èµ·ï¼‰ å®¢æˆ·ç«¯ - å®¢æˆ·ç«¯ èŠå¤©è®°å½•ä¸èƒ½äº‘å¤‡ä»½ï¼Œå› ä¸ºç§äººæ•°æ®æ²¡æœ‰ç»è¿‡ Telegram çš„åŒæ­¥æœåŠ¡å™¨ï¼Œæ‰€ä»¥æ²¡æœ‰ä»»ä½•äººå¯ä»¥ç ´è§£ï¼ŒåŒ…å« Telegram å›¢é˜Ÿæœ¬èº«ã€‚ å…³è”é˜…è¯»ï¼šä¸ºä»€ä¹ˆç”µæŠ¥çš„ç«¯åˆ°ç«¯åŠ å¯†ä¸æ˜¯é»˜è®¤çš„ï¼Ÿ åªèƒ½é€šè¿‡åŸå§‹è®¾å¤‡è®¿é—®å†å²æ¶ˆæ¯ã€‚é€€å‡ºå¹¶å†æ¬¡ç™»å½•ï¼Œå°†å¤±å»æ‰€æœ‰çš„ç§˜å¯†èŠå¤©è®°å½•ã€‚ å¯è®¾ç½®é˜…åå³ç„šï¼ˆself-destructï¼‰è®¡æ—¶å™¨ï¼Œè‡ªåŠ¨é”€æ¯æ¶ˆæ¯æˆ–åª’ä½“æ–‡ä»¶ï¼ˆåªé€‚ç”¨äºè®¡æ—¶å™¨è®¾ç½®åå‘é€çš„æ¶ˆæ¯ï¼Œå¯¹æ—©æœŸçš„ä¿¡æ¯æ²¡æœ‰å½±å“ï¼‰ã€‚ ä¸èƒ½è½¬å‘æ¶ˆæ¯ã€‚ ä¸èƒ½ç¼–è¾‘å·²å‘é€çš„æ¶ˆæ¯ã€‚ Android è®¾å¤‡ä¸èƒ½æˆªå±ï¼›iOS è®¾å¤‡å¯ä»¥æˆªå± ï¼Œä½†å¯¹æ–¹æˆªå±æ—¶ä½ ä¼šæ”¶åˆ°é€šçŸ¥ã€‚ä¸è¿‡ï¼Œåªå»ºè®®ä¸ä½ ä¿¡ä»»çš„äººåˆ†äº«æ•æ„Ÿä¿¡æ¯ã€‚ æ¯•ç«Ÿï¼Œå¯¹æ–¹å¯ä»¥ç”¨å¦å¤–ä¸€å°è®¾å¤‡ç»™å±å¹•æ‹ç…§ã€‚ åˆ é™¤å‘é€æ–¹çš„æ¶ˆæ¯ï¼Œæ¥æ”¶æ–¹é‚£è¾¹ä¹Ÿä¼šå¼ºåˆ¶åˆ é™¤ã€‚ ğŸ˜ TelegraphTelegraph ä¸€ä¸ªæç®€çš„åŒ¿åå†…å®¹å‘å¸ƒå·¥å…·ï¼ˆMinimalist publishing toolï¼‰ã€‚å¦‚æœå†…å®¹ä¾µæƒäº†ï¼Œä¾‹å¦‚ä½¿ç”¨æœ‰ç‰ˆæƒçš„å›¾ç‰‡ï¼Œå¯èƒ½æ–‡ç« ä¼šè¢«æŠ•è¯‰ä¸‹æ¶ã€‚ â˜ï¸ ç”¨æ³•ä¸€æ­¤æ³•ä¸éœ€è¦æ³¨å†Œè´¦å·ä¸ä¸‹è½½è½¯ä»¶ã€‚ åœ¨æ‰‹æœºæˆ–ç”µè„‘çš„æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥ telegra.ph å†™æ–‡ç«  å‘å¸ƒï¼ˆPUBLISHï¼‰ âš ï¸ å†…å®¹å‘å¸ƒä¹‹åï¼Œåªè¦æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼Œä¾¿æ— æ³•å†ç¼–è¾‘æ–‡ç« ï¼Œä¹Ÿä¸èƒ½è¿½æº¯åˆ°æ–‡ç« ä½œè€…ã€‚ âœŒï¸ ç”¨æ³•äºŒé€šè¿‡ Telegraph æœºå™¨äºº @telegraph ç®¡ç†æ–‡ç« ï¼š èƒ½çœ‹åˆ°ä½ å‘äº†å¤šå°‘ç¯‡æ–‡ç« ï¼Œå¤šå°‘äººçœ‹äº†ï¼ˆä½†æ˜¯è¯»è€…ä¾æ—§çœ‹ä¸åˆ°ä½œè€…æ˜¯è°ï¼‰ã€‚ åœ¨ä»»æ„èŠå¤©çª—å£è¾“å…¥ @telegraphï¼Œå³å¯å¼¹å‡ºä½ å‘å¸ƒçš„æ‰€æœ‰æ–‡ç« ã€‚ ğŸ“ å‘å¸ƒæµç¨‹ åœ¨ Telegram æ‰“å¼€ Telegraph çš„å°ç®¡å®¶ @telegraph æ ¹æ®æç¤ºé…ç½® Account å†™æ–‡ç« ï¼šAuthor å¯ä»¥å†™é¢‘é“æˆ–è€…ç¾¤ç»„çš„ Public linkï¼ˆä¾‹å¦‚ https://t.me/tingtalkï¼‰ï¼Œè¯»è€…ç‚¹å‡»ä½œè€…å³å¯è·³è½¬ã€‚ å‘å¸ƒï¼ˆPUBLISHï¼‰ âœï¸ ä¿®æ”¹æµç¨‹åœ¨ä»»ä½•ä¸€ä¸ªè®¾å¤‡ï¼ˆacross any number of devicesï¼‰éƒ½å¯ä»¥å†æ¬¡ç¼–è¾‘æ–‡ç« çš„æ ‡é¢˜ã€ä½œè€…å’Œæ­£æ–‡ï¼ˆé™¤äº†æ–‡ç« é“¾æ¥ï¼‰ï¼š Log in as *** on this device è¿”å› @telegraph My postsï¼Œç‚¹å‡»æ–‡ç« çš„æ ‡é¢˜ ç”µè„‘ï¼šè‡ªåŠ¨è·³è½¬åˆ°æµè§ˆå™¨æ‰“å¼€ï¼Œç„¶ååœ¨å³ä¸Šè§’æ‰¾åˆ° EDIT æ‰‹æœºï¼šç‚¹å‡»ç•Œé¢çš„å³ä¸Šè§’ 3 ä¸ªç‚¹ï¼Œé€‰æ‹© Open inâ€¦ ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œæ»‘å€’æ–‡ç« åº•éƒ¨å³å¯çœ‹åˆ° EDIT ğŸ”— å¦‚ä½•è®©æ–‡ç« é“¾æ¥æ›´ç¾è§‚URL &#x3D; https://telegra.ph&#x2F;é¦–æ¬¡è¾“å…¥çš„æ ‡é¢˜-é¦–æ¬¡å‘è¡¨æ—¶çš„æœˆä»½ -é¦–æ¬¡å‘è¡¨æ—¶çš„æ—¥æœŸ å¦‚æœä½ ç”¨ä¸­æ–‡æ’°å†™æ ‡é¢˜ï¼Œä¾‹å¦‚ã€Šé€‰æ‹© Telegraph çš„ 10 ä¸ªç†ç”±ã€‹ï¼Œé‚£ä¹ˆæ–‡ç« é“¾æ¥ä¼šå˜å¾—åˆè‡­åˆé•¿ï¼Œä¸”ä¸èƒ½ä»é“¾æ¥æˆ–è€…æ–‡ç« ä¸»é¢˜ï¼š https:&#x2F;&#x2F;telegra.ph&#x2F;%E9%80%89%E6%8B%A9-Telegraph-%E7%9A%84-10-%E4%B8%AA%E7%90%86%E7%94%B1-12-04 è¦æƒ³å¾—åˆ°ä¸€ä¸ª friendlier-looking linkï¼Œé¦–æ¬¡ç¼–è¾‘è¯·ä½¿ç”¨è‹±æ–‡æ ‡é¢˜ï¼š è‹±æ–‡å•è¯å…¨éƒ¨å°å†™ï¼š10 reasons to choose the telegraph æŠŠ theã€aã€an ç­‰å»æ‰ï¼š10 reasons to choose telegraph ç”¨è¿å­—ç¬¦ - ä»£æ›¿æ ‡ç‚¹å’Œç©ºæ ¼ï¼š10-reasons-to-choose-telegraph æ˜¯å¦å¯ä»¥ç²¾ç®€æˆ–è€…é‡‡ç”¨å¦å¤–ä¸€ç§ç¿»è¯‘ï¼šwhy-telegraph å†ç”¨ Edit åŠŸèƒ½ä¿®æ”¹æ ‡é¢˜ä¸ºä¸­æ–‡ï¼šé€‰æ‹©ç”µæŠ¥çš„ 10 ä¸ªç†ç”±ã€‚ ğŸ“ å¦‚ä½•è®©æ–‡ç« æ’ç‰ˆæ›´ç¾è§‚ ä½¿ç”¨ Markdown å†™æ–‡ç« ï¼ˆä¾‹å¦‚ Typoraï¼‰ å¤åˆ¶ Markdown é¢„è§ˆï¼ˆä¸æ˜¯æºä»£ç ï¼‰ ç²˜è´´åˆ° telegra.phï¼Œå³å¯å¿«é€Ÿæ’å‡ºç²¾ç¾çš„æ–‡ç« ï¼ˆä¸æ”¯æŒæŸäº›æ ¼å¼ï¼Œä¾‹å¦‚å¤šçº§é¡¹ç›®åˆ—è¡¨ï¼‰ ğŸ”— å…³è”é˜…è¯» Telegram FAQï¼šç”µæŠ¥å¸¸è§é—®é¢˜ï¼ˆè‹±æ–‡ç½‘é¡µï¼‰ã€‚ The Evolution of Telegramï¼šç”µæŠ¥çš„æ¼”åŒ–ï¼ˆç®€å²ï¼‰ã€‚ Articles about Telegramï¼šè¿™äº›æ–‡ç« æ¶µç›–äº† Telegram åŠå…¶èµåŠ©å•†ã€å…¨çƒä¼ä¸šå®¶å¸•ç»´å°”â€¢æœç½—å¤«ï¼ˆPavel Durovï¼‰ã€‚ Telegram Messenger - Twitterï¼šKeep evolving and stay in touchï¼Œå®˜æ–¹æ¨ç‰¹ä¼šä»‹ç»å„ç§ #TelegramTipsã€‚ Telegram - reddit Telegram logosï¼šPlease feel free to use these Telegram logos. Just make sure people understand youâ€™re not representing Telegram officially. A long way from Moscowï¼šâ€™Russiaâ€™s Mark Zuckerbergâ€™ took on the Kremlin - and lost his country by Christopher Miller Telegram X ä»‹ç»è§†é¢‘ï¼šè¶…çº§ç‚«é…·ï¼Œä¸€å®šè¦çœ‹ã€‚ ç»™ç”µæŠ¥æ‰¾ Bugï¼šæ¬¢è¿å®‰å…¨ç ”ç©¶äººå‘˜å°† Ta ä»¬åœ¨ Telegram åº”ç”¨ç¨‹åºæˆ–åè®®ä¸­å‘ç° ğŸ§ çš„ä»»ä½•é—®é¢˜æäº¤åˆ° security@telegram.orgã€‚ æ ¹æ®é—®é¢˜çš„ä¸¥é‡ç¨‹åº¦ï¼Œå¥–é‡‘ä» 500 ç¾å…ƒåˆ° 10 ä¸‡ç¾å…ƒæˆ–æ›´å¤šã€‚ Telegram èƒŒåçš„æ•…äº‹ Telegram ä¼ å¥‡ï¼šä¸€ä¸ªå…³äºä¿„ç½—æ–¯å¯Œè±ªã€é»‘å®¢ã€ææƒå’Œé˜´è°‹çš„åˆ›ä¸šæ•…äº‹ - éœç‚¬ å…³äº Telegram çš„ä¸€äº›äº‹ - å®ˆæœ›çš„éº¦å­ï¼šæˆ‘æ›´åŠ ç›¸ä¿¡ä¸€å®šä¼šæœ‰è¶Šæ¥è¶Šå¤šçš„ç†æƒ³ä¸»ä¹‰è€…ï¼Œä»–ä»¬ç›¸ä¿¡ å¹³ç­‰ å’Œè‡ªç”±ï¼Œåšå®ˆä¿¡å¿µå’Œä»·å€¼è§‚ï¼Œæ¯å¤©å……å®åœ°ç”Ÿæ´»ç€ã€‚ æˆ‘ä¸ºä»€ä¹ˆé€‰æ‹© Telegram æ¥è¿è¥ç²‰ä¸ç¤¾ç¾¤ | è§„åˆ™ã€ç»éªŒå’Œæ€è€ƒ - ç½—ç£Š Telegram æ•™ç¨‹å…¨æŒ‡å— by TGæå®¢ Telegram ç¾¤ç»„ã€é¢‘é“ã€æœºå™¨äºº - æ±‡æ€»åˆ†äº« - èªèª Blog Telegram é¢‘é“ï¼šNewlearnerã®è‡ªç•™åœ° å¯¼èˆªé¡µ Stay home. Wash your hands. Be safe. And stay tuned for our next updates! It is already brewing in our dungeons! å‘†åœ¨å®¶ï¼Œå¸¸æ´—æ‰‹ï¼Œæ•¬è¯·å…³æ³¨ï¼Œæ›´å¼ºå¤§çš„ Telegram å·²ç»åœ¨æˆ‘ä»¬çš„åœ°ç‰¢é‡Œé…é…¿ä¸­äº†ï¼ ğŸ“ ä¸æˆ‘è”ç³»æ¬¢è¿è¯»è€…åœ¨ Telegram æœç´¢ @tingbot ä¸æˆ‘å–å¾—è”ç³»ï¼šæŒ‡å‡ºæ­¤æ–‡ç–æ¼ï¼Œæ¨èä¼˜è´¨é¢‘é“å’Œæœºå™¨äººï¼Œä¸€èµ·è·¨è¶Šæ•°å­—é¸¿æ²Ÿï¼Œå…±äº«ä¿¡æ¯è‡ªç”±ã€‚","categories":[],"tags":[{"name":"ç½‘ä¸Šå†²æµªæŒ‡å—","slug":"ç½‘ä¸Šå†²æµªæŒ‡å—","permalink":"https://blog.ehzyil.xyz/tags/%E7%BD%91%E4%B8%8A%E5%86%B2%E6%B5%AA%E6%8C%87%E5%8D%97/"},{"name":"Telegram","slug":"Telegram","permalink":"https://blog.ehzyil.xyz/tags/Telegram/"}],"author":"ehzyil"}],"categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://blog.ehzyil.xyz/categories/%E6%8A%80%E6%9C%AF/"},{"name":"è®°å½•","slug":"è®°å½•","permalink":"https://blog.ehzyil.xyz/categories/%E8%AE%B0%E5%BD%95/"},{"name":"æ•™ç¨‹","slug":"æ•™ç¨‹","permalink":"https://blog.ehzyil.xyz/categories/%E6%95%99%E7%A8%8B/"},{"name":"Linux","slug":"Linux","permalink":"https://blog.ehzyil.xyz/categories/Linux/"},{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://blog.ehzyil.xyz/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"},{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://blog.ehzyil.xyz/categories/%E5%B7%A5%E5%85%B7/"},{"name":"Docker","slug":"Docker","permalink":"https://blog.ehzyil.xyz/categories/Docker/"}],"tags":[{"name":"å†…ç½‘ç©¿é€","slug":"å†…ç½‘ç©¿é€","permalink":"https://blog.ehzyil.xyz/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"},{"name":"Java","slug":"Java","permalink":"https://blog.ehzyil.xyz/tags/Java/"},{"name":"è¸©å‘","slug":"è¸©å‘","permalink":"https://blog.ehzyil.xyz/tags/%E8%B8%A9%E5%9D%91/"},{"name":"SpringBoot","slug":"SpringBoot","permalink":"https://blog.ehzyil.xyz/tags/SpringBoot/"},{"name":"docker","slug":"docker","permalink":"https://blog.ehzyil.xyz/tags/docker/"},{"name":"git","slug":"git","permalink":"https://blog.ehzyil.xyz/tags/git/"},{"name":"Mybatis","slug":"Mybatis","permalink":"https://blog.ehzyil.xyz/tags/Mybatis/"},{"name":"MySQL","slug":"MySQL","permalink":"https://blog.ehzyil.xyz/tags/MySQL/"},{"name":"Docker","slug":"Docker","permalink":"https://blog.ehzyil.xyz/tags/Docker/"},{"name":"linux","slug":"linux","permalink":"https://blog.ehzyil.xyz/tags/linux/"},{"name":"Java Script","slug":"Java-Script","permalink":"https://blog.ehzyil.xyz/tags/Java-Script/"},{"name":"AES","slug":"AES","permalink":"https://blog.ehzyil.xyz/tags/AES/"},{"name":"Spring","slug":"Spring","permalink":"https://blog.ehzyil.xyz/tags/Spring/"},{"name":"Azure","slug":"Azure","permalink":"https://blog.ehzyil.xyz/tags/Azure/"},{"name":"å¹¶å‘","slug":"å¹¶å‘","permalink":"https://blog.ehzyil.xyz/tags/%E5%B9%B6%E5%8F%91/"},{"name":"CentOS","slug":"CentOS","permalink":"https://blog.ehzyil.xyz/tags/CentOS/"},{"name":"ç½‘ç›˜","slug":"ç½‘ç›˜","permalink":"https://blog.ehzyil.xyz/tags/%E7%BD%91%E7%9B%98/"},{"name":"æœåŠ¡å™¨","slug":"æœåŠ¡å™¨","permalink":"https://blog.ehzyil.xyz/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/"},{"name":"rss","slug":"rss","permalink":"https://blog.ehzyil.xyz/tags/rss/"},{"name":"render","slug":"render","permalink":"https://blog.ehzyil.xyz/tags/render/"},{"name":"Telegram","slug":"Telegram","permalink":"https://blog.ehzyil.xyz/tags/Telegram/"},{"name":"JVM","slug":"JVM","permalink":"https://blog.ehzyil.xyz/tags/JVM/"},{"name":"Leetcode","slug":"Leetcode","permalink":"https://blog.ehzyil.xyz/tags/Leetcode/"},{"name":"è½¯ä»¶","slug":"è½¯ä»¶","permalink":"https://blog.ehzyil.xyz/tags/%E8%BD%AF%E4%BB%B6/"},{"name":"å¼‚å¸¸","slug":"å¼‚å¸¸","permalink":"https://blog.ehzyil.xyz/tags/%E5%BC%82%E5%B8%B8/"},{"name":"AOP","slug":"AOP","permalink":"https://blog.ehzyil.xyz/tags/AOP/"},{"name":"æ—¥å¿—","slug":"æ—¥å¿—","permalink":"https://blog.ehzyil.xyz/tags/%E6%97%A5%E5%BF%97/"},{"name":"å›¾ç‰‡ä¸Šä¼ ","slug":"å›¾ç‰‡ä¸Šä¼ ","permalink":"https://blog.ehzyil.xyz/tags/%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/"},{"name":"Quartz","slug":"Quartz","permalink":"https://blog.ehzyil.xyz/tags/Quartz/"},{"name":"IntelliJ IDEA","slug":"IntelliJ-IDEA","permalink":"https://blog.ehzyil.xyz/tags/IntelliJ-IDEA/"},{"name":"JSP","slug":"JSP","permalink":"https://blog.ehzyil.xyz/tags/JSP/"},{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://blog.ehzyil.xyz/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"},{"name":"æ ‡ç­¾æ’ä»¶","slug":"æ ‡ç­¾æ’ä»¶","permalink":"https://blog.ehzyil.xyz/tags/%E6%A0%87%E7%AD%BE%E6%8F%92%E4%BB%B6/"},{"name":"Linux","slug":"Linux","permalink":"https://blog.ehzyil.xyz/tags/Linux/"},{"name":"Yauaa","slug":"Yauaa","permalink":"https://blog.ehzyil.xyz/tags/Yauaa/"},{"name":"node.js","slug":"node-js","permalink":"https://blog.ehzyil.xyz/tags/node-js/"},{"name":"Spring Security","slug":"Spring-Security","permalink":"https://blog.ehzyil.xyz/tags/Spring-Security/"},{"name":"Nacos","slug":"Nacos","permalink":"https://blog.ehzyil.xyz/tags/Nacos/"},{"name":"ç½‘ä¸Šå†²æµªæŒ‡å—","slug":"ç½‘ä¸Šå†²æµªæŒ‡å—","permalink":"https://blog.ehzyil.xyz/tags/%E7%BD%91%E4%B8%8A%E5%86%B2%E6%B5%AA%E6%8C%87%E5%8D%97/"}]}